function throwDeprecated(t){throw new Error("Function "+t+" Deprecated")}function countTotal(t){var e=1;if(t.children)for(var o=0;o<t.children.length;o++)e+=countTotal(t.children[o]);return e}window.miniqyboot=!0;window.QYCOMPILED=!0;var Box2D={};Box2D.MIN_VALUE=Number.MIN_VALUE||1e-100;!function(){function t(t,e){e||(e=1);var i,n,r,s,a,l=t.length,g=[];for(i=0;l>i;i++)g.push(new b2Vec2(t[i].x*e,t[i].y*e));s=o(g);l=s.length;var m=new Array(l);for(i=0;l>i;i++){t=[];g=s[i];r=g.length;for(n=0;r>n;n++)t.push(new b2Vec2(g[n].x/e,g[n].y/e));a=new b2PolygonShape;a.SetAsVector(t);m[i]=a}return m}function e(t){var e,o,i,r,s,a,g,m=t.length,c=0,u=!1;for(e=0;m>e;e++){r=m-1>e?e+1:0;s=e>0?e-1:m-1;g=!1;for(o=0;m>o;o++)if(o!=e&&o!=r){if(!g){a=l(t[e].x,t[e].y,t[r].x,t[r].y,t[o].x,t[o].y);a>0&&(g=!0)}if(o!=s){i=m-1>o?o+1:0;n(t[e].x,t[e].y,t[r].x,t[r].y,t[o].x,t[o].y,t[i].x,t[i].y)&&(c=1)}}g||(u=!0)}u&&(c=1==c?3:2);return c}function o(t){var e,o,n,a,m,c,u,h,p,_,d,y,f,v,x,b,S,A,C,E,D,T,R,w,B,M,I=[],N=[];N.push(t);for(;N.length;){e=N[0];n=e.length;M=!0;for(o=0;n>o;o++){_=o;d=n-1>o?o+1:o+1-n;y=n-2>o?o+2:o+2-n;f=e[_];v=e[d];x=e[y];m=l(f.x,f.y,v.x,v.y,x.x,x.y);if(0>m){M=!1;p=Number.MAX_VALUE;for(a=0;n>a;a++)if(a!=_&&a!=d){b=a;S=n-1>a?a+1:0;A=e[b];C=e[S];w=i(f.x,f.y,v.x,v.y,A.x,A.y,C.x,C.y);if(w){u=v.x-w.x;h=v.y-w.y;c=u*u+h*h;if(p>c){D=b;E=S;B=w;p=c}}}p==Number.MAX_VALUE&&g();T=[];R=[];b=D;S=E;A=e[b];C=e[S];s(B.x,B.y,C.x,C.y)||T.push(B);s(B.x,B.y,A.x,A.y)||R.push(B);D=-1;E=_;for(;;){if(E==S){(0>D||D>=n)&&g();r(C.x,C.y,e[D].x,e[D].y,f.x,f.y)||T.push(e[E]);break}T.push(e[E]);D=E;0>E-1?E=n-1:E--}T=T.reverse();D=-1;E=d;for(;;){if(E==b){(0>D||D>=n)&&g();E!=b||r(A.x,A.y,e[D].x,e[D].y,v.x,v.y)||R.push(e[E]);break}R.push(e[E]);D=E;E+1>n-1?E=0:E++}N.push(T,R);N.shift();break}}M&&I.push(N.shift())}return I}function i(t,e,o,i,n,s,a,l){var g,m=n-t,c=s-e,u=o-t,h=i-e,p=a-n,_=l-s,d=h*p-u*_;g=(p*c-_*m)/d;var y=t+g*u,f=e+g*h,v=r(o,i,t,e,y,f),x=r(y,f,n,s,a,l);return v&&x?new b2Vec2(y,f):null}function n(t,e,o,i,n,s,a,l){var g,m=n-t,c=s-e,u=o-t,h=i-e,p=a-n,_=l-s,d=h*p-u*_;g=(p*c-_*m)/d;var y=t+g*u,f=e+g*h,v=r(y,f,t,e,o,i),x=r(y,f,n,s,a,l);return v&&x?new b2Vec2(y,f):null}function r(t,e,o,i,n,r){var s=o+.1>=t&&t>=n-.1||t>=o-.1&&n+.1>=t,l=i+.1>=e&&e>=r-.1||e>=i-.1&&r+.1>=e;return s&&l&&a(t,e,o,i,n,r)}function s(t,e,o,i){var n=o>=t?o-t:t-o,r=i>=e?i-e:e-i;return.1>n&&.1>r}function a(t,e,o,i,n,r){if(n-o>.1||o-n>.1){var s=(r-i)/(n-o),a=s*(t-o)+i,l=a>e?a-e:e-a;return.1>l}return.1>t-o||.1>o-t}function l(t,e,o,i,n,r){return t*i+o*r+n*e-e*o-i*n-r*t}function g(){throw"A problem has occurred. Use the Validate() method to see where the problem is."}window.qyengine||(window.qyengine={});qyengine.separateShape=t;qyengine.validateShape=e}();!function(t,e){function o(){}!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(t,e,o){o.get instanceof Function&&t.__defineGetter__(e,o.get);o.set instanceof Function&&t.__defineSetter__(e,o.set)});t.inherit=function(t,e){var i=t;o.prototype=e.prototype;t.prototype=new o;t.prototype.constructor=i};t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}};t.NVector=function(t){t===e&&(t=0);for(var o=new Array(t||0),i=0;t>i;++i)o[i]=0;return o};t.is=function(t,o){return null===t?!1:o instanceof Function&&t instanceof o?!0:t.constructor.__implements!=e&&t.constructor.__implements[o]?!0:!1};t.parseUInt=function(t){return Math.abs(parseInt(t))}}(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"==typeof Box2D&&(Box2D={});"undefined"==typeof Box2D.Collision&&(Box2D.Collision={});"undefined"==typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={});"undefined"==typeof Box2D.Common&&(Box2D.Common={});"undefined"==typeof Box2D.Common.Math&&(Box2D.Common.Math={});"undefined"==typeof Box2D.Dynamics&&(Box2D.Dynamics={});"undefined"==typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={});"undefined"==typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={});"undefined"==typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={});!function(){function t(){t.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function o(){o.b2BoundValues.apply(this,arguments);this.constructor===o&&this.b2BoundValues.apply(this,arguments)}function i(){i.b2Collision.apply(this,arguments)}function n(){n.b2ContactID.apply(this,arguments);this.constructor===n&&this.b2ContactID.apply(this,arguments)}function r(){r.b2ContactPoint.apply(this,arguments)}function s(){s.b2Distance.apply(this,arguments)}function a(){a.b2DistanceInput.apply(this,arguments)}function l(){l.b2DistanceOutput.apply(this,arguments)}function g(){g.b2DistanceProxy.apply(this,arguments)}function m(){m.b2DynamicTree.apply(this,arguments);this.constructor===m&&this.b2DynamicTree.apply(this,arguments)}function c(){c.b2DynamicTreeBroadPhase.apply(this,arguments)}function u(){u.b2DynamicTreeNode.apply(this,arguments)}function h(){h.b2DynamicTreePair.apply(this,arguments)}function p(){p.b2Manifold.apply(this,arguments);this.constructor===p&&this.b2Manifold.apply(this,arguments)}function _(){_.b2ManifoldPoint.apply(this,arguments);this.constructor===_&&this.b2ManifoldPoint.apply(this,arguments)}function d(){d.b2Point.apply(this,arguments)}function y(){y.b2RayCastInput.apply(this,arguments);this.constructor===y&&this.b2RayCastInput.apply(this,arguments)}function f(){f.b2RayCastOutput.apply(this,arguments)}function v(){v.b2Segment.apply(this,arguments)}function x(){x.b2SeparationFunction.apply(this,arguments)}function b(){b.b2Simplex.apply(this,arguments);this.constructor===b&&this.b2Simplex.apply(this,arguments)}function S(){S.b2SimplexCache.apply(this,arguments)}function A(){A.b2SimplexVertex.apply(this,arguments)}function C(){C.b2TimeOfImpact.apply(this,arguments)}function E(){E.b2TOIInput.apply(this,arguments)}function D(){D.b2WorldManifold.apply(this,arguments);this.constructor===D&&this.b2WorldManifold.apply(this,arguments)}function T(){T.ClipVertex.apply(this,arguments)}function R(){R.Features.apply(this,arguments)}function w(){w.b2CircleShape.apply(this,arguments);this.constructor===w&&this.b2CircleShape.apply(this,arguments)}function B(){B.b2EdgeChainDef.apply(this,arguments);this.constructor===B&&this.b2EdgeChainDef.apply(this,arguments)}function M(){M.b2EdgeShape.apply(this,arguments);this.constructor===M&&this.b2EdgeShape.apply(this,arguments)}function I(){I.b2MassData.apply(this,arguments)}function N(){N.b2PolygonShape.apply(this,arguments);this.constructor===N&&this.b2PolygonShape.apply(this,arguments)}function L(){L.b2Shape.apply(this,arguments);this.constructor===L&&this.b2Shape.apply(this,arguments)}function O(){O.b2Color.apply(this,arguments);this.constructor===O&&this.b2Color.apply(this,arguments)}function P(){P.b2Settings.apply(this,arguments)}function F(){F.b2Mat22.apply(this,arguments);this.constructor===F&&this.b2Mat22.apply(this,arguments)}function V(){V.b2Mat33.apply(this,arguments);this.constructor===V&&this.b2Mat33.apply(this,arguments)}function H(){H.b2Math.apply(this,arguments)}function k(){k.b2Sweep.apply(this,arguments)}function G(){G.b2Transform.apply(this,arguments);this.constructor===G&&this.b2Transform.apply(this,arguments)}function K(){K.b2Vec2.apply(this,arguments);this.constructor===K&&this.b2Vec2.apply(this,arguments)}function z(){z.b2Vec3.apply(this,arguments);this.constructor===z&&this.b2Vec3.apply(this,arguments)}function U(){U.b2Body.apply(this,arguments);this.constructor===U&&this.b2Body.apply(this,arguments)}function $(){$.b2BodyDef.apply(this,arguments);this.constructor===$&&this.b2BodyDef.apply(this,arguments)}function J(){J.b2ContactFilter.apply(this,arguments)}function q(){q.b2ContactImpulse.apply(this,arguments)}function W(){W.b2ContactListener.apply(this,arguments)}function j(){j.b2ContactManager.apply(this,arguments);this.constructor===j&&this.b2ContactManager.apply(this,arguments)}function Y(){Y.b2DebugDraw.apply(this,arguments);this.constructor===Y&&this.b2DebugDraw.apply(this,arguments)}function X(){X.b2DestructionListener.apply(this,arguments)}function Z(){Z.b2FilterData.apply(this,arguments)}function Q(){Q.b2Fixture.apply(this,arguments);this.constructor===Q&&this.b2Fixture.apply(this,arguments)}function te(){te.b2FixtureDef.apply(this,arguments);this.constructor===te&&this.b2FixtureDef.apply(this,arguments)}function ee(){ee.b2Island.apply(this,arguments);this.constructor===ee&&this.b2Island.apply(this,arguments)}function oe(){oe.b2TimeStep.apply(this,arguments)}function ie(){ie.b2World.apply(this,arguments);this.constructor===ie&&this.b2World.apply(this,arguments)}function ne(){ne.b2CircleContact.apply(this,arguments)}function re(){re.b2Contact.apply(this,arguments);this.constructor===re&&this.b2Contact.apply(this,arguments)}function se(){se.b2ContactConstraint.apply(this,arguments);this.constructor===se&&this.b2ContactConstraint.apply(this,arguments)}function ae(){ae.b2ContactConstraintPoint.apply(this,arguments)}function le(){le.b2ContactEdge.apply(this,arguments)}function ge(){ge.b2ContactFactory.apply(this,arguments);this.constructor===ge&&this.b2ContactFactory.apply(this,arguments)}function me(){me.b2ContactRegister.apply(this,arguments)}function ce(){ce.b2ContactResult.apply(this,arguments)}function ue(){ue.b2ContactSolver.apply(this,arguments);this.constructor===ue&&this.b2ContactSolver.apply(this,arguments)}function he(){he.b2EdgeAndCircleContact.apply(this,arguments)}function pe(){pe.b2NullContact.apply(this,arguments);this.constructor===pe&&this.b2NullContact.apply(this,arguments)}function _e(){_e.b2PolyAndCircleContact.apply(this,arguments)}function de(){de.b2PolyAndEdgeContact.apply(this,arguments)}function ye(){ye.b2PolygonContact.apply(this,arguments)}function fe(){fe.b2PositionSolverManifold.apply(this,arguments);this.constructor===fe&&this.b2PositionSolverManifold.apply(this,arguments)}function ve(){ve.b2BuoyancyController.apply(this,arguments)}function xe(){xe.b2ConstantAccelController.apply(this,arguments)}function be(){be.b2ConstantForceController.apply(this,arguments)}function Se(){Se.b2Controller.apply(this,arguments)}function Ae(){Ae.b2ControllerEdge.apply(this,arguments)}function Ce(){Ce.b2GravityController.apply(this,arguments)}function Ee(){Ee.b2TensorDampingController.apply(this,arguments)}function De(){De.b2DistanceJoint.apply(this,arguments);this.constructor===De&&this.b2DistanceJoint.apply(this,arguments)}function Te(){Te.b2DistanceJointDef.apply(this,arguments);this.constructor===Te&&this.b2DistanceJointDef.apply(this,arguments)}function Re(){Re.b2RopeJoint.apply(this,arguments);this.constructor===Re&&this.b2RopeJoint.apply(this,arguments)}function we(){we.b2RopeJointDef.apply(this,arguments);this.constructor===we&&this.b2RopeJointDef.apply(this,arguments)}function Be(){Be.b2FrictionJoint.apply(this,arguments);this.constructor===Be&&this.b2FrictionJoint.apply(this,arguments)}function Me(){Me.b2FrictionJointDef.apply(this,arguments);this.constructor===Me&&this.b2FrictionJointDef.apply(this,arguments)}function Ie(){Ie.b2GearJoint.apply(this,arguments);this.constructor===Ie&&this.b2GearJoint.apply(this,arguments)}function Ne(){Ne.b2GearJointDef.apply(this,arguments);this.constructor===Ne&&this.b2GearJointDef.apply(this,arguments)}function Le(){Le.b2Jacobian.apply(this,arguments)}function Oe(){Oe.b2Joint.apply(this,arguments);this.constructor===Oe&&this.b2Joint.apply(this,arguments)}function Pe(){Pe.b2JointDef.apply(this,arguments);this.constructor===Pe&&this.b2JointDef.apply(this,arguments)}function Fe(){Fe.b2JointEdge.apply(this,arguments)}function Ve(){Ve.b2LineJoint.apply(this,arguments);this.constructor===Ve&&this.b2LineJoint.apply(this,arguments)}function He(){He.b2LineJointDef.apply(this,arguments);this.constructor===He&&this.b2LineJointDef.apply(this,arguments)}function ke(){ke.b2MouseJoint.apply(this,arguments);this.constructor===ke&&this.b2MouseJoint.apply(this,arguments)}function Ge(){Ge.b2MouseJointDef.apply(this,arguments);this.constructor===Ge&&this.b2MouseJointDef.apply(this,arguments)}function Ke(){Ke.b2PrismaticJoint.apply(this,arguments);this.constructor===Ke&&this.b2PrismaticJoint.apply(this,arguments)}function ze(){ze.b2PrismaticJointDef.apply(this,arguments);this.constructor===ze&&this.b2PrismaticJointDef.apply(this,arguments)}function Ue(){Ue.b2PulleyJoint.apply(this,arguments);this.constructor===Ue&&this.b2PulleyJoint.apply(this,arguments)}function $e(){$e.b2PulleyJointDef.apply(this,arguments);this.constructor===$e&&this.b2PulleyJointDef.apply(this,arguments)}function Je(){Je.b2RevoluteJoint.apply(this,arguments);this.constructor===Je&&this.b2RevoluteJoint.apply(this,arguments)}function qe(){qe.b2RevoluteJointDef.apply(this,arguments);this.constructor===qe&&this.b2RevoluteJointDef.apply(this,arguments)}function We(){We.b2WeldJoint.apply(this,arguments);this.constructor===We&&this.b2WeldJoint.apply(this,arguments)}function je(){je.b2WeldJointDef.apply(this,arguments);this.constructor===je&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";Box2D.Collision.b2AABB=t;Box2D.Collision.b2Bound=e;Box2D.Collision.b2BoundValues=o;Box2D.Collision.b2Collision=i;Box2D.Collision.b2ContactID=n;Box2D.Collision.b2ContactPoint=r;Box2D.Collision.b2Distance=s;Box2D.Collision.b2DistanceInput=a;Box2D.Collision.b2DistanceOutput=l;Box2D.Collision.b2DistanceProxy=g;Box2D.Collision.b2DynamicTree=m;Box2D.Collision.b2DynamicTreeBroadPhase=c;Box2D.Collision.b2DynamicTreeNode=u;Box2D.Collision.b2DynamicTreePair=h;Box2D.Collision.b2Manifold=p;Box2D.Collision.b2ManifoldPoint=_;Box2D.Collision.b2Point=d;Box2D.Collision.b2RayCastInput=y;Box2D.Collision.b2RayCastOutput=f;Box2D.Collision.b2Segment=v;Box2D.Collision.b2SeparationFunction=x;Box2D.Collision.b2Simplex=b;Box2D.Collision.b2SimplexCache=S;Box2D.Collision.b2SimplexVertex=A;Box2D.Collision.b2TimeOfImpact=C;Box2D.Collision.b2TOIInput=E;Box2D.Collision.b2WorldManifold=D;Box2D.Collision.ClipVertex=T;Box2D.Collision.Features=R;Box2D.Collision.Shapes.b2CircleShape=w;Box2D.Collision.Shapes.b2EdgeChainDef=B;Box2D.Collision.Shapes.b2EdgeShape=M;Box2D.Collision.Shapes.b2MassData=I;Box2D.Collision.Shapes.b2PolygonShape=N;Box2D.Collision.Shapes.b2Shape=L;Box2D.Common.b2internal="Box2D.Common.b2internal";Box2D.Common.b2Color=O;Box2D.Common.b2Settings=P;Box2D.Common.Math.b2Mat22=F;Box2D.Common.Math.b2Mat33=V;Box2D.Common.Math.b2Math=H;Box2D.Common.Math.b2Sweep=k;Box2D.Common.Math.b2Transform=G;Box2D.Common.Math.b2Vec2=K;Box2D.Common.Math.b2Vec3=z;Box2D.Dynamics.b2Body=U;Box2D.Dynamics.b2BodyDef=$;Box2D.Dynamics.b2ContactFilter=J;Box2D.Dynamics.b2ContactImpulse=q;Box2D.Dynamics.b2ContactListener=W;Box2D.Dynamics.b2ContactManager=j;Box2D.Dynamics.b2DebugDraw=Y;Box2D.Dynamics.b2DestructionListener=X;Box2D.Dynamics.b2FilterData=Z;Box2D.Dynamics.b2Fixture=Q;Box2D.Dynamics.b2FixtureDef=te;Box2D.Dynamics.b2Island=ee;Box2D.Dynamics.b2TimeStep=oe;Box2D.Dynamics.b2World=ie;Box2D.Dynamics.Contacts.b2CircleContact=ne;Box2D.Dynamics.Contacts.b2Contact=re;Box2D.Dynamics.Contacts.b2ContactConstraint=se;Box2D.Dynamics.Contacts.b2ContactConstraintPoint=ae;Box2D.Dynamics.Contacts.b2ContactEdge=le;Box2D.Dynamics.Contacts.b2ContactFactory=ge;Box2D.Dynamics.Contacts.b2ContactRegister=me;Box2D.Dynamics.Contacts.b2ContactResult=ce;Box2D.Dynamics.Contacts.b2ContactSolver=ue;Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=he;Box2D.Dynamics.Contacts.b2NullContact=pe;Box2D.Dynamics.Contacts.b2PolyAndCircleContact=_e;Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=de;Box2D.Dynamics.Contacts.b2PolygonContact=ye;Box2D.Dynamics.Contacts.b2PositionSolverManifold=fe;Box2D.Dynamics.Controllers.b2BuoyancyController=ve;Box2D.Dynamics.Controllers.b2ConstantAccelController=xe;Box2D.Dynamics.Controllers.b2ConstantForceController=be;Box2D.Dynamics.Controllers.b2Controller=Se;Box2D.Dynamics.Controllers.b2ControllerEdge=Ae;Box2D.Dynamics.Controllers.b2GravityController=Ce;Box2D.Dynamics.Controllers.b2TensorDampingController=Ee;Box2D.Dynamics.Joints.b2DistanceJoint=De;Box2D.Dynamics.Joints.b2DistanceJointDef=Te;Box2D.Dynamics.Joints.b2RopeJoint=Re;Box2D.Dynamics.Joints.b2RopeJointDef=we;Box2D.Dynamics.Joints.b2FrictionJoint=Be;Box2D.Dynamics.Joints.b2FrictionJointDef=Me;Box2D.Dynamics.Joints.b2GearJoint=Ie;Box2D.Dynamics.Joints.b2GearJointDef=Ne;Box2D.Dynamics.Joints.b2Jacobian=Le;Box2D.Dynamics.Joints.b2Joint=Oe;Box2D.Dynamics.Joints.b2JointDef=Pe;Box2D.Dynamics.Joints.b2JointEdge=Fe;Box2D.Dynamics.Joints.b2LineJoint=Ve;Box2D.Dynamics.Joints.b2LineJointDef=He;Box2D.Dynamics.Joints.b2MouseJoint=ke;Box2D.Dynamics.Joints.b2MouseJointDef=Ge;Box2D.Dynamics.Joints.b2PrismaticJoint=Ke;Box2D.Dynamics.Joints.b2PrismaticJointDef=ze;Box2D.Dynamics.Joints.b2PulleyJoint=Ue;Box2D.Dynamics.Joints.b2PulleyJointDef=$e;Box2D.Dynamics.Joints.b2RevoluteJoint=Je;Box2D.Dynamics.Joints.b2RevoluteJointDef=qe;Box2D.Dynamics.Joints.b2WeldJoint=We;Box2D.Dynamics.Joints.b2WeldJointDef=je}();Box2D.postDefs=[];!function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),o=Box2D.Collision.Shapes.b2Shape,i=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),n=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),r=Box2D.Common.Math.b2Sweep,s=Box2D.Common.Math.b2Transform,a=Box2D.Common.Math.b2Vec2,l=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB),g=Box2D.Collision.b2Bound,m=Box2D.Collision.b2BoundValues,c=Box2D.Collision.b2Collision,u=Box2D.Collision.b2ContactID,h=Box2D.Collision.b2ContactPoint,p=Box2D.Collision.b2Distance,_=Box2D.Collision.b2DistanceInput,d=Box2D.Collision.b2DistanceOutput,y=Box2D.Collision.b2DistanceProxy,f=Box2D.Collision.b2DynamicTree,v=Box2D.Collision.b2DynamicTreeBroadPhase,x=Box2D.Collision.b2DynamicTreeNode,b=Box2D.Collision.b2DynamicTreePair,S=Box2D.Collision.b2Manifold,A=Box2D.Collision.b2ManifoldPoint,C=Box2D.Collision.b2Point,E=Box2D.Collision.b2RayCastInput,D=Box2D.Collision.b2RayCastOutput,T=Box2D.Collision.b2Segment,R=Box2D.Collision.b2SeparationFunction,w=Box2D.Collision.b2Simplex,B=Box2D.Collision.b2SimplexCache,M=Box2D.Collision.b2SimplexVertex,I=Box2D.Collision.b2TimeOfImpact,N=Box2D.Collision.b2TOIInput,L=Box2D.Collision.b2WorldManifold,O=Box2D.Collision.ClipVertex,P=Box2D.Collision.Features,F=Box2D.Collision.IBroadPhase;l.b2AABB=function(){this.lowerBound=new a;this.upperBound=new a};l.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,o=t>=0&&e>=0;o=o&&this.lowerBound.IsValid()&&this.upperBound.IsValid();return o};l.prototype.GetCenter=function(){return new a((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)};l.prototype.GetExtents=function(){return new a((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};l.prototype.Contains=function(t){var e=!0;e=e&&this.lowerBound.x<=t.lowerBound.x;e=e&&this.lowerBound.y<=t.lowerBound.y;e=e&&t.upperBound.x<=this.upperBound.x;e=e&&t.upperBound.y<=this.upperBound.y;return e};l.prototype.RayCast=function(t,e){var o=-Number.MAX_VALUE,i=Number.MAX_VALUE,n=e.p1.x,r=e.p1.y,s=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(s),g=Math.abs(a),m=t.normal,c=0,u=0,h=0,p=0,_=0;if(l<Box2D.MIN_VALUE){if(n<this.lowerBound.x||this.upperBound.x<n)return!1}else{c=1/s;u=(this.lowerBound.x-n)*c;h=(this.upperBound.x-n)*c;_=-1;if(u>h){p=u;u=h;h=p;_=1}if(u>o){m.x=_;m.y=0;o=u}i=Math.min(i,h);if(o>i)return!1}if(g<Box2D.MIN_VALUE){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else{c=1/a;u=(this.lowerBound.y-r)*c;h=(this.upperBound.y-r)*c;_=-1;if(u>h){p=u;u=h;h=p;_=1}if(u>o){m.y=_;m.x=0;o=u}i=Math.min(i,h);if(o>i)return!1}t.fraction=o;return!0};l.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,o=t.lowerBound.y-this.upperBound.y,i=this.lowerBound.x-t.upperBound.x,n=this.lowerBound.y-t.upperBound.y;return e>0||o>0?!1:i>0||n>0?!1:!0};l.Combine=function(t,e){var o=new l;o.Combine(t,e);return o};l.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x);this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y);this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x);this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)};g.b2Bound=function(){};g.prototype.IsLower=function(){return 0==(1&this.value)};g.prototype.IsUpper=function(){return 1==(1&this.value)};g.prototype.Swap=function(t){var e=this.value,o=this.proxy,i=this.stabbingCount;this.value=t.value;this.proxy=t.proxy;this.stabbingCount=t.stabbingCount;t.value=e;t.proxy=o;t.stabbingCount=i};m.b2BoundValues=function(){};m.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number;this.lowerValues[0]=0;this.lowerValues[1]=0;this.upperValues=new Vector_a2j_Number;this.upperValues[0]=0;this.upperValues[1]=0};c.b2Collision=function(){};c.ClipSegmentToLine=function(t,e,o,i){void 0===i&&(i=0);var n,r=0;n=e[0];var s=n.v;n=e[1];var a=n.v,l=o.x*s.x+o.y*s.y-i,g=o.x*a.x+o.y*a.y-i;0>=l&&t[r++].Set(e[0]);0>=g&&t[r++].Set(e[1]);if(0>l*g){var m=l/(l-g);n=t[r];var c=n.v;c.x=s.x+m*(a.x-s.x);c.y=s.y+m*(a.y-s.y);n=t[r];var u;if(l>0){u=e[0];n.id=u.id}else{u=e[1];n.id=u.id}++r}return r};c.EdgeSeparation=function(t,e,o,i,n){void 0===o&&(o=0);var r,s,a=(parseInt(t.m_vertexCount),t.m_vertices),l=t.m_normals,g=parseInt(i.m_vertexCount),m=i.m_vertices;r=e.R;s=l[o];var c=r.col1.x*s.x+r.col2.x*s.y,u=r.col1.y*s.x+r.col2.y*s.y;r=n.R;for(var h=r.col1.x*c+r.col1.y*u,p=r.col2.x*c+r.col2.y*u,_=0,d=Number.MAX_VALUE,y=0;g>y;++y){s=m[y];var f=s.x*h+s.y*p;if(d>f){d=f;_=y}}s=a[o];r=e.R;var v=e.position.x+(r.col1.x*s.x+r.col2.x*s.y),x=e.position.y+(r.col1.y*s.x+r.col2.y*s.y);s=m[_];r=n.R;var b=n.position.x+(r.col1.x*s.x+r.col2.x*s.y),S=n.position.y+(r.col1.y*s.x+r.col2.y*s.y);b-=v;S-=x;var A=b*c+S*u;return A};c.FindMaxSeparation=function(t,e,o,i,n){var r,s,a=parseInt(e.m_vertexCount),l=e.m_normals;s=n.R;r=i.m_centroid;var g=n.position.x+(s.col1.x*r.x+s.col2.x*r.y),m=n.position.y+(s.col1.y*r.x+s.col2.y*r.y);s=o.R;r=e.m_centroid;g-=o.position.x+(s.col1.x*r.x+s.col2.x*r.y);m-=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);for(var u=g*o.R.col1.x+m*o.R.col1.y,h=g*o.R.col2.x+m*o.R.col2.y,p=0,_=-Number.MAX_VALUE,d=0;a>d;++d){r=l[d];var y=r.x*u+r.y*h;if(y>_){_=y;p=d}}var f=c.EdgeSeparation(e,o,p,i,n),v=parseInt(p-1>=0?p-1:a-1),x=c.EdgeSeparation(e,o,v,i,n),b=parseInt(a>p+1?p+1:0),S=c.EdgeSeparation(e,o,b,i,n),A=0,C=0,E=0;if(x>f&&x>S){E=-1;A=v;C=x}else{if(!(S>f)){t[0]=p;return f}E=1;A=b;C=S}for(;;){p=-1==E?A-1>=0?A-1:a-1:a>A+1?A+1:0;f=c.EdgeSeparation(e,o,p,i,n);if(!(f>C))break;A=p;C=f}t[0]=A;return C};c.FindIncidentEdge=function(t,e,o,i,n,r){void 0===i&&(i=0);var s,a,l=(parseInt(e.m_vertexCount),e.m_normals),g=parseInt(n.m_vertexCount),m=n.m_vertices,c=n.m_normals;s=o.R;a=l[i];var u=s.col1.x*a.x+s.col2.x*a.y,h=s.col1.y*a.x+s.col2.y*a.y;s=r.R;var p=s.col1.x*u+s.col1.y*h;h=s.col2.x*u+s.col2.y*h;u=p;for(var _=0,d=Number.MAX_VALUE,y=0;g>y;++y){a=c[y];var f=u*a.x+h*a.y;if(d>f){d=f;_=y}}var v,x=parseInt(_),b=parseInt(g>x+1?x+1:0);v=t[0];a=m[x];s=r.R;v.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y);v.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y);v.id.features.referenceEdge=i;v.id.features.incidentEdge=x;v.id.features.incidentVertex=0;v=t[1];a=m[b];s=r.R;v.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y);v.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y);v.id.features.referenceEdge=i;v.id.features.incidentEdge=b;v.id.features.incidentVertex=1};c.MakeClipPointVector=function(){var t=new Vector(2);t[0]=new O;t[1]=new O;return t};c.CollidePolygons=function(t,e,o,n,r){var s;t.m_pointCount=0;var a=e.m_radius+n.m_radius,l=0;c.s_edgeAO[0]=l;var g=c.FindMaxSeparation(c.s_edgeAO,e,o,n,r);l=c.s_edgeAO[0];if(!(g>a)){var m=0;c.s_edgeBO[0]=m;var u=c.FindMaxSeparation(c.s_edgeBO,n,r,e,o);m=c.s_edgeBO[0];if(!(u>a)){var h,p,_,d,y,f=0,v=0,x=.98,b=.001;if(u>x*g+b){h=n;p=e;_=r;d=o;f=m;t.m_type=S.e_faceB;v=1}else{h=e;p=n;_=o;d=r;f=l;t.m_type=S.e_faceA;v=0}var A=c.s_incidentEdge;c.FindIncidentEdge(A,h,_,f,p,d);var C,E=parseInt(h.m_vertexCount),D=h.m_vertices,T=D[f];C=E>f+1?D[parseInt(f+1)]:D[0];var R=c.s_localTangent;R.Set(C.x-T.x,C.y-T.y);R.Normalize();var w=c.s_localNormal;w.x=R.y;w.y=-R.x;var B=c.s_planePoint;B.Set(.5*(T.x+C.x),.5*(T.y+C.y));var M=c.s_tangent;y=_.R;M.x=y.col1.x*R.x+y.col2.x*R.y;M.y=y.col1.y*R.x+y.col2.y*R.y;var I=c.s_tangent2;I.x=-M.x;I.y=-M.y;var N=c.s_normal;N.x=M.y;N.y=-M.x;var L=c.s_v11,O=c.s_v12;L.x=_.position.x+(y.col1.x*T.x+y.col2.x*T.y);L.y=_.position.y+(y.col1.y*T.x+y.col2.y*T.y);O.x=_.position.x+(y.col1.x*C.x+y.col2.x*C.y);O.y=_.position.y+(y.col1.y*C.x+y.col2.y*C.y);var P=N.x*L.x+N.y*L.y,F=-M.x*L.x-M.y*L.y+a,V=M.x*O.x+M.y*O.y+a,H=c.s_clipPoints1,k=c.s_clipPoints2,G=0;G=c.ClipSegmentToLine(H,A,I,F);if(!(2>G)){G=c.ClipSegmentToLine(k,H,M,V);if(!(2>G)){t.m_localPlaneNormal.SetV(w);t.m_localPoint.SetV(B);for(var K=0,z=0;z<i.b2_maxManifoldPoints;++z){s=k[z];var U=N.x*s.v.x+N.y*s.v.y-P;if(a>=U){var $=t.m_points[K];y=d.R;var J=s.v.x-d.position.x,q=s.v.y-d.position.y;$.m_localPoint.x=J*y.col1.x+q*y.col1.y;$.m_localPoint.y=J*y.col2.x+q*y.col2.y;$.m_id.Set(s.id);$.m_id.features.flip=v;++K}}t.m_pointCount=K}}}}};c.CollideCircles=function(t,e,o,i,n){t.m_pointCount=0;var r,s;r=o.R;s=e.m_p;var a=o.position.x+(r.col1.x*s.x+r.col2.x*s.y),l=o.position.y+(r.col1.y*s.x+r.col2.y*s.y);r=n.R;s=i.m_p;var g=n.position.x+(r.col1.x*s.x+r.col2.x*s.y),m=n.position.y+(r.col1.y*s.x+r.col2.y*s.y),c=g-a,u=m-l,h=c*c+u*u,p=e.m_radius+i.m_radius;if(!(h>p*p)){t.m_type=S.e_circles;t.m_localPoint.SetV(e.m_p);t.m_localPlaneNormal.SetZero();t.m_pointCount=1;t.m_points[0].m_localPoint.SetV(i.m_p);t.m_points[0].m_id.key=0}};c.CollidePolygonAndCircle=function(t,e,o,i,n){t.m_pointCount=0;var r,s,a=0,l=0;s=n.R;r=i.m_p;var g=n.position.x+(s.col1.x*r.x+s.col2.x*r.y),m=n.position.y+(s.col1.y*r.x+s.col2.y*r.y);a=g-o.position.x;l=m-o.position.y;s=o.R;for(var c=a*s.col1.x+l*s.col1.y,u=a*s.col2.x+l*s.col2.y,h=0,p=-Number.MAX_VALUE,_=e.m_radius+i.m_radius,d=parseInt(e.m_vertexCount),y=e.m_vertices,f=e.m_normals,v=0;d>v;++v){r=y[v];a=c-r.x;l=u-r.y;r=f[v];var x=r.x*a+r.y*l;if(x>_)return;if(x>p){p=x;h=v}}var b=parseInt(h),A=parseInt(d>b+1?b+1:0),C=y[b],E=y[A];if(p<Box2D.MIN_VALUE){t.m_pointCount=1;t.m_type=S.e_faceA;t.m_localPlaneNormal.SetV(f[h]);t.m_localPoint.x=.5*(C.x+E.x);t.m_localPoint.y=.5*(C.y+E.y);t.m_points[0].m_localPoint.SetV(i.m_p);t.m_points[0].m_id.key=0}else{var D=(c-C.x)*(E.x-C.x)+(u-C.y)*(E.y-C.y),T=(c-E.x)*(C.x-E.x)+(u-E.y)*(C.y-E.y);if(0>=D){if((c-C.x)*(c-C.x)+(u-C.y)*(u-C.y)>_*_)return;t.m_pointCount=1;t.m_type=S.e_faceA;t.m_localPlaneNormal.x=c-C.x;t.m_localPlaneNormal.y=u-C.y;t.m_localPlaneNormal.Normalize();t.m_localPoint.SetV(C);t.m_points[0].m_localPoint.SetV(i.m_p);t.m_points[0].m_id.key=0}else if(0>=T){if((c-E.x)*(c-E.x)+(u-E.y)*(u-E.y)>_*_)return;t.m_pointCount=1;t.m_type=S.e_faceA;t.m_localPlaneNormal.x=c-E.x;t.m_localPlaneNormal.y=u-E.y;t.m_localPlaneNormal.Normalize();t.m_localPoint.SetV(E);t.m_points[0].m_localPoint.SetV(i.m_p);t.m_points[0].m_id.key=0}else{var R=.5*(C.x+E.x),w=.5*(C.y+E.y);p=(c-R)*f[b].x+(u-w)*f[b].y;if(p>_)return;t.m_pointCount=1;t.m_type=S.e_faceA;t.m_localPlaneNormal.x=f[b].x;t.m_localPlaneNormal.y=f[b].y;t.m_localPlaneNormal.Normalize();t.m_localPoint.Set(R,w);t.m_points[0].m_localPoint.SetV(i.m_p);t.m_points[0].m_id.key=0}}};c.TestOverlap=function(t,e){var o=e.lowerBound,i=t.upperBound,n=o.x-i.x,r=o.y-i.y;o=t.lowerBound;i=e.upperBound;var s=o.x-i.x,a=o.y-i.y;return n>0||r>0?!1:s>0||a>0?!1:!0};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=c.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints1=c.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=c.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new a;Box2D.Collision.b2Collision.s_localNormal=new a;Box2D.Collision.b2Collision.s_planePoint=new a;Box2D.Collision.b2Collision.s_normal=new a;Box2D.Collision.b2Collision.s_tangent=new a;Box2D.Collision.b2Collision.s_tangent2=new a;Box2D.Collision.b2Collision.s_v11=new a;Box2D.Collision.b2Collision.s_v12=new a;Box2D.Collision.b2Collision.b2CollidePolyTempVec=new a;Box2D.Collision.b2Collision.b2_nullFeature=255});u.b2ContactID=function(){this.features=new P};u.prototype.b2ContactID=function(){this.features._m_id=this};u.prototype.Set=function(t){this.key=t._key};u.prototype.Copy=function(){var t=new u;t.key=this.key;return t};Object.defineProperty(u.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}});Object.defineProperty(u.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._key=t;this.features._referenceEdge=255&this._key;this.features._incidentEdge=(65280&this._key)>>8&255;this.features._incidentVertex=(16711680&this._key)>>16&255;this.features._flip=(4278190080&this._key)>>24&255}});h.b2ContactPoint=function(){this.position=new a;this.velocity=new a;this.normal=new a;this.id=new u};p.b2Distance=function(){};p.Distance=function(t,e,o){++p.b2_gjkCalls;var r=o.proxyA,s=o.proxyB,l=o.transformA,g=o.transformB,m=p.s_simplex;m.ReadCache(e,r,l,s,g);for(var c,u=m.m_vertices,h=20,_=p.s_saveA,d=p.s_saveB,y=0,f=m.GetClosestPoint(),v=f.LengthSquared(),x=v,b=0,S=0;h>S;){y=m.m_count;for(b=0;y>b;b++){_[b]=u[b].indexA;d[b]=u[b].indexB}switch(m.m_count){case 1:break;case 2:m.Solve2();break;case 3:m.Solve3();break;default:i.b2Assert(!1)}if(3==m.m_count)break;c=m.GetClosestPoint();x=c.LengthSquared();v=x;var A=m.GetSearchDirection();if(A.LengthSquared()<Box2D.MIN_VALUE*Box2D.MIN_VALUE)break;var C=u[m.m_count];C.indexA=r.GetSupport(n.MulTMV(l.R,A.GetNegative()));C.wA=n.MulX(l,r.GetVertex(C.indexA));C.indexB=s.GetSupport(n.MulTMV(g.R,A));C.wB=n.MulX(g,s.GetVertex(C.indexB));C.w=n.SubtractVV(C.wB,C.wA);++S;++p.b2_gjkIters;var E=!1;for(b=0;y>b;b++)if(C.indexA==_[b]&&C.indexB==d[b]){E=!0;break}if(E)break;++m.m_count}p.b2_gjkMaxIters=n.Max(p.b2_gjkMaxIters,S);m.GetWitnessPoints(t.pointA,t.pointB);t.distance=n.SubtractVV(t.pointA,t.pointB).Length();t.iterations=S;m.WriteCache(e);if(o.useRadii){var D=r.m_radius,T=s.m_radius;if(t.distance>D+T&&t.distance>Box2D.MIN_VALUE){t.distance-=D+T;var R=n.SubtractVV(t.pointB,t.pointA);R.Normalize();t.pointA.x+=D*R.x;t.pointA.y+=D*R.y;t.pointB.x-=T*R.x;t.pointB.y-=T*R.y}else{c=new a;c.x=.5*(t.pointA.x+t.pointB.x);c.y=.5*(t.pointA.y+t.pointB.y);t.pointA.x=t.pointB.x=c.x;t.pointA.y=t.pointB.y=c.y;t.distance=0}}};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new w;Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)});_.b2DistanceInput=function(){};d.b2DistanceOutput=function(){this.pointA=new a;this.pointB=new a};y.b2DistanceProxy=function(){};y.prototype.Set=function(n){switch(n.GetType()){case o.e_circleShape:var r=n instanceof t?n:null;this.m_vertices=new Vector(1,!0);this.m_vertices[0]=r.m_p;this.m_count=1;this.m_radius=r.m_radius;break;case o.e_polygonShape:var s=n instanceof e?n:null;this.m_vertices=s.m_vertices;this.m_count=s.m_vertexCount;this.m_radius=s.m_radius;break;default:i.b2Assert(!1)}};y.prototype.GetSupport=function(t){for(var e=0,o=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,i=1;i<this.m_count;++i){var n=this.m_vertices[i].x*t.x+this.m_vertices[i].y*t.y;if(n>o){e=i;o=n}}return e};y.prototype.GetSupportVertex=function(t){for(var e=0,o=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,i=1;i<this.m_count;++i){var n=this.m_vertices[i].x*t.x+this.m_vertices[i].y*t.y;if(n>o){e=i;o=n}}return this.m_vertices[e]};y.prototype.GetVertexCount=function(){return this.m_count};y.prototype.GetVertex=function(t){void 0===t&&(t=0);i.b2Assert(t>=0&&t<this.m_count);return this.m_vertices[t]};f.b2DynamicTree=function(){};f.prototype.b2DynamicTree=function(){this.m_root=null;
this.m_freeList=null;this.m_path=0;this.m_insertionCount=0};f.prototype.CreateProxy=function(t,e){var o=this.AllocateNode(),n=i.b2_aabbExtension,r=i.b2_aabbExtension;o.aabb.lowerBound.x=t.lowerBound.x-n;o.aabb.lowerBound.y=t.lowerBound.y-r;o.aabb.upperBound.x=t.upperBound.x+n;o.aabb.upperBound.y=t.upperBound.y+r;o.userData=e;this.InsertLeaf(o);return o};f.prototype.DestroyProxy=function(t){this.RemoveLeaf(t);this.FreeNode(t)};f.prototype.MoveProxy=function(t,e,o){i.b2Assert(t.IsLeaf());if(t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=i.b2_aabbExtension+i.b2_aabbMultiplier*(o.x>0?o.x:-o.x),r=i.b2_aabbExtension+i.b2_aabbMultiplier*(o.y>0?o.y:-o.y);t.aabb.lowerBound.x=e.lowerBound.x-n;t.aabb.lowerBound.y=e.lowerBound.y-r;t.aabb.upperBound.x=e.upperBound.x+n;t.aabb.upperBound.y=e.upperBound.y+r;this.InsertLeaf(t);return!0};f.prototype.Rebalance=function(t){void 0===t&&(t=0);if(null!=this.m_root)for(var e=0;t>e;e++){for(var o=this.m_root,i=0;0==o.IsLeaf();){o=this.m_path>>i&1?o.child2:o.child1;i=i+1&31}++this.m_path;this.RemoveLeaf(o);this.InsertLeaf(o)}};f.prototype.GetFatAABB=function(t){return t.aabb};f.prototype.GetUserData=function(t){return t.userData};f.prototype.Query=function(t,e){if(null!=this.m_root){var o=new Vector,i=0;o[i++]=this.m_root;for(;i>0;){var n=o[--i];if(n.aabb.TestOverlap(e))if(n.IsLeaf()){var r=t(n);if(!r)return}else{o[i++]=n.child1;o[i++]=n.child2}}}};f.prototype.RayCast=function(t,e){if(null!=this.m_root){var o=e.p1,i=e.p2,r=n.SubtractVV(o,i);r.Normalize();var s=n.CrossFV(1,r),a=n.AbsV(s),g=e.maxFraction,m=new l,c=0,u=0;c=o.x+g*(i.x-o.x);u=o.y+g*(i.y-o.y);m.lowerBound.x=Math.min(o.x,c);m.lowerBound.y=Math.min(o.y,u);m.upperBound.x=Math.max(o.x,c);m.upperBound.y=Math.max(o.y,u);var h=new Vector,p=0;h[p++]=this.m_root;for(;p>0;){var _=h[--p];if(0!=_.aabb.TestOverlap(m)){var d=_.aabb.GetCenter(),y=_.aabb.GetExtents(),f=Math.abs(s.x*(o.x-d.x)+s.y*(o.y-d.y))-a.x*y.x-a.y*y.y;if(!(f>0))if(_.IsLeaf()){var v=new E;v.p1=e.p1;v.p2=e.p2;v.maxFraction=e.maxFraction;g=t(v,_);if(0==g)return;if(g>0){c=o.x+g*(i.x-o.x);u=o.y+g*(i.y-o.y);m.lowerBound.x=Math.min(o.x,c);m.lowerBound.y=Math.min(o.y,u);m.upperBound.x=Math.max(o.x,c);m.upperBound.y=Math.max(o.y,u)}}else{h[p++]=_.child1;h[p++]=_.child2}}}}};f.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;this.m_freeList=t.parent;t.parent=null;t.child1=null;t.child2=null;return t}return new x};f.prototype.FreeNode=function(t){t.parent=this.m_freeList;this.m_freeList=t};f.prototype.InsertLeaf=function(t){++this.m_insertionCount;if(null!=this.m_root){var e=t.aabb.GetCenter(),o=this.m_root;if(0==o.IsLeaf())do{var i=o.child1,n=o.child2,r=Math.abs((i.aabb.lowerBound.x+i.aabb.upperBound.x)/2-e.x)+Math.abs((i.aabb.lowerBound.y+i.aabb.upperBound.y)/2-e.y),s=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y);o=s>r?i:n}while(0==o.IsLeaf());var a=o.parent,l=this.AllocateNode();l.parent=a;l.userData=null;l.aabb.Combine(t.aabb,o.aabb);if(a){o.parent.child1==o?a.child1=l:a.child2=l;l.child1=o;l.child2=t;o.parent=l;t.parent=l;do{if(a.aabb.Contains(l.aabb))break;a.aabb.Combine(a.child1.aabb,a.child2.aabb);l=a;a=a.parent}while(a)}else{l.child1=o;l.child2=t;o.parent=l;t.parent=l;this.m_root=l}}else{this.m_root=t;this.m_root.parent=null}};f.prototype.RemoveLeaf=function(t){if(t!=this.m_root){var e,o=t.parent,i=o.parent;e=o.child1==t?o.child2:o.child1;if(i){i.child1==o?i.child1=e:i.child2=e;e.parent=i;this.FreeNode(o);for(;i;){var n=i.aabb;i.aabb=l.Combine(i.child1.aabb,i.child2.aabb);if(n.Contains(i.aabb))break;i=i.parent}}else{this.m_root=e;e.parent=null;this.FreeNode(o)}}else this.m_root=null};v.b2DynamicTreeBroadPhase=function(){this.m_tree=new f;this.m_moveBuffer=new Vector;this.m_pairBuffer=new Vector;this.m_pairCount=0};v.prototype.CreateProxy=function(t,e){var o=this.m_tree.CreateProxy(t,e);++this.m_proxyCount;this.BufferMove(o);return o};v.prototype.DestroyProxy=function(t){this.UnBufferMove(t);--this.m_proxyCount;this.m_tree.DestroyProxy(t)};v.prototype.MoveProxy=function(t,e,o){var i=this.m_tree.MoveProxy(t,e,o);i&&this.BufferMove(t)};v.prototype.TestOverlap=function(t,e){var o=this.m_tree.GetFatAABB(t),i=this.m_tree.GetFatAABB(e);return o.TestOverlap(i)};v.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)};v.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)};v.prototype.GetProxyCount=function(){return this.m_proxyCount};v.prototype.UpdatePairs=function(t){function e(t){if(t==i)return!0;o.m_pairCount==o.m_pairBuffer.length&&(o.m_pairBuffer[o.m_pairCount]=new b);var e=o.m_pairBuffer[o.m_pairCount];e.proxyA=i>t?t:i;e.proxyB=t>=i?t:i;++o.m_pairCount;return!0}var o=this;o.m_pairCount=0;var i,n=0;for(n=0;n<o.m_moveBuffer.length;++n){i=o.m_moveBuffer[n];var r=o.m_tree.GetFatAABB(i);o.m_tree.Query(e,r)}o.m_moveBuffer.length=0;for(var n=0;n<o.m_pairCount;){var s=o.m_pairBuffer[n],a=o.m_tree.GetUserData(s.proxyA),l=o.m_tree.GetUserData(s.proxyB);t(a,l);++n;for(;n<o.m_pairCount;){var g=o.m_pairBuffer[n];if(g.proxyA!=s.proxyA||g.proxyB!=s.proxyB)break;++n}}};v.prototype.Query=function(t,e){this.m_tree.Query(t,e)};v.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)};v.prototype.Validate=function(){};v.prototype.Rebalance=function(t){void 0===t&&(t=0);this.m_tree.Rebalance(t)};v.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t};v.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)};v.prototype.ComparePairs=function(){return 0};v.__implements={};v.__implements[F]=!0;x.b2DynamicTreeNode=function(){this.aabb=new l};x.prototype.IsLeaf=function(){return null==this.child1};b.b2DynamicTreePair=function(){};S.b2Manifold=function(){this.m_pointCount=0};S.prototype.b2Manifold=function(){this.m_points=new Vector(i.b2_maxManifoldPoints);for(var t=0;t<i.b2_maxManifoldPoints;t++)this.m_points[t]=new A;this.m_localPlaneNormal=new a;this.m_localPoint=new a};S.prototype.Reset=function(){for(var t=0;t<i.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof A?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_type=0;this.m_pointCount=0};S.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<i.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof A?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal);this.m_localPoint.SetV(t.m_localPoint);this.m_type=t.m_type};S.prototype.Copy=function(){var t=new S;t.Set(this);return t};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=4});A.b2ManifoldPoint=function(){this.m_localPoint=new a;this.m_id=new u};A.prototype.b2ManifoldPoint=function(){this.Reset()};A.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_normalImpulse=0;this.m_tangentImpulse=0;this.m_id.key=0};A.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint);this.m_normalImpulse=t.m_normalImpulse;this.m_tangentImpulse=t.m_tangentImpulse;this.m_id.Set(t.m_id)};C.b2Point=function(){this.p=new a};C.prototype.Support=function(t,e,o){void 0===e&&(e=0);void 0===o&&(o=0);return this.p};C.prototype.GetFirstVertex=function(){return this.p};E.b2RayCastInput=function(){this.p1=new a;this.p2=new a};E.prototype.b2RayCastInput=function(t,e,o){void 0===t&&(t=null);void 0===e&&(e=null);void 0===o&&(o=1);t&&this.p1.SetV(t);e&&this.p2.SetV(e);this.maxFraction=o};D.b2RayCastOutput=function(){this.normal=new a};T.b2Segment=function(){this.p1=new a;this.p2=new a};T.prototype.TestSegment=function(t,e,o,i){void 0===i&&(i=0);var n=o.p1,r=o.p2.x-n.x,s=o.p2.y-n.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,g=l,m=-a,c=100*Box2D.MIN_VALUE,u=-(r*g+s*m);if(u>c){var h=n.x-this.p1.x,p=n.y-this.p1.y,_=h*g+p*m;if(_>=0&&i*u>=_){var d=-r*p+s*h;if(d>=-c*u&&u*(1+c)>=d){_/=u;var y=Math.sqrt(g*g+m*m);g/=y;m/=y;t[0]=_;e.Set(g,m);return!0}}}return!1};T.prototype.Extend=function(t){this.ExtendForward(t);this.ExtendBackward(t)};T.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,o=this.p2.y-this.p1.y,i=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:0>e?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,o>0?(t.upperBound.y-this.p1.y)/o:0>o?(t.lowerBound.y-this.p1.y)/o:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*i;this.p2.y=this.p1.y+o*i};T.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,o=-this.p2.y+this.p1.y,i=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:0>e?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,o>0?(t.upperBound.y-this.p2.y)/o:0>o?(t.lowerBound.y-this.p2.y)/o:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*i;this.p1.y=this.p2.y+o*i};R.b2SeparationFunction=function(){this.m_localPoint=new a;this.m_axis=new a};R.prototype.Initialize=function(t,e,o,r,s){this.m_proxyA=e;this.m_proxyB=r;var l=parseInt(t.count);i.b2Assert(l>0&&3>l);var g,m,c,u,h,p,_,d,y=0,f=0,v=0,x=0,b=0,S=0,A=0,C=0;if(1==l){this.m_type=R.e_points;g=this.m_proxyA.GetVertex(t.indexA[0]);u=this.m_proxyB.GetVertex(t.indexB[0]);d=g;_=o.R;y=o.position.x+(_.col1.x*d.x+_.col2.x*d.y);f=o.position.y+(_.col1.y*d.x+_.col2.y*d.y);d=u;_=s.R;v=s.position.x+(_.col1.x*d.x+_.col2.x*d.y);x=s.position.y+(_.col1.y*d.x+_.col2.y*d.y);this.m_axis.x=v-y;this.m_axis.y=x-f;this.m_axis.Normalize()}else if(t.indexB[0]==t.indexB[1]){this.m_type=R.e_faceA;m=this.m_proxyA.GetVertex(t.indexA[0]);c=this.m_proxyA.GetVertex(t.indexA[1]);u=this.m_proxyB.GetVertex(t.indexB[0]);this.m_localPoint.x=.5*(m.x+c.x);this.m_localPoint.y=.5*(m.y+c.y);this.m_axis=n.CrossVF(n.SubtractVV(c,m),1);this.m_axis.Normalize();d=this.m_axis;_=o.R;b=_.col1.x*d.x+_.col2.x*d.y;S=_.col1.y*d.x+_.col2.y*d.y;d=this.m_localPoint;_=o.R;y=o.position.x+(_.col1.x*d.x+_.col2.x*d.y);f=o.position.y+(_.col1.y*d.x+_.col2.y*d.y);d=u;_=s.R;v=s.position.x+(_.col1.x*d.x+_.col2.x*d.y);x=s.position.y+(_.col1.y*d.x+_.col2.y*d.y);A=(v-y)*b+(x-f)*S;0>A&&this.m_axis.NegativeSelf()}else if(t.indexA[0]==t.indexA[0]){this.m_type=R.e_faceB;h=this.m_proxyB.GetVertex(t.indexB[0]);p=this.m_proxyB.GetVertex(t.indexB[1]);g=this.m_proxyA.GetVertex(t.indexA[0]);this.m_localPoint.x=.5*(h.x+p.x);this.m_localPoint.y=.5*(h.y+p.y);this.m_axis=n.CrossVF(n.SubtractVV(p,h),1);this.m_axis.Normalize();d=this.m_axis;_=s.R;b=_.col1.x*d.x+_.col2.x*d.y;S=_.col1.y*d.x+_.col2.y*d.y;d=this.m_localPoint;_=s.R;v=s.position.x+(_.col1.x*d.x+_.col2.x*d.y);x=s.position.y+(_.col1.y*d.x+_.col2.y*d.y);d=g;_=o.R;y=o.position.x+(_.col1.x*d.x+_.col2.x*d.y);f=o.position.y+(_.col1.y*d.x+_.col2.y*d.y);A=(y-v)*b+(f-x)*S;0>A&&this.m_axis.NegativeSelf()}else{m=this.m_proxyA.GetVertex(t.indexA[0]);c=this.m_proxyA.GetVertex(t.indexA[1]);h=this.m_proxyB.GetVertex(t.indexB[0]);p=this.m_proxyB.GetVertex(t.indexB[1]);var E=(n.MulX(o,g),n.MulMV(o.R,n.SubtractVV(c,m))),D=(n.MulX(s,u),n.MulMV(s.R,n.SubtractVV(p,h))),T=E.x*E.x+E.y*E.y,w=D.x*D.x+D.y*D.y,B=n.SubtractVV(D,E),M=E.x*B.x+E.y*B.y,I=D.x*B.x+D.y*B.y,N=E.x*D.x+E.y*D.y,L=T*w-N*N;A=0;0!=L&&(A=n.Clamp((N*I-M*w)/L,0,1));var O=(N*A+I)/w;if(0>O){O=0;A=n.Clamp((N-M)/T,0,1)}g=new a;g.x=m.x+A*(c.x-m.x);g.y=m.y+A*(c.y-m.y);u=new a;u.x=h.x+A*(p.x-h.x);u.y=h.y+A*(p.y-h.y);if(0==A||1==A){this.m_type=R.e_faceB;this.m_axis=n.CrossVF(n.SubtractVV(p,h),1);this.m_axis.Normalize();this.m_localPoint=u;d=this.m_axis;_=s.R;b=_.col1.x*d.x+_.col2.x*d.y;S=_.col1.y*d.x+_.col2.y*d.y;d=this.m_localPoint;_=s.R;v=s.position.x+(_.col1.x*d.x+_.col2.x*d.y);x=s.position.y+(_.col1.y*d.x+_.col2.y*d.y);d=g;_=o.R;y=o.position.x+(_.col1.x*d.x+_.col2.x*d.y);f=o.position.y+(_.col1.y*d.x+_.col2.y*d.y);C=(y-v)*b+(f-x)*S;0>A&&this.m_axis.NegativeSelf()}else{this.m_type=R.e_faceA;this.m_axis=n.CrossVF(n.SubtractVV(c,m),1);this.m_localPoint=g;d=this.m_axis;_=o.R;b=_.col1.x*d.x+_.col2.x*d.y;S=_.col1.y*d.x+_.col2.y*d.y;d=this.m_localPoint;_=o.R;y=o.position.x+(_.col1.x*d.x+_.col2.x*d.y);f=o.position.y+(_.col1.y*d.x+_.col2.y*d.y);d=u;_=s.R;v=s.position.x+(_.col1.x*d.x+_.col2.x*d.y);x=s.position.y+(_.col1.y*d.x+_.col2.y*d.y);C=(v-y)*b+(x-f)*S;0>A&&this.m_axis.NegativeSelf()}}};R.prototype.Evaluate=function(t,e){var o,r,s,a,l,g,m,c=0;switch(this.m_type){case R.e_points:o=n.MulTMV(t.R,this.m_axis);r=n.MulTMV(e.R,this.m_axis.GetNegative());s=this.m_proxyA.GetSupportVertex(o);a=this.m_proxyB.GetSupportVertex(r);l=n.MulX(t,s);g=n.MulX(e,a);c=(g.x-l.x)*this.m_axis.x+(g.y-l.y)*this.m_axis.y;return c;case R.e_faceA:m=n.MulMV(t.R,this.m_axis);l=n.MulX(t,this.m_localPoint);r=n.MulTMV(e.R,m.GetNegative());a=this.m_proxyB.GetSupportVertex(r);g=n.MulX(e,a);c=(g.x-l.x)*m.x+(g.y-l.y)*m.y;return c;case R.e_faceB:m=n.MulMV(e.R,this.m_axis);g=n.MulX(e,this.m_localPoint);o=n.MulTMV(t.R,m.GetNegative());s=this.m_proxyA.GetSupportVertex(o);l=n.MulX(t,s);c=(l.x-g.x)*m.x+(l.y-g.y)*m.y;return c;default:i.b2Assert(!1);return 0}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;Box2D.Collision.b2SeparationFunction.e_faceA=2;Box2D.Collision.b2SeparationFunction.e_faceB=4});w.b2Simplex=function(){this.m_v1=new M;this.m_v2=new M;this.m_v3=new M;this.m_vertices=new Vector(3)};w.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};w.prototype.ReadCache=function(t,e,o,r,s){i.b2Assert(0<=t.count&&t.count<=3);var a,l;this.m_count=t.count;for(var g=this.m_vertices,m=0;m<this.m_count;m++){var c=g[m];c.indexA=t.indexA[m];c.indexB=t.indexB[m];a=e.GetVertex(c.indexA);l=r.GetVertex(c.indexB);c.wA=n.MulX(o,a);c.wB=n.MulX(s,l);c.w=n.SubtractVV(c.wB,c.wA);c.a=0}if(this.m_count>1){var u=t.metric,h=this.GetMetric();(.5*u>h||h>2*u||h<Box2D.MIN_VALUE)&&(this.m_count=0)}if(0==this.m_count){c=g[0];c.indexA=0;c.indexB=0;a=e.GetVertex(0);l=r.GetVertex(0);c.wA=n.MulX(o,a);c.wB=n.MulX(s,l);c.w=n.SubtractVV(c.wB,c.wA);this.m_count=1}};w.prototype.WriteCache=function(t){t.metric=this.GetMetric();t.count=Box2D.parseUInt(this.m_count);for(var e=this.m_vertices,o=0;o<this.m_count;o++){t.indexA[o]=Box2D.parseUInt(e[o].indexA);t.indexB[o]=Box2D.parseUInt(e[o].indexB)}};w.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=n.SubtractVV(this.m_v2.w,this.m_v1.w),e=n.CrossVV(t,this.m_v1.w.GetNegative());return e>0?n.CrossFV(1,t):n.CrossVF(t,1);default:i.b2Assert(!1);return new a}};w.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:i.b2Assert(!1);return new a;case 1:return this.m_v1.w;case 2:return new a(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:i.b2Assert(!1);return new a}};w.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:i.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA);e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:i.b2Assert(!1)}};w.prototype.GetMetric=function(){switch(this.m_count){case 0:i.b2Assert(!1);return 0;case 1:return 0;case 2:return n.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return n.CrossVV(n.SubtractVV(this.m_v2.w,this.m_v1.w),n.SubtractVV(this.m_v3.w,this.m_v1.w));default:i.b2Assert(!1);return 0}};w.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,o=n.SubtractVV(e,t),i=-(t.x*o.x+t.y*o.y);if(0>=i){this.m_v1.a=1;this.m_count=1}else{var r=e.x*o.x+e.y*o.y;if(0>=r){this.m_v2.a=1;this.m_count=1;this.m_v1.Set(this.m_v2)}else{var s=1/(r+i);this.m_v1.a=r*s;this.m_v2.a=i*s;this.m_count=2}}};w.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,o=this.m_v3.w,i=n.SubtractVV(e,t),r=n.Dot(t,i),s=n.Dot(e,i),a=s,l=-r,g=n.SubtractVV(o,t),m=n.Dot(t,g),c=n.Dot(o,g),u=c,h=-m,p=n.SubtractVV(o,e),_=n.Dot(e,p),d=n.Dot(o,p),y=d,f=-_,v=n.CrossVV(i,g),x=v*n.CrossVV(e,o),b=v*n.CrossVV(o,t),S=v*n.CrossVV(t,e);if(0>=l&&0>=h){this.m_v1.a=1;this.m_count=1}else if(a>0&&l>0&&0>=S){var A=1/(a+l);this.m_v1.a=a*A;this.m_v2.a=l*A;this.m_count=2}else if(u>0&&h>0&&0>=b){var C=1/(u+h);this.m_v1.a=u*C;this.m_v3.a=h*C;this.m_count=2;this.m_v2.Set(this.m_v3)}else if(0>=a&&0>=f){this.m_v2.a=1;this.m_count=1;this.m_v1.Set(this.m_v2)}else if(0>=u&&0>=y){this.m_v3.a=1;this.m_count=1;this.m_v1.Set(this.m_v3)}else if(y>0&&f>0&&0>=x){var E=1/(y+f);this.m_v2.a=y*E;this.m_v3.a=f*E;this.m_count=2;this.m_v1.Set(this.m_v3)}else{var D=1/(x+b+S);this.m_v1.a=x*D;this.m_v2.a=b*D;this.m_v3.a=S*D;this.m_count=3}};B.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3)};M.b2SimplexVertex=function(){};M.prototype.Set=function(t){this.wA.SetV(t.wA);this.wB.SetV(t.wB);this.w.SetV(t.w);this.a=t.a;this.indexA=t.indexA;this.indexB=t.indexB};I.b2TimeOfImpact=function(){};I.TimeOfImpact=function(t){++I.b2_toiCalls;var e=t.proxyA,o=t.proxyB,r=t.sweepA,s=t.sweepB;i.b2Assert(r.t0==s.t0);i.b2Assert(1-r.t0>Box2D.MIN_VALUE);var a=e.m_radius+o.m_radius,l=t.tolerance,g=0,m=1e3,c=0,u=0;I.s_cache.count=0;I.s_distanceInput.useRadii=!1;for(;;){r.GetTransform(I.s_xfA,g);s.GetTransform(I.s_xfB,g);I.s_distanceInput.proxyA=e;I.s_distanceInput.proxyB=o;I.s_distanceInput.transformA=I.s_xfA;I.s_distanceInput.transformB=I.s_xfB;p.Distance(I.s_distanceOutput,I.s_cache,I.s_distanceInput);if(I.s_distanceOutput.distance<=0){g=1;break}I.s_fcn.Initialize(I.s_cache,e,I.s_xfA,o,I.s_xfB);var h=I.s_fcn.Evaluate(I.s_xfA,I.s_xfB);if(0>=h){g=1;break}0==c&&(u=h>a?n.Max(a-l,.75*a):n.Max(h-l,.02*a));if(.5*l>h-u){if(0==c){g=1;break}break}var _=g,d=g,y=1,f=h;r.GetTransform(I.s_xfA,y);s.GetTransform(I.s_xfB,y);var v=I.s_fcn.Evaluate(I.s_xfA,I.s_xfB);if(v>=u){g=1;break}for(var x=0;;){var b=0;b=1&x?d+(u-f)*(y-d)/(v-f):.5*(d+y);r.GetTransform(I.s_xfA,b);s.GetTransform(I.s_xfB,b);var S=I.s_fcn.Evaluate(I.s_xfA,I.s_xfB);if(n.Abs(S-u)<.025*l){_=b;break}if(S>u){d=b;f=S}else{y=b;v=S}++x;++I.b2_toiRootIters;if(50==x)break}I.b2_toiMaxRootIters=n.Max(I.b2_toiMaxRootIters,x);if(_<(1+100*Box2D.MIN_VALUE)*g)break;g=_;c++;++I.b2_toiIters;if(c==m)break}I.b2_toiMaxIters=n.Max(I.b2_toiMaxIters,c);return g};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0;Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;Box2D.Collision.b2TimeOfImpact.s_cache=new B;Box2D.Collision.b2TimeOfImpact.s_distanceInput=new _;Box2D.Collision.b2TimeOfImpact.s_xfA=new s;Box2D.Collision.b2TimeOfImpact.s_xfB=new s;Box2D.Collision.b2TimeOfImpact.s_fcn=new R;Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new d});N.b2TOIInput=function(){this.proxyA=new y;this.proxyB=new y;this.sweepA=new r;this.sweepB=new r};L.b2WorldManifold=function(){this.m_normal=new a};L.prototype.b2WorldManifold=function(){this.m_points=new Vector(i.b2_maxManifoldPoints);for(var t=0;t<i.b2_maxManifoldPoints;t++)this.m_points[t]=new a};L.prototype.Initialize=function(t,e,o,i,n){void 0===o&&(o=0);void 0===n&&(n=0);if(0!=t.m_pointCount){var r,s,a=0,l=0,g=0,m=0,c=0,u=0,h=0;switch(t.m_type){case S.e_circles:s=e.R;r=t.m_localPoint;var p=e.position.x+s.col1.x*r.x+s.col2.x*r.y,_=e.position.y+s.col1.y*r.x+s.col2.y*r.y;s=i.R;r=t.m_points[0].m_localPoint;var d=i.position.x+s.col1.x*r.x+s.col2.x*r.y,y=i.position.y+s.col1.y*r.x+s.col2.y*r.y,f=d-p,v=y-_,x=f*f+v*v;if(x>Box2D.MIN_VALUE*Box2D.MIN_VALUE){var b=Math.sqrt(x);this.m_normal.x=f/b;this.m_normal.y=v/b}else{this.m_normal.x=1;this.m_normal.y=0}var A=p+o*this.m_normal.x,C=_+o*this.m_normal.y,E=d-n*this.m_normal.x,D=y-n*this.m_normal.y;this.m_points[0].x=.5*(A+E);this.m_points[0].y=.5*(C+D);break;case S.e_faceA:s=e.R;r=t.m_localPlaneNormal;l=s.col1.x*r.x+s.col2.x*r.y;g=s.col1.y*r.x+s.col2.y*r.y;s=e.R;r=t.m_localPoint;m=e.position.x+s.col1.x*r.x+s.col2.x*r.y;c=e.position.y+s.col1.y*r.x+s.col2.y*r.y;this.m_normal.x=l;this.m_normal.y=g;for(a=0;a<t.m_pointCount;a++){s=i.R;r=t.m_points[a].m_localPoint;u=i.position.x+s.col1.x*r.x+s.col2.x*r.y;h=i.position.y+s.col1.y*r.x+s.col2.y*r.y;this.m_points[a].x=u+.5*(o-(u-m)*l-(h-c)*g-n)*l;this.m_points[a].y=h+.5*(o-(u-m)*l-(h-c)*g-n)*g}break;case S.e_faceB:s=i.R;r=t.m_localPlaneNormal;l=s.col1.x*r.x+s.col2.x*r.y;g=s.col1.y*r.x+s.col2.y*r.y;s=i.R;r=t.m_localPoint;m=i.position.x+s.col1.x*r.x+s.col2.x*r.y;c=i.position.y+s.col1.y*r.x+s.col2.y*r.y;this.m_normal.x=-l;this.m_normal.y=-g;for(a=0;a<t.m_pointCount;a++){s=e.R;r=t.m_points[a].m_localPoint;u=e.position.x+s.col1.x*r.x+s.col2.x*r.y;h=e.position.y+s.col1.y*r.x+s.col2.y*r.y;this.m_points[a].x=u+.5*(n-(u-m)*l-(h-c)*g-o)*l;this.m_points[a].y=h+.5*(n-(u-m)*l-(h-c)*g-o)*g}}}};O.ClipVertex=function(){this.v=new a;this.id=new u};O.prototype.Set=function(t){this.v.SetV(t.v);this.id.Set(t.id)};P.Features=function(){};Object.defineProperty(P.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}});Object.defineProperty(P.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._referenceEdge=t;this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}});Object.defineProperty(P.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}});Object.defineProperty(P.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._incidentEdge=t;this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}});Object.defineProperty(P.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}});Object.defineProperty(P.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._incidentVertex=t;this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}});Object.defineProperty(P.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}});Object.defineProperty(P.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._flip=t;this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})}();!function(){{var t=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),e=Box2D.Collision.Shapes.b2CircleShape,o=Box2D.Collision.Shapes.b2EdgeChainDef,i=Box2D.Collision.Shapes.b2EdgeShape,n=Box2D.Collision.Shapes.b2MassData,r=Box2D.Collision.Shapes.b2PolygonShape,s=Box2D.Collision.Shapes.b2Shape,a=Box2D.Common.Math.b2Mat22,l=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),g=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform),m=Box2D.Common.Math.b2Vec2,c=(Box2D.Common.Math.b2Vec3,Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance),u=Box2D.Collision.b2DistanceInput,h=Box2D.Collision.b2DistanceOutput,p=Box2D.Collision.b2DistanceProxy,_=(Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache);Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase}Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape);e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;e.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.m_p=new m};e.prototype.Copy=function(){var t=new e;t.Set(this);return t};e.prototype.Set=function(t){this.__super.Set.call(this,t);if(Box2D.is(t,e)){var o=t instanceof e?t:null;this.m_p.SetV(o.m_p)}};e.prototype.TestPoint=function(t,e){var o=t.R,i=t.position.x+(o.col1.x*this.m_p.x+o.col2.x*this.m_p.y),n=t.position.y+(o.col1.y*this.m_p.x+o.col2.y*this.m_p.y);i=e.x-i;n=e.y-n;return i*i+n*n<=this.m_radius*this.m_radius};e.prototype.RayCast=function(t,e,o){var i=o.R,n=o.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=o.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y),s=e.p1.x-n,a=e.p1.y-r,l=s*s+a*a-this.m_radius*this.m_radius,g=e.p2.x-e.p1.x,m=e.p2.y-e.p1.y,c=s*g+a*m,u=g*g+m*m,h=c*c-u*l;if(0>h||u<Box2D.MIN_VALUE)return!1;var p=-(c+Math.sqrt(h));if(p>=0&&p<=e.maxFraction*u){p/=u;t.fraction=p;t.normal.x=s+p*g;t.normal.y=a+p*m;t.normal.Normalize();return!0}return!1};e.prototype.ComputeAABB=function(t,e){var o=e.R,i=e.position.x+(o.col1.x*this.m_p.x+o.col2.x*this.m_p.y),n=e.position.y+(o.col1.y*this.m_p.x+o.col2.y*this.m_p.y);t.lowerBound.Set(i-this.m_radius,n-this.m_radius);t.upperBound.Set(i+this.m_radius,n+this.m_radius)};e.prototype.ComputeMass=function(e,o){void 0===o&&(o=0);e.mass=o*t.b2_pi*this.m_radius*this.m_radius;e.center.SetV(this.m_p);e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};e.prototype.ComputeSubmergedArea=function(t,e,o,i){void 0===e&&(e=0);var n=l.MulX(o,this.m_p),r=-(l.Dot(t,n)-e);if(r<-this.m_radius+Box2D.MIN_VALUE)return 0;if(r>this.m_radius){i.SetV(n);return Math.PI*this.m_radius*this.m_radius}var s=this.m_radius*this.m_radius,a=r*r,g=s*(Math.asin(r/this.m_radius)+Math.PI/2)+r*Math.sqrt(s-a),m=-2/3*Math.pow(s-a,1.5)/g;i.x=n.x+t.x*m;i.y=n.y+t.y*m;return g};e.prototype.GetLocalPosition=function(){return this.m_p};e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)};e.prototype.GetRadius=function(){return this.m_radius};e.prototype.SetRadius=function(t){void 0===t&&(t=0);this.m_radius=t};e.prototype.b2CircleShape=function(t){void 0===t&&(t=0);this.__super.b2Shape.call(this);this.m_type=s.e_circleShape;this.m_radius=t};o.b2EdgeChainDef=function(){};o.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=!0;this.vertices=[]};Box2D.inherit(i,Box2D.Collision.Shapes.b2Shape);i.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;i.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new m;this.m_v1=new m;this.m_v2=new m;this.m_coreV1=new m;this.m_coreV2=new m;this.m_normal=new m;this.m_direction=new m;this.m_cornerDir1=new m;this.m_cornerDir2=new m};i.prototype.TestPoint=function(){return!1};i.prototype.RayCast=function(t,e,o){var i,n=e.p2.x-e.p1.x,r=e.p2.y-e.p1.y;i=o.R;var s=o.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),a=o.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),l=o.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y)-a,g=-(o.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y)-s),m=100*Box2D.MIN_VALUE,c=-(n*l+r*g);if(c>m){var u=e.p1.x-s,h=e.p1.y-a,p=u*l+h*g;if(p>=0&&p<=e.maxFraction*c){var _=-n*h+r*u;if(_>=-m*c&&c*(1+m)>=_){p/=c;t.fraction=p;var d=Math.sqrt(l*l+g*g);t.normal.x=l/d;t.normal.y=g/d;return!0}}}return!1};i.prototype.ComputeAABB=function(t,e){var o=e.R,i=e.position.x+(o.col1.x*this.m_v1.x+o.col2.x*this.m_v1.y),n=e.position.y+(o.col1.y*this.m_v1.x+o.col2.y*this.m_v1.y),r=e.position.x+(o.col1.x*this.m_v2.x+o.col2.x*this.m_v2.y),s=e.position.y+(o.col1.y*this.m_v2.x+o.col2.y*this.m_v2.y);if(r>i){t.lowerBound.x=i;t.upperBound.x=r}else{t.lowerBound.x=r;t.upperBound.x=i}if(s>n){t.lowerBound.y=n;t.upperBound.y=s}else{t.lowerBound.y=s;t.upperBound.y=n}};i.prototype.ComputeMass=function(t,e){void 0===e&&(e=0);t.mass=0;t.center.SetV(this.m_v1);t.I=0};i.prototype.ComputeSubmergedArea=function(t,e,o,i){void 0===e&&(e=0);var n=new m(t.x*e,t.y*e),r=l.MulX(o,this.m_v1),s=l.MulX(o,this.m_v2),a=l.Dot(t,r)-e,g=l.Dot(t,s)-e;if(a>0){if(g>0)return 0;r.x=-g/(a-g)*r.x+a/(a-g)*s.x;r.y=-g/(a-g)*r.y+a/(a-g)*s.y}else if(g>0){s.x=-g/(a-g)*r.x+a/(a-g)*s.x;s.y=-g/(a-g)*r.y+a/(a-g)*s.y}i.x=(n.x+r.x+s.x)/3;i.y=(n.y+r.y+s.y)/3;return.5*((r.x-n.x)*(s.y-n.y)-(r.y-n.y)*(s.x-n.x))};i.prototype.GetLength=function(){return this.m_length};i.prototype.GetVertex1=function(){return this.m_v1};i.prototype.GetVertex2=function(){return this.m_v2};i.prototype.GetCoreVertex1=function(){return this.m_coreV1};i.prototype.GetCoreVertex2=function(){return this.m_coreV2};i.prototype.GetNormalVector=function(){return this.m_normal};i.prototype.GetDirectionVector=function(){return this.m_direction};i.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};i.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};i.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};i.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2};i.prototype.GetFirstVertex=function(t){var e=t.R;return new m(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))};i.prototype.GetNextEdge=function(){return this.m_nextEdge};i.prototype.GetPrevEdge=function(){return this.m_prevEdge};i.prototype.Support=function(t,e,o){void 0===e&&(e=0);void 0===o&&(o=0);var i=t.R,n=t.position.x+(i.col1.x*this.m_coreV1.x+i.col2.x*this.m_coreV1.y),r=t.position.y+(i.col1.y*this.m_coreV1.x+i.col2.y*this.m_coreV1.y),s=t.position.x+(i.col1.x*this.m_coreV2.x+i.col2.x*this.m_coreV2.y),a=t.position.y+(i.col1.y*this.m_coreV2.x+i.col2.y*this.m_coreV2.y);if(n*e+r*o>s*e+a*o){this.s_supportVec.x=n;this.s_supportVec.y=r}else{this.s_supportVec.x=s;this.s_supportVec.y=a}return this.s_supportVec};i.prototype.b2EdgeShape=function(e,o){this.__super.b2Shape.call(this);this.m_type=s.e_edgeShape;this.m_prevEdge=null;this.m_nextEdge=null;this.m_v1=e;this.m_v2=o;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)};i.prototype.SetPrevEdge=function(t,e,o,i){this.m_prevEdge=t;this.m_coreV1=e;this.m_cornerDir1=o;this.m_cornerConvex1=i};i.prototype.SetNextEdge=function(t,e,o,i){this.m_nextEdge=t;this.m_coreV2=e;this.m_cornerDir2=o;this.m_cornerConvex2=i};n.b2MassData=function(){this.mass=0;this.center=new m(0,0);this.I=0};Box2D.inherit(r,Box2D.Collision.Shapes.b2Shape);r.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;r.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};r.prototype.Copy=function(){var t=new r;t.Set(this);return t};r.prototype.Set=function(t){this.__super.Set.call(this,t);if(Box2D.is(t,r)){var e=t instanceof r?t:null;this.m_centroid.SetV(e.m_centroid);this.m_vertexCount=e.m_vertexCount;this.Reserve(this.m_vertexCount);for(var o=0;o<this.m_vertexCount;o++){this.m_vertices[o].SetV(e.m_vertices[o]);this.m_normals[o].SetV(e.m_normals[o])}}};r.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var o,i=new Vector,n=0;for(n=0;n<t.length;++n){o=t[n];i.push(o)}this.SetAsVector(i,e)};r.AsArray=function(t,e){void 0===e&&(e=0);var o=new r;o.SetAsArray(t,e);return o};r.prototype.SetAsVector=function(e,o){void 0===o&&(o=0);0==o&&(o=e.length);t.b2Assert(o>=2);this.m_vertexCount=o;this.Reserve(o);var i=0;for(i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e[i]);
for(i=0;i<this.m_vertexCount;++i){var n=parseInt(i),s=parseInt(i+1<this.m_vertexCount?i+1:0),a=l.SubtractVV(this.m_vertices[s],this.m_vertices[n]);t.b2Assert(a.LengthSquared()>Box2D.MIN_VALUE);this.m_normals[i].SetV(l.CrossVF(a,1));this.m_normals[i].Normalize()}this.m_centroid=r.ComputeCentroid(this.m_vertices,this.m_vertexCount)};r.AsVector=function(t,e){void 0===e&&(e=0);var o=new r;o.SetAsVector(t,e);return o};r.prototype.SetAsBox=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-t,-e);this.m_vertices[1].Set(t,-e);this.m_vertices[2].Set(t,e);this.m_vertices[3].Set(-t,e);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid.SetZero()};r.AsBox=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);var o=new r;o.SetAsBox(t,e);return o};r.prototype.SetAsOrientedBox=function(t,e,o,i){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=null);void 0===i&&(i=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-t,-e);this.m_vertices[1].Set(t,-e);this.m_vertices[2].Set(t,e);this.m_vertices[3].Set(-t,e);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid=o;var n=new g;n.position=o;n.R.Set(i);for(var r=0;r<this.m_vertexCount;++r){this.m_vertices[r]=l.MulX(n,this.m_vertices[r]);this.m_normals[r]=l.MulMV(n.R,this.m_normals[r])}};r.AsOrientedBox=function(t,e,o,i){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=null);void 0===i&&(i=0);var n=new r;n.SetAsOrientedBox(t,e,o,i);return n};r.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(t);this.m_vertices[1].SetV(e);this.m_centroid.x=.5*(t.x+e.x);this.m_centroid.y=.5*(t.y+e.y);this.m_normals[0]=l.CrossVF(l.SubtractVV(e,t),1);this.m_normals[0].Normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y};r.AsEdge=function(t,e){var o=new r;o.SetAsEdge(t,e);return o};r.prototype.TestPoint=function(t,e){for(var o,i=t.R,n=e.x-t.position.x,r=e.y-t.position.y,s=n*i.col1.x+r*i.col1.y,a=n*i.col2.x+r*i.col2.y,l=0;l<this.m_vertexCount;++l){o=this.m_vertices[l];n=s-o.x;r=a-o.y;o=this.m_normals[l];var g=o.x*n+o.y*r;if(g>0)return!1}return!0};r.prototype.RayCast=function(t,e,o){var i,n,r=0,s=e.maxFraction,a=0,l=0;a=e.p1.x-o.position.x;l=e.p1.y-o.position.y;i=o.R;var g=a*i.col1.x+l*i.col1.y,m=a*i.col2.x+l*i.col2.y;a=e.p2.x-o.position.x;l=e.p2.y-o.position.y;i=o.R;for(var c=a*i.col1.x+l*i.col1.y,u=a*i.col2.x+l*i.col2.y,h=c-g,p=u-m,_=parseInt(-1),d=0;d<this.m_vertexCount;++d){n=this.m_vertices[d];a=n.x-g;l=n.y-m;n=this.m_normals[d];var y=n.x*a+n.y*l,f=n.x*h+n.y*p;if(0==f){if(0>y)return!1}else if(0>f&&r*f>y){r=y/f;_=d}else f>0&&s*f>y&&(s=y/f);if(s<r-Box2D.MIN_VALUE)return!1}if(_>=0){t.fraction=r;i=o.R;n=this.m_normals[_];t.normal.x=i.col1.x*n.x+i.col2.x*n.y;t.normal.y=i.col1.y*n.x+i.col2.y*n.y;return!0}return!1};r.prototype.ComputeAABB=function(t,e){for(var o=e.R,i=this.m_vertices[0],n=e.position.x+(o.col1.x*i.x+o.col2.x*i.y),r=e.position.y+(o.col1.y*i.x+o.col2.y*i.y),s=n,a=r,l=1;l<this.m_vertexCount;++l){i=this.m_vertices[l];var g=e.position.x+(o.col1.x*i.x+o.col2.x*i.y),m=e.position.y+(o.col1.y*i.x+o.col2.y*i.y);n=g>n?n:g;r=m>r?r:m;s=s>g?s:g;a=a>m?a:m}t.lowerBound.x=n-this.m_radius;t.lowerBound.y=r-this.m_radius;t.upperBound.x=s+this.m_radius;t.upperBound.y=a+this.m_radius};r.prototype.ComputeMass=function(t,e){void 0===e&&(e=0);if(2!=this.m_vertexCount){for(var o=0,i=0,n=0,r=0,s=0,a=0,l=1/3,g=0;g<this.m_vertexCount;++g){var m=this.m_vertices[g],c=g+1<this.m_vertexCount?this.m_vertices[parseInt(g+1)]:this.m_vertices[0],u=m.x-s,h=m.y-a,p=c.x-s,_=c.y-a,d=u*_-h*p,y=.5*d;n+=y;o+=y*l*(s+m.x+c.x);i+=y*l*(a+m.y+c.y);var f=s,v=a,x=u,b=h,S=p,A=_,C=l*(.25*(x*x+S*x+S*S)+(f*x+f*S))+.5*f*f,E=l*(.25*(b*b+A*b+A*A)+(v*b+v*A))+.5*v*v;r+=d*(C+E)}t.mass=e*n;o*=1/n;i*=1/n;t.center.Set(o,i);t.I=e*r}else{t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x);t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y);t.mass=0;t.I=0}};r.prototype.ComputeSubmergedArea=function(t,e,o,i){void 0===e&&(e=0);var r=l.MulTMV(o.R,t),s=e-l.Dot(t,o.position),a=new Vector_a2j_Number,g=0,c=parseInt(-1),u=parseInt(-1),h=!1,p=0;for(p=0;p<this.m_vertexCount;++p){a[p]=l.Dot(r,this.m_vertices[p])-s;var _=a[p]<-Box2D.MIN_VALUE;if(p>0)if(_){if(!h){c=p-1;g++}}else if(h){u=p-1;g++}h=_}switch(g){case 0:if(h){var d=new n;this.ComputeMass(d,1);i.SetV(l.MulX(o,d.center));return d.mass}return 0;case 1:-1==c?c=this.m_vertexCount-1:u=this.m_vertexCount-1}var y,f=parseInt((c+1)%this.m_vertexCount),v=parseInt((u+1)%this.m_vertexCount),x=(0-a[c])/(a[f]-a[c]),b=(0-a[u])/(a[v]-a[u]),S=new m(this.m_vertices[c].x*(1-x)+this.m_vertices[f].x*x,this.m_vertices[c].y*(1-x)+this.m_vertices[f].y*x),A=new m(this.m_vertices[u].x*(1-b)+this.m_vertices[v].x*b,this.m_vertices[u].y*(1-b)+this.m_vertices[v].y*b),C=0,E=new m,D=this.m_vertices[f];p=f;for(;p!=v;){p=(p+1)%this.m_vertexCount;y=p==v?A:this.m_vertices[p];var T=.5*((D.x-S.x)*(y.y-S.y)-(D.y-S.y)*(y.x-S.x));C+=T;E.x+=T*(S.x+D.x+y.x)/3;E.y+=T*(S.y+D.y+y.y)/3;D=y}E.Multiply(1/C);i.SetV(l.MulX(o,E));return C};r.prototype.GetVertexCount=function(){return this.m_vertexCount};r.prototype.GetVertices=function(){return this.m_vertices};r.prototype.GetNormals=function(){return this.m_normals};r.prototype.GetSupport=function(t){for(var e=0,o=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,i=1;i<this.m_vertexCount;++i){var n=this.m_vertices[i].x*t.x+this.m_vertices[i].y*t.y;if(n>o){e=i;o=n}}return e};r.prototype.GetSupportVertex=function(t){for(var e=0,o=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,i=1;i<this.m_vertexCount;++i){var n=this.m_vertices[i].x*t.x+this.m_vertices[i].y*t.y;if(n>o){e=i;o=n}}return this.m_vertices[e]};r.prototype.Validate=function(){return!1};r.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=s.e_polygonShape;this.m_centroid=new m;this.m_vertices=new Vector;this.m_normals=new Vector};r.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);t>e;e++){this.m_vertices[e]=new m;this.m_normals[e]=new m}};r.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var o=new m,i=0,n=0,r=0,s=1/3,a=0;e>a;++a){var l=t[a],g=e>a+1?t[parseInt(a+1)]:t[0],c=l.x-n,u=l.y-r,h=g.x-n,p=g.y-r,_=c*p-u*h,d=.5*_;i+=d;o.x+=d*s*(n+l.x+g.x);o.y+=d*s*(r+l.y+g.y)}o.x*=1/i;o.y*=1/i;return o};r.ComputeOBB=function(t,e,o){void 0===o&&(o=0);var i=0,n=new Vector(o+1);for(i=0;o>i;++i)n[i]=e[i];n[o]=n[0];var r=Number.MAX_VALUE;for(i=1;o>=i;++i){var s=n[parseInt(i-1)],a=n[i].x-s.x,l=n[i].y-s.y,g=Math.sqrt(a*a+l*l);a/=g;l/=g;for(var m=-l,c=a,u=Number.MAX_VALUE,h=Number.MAX_VALUE,p=-Number.MAX_VALUE,_=-Number.MAX_VALUE,d=0;o>d;++d){var y=n[d].x-s.x,f=n[d].y-s.y,v=a*y+l*f,x=m*y+c*f;u>v&&(u=v);h>x&&(h=x);v>p&&(p=v);x>_&&(_=x)}var b=(p-u)*(_-h);if(.95*r>b){r=b;t.R.col1.x=a;t.R.col1.y=l;t.R.col2.x=m;t.R.col2.y=c;var S=.5*(u+p),A=.5*(h+_),C=t.R;t.center.x=s.x+(C.col1.x*S+C.col2.x*A);t.center.y=s.y+(C.col1.y*S+C.col2.y*A);t.extents.x=.5*(p-u);t.extents.y=.5*(_-h)}}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new a});s.b2Shape=function(){};s.prototype.Copy=function(){return null};s.prototype.Set=function(t){this.m_radius=t.m_radius};s.prototype.GetType=function(){return this.m_type};s.prototype.TestPoint=function(){return!1};s.prototype.RayCast=function(){return!1};s.prototype.ComputeAABB=function(){};s.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)};s.prototype.ComputeSubmergedArea=function(t,e){void 0===e&&(e=0);return 0};s.TestOverlap=function(t,e,o,i){var n=new u;n.proxyA=new p;n.proxyA.Set(t);n.proxyB=new p;n.proxyB.Set(o);n.transformA=e;n.transformB=i;n.useRadii=!0;var r=new _;r.count=0;var s=new h;c.Distance(s,r,n);return s.distance<10*Box2D.MIN_VALUE};s.prototype.b2Shape=function(){this.m_type=s.e_unknownShape;this.m_radius=t.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1);Box2D.Collision.Shapes.b2Shape.e_circleShape=0;Box2D.Collision.Shapes.b2Shape.e_polygonShape=1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}();!function(){{var t=Box2D.Common.b2Color,e=(Box2D.Common.b2internal,Box2D.Common.b2Settings),o=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math);Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2,Box2D.Common.Math.b2Vec3}t.b2Color=function(){this._r=0;this._g=0;this._b=0};t.prototype.b2Color=function(t,e,i){void 0===t&&(t=0);void 0===e&&(e=0);void 0===i&&(i=0);this._r=Box2D.parseUInt(255*o.Clamp(t,0,1));this._g=Box2D.parseUInt(255*o.Clamp(e,0,1));this._b=Box2D.parseUInt(255*o.Clamp(i,0,1))};t.prototype.Set=function(t,e,i){void 0===t&&(t=0);void 0===e&&(e=0);void 0===i&&(i=0);this._r=Box2D.parseUInt(255*o.Clamp(t,0,1));this._g=Box2D.parseUInt(255*o.Clamp(e,0,1));this._b=Box2D.parseUInt(255*o.Clamp(i,0,1))};Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._r=Box2D.parseUInt(255*o.Clamp(t,0,1))}});Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._g=Box2D.parseUInt(255*o.Clamp(t,0,1))}});Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0);this._b=Box2D.parseUInt(255*o.Clamp(t,0,1))}});Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}});e.b2Settings=function(){};e.b2MixFriction=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);return Math.sqrt(t*e)};e.b2MixRestitution=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);return t>e?t:e};e.b2Assert=function(t){if(!t)throw"Assertion Failed"};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";Box2D.Common.b2Settings.USHRT_MAX=65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=.1;Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi;Box2D.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32;Box2D.Common.b2Settings.b2_velocityThreshold=1;Box2D.Common.b2Settings.b2_maxLinearCorrection=.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi;Box2D.Common.b2Settings.b2_maxTranslation=20;Box2D.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=1.5*e.b2_pi;Box2D.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=.2;Box2D.Common.b2Settings.b2_timeToSleep=.5;Box2D.Common.b2Settings.b2_linearSleepTolerance=.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}();!function(){var t=(Box2D.Collision.b2AABB,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Common.Math.b2Mat22),e=Box2D.Common.Math.b2Mat33,o=Box2D.Common.Math.b2Math,i=Box2D.Common.Math.b2Sweep,n=Box2D.Common.Math.b2Transform,r=Box2D.Common.Math.b2Vec2,s=Box2D.Common.Math.b2Vec3;t.b2Mat22=function(){this.col1=new r;this.col2=new r};t.prototype.b2Mat22=function(){this.SetIdentity()};t.FromAngle=function(e){void 0===e&&(e=0);var o=new t;o.Set(e);return o};t.FromVV=function(e,o){var i=new t;i.SetVV(e,o);return i};t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),o=Math.sin(t);this.col1.x=e;this.col2.x=-o;this.col1.y=o;this.col2.y=e};t.prototype.SetVV=function(t,e){this.col1.SetV(t);this.col2.SetV(e)};t.prototype.Copy=function(){var e=new t;e.SetM(this);return e};t.prototype.SetM=function(t){this.col1.SetV(t.col1);this.col2.SetV(t.col2)};t.prototype.AddM=function(t){this.col1.x+=t.col1.x;this.col1.y+=t.col1.y;this.col2.x+=t.col2.x;this.col2.y+=t.col2.y};t.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1};t.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};t.prototype.GetInverse=function(t){var e=this.col1.x,o=this.col2.x,i=this.col1.y,n=this.col2.y,r=e*n-o*i;0!=r&&(r=1/r);t.col1.x=r*n;t.col2.x=-r*o;t.col1.y=-r*i;t.col2.y=r*e;return t};t.prototype.Solve=function(t,e,o){void 0===e&&(e=0);void 0===o&&(o=0);var i=this.col1.x,n=this.col2.x,r=this.col1.y,s=this.col2.y,a=i*s-n*r;0!=a&&(a=1/a);t.x=a*(s*e-n*o);t.y=a*(i*o-r*e);return t};t.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};e.b2Mat33=function(){this.col1=new s;this.col2=new s;this.col3=new s};e.prototype.b2Mat33=function(t,e,o){void 0===t&&(t=null);void 0===e&&(e=null);void 0===o&&(o=null);if(t||e||o){this.col1.SetV(t);this.col2.SetV(e);this.col3.SetV(o)}else{this.col1.SetZero();this.col2.SetZero();this.col3.SetZero()}};e.prototype.SetVVV=function(t,e,o){this.col1.SetV(t);this.col2.SetV(e);this.col3.SetV(o)};e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)};e.prototype.SetM=function(t){this.col1.SetV(t.col1);this.col2.SetV(t.col2);this.col3.SetV(t.col3)};e.prototype.AddM=function(t){this.col1.x+=t.col1.x;this.col1.y+=t.col1.y;this.col1.z+=t.col1.z;this.col2.x+=t.col2.x;this.col2.y+=t.col2.y;this.col2.z+=t.col2.z;this.col3.x+=t.col3.x;this.col3.y+=t.col3.y;this.col3.z+=t.col3.z};e.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1};e.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0};e.prototype.Solve22=function(t,e,o){void 0===e&&(e=0);void 0===o&&(o=0);var i=this.col1.x,n=this.col2.x,r=this.col1.y,s=this.col2.y,a=i*s-n*r;0!=a&&(a=1/a);t.x=a*(s*e-n*o);t.y=a*(i*o-r*e);return t};e.prototype.Solve33=function(t,e,o,i){void 0===e&&(e=0);void 0===o&&(o=0);void 0===i&&(i=0);var n=this.col1.x,r=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,g=this.col2.z,m=this.col3.x,c=this.col3.y,u=this.col3.z,h=n*(l*u-g*c)+r*(g*m-a*u)+s*(a*c-l*m);0!=h&&(h=1/h);t.x=h*(e*(l*u-g*c)+o*(g*m-a*u)+i*(a*c-l*m));t.y=h*(n*(o*u-i*c)+r*(i*m-e*u)+s*(e*c-o*m));t.z=h*(n*(l*i-g*o)+r*(g*e-a*i)+s*(a*o-l*e));return t};o.b2Math=function(){};o.IsValid=function(t){void 0===t&&(t=0);return isFinite(t)};o.Dot=function(t,e){return t.x*e.x+t.y*e.y};o.CrossVV=function(t,e){return t.x*e.y-t.y*e.x};o.CrossVF=function(t,e){void 0===e&&(e=0);var o=new r(e*t.y,-e*t.x);return o};o.CrossFV=function(t,e){void 0===t&&(t=0);var o=new r(-t*e.y,t*e.x);return o};o.MulMV=function(t,e){var o=new r(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y);return o};o.MulTMV=function(t,e){var i=new r(o.Dot(e,t.col1),o.Dot(e,t.col2));return i};o.MulX=function(t,e){var i=o.MulMV(t.R,e);i.x+=t.position.x;i.y+=t.position.y;return i};o.MulXT=function(t,e){var i=o.SubtractVV(e,t.position),n=i.x*t.R.col1.x+i.y*t.R.col1.y;i.y=i.x*t.R.col2.x+i.y*t.R.col2.y;i.x=n;return i};o.AddVV=function(t,e){var o=new r(t.x+e.x,t.y+e.y);return o};o.SubtractVV=function(t,e){var o=new r(t.x-e.x,t.y-e.y);return o};o.Distance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)};o.DistanceSquared=function(t,e){var o=t.x-e.x,i=t.y-e.y;return o*o+i*i};o.MulFV=function(t,e){void 0===t&&(t=0);var o=new r(t*e.x,t*e.y);return o};o.AddMM=function(e,i){var n=t.FromVV(o.AddVV(e.col1,i.col1),o.AddVV(e.col2,i.col2));return n};o.MulMM=function(e,i){var n=t.FromVV(o.MulMV(e,i.col1),o.MulMV(e,i.col2));return n};o.MulTMM=function(e,i){var n=new r(o.Dot(e.col1,i.col1),o.Dot(e.col2,i.col1)),s=new r(o.Dot(e.col1,i.col2),o.Dot(e.col2,i.col2)),a=t.FromVV(n,s);return a};o.Abs=function(t){void 0===t&&(t=0);return t>0?t:-t};o.AbsV=function(t){var e=new r(o.Abs(t.x),o.Abs(t.y));return e};o.AbsM=function(e){var i=t.FromVV(o.AbsV(e.col1),o.AbsV(e.col2));return i};o.Min=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);return e>t?t:e};o.MinV=function(t,e){var i=new r(o.Min(t.x,e.x),o.Min(t.y,e.y));return i};o.Max=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);return t>e?t:e};o.MaxV=function(t,e){var i=new r(o.Max(t.x,e.x),o.Max(t.y,e.y));return i};o.Clamp=function(t,e,o){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=0);return e>t?e:t>o?o:t};o.ClampV=function(t,e,i){return o.MaxV(e,o.MinV(t,i))};o.Swap=function(t,e){var o=t[0];t[0]=e[0];e[0]=o};o.Random=function(){return 2*Math.random()-1};o.RandomRange=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);var o=Math.random();o=(e-t)*o+t;return o};o.NextPowerOfTwo=function(t){void 0===t&&(t=0);t|=t>>1&2147483647;t|=t>>2&1073741823;t|=t>>4&268435455;t|=t>>8&16777215;t|=t>>16&65535;return t+1};o.IsPowerOfTwo=function(t){void 0===t&&(t=0);var e=t>0&&0==(t&t-1);return e};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new r(0,0);Box2D.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new r(1,0),new r(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new n(o.b2Vec2_zero,o.b2Mat22_identity)});i.b2Sweep=function(){this.localCenter=new r;this.c0=new r;this.c=new r};i.prototype.Set=function(t){this.localCenter.SetV(t.localCenter);this.c0.SetV(t.c0);this.c.SetV(t.c);this.a0=t.a0;this.a=t.a;this.t0=t.t0};i.prototype.Copy=function(){var t=new i;t.localCenter.SetV(this.localCenter);t.c0.SetV(this.c0);t.c.SetV(this.c);t.a0=this.a0;t.a=this.a;t.t0=this.t0;return t};i.prototype.GetTransform=function(t,e){void 0===e&&(e=0);t.position.x=(1-e)*this.c0.x+e*this.c.x;t.position.y=(1-e)*this.c0.y+e*this.c.y;var o=(1-e)*this.a0+e*this.a;t.R.Set(o);var i=t.R;t.position.x-=i.col1.x*this.localCenter.x+i.col2.x*this.localCenter.y;t.position.y-=i.col1.y*this.localCenter.x+i.col2.y*this.localCenter.y};i.prototype.Advance=function(t){void 0===t&&(t=0);if(this.t0<t&&1-this.t0>Box2D.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x;this.c0.y=(1-e)*this.c0.y+e*this.c.y;this.a0=(1-e)*this.a0+e*this.a;this.t0=t}};n.b2Transform=function(){this.position=new r;this.R=new t};n.prototype.b2Transform=function(t,e){void 0===t&&(t=null);void 0===e&&(e=null);if(t){this.position.SetV(t);this.R.SetM(e)}};n.prototype.Initialize=function(t,e){this.position.SetV(t);this.R.SetM(e)};n.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};n.prototype.Set=function(t){this.position.SetV(t.position);this.R.SetM(t.R)};n.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};r.b2Vec2=function(){};r.prototype.b2Vec2=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);this.x=t;this.y=e};r.prototype.SetZero=function(){this.x=0;this.y=0};r.prototype.Set=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);this.x=t;this.y=e};r.prototype.SetV=function(t){this.x=t.x;this.y=t.y};r.prototype.GetNegative=function(){return new r(-this.x,-this.y)};r.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y};r.Make=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);return new r(t,e)};r.prototype.Copy=function(){return new r(this.x,this.y)};r.prototype.Add=function(t){this.x+=t.x;this.y+=t.y};r.prototype.Subtract=function(t){this.x-=t.x;this.y-=t.y};r.prototype.Multiply=function(t){void 0===t&&(t=0);this.x*=t;this.y*=t};r.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y;this.y=t.col1.y*e+t.col2.y*this.y};r.prototype.MulTM=function(t){var e=o.Dot(this,t.col1);this.y=o.Dot(this,t.col2);this.x=e};r.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y;this.y=-t*e};r.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y;this.y=t*e};r.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x;this.y=this.y<t.y?this.y:t.y};r.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x;this.y=this.y>t.y?this.y:t.y};r.prototype.Abs=function(){this.x<0&&(this.x=-this.x);this.y<0&&(this.y=-this.y)};r.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};r.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y};r.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Box2D.MIN_VALUE)return 0;var e=1/t;this.x*=e;this.y*=e;return t};r.prototype.IsValid=function(){return o.IsValid(this.x)&&o.IsValid(this.y)};s.b2Vec3=function(){};s.prototype.b2Vec3=function(t,e,o){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=0);this.x=t;this.y=e;this.z=o};s.prototype.SetZero=function(){this.x=this.y=this.z=0};s.prototype.Set=function(t,e,o){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=0);this.x=t;this.y=e;this.z=o};s.prototype.SetV=function(t){this.x=t.x;this.y=t.y;this.z=t.z};s.prototype.GetNegative=function(){return new s(-this.x,-this.y,-this.z)};s.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z};s.prototype.Copy=function(){return new s(this.x,this.y,this.z)};s.prototype.Add=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z};s.prototype.Subtract=function(t){this.x-=t.x;this.y-=t.y;this.z-=t.z};s.prototype.Multiply=function(t){void 0===t&&(t=0);this.x*=t;this.y*=t;this.z*=t}}();!function(){{var t=(Box2D.Dynamics.Controllers.b2ControllerEdge,Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),e=Box2D.Common.Math.b2Sweep,o=Box2D.Common.Math.b2Transform,i=Box2D.Common.Math.b2Vec2,n=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),r=(Box2D.Common.b2internal,Box2D.Common.b2Settings),s=Box2D.Collision.b2AABB,a=(Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint),l=(Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase),g=(Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput),m=Box2D.Collision.b2RayCastOutput,c=(Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase,Box2D.Collision.Shapes.b2CircleShape),u=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),h=Box2D.Collision.Shapes.b2MassData,p=Box2D.Collision.Shapes.b2PolygonShape,_=Box2D.Collision.Shapes.b2Shape,d=Box2D.Dynamics.b2Body,y=Box2D.Dynamics.b2BodyDef,f=Box2D.Dynamics.b2ContactFilter,v=Box2D.Dynamics.b2ContactImpulse,x=Box2D.Dynamics.b2ContactListener,b=Box2D.Dynamics.b2ContactManager,S=Box2D.Dynamics.b2DebugDraw,A=Box2D.Dynamics.b2DestructionListener,C=Box2D.Dynamics.b2FilterData,E=Box2D.Dynamics.b2Fixture,D=Box2D.Dynamics.b2FixtureDef,T=Box2D.Dynamics.b2Island,R=Box2D.Dynamics.b2TimeStep,w=Box2D.Dynamics.b2World,B=(Box2D.Dynamics.Contacts.b2CircleContact,Box2D.Dynamics.Contacts.b2Contact),M=(Box2D.Dynamics.Contacts.b2ContactConstraint,Box2D.Dynamics.Contacts.b2ContactConstraintPoint,Box2D.Dynamics.Contacts.b2ContactEdge,Box2D.Dynamics.Contacts.b2ContactFactory),I=(Box2D.Dynamics.Contacts.b2ContactRegister,Box2D.Dynamics.Contacts.b2ContactResult,Box2D.Dynamics.Contacts.b2ContactSolver),N=(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,Box2D.Dynamics.Contacts.b2NullContact,Box2D.Dynamics.Contacts.b2PolyAndCircleContact,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,Box2D.Dynamics.Contacts.b2PolygonContact,Box2D.Dynamics.Contacts.b2PositionSolverManifold,Box2D.Dynamics.Controllers.b2Controller,Box2D.Dynamics.Joints.b2DistanceJoint,Box2D.Dynamics.Joints.b2DistanceJointDef,Box2D.Dynamics.Joints.b2RopeJoint,Box2D.Dynamics.Joints.b2RopeJointDef,Box2D.Dynamics.Joints.b2FrictionJoint,Box2D.Dynamics.Joints.b2FrictionJointDef,Box2D.Dynamics.Joints.b2GearJoint,Box2D.Dynamics.Joints.b2GearJointDef,Box2D.Dynamics.Joints.b2Jacobian,Box2D.Dynamics.Joints.b2Joint),L=(Box2D.Dynamics.Joints.b2JointDef,Box2D.Dynamics.Joints.b2JointEdge,Box2D.Dynamics.Joints.b2LineJoint,Box2D.Dynamics.Joints.b2LineJointDef,Box2D.Dynamics.Joints.b2MouseJoint,Box2D.Dynamics.Joints.b2MouseJointDef,Box2D.Dynamics.Joints.b2PrismaticJoint,Box2D.Dynamics.Joints.b2PrismaticJointDef,Box2D.Dynamics.Joints.b2PulleyJoint);Box2D.Dynamics.Joints.b2PulleyJointDef,Box2D.Dynamics.Joints.b2RevoluteJoint,Box2D.Dynamics.Joints.b2RevoluteJointDef,Box2D.Dynamics.Joints.b2WeldJoint,Box2D.Dynamics.Joints.b2WeldJointDef}d.b2Body=function(){this.m_xf=new o;this.m_sweep=new e;this.m_linearVelocity=new i;this.m_force=new i};d.prototype.connectEdges=function(e,o,i){void 0===i&&(i=0);var n=Math.atan2(o.GetDirectionVector().y,o.GetDirectionVector().x),s=Math.tan(.5*(n-i)),a=t.MulFV(s,o.GetDirectionVector());a=t.SubtractVV(a,o.GetNormalVector());a=t.MulFV(r.b2_toiSlop,a);a=t.AddVV(a,o.GetVertex1());var l=t.AddVV(e.GetDirectionVector(),o.GetDirectionVector());l.Normalize();var g=t.Dot(e.GetDirectionVector(),o.GetNormalVector())>0;e.SetNextEdge(o,a,l,g);o.SetPrevEdge(e,a,l,g);return n};d.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new E;e.Create(this,this.m_xf,t);if(this.m_flags&d.e_activeFlag){var o=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(o,this.m_xf)}e.m_next=this.m_fixtureList;this.m_fixtureList=e;++this.m_fixtureCount;e.m_body=this;e.m_density>0&&this.ResetMassData();this.m_world.m_flags|=w.e_newFixture;return e};d.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var o=new D;o.shape=t;o.density=e;return this.CreateFixture(o)};d.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,o=null,i=!1;null!=e;){if(e==t){o?o.m_next=t.m_next:this.m_fixtureList=t.m_next;i=!0;break}o=e;e=e.m_next}for(var n=this.m_contactList;n;){var r=n.contact;n=n.next;var s=r.GetFixtureA(),a=r.GetFixtureB();(t==s||t==a)&&this.m_world.m_contactManager.Destroy(r)}if(this.m_flags&d.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(l)}t.Destroy();t.m_body=null;t.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};d.prototype.SetPositionAndAngle=function(t,e){void 0===e&&(e=0);var o;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e);this.m_xf.position.SetV(t);var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y;this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=e;var r=this.m_world.m_contactManager.m_broadPhase;for(o=this.m_fixtureList;o;o=o.m_next)o.Synchronize(r,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}};d.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())};d.prototype.GetTransform=function(){return this.m_xf};d.prototype.GetPosition=function(){return this.m_xf.position};d.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())};d.prototype.GetAngle=function(){return this.m_sweep.a};d.prototype.SetAngle=function(t){void 0===t&&(t=0);this.SetPositionAndAngle(this.GetPosition(),t)};d.prototype.GetWorldCenter=function(){return this.m_sweep.c};d.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};d.prototype.SetLinearVelocity=function(t){this.m_type!=d.b2_staticBody&&this.m_linearVelocity.SetV(t)};d.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};d.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0);this.m_type!=d.b2_staticBody&&(this.m_angularVelocity=t)};d.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};d.prototype.GetDefinition=function(){var t=new y;t.type=this.GetType();t.allowSleep=(this.m_flags&d.e_allowSleepFlag)==d.e_allowSleepFlag;t.angle=this.GetAngle();t.angularDamping=this.m_angularDamping;t.gravityScale=this.m_gravityScale;t.angularVelocity=this.m_angularVelocity;t.fixedRotation=(this.m_flags&d.e_fixedRotationFlag)==d.e_fixedRotationFlag;t.bullet=(this.m_flags&d.e_bulletFlag)==d.e_bulletFlag;t.awake=(this.m_flags&d.e_awakeFlag)==d.e_awakeFlag;t.linearDamping=this.m_linearDamping;t.linearVelocity.SetV(this.GetLinearVelocity());t.position=this.GetPosition();t.userData=this.GetUserData();return t};d.prototype.ApplyForce=function(t,e){if(this.m_type==d.b2_dynamicBody){0==this.IsAwake()&&this.SetAwake(!0);this.m_force.x+=t.x;this.m_force.y+=t.y;this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x}};d.prototype.ApplyTorque=function(t){void 0===t&&(t=0);if(this.m_type==d.b2_dynamicBody){0==this.IsAwake()&&this.SetAwake(!0);this.m_torque+=t}};d.prototype.ApplyImpulse=function(t,e){if(this.m_type==d.b2_dynamicBody){0==this.IsAwake()&&this.SetAwake(!0);this.m_linearVelocity.x+=this.m_invMass*t.x;this.m_linearVelocity.y+=this.m_invMass*t.y;this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)}};d.prototype.Split=function(e){for(var o,i=this.GetLinearVelocity().Copy(),n=this.GetAngularVelocity(),r=this.GetWorldCenter(),s=this,a=this.m_world.CreateBody(this.GetDefinition()),l=s.m_fixtureList;l;)if(e(l)){var g=l.m_next;o?o.m_next=g:s.m_fixtureList=g;s.m_fixtureCount--;l.m_next=a.m_fixtureList;a.m_fixtureList=l;a.m_fixtureCount++;l.m_body=a;l=g}else{o=l;l=l.m_next}s.ResetMassData();a.ResetMassData();var m=s.GetWorldCenter(),c=a.GetWorldCenter(),u=t.AddVV(i,t.CrossFV(n,t.SubtractVV(m,r))),h=t.AddVV(i,t.CrossFV(n,t.SubtractVV(c,r)));s.SetLinearVelocity(u);a.SetLinearVelocity(h);s.SetAngularVelocity(n);a.SetAngularVelocity(n);s.SynchronizeFixtures();a.SynchronizeFixtures();return a};d.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var o=e.m_next;t.m_fixtureCount--;e.m_next=this.m_fixtureList;this.m_fixtureList=e;this.m_fixtureCount++;e.m_body=n;e=o}i.m_fixtureCount=0;{var i=this,n=t;i.GetWorldCenter(),n.GetWorldCenter(),i.GetLinearVelocity().Copy(),n.GetLinearVelocity().Copy(),i.GetAngularVelocity(),n.GetAngularVelocity()}i.ResetMassData();this.SynchronizeFixtures()};d.prototype.GetMass=function(){return this.m_mass};d.prototype.GetInertia=function(){return this.m_I};d.prototype.GetMassData=function(t){t.mass=this.m_mass;t.I=this.m_I;t.center.SetV(this.m_sweep.localCenter)};d.prototype.SetMassData=function(e){r.b2Assert(0==this.m_world.IsLocked());if(1!=this.m_world.IsLocked()&&this.m_type==d.b2_dynamicBody){this.m_invMass=0;this.m_I=0;this.m_invI=0;this.m_mass=e.mass;this.m_mass<=0&&(this.m_mass=1);this.m_invMass=1/this.m_mass;if(e.I>0&&0==(this.m_flags&d.e_fixedRotationFlag)){this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y);this.m_invI=1/this.m_I}var o=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center);this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-o.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-o.x)}};d.prototype.ResetMassData=function(){this.m_mass=0;this.m_invMass=0;this.m_I=0;this.m_invI=0;this.m_sweep.localCenter.SetZero();if(this.m_type!=d.b2_staticBody&&this.m_type!=d.b2_kinematicBody){for(var e=i.Make(0,0),o=this.m_fixtureList;o;o=o.m_next)if(0!=o.m_density){var n=o.GetMassData();this.m_mass+=n.mass;e.x+=n.center.x*n.mass;e.y+=n.center.y*n.mass;this.m_I+=n.I}if(this.m_mass>0){this.m_invMass=1/this.m_mass;e.x*=this.m_invMass;e.y*=this.m_invMass}else{this.m_mass=1;this.m_invMass=1}if(this.m_I>0&&0==(this.m_flags&d.e_fixedRotationFlag)){this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y);this.m_I*=this.m_inertiaScale;r.b2Assert(this.m_I>0);this.m_invI=1/this.m_I}else{this.m_I=0;
this.m_invI=0}var s=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e);this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-s.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-s.x)}};d.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,o=new i(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);o.x+=this.m_xf.position.x;o.y+=this.m_xf.position.y;return o};d.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)};d.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)};d.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)};d.prototype.GetLinearVelocityFromWorldPoint=function(t){return new i(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))};d.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,o=new i(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);o.x+=this.m_xf.position.x;o.y+=this.m_xf.position.y;return new i(this.m_linearVelocity.x-this.m_angularVelocity*(o.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(o.x-this.m_sweep.c.x))};d.prototype.GetLinearDamping=function(){return this.m_linearDamping};d.prototype.SetLinearDamping=function(t){void 0===t&&(t=0);this.m_linearDamping=t};d.prototype.GetAngularDamping=function(){return this.m_angularDamping};d.prototype.SetAngularDamping=function(t){void 0===t&&(t=0);this.m_angularDamping=t};d.prototype.GetGravityScale=function(){return this.m_gravityScale};d.prototype.SetGravityScale=function(t){void 0===t&&(t=1);this.m_gravityScale=t};d.prototype.SetType=function(t){void 0===t&&(t=0);if(this.m_type!=t){this.m_type=t;this.ResetMassData();if(this.m_type==d.b2_staticBody){this.m_linearVelocity.SetZero();this.m_angularVelocity=0}this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}};d.prototype.GetType=function(){return this.m_type};d.prototype.SetBullet=function(t){t?this.m_flags|=d.e_bulletFlag:this.m_flags&=~d.e_bulletFlag};d.prototype.IsBullet=function(){return(this.m_flags&d.e_bulletFlag)==d.e_bulletFlag};d.prototype.SetSleepingAllowed=function(t){if(t)this.m_flags|=d.e_allowSleepFlag;else{this.m_flags&=~d.e_allowSleepFlag;this.SetAwake(!0)}};d.prototype.SetAwake=function(t){if(t){this.qyobj&&!this.IsAwake()&&this.qyobj.dispatchEvent("wakeup");this.m_flags|=d.e_awakeFlag;this.m_sleepTime=0}else{this.qyobj&&this.IsAwake()&&this.qyobj.dispatchEvent("sleep");this.m_flags&=~d.e_awakeFlag;this.m_sleepTime=0;this.m_linearVelocity.SetZero();this.m_angularVelocity=0;this.m_force.SetZero();this.m_torque=0}};d.prototype.IsAwake=function(){return(this.m_flags&d.e_awakeFlag)==d.e_awakeFlag};d.prototype.SetFixedRotation=function(t){t?this.m_flags|=d.e_fixedRotationFlag:this.m_flags&=~d.e_fixedRotationFlag;this.ResetMassData()};d.prototype.IsFixedRotation=function(){return(this.m_flags&d.e_fixedRotationFlag)==d.e_fixedRotationFlag};d.prototype.SetActive=function(t){if(t!=this.IsActive()){var e,o;if(t){this.m_flags|=d.e_activeFlag;e=this.m_world.m_contactManager.m_broadPhase;for(o=this.m_fixtureList;o;o=o.m_next)o.CreateProxy(e,this.m_xf)}else{this.m_flags&=~d.e_activeFlag;e=this.m_world.m_contactManager.m_broadPhase;for(o=this.m_fixtureList;o;o=o.m_next)o.DestroyProxy(e);for(var i=this.m_contactList;i;){var n=i;i=i.next;this.m_world.m_contactManager.Destroy(n.contact)}this.m_contactList=null}}};d.prototype.IsActive=function(){return(this.m_flags&d.e_activeFlag)==d.e_activeFlag};d.prototype.IsSleepingAllowed=function(){return(this.m_flags&d.e_allowSleepFlag)==d.e_allowSleepFlag};d.prototype.GetFixtureList=function(){return this.m_fixtureList};d.prototype.GetJointList=function(){return this.m_jointList};d.prototype.GetControllerList=function(){return this.m_controllerList};d.prototype.GetContactList=function(){return this.m_contactList};d.prototype.GetNext=function(){return this.m_next};d.prototype.GetUserData=function(){return this.m_userData};d.prototype.SetUserData=function(t){this.m_userData=t};d.prototype.GetWorld=function(){return this.m_world};d.prototype.b2Body=function(t,e){this.m_flags=0;t.bullet&&(this.m_flags|=d.e_bulletFlag);t.fixedRotation&&(this.m_flags|=d.e_fixedRotationFlag);t.allowSleep&&(this.m_flags|=d.e_allowSleepFlag);t.awake&&(this.m_flags|=d.e_awakeFlag);t.active&&(this.m_flags|=d.e_activeFlag);this.m_world=e;this.m_xf.position.SetV(t.position);this.m_xf.R.Set(t.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=t.angle;var o=this.m_xf.R,i=this.m_sweep.localCenter;this.m_sweep.c.x=o.col1.x*i.x+o.col2.x*i.y;this.m_sweep.c.y=o.col1.y*i.x+o.col2.y*i.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_jointList=null;this.m_controllerList=null;this.m_contactList=null;this.m_controllerCount=0;this.m_prev=null;this.m_next=null;this.m_linearVelocity.SetV(t.linearVelocity);this.m_angularVelocity=t.angularVelocity;this.m_linearDamping=t.linearDamping;this.m_angularDamping=t.angularDamping;this.m_gravityScale=t.gravityScale;this.m_force.Set(0,0);this.m_torque=0;this.m_sleepTime=0;this.m_type=t.type;if(this.m_type==d.b2_dynamicBody){this.m_mass=1;this.m_invMass=1}else{this.m_mass=0;this.m_invMass=0}this.m_I=0;this.m_invI=0;this.m_inertiaScale=t.inertiaScale;this.m_userData=t.userData;this.m_fixtureList=null;this.m_fixtureCount=0};d.prototype.SynchronizeFixtures=function(){var t=d.s_xf1;t.R.Set(this.m_sweep.a0);var e=t.R,o=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(e.col1.x*o.x+e.col2.x*o.y);t.position.y=this.m_sweep.c0.y-(e.col1.y*o.x+e.col2.y*o.y);var i,n=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(n,t,this.m_xf)};d.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y);this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)};d.prototype.ShouldCollide=function(t){if(this.m_type!=d.b2_dynamicBody&&t.m_type!=d.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0};d.prototype.Advance=function(t){void 0===t&&(t=0);this.m_sweep.Advance(t);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.SynchronizeTransform()};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new o;Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=2});y.b2BodyDef=function(){this.position=new i;this.linearVelocity=new i};y.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,0);this.angularVelocity=0;this.linearDamping=0;this.angularDamping=0;this.gravityScale=1;this.allowSleep=!0;this.awake=!0;this.fixedRotation=!1;this.bullet=!1;this.type=d.b2_staticBody;this.active=!0;this.inertiaScale=1};f.b2ContactFilter=function(){};f.prototype.ShouldCollide=function(t,e){var o=t.GetFilterData(),i=e.GetFilterData();if(o.groupIndex==i.groupIndex&&0!=o.groupIndex)return o.groupIndex>0;var n=0!=(o.maskBits&i.categoryBits)&&0!=(o.categoryBits&i.maskBits);return n};f.prototype.RayCollide=function(t,e){return t?this.ShouldCollide(t instanceof E?t:null,e):!0};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new f});v.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(r.b2_maxManifoldPoints);this.tangentImpulses=new Vector_a2j_Number(r.b2_maxManifoldPoints)};x.b2ContactListener=function(){};x.prototype.BeginContact=function(){};x.prototype.EndContact=function(){};x.prototype.PreSolve=function(){};x.prototype.PostSolve=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new x});b.b2ContactManager=function(){};b.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=f.b2_defaultFilter;this.m_contactListener=x.b2_defaultListener;this.m_contactFactory=new M(this.m_allocator);this.m_broadPhase=new l};b.prototype.AddPair=function(t,e){var o=t instanceof E?t:null,i=e instanceof E?e:null,n=o.GetBody(),r=i.GetBody();if(n!=r){for(var s=r.GetContactList();s;){if(s.other==n){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==o&&l==i)return;if(a==i&&l==o)return}s=s.next}if(0!=r.ShouldCollide(n)&&0!=this.m_contactFilter.ShouldCollide(o,i)){var g=this.m_contactFactory.Create(o,i);o=g.GetFixtureA();i=g.GetFixtureB();n=o.m_body;r=i.m_body;g.m_prev=null;g.m_next=this.m_world.m_contactList;null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=g);this.m_world.m_contactList=g;g.m_nodeA.contact=g;g.m_nodeA.other=r;g.m_nodeA.prev=null;g.m_nodeA.next=n.m_contactList;null!=n.m_contactList&&(n.m_contactList.prev=g.m_nodeA);n.m_contactList=g.m_nodeA;g.m_nodeB.contact=g;g.m_nodeB.other=n;g.m_nodeB.prev=null;g.m_nodeB.next=r.m_contactList;null!=r.m_contactList&&(r.m_contactList.prev=g.m_nodeB);r.m_contactList=g.m_nodeB;++this.m_world.m_contactCount}}};b.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))};b.prototype.Destroy=function(t){var e=t.GetFixtureA(),o=t.GetFixtureB(),i=e.GetBody(),n=o.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t);t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next);t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next);t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev);t.m_nodeA==i.m_contactList&&(i.m_contactList=t.m_nodeA.next);t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next);t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev);t.m_nodeB==n.m_contactList&&(n.m_contactList=t.m_nodeB.next);this.m_contactFactory.Destroy(t);--this.m_contactCount};b.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),o=t.GetFixtureB(),i=e.GetBody(),n=o.GetBody();if(0!=i.IsAwake()||0!=n.IsAwake()){if(t.m_flags&B.e_filterFlag){if(0==n.ShouldCollide(i)){var r=t;t=r.GetNext();this.Destroy(r);continue}if(0==this.m_contactFilter.ShouldCollide(e,o)){r=t;t=r.GetNext();this.Destroy(r);continue}t.m_flags&=~B.e_filterFlag}var s=e.m_proxy,a=o.m_proxy,l=this.m_broadPhase.TestOverlap(s,a);if(0!=l){t.Update(this.m_contactListener);t=t.GetNext()}else{r=t;t=r.GetNext();this.Destroy(r)}}else t=t.GetNext()}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new a});S.b2DebugDraw=function(){};S.prototype.b2DebugDraw=function(){};S.prototype.SetFlags=function(t){void 0===t&&(t=0)};S.prototype.GetFlags=function(){};S.prototype.AppendFlags=function(t){void 0===t&&(t=0)};S.prototype.ClearFlags=function(t){void 0===t&&(t=0)};S.prototype.SetSprite=function(){};S.prototype.GetSprite=function(){};S.prototype.SetDrawScale=function(t){void 0===t&&(t=0)};S.prototype.GetDrawScale=function(){};S.prototype.SetLineThickness=function(t){void 0===t&&(t=0)};S.prototype.GetLineThickness=function(){};S.prototype.SetAlpha=function(t){void 0===t&&(t=0)};S.prototype.GetAlpha=function(){};S.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)};S.prototype.GetFillAlpha=function(){};S.prototype.SetXFormScale=function(t){void 0===t&&(t=0)};S.prototype.GetXFormScale=function(){};S.prototype.DrawPolygon=function(t,e){void 0===e&&(e=0)};S.prototype.DrawSolidPolygon=function(t,e){void 0===e&&(e=0)};S.prototype.DrawCircle=function(t,e){void 0===e&&(e=0)};S.prototype.DrawSolidCircle=function(t,e){void 0===e&&(e=0)};S.prototype.DrawSegment=function(){};S.prototype.DrawTransform=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2DebugDraw.e_controllerBit=32});A.b2DestructionListener=function(){};A.prototype.SayGoodbyeJoint=function(){};A.prototype.SayGoodbyeFixture=function(){};C.b2FilterData=function(){this.categoryBits=1;this.maskBits=4294967295;this.groupIndex=0};C.prototype.Copy=function(){var t=new C;t.categoryBits=this.categoryBits;t.maskBits=this.maskBits;t.groupIndex=this.groupIndex;return t};E.b2Fixture=function(){this.m_filter=new C};E.prototype.GetType=function(){return this.m_shape.GetType()};E.prototype.GetShape=function(){return this.m_shape};E.prototype.SetSensor=function(t){if(this.m_isSensor!=t){this.m_isSensor=t;if(null!=this.m_body)for(var e=this.m_body.GetContactList();e;){var o=e.contact,i=o.GetFixtureA(),n=o.GetFixtureB();(i==this||n==this)&&o.SetSensor(i.IsSensor()||n.IsSensor());e=e.next}}};E.prototype.IsSensor=function(){return this.m_isSensor};E.prototype.SetFilterData=function(t){this.m_filter=t.Copy();if(!this.m_body)for(var e=this.m_body.GetContactList();e;){var o=e.contact,i=o.GetFixtureA(),n=o.GetFixtureB();(i==this||n==this)&&o.FlagForFiltering();e=e.next}};E.prototype.GetFilterData=function(){return this.m_filter.Copy()};E.prototype.GetBody=function(){return this.m_body};E.prototype.GetNext=function(){return this.m_next};E.prototype.GetUserData=function(){return this.m_userData};E.prototype.SetUserData=function(t){this.m_userData=t};E.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)};E.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())};E.prototype.GetMassData=function(t){void 0===t&&(t=null);null==t&&(t=new h);this.m_shape.ComputeMass(t,this.m_density);return t};E.prototype.SetDensity=function(t){void 0===t&&(t=0);this.m_density=t};E.prototype.GetDensity=function(){return this.m_density};E.prototype.GetFriction=function(){return this.m_friction};E.prototype.SetFriction=function(t){void 0===t&&(t=0);this.m_friction=t};E.prototype.GetRestitution=function(){return this.m_restitution};E.prototype.SetRestitution=function(t){void 0===t&&(t=0);this.m_restitution=t};E.prototype.GetAABB=function(){return this.m_aabb};E.prototype.b2Fixture=function(){this.m_aabb=new s;this.m_userData=null;this.m_body=null;this.m_next=null;this.m_shape=null;this.m_density=0;this.m_friction=0;this.m_restitution=0};E.prototype.Create=function(t,e,o){this.m_userData=o.userData;this.m_friction=o.friction;this.m_restitution=o.restitution;this.m_body=t;this.m_next=null;this.m_filter=o.filter.Copy();this.m_isSensor=o.isSensor;this.m_shape=o.shape.Copy();this.m_density=o.density};E.prototype.Destroy=function(){this.m_shape=null};E.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e);this.m_proxy=t.CreateProxy(this.m_aabb,this)};E.prototype.DestroyProxy=function(t){if(null!=this.m_proxy){t.DestroyProxy(this.m_proxy);this.m_proxy=null}};E.prototype.Synchronize=function(e,o,i){if(this.m_proxy){var n=new s,r=new s;this.m_shape.ComputeAABB(n,o);this.m_shape.ComputeAABB(r,i);this.m_aabb.Combine(n,r);var a=t.SubtractVV(i.position,o.position);e.MoveProxy(this.m_proxy,this.m_aabb,a)}};D.b2FixtureDef=function(){this.filter=new C};D.prototype.b2FixtureDef=function(){this.shape=null;this.userData=null;this.friction=.2;this.restitution=0;this.density=0;this.filter.categoryBits=1;this.filter.maskBits=4294967295;this.filter.groupIndex=0;this.isSensor=!1};T.b2Island=function(){};T.prototype.b2Island=function(){this.m_bodies=new Vector;this.m_contacts=new Vector;this.m_joints=new Vector};T.prototype.Initialize=function(t,e,o,i,n,r){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=0);var s=0;this.m_bodyCapacity=t;this.m_contactCapacity=e;this.m_jointCapacity=o;this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0;this.m_allocator=i;this.m_listener=n;this.m_contactSolver=r;for(s=this.m_bodies.length;t>s;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;e>s;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;o>s;s++)this.m_joints[s]=null};T.prototype.Clear=function(){this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0};T.prototype.Solve=function(e,o,i){var n,s,a=0,l=0;for(a=0;a<this.m_bodyCount;++a){n=this.m_bodies[a];if(n.GetType()==d.b2_dynamicBody){n.m_linearVelocity.x+=e.dt*(n.m_gravityScale*o.x+n.m_invMass*n.m_force.x);n.m_linearVelocity.y+=e.dt*(n.m_gravityScale*o.y+n.m_invMass*n.m_force.y);n.m_angularVelocity+=e.dt*n.m_invI*n.m_torque;n.m_linearVelocity.Multiply(t.Clamp(1-e.dt*n.m_linearDamping,0,1));n.m_angularVelocity*=t.Clamp(1-e.dt*n.m_angularDamping,0,1)}}this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var g=this.m_contactSolver;g.InitVelocityConstraints(e);for(a=0;a<this.m_jointCount;++a){s=this.m_joints[a];s.InitVelocityConstraints(e)}for(a=0;a<e.velocityIterations;++a){for(l=0;l<this.m_jointCount;++l){s=this.m_joints[l];s.SolveVelocityConstraints(e)}g.SolveVelocityConstraints()}for(a=0;a<this.m_jointCount;++a){s=this.m_joints[a];s.FinalizeVelocityConstraints()}g.FinalizeVelocityConstraints();for(a=0;a<this.m_bodyCount;++a){n=this.m_bodies[a];if(n.GetType()!=d.b2_staticBody){var m=e.dt*n.m_linearVelocity.x,c=e.dt*n.m_linearVelocity.y;if(m*m+c*c>r.b2_maxTranslationSquared){n.m_linearVelocity.Normalize();n.m_linearVelocity.x*=r.b2_maxTranslation*e.inv_dt;n.m_linearVelocity.y*=r.b2_maxTranslation*e.inv_dt}var u=e.dt*n.m_angularVelocity;u*u>r.b2_maxRotationSquared&&(n.m_angularVelocity=n.m_angularVelocity<0?-r.b2_maxRotation*e.inv_dt:r.b2_maxRotation*e.inv_dt);n.m_sweep.c0.SetV(n.m_sweep.c);n.m_sweep.a0=n.m_sweep.a;n.m_sweep.c.x+=e.dt*n.m_linearVelocity.x;n.m_sweep.c.y+=e.dt*n.m_linearVelocity.y;n.m_sweep.a+=e.dt*n.m_angularVelocity;n.SynchronizeTransform()}}for(a=0;a<e.positionIterations;++a){var h=g.SolvePositionConstraints(r.b2_contactBaumgarte),p=!0;for(l=0;l<this.m_jointCount;++l){s=this.m_joints[l];var _=s.SolvePositionConstraints(r.b2_contactBaumgarte);p=p&&_}if(h&&p)break}this.Report(g.m_constraints);if(i){var y=Number.MAX_VALUE,f=r.b2_linearSleepTolerance*r.b2_linearSleepTolerance,v=r.b2_angularSleepTolerance*r.b2_angularSleepTolerance;for(a=0;a<this.m_bodyCount;++a){n=this.m_bodies[a];if(n.GetType()!=d.b2_staticBody){if(0==(n.m_flags&d.e_allowSleepFlag)){n.m_sleepTime=0;y=0}if(0==(n.m_flags&d.e_allowSleepFlag)||n.m_angularVelocity*n.m_angularVelocity>v||t.Dot(n.m_linearVelocity,n.m_linearVelocity)>f){n.m_sleepTime=0;y=0}else{n.m_sleepTime+=e.dt;y=t.Min(y,n.m_sleepTime)}}}if(y>=r.b2_timeToSleep)for(a=0;a<this.m_bodyCount;++a){n=this.m_bodies[a];n.SetAwake(!1)}}};T.prototype.SolveTOI=function(t){var e=0,o=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var i=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e){i.SolveVelocityConstraints();for(o=0;o<this.m_jointCount;++o)this.m_joints[o].SolveVelocityConstraints(t)}for(e=0;e<this.m_bodyCount;++e){var n=this.m_bodies[e];if(n.GetType()!=d.b2_staticBody){var s=t.dt*n.m_linearVelocity.x,a=t.dt*n.m_linearVelocity.y;if(s*s+a*a>r.b2_maxTranslationSquared){n.m_linearVelocity.Normalize();n.m_linearVelocity.x*=r.b2_maxTranslation*t.inv_dt;n.m_linearVelocity.y*=r.b2_maxTranslation*t.inv_dt}var l=t.dt*n.m_angularVelocity;l*l>r.b2_maxRotationSquared&&(n.m_angularVelocity=n.m_angularVelocity<0?-r.b2_maxRotation*t.inv_dt:r.b2_maxRotation*t.inv_dt);n.m_sweep.c0.SetV(n.m_sweep.c);n.m_sweep.a0=n.m_sweep.a;n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x;n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y;n.m_sweep.a+=t.dt*n.m_angularVelocity;n.SynchronizeTransform()}}var g=.75;for(e=0;e<t.positionIterations;++e){var m=i.SolvePositionConstraints(g),c=!0;for(o=0;o<this.m_jointCount;++o){var u=this.m_joints[o].SolvePositionConstraints(r.b2_contactBaumgarte);c=c&&u}if(m&&c)break}this.Report(i.m_constraints)};T.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var o=this.m_contacts[e],i=t[e],n=0;n<i.pointCount;++n){T.s_impulse.normalImpulses[n]=i.points[n].normalImpulse;T.s_impulse.tangentImpulses[n]=i.points[n].tangentImpulse}this.m_listener.PostSolve(o,T.s_impulse)}};T.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=t};T.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t};T.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new v});R.b2TimeStep=function(){};R.prototype.Set=function(t){this.dt=t.dt;this.inv_dt=t.inv_dt;this.positionIterations=t.positionIterations;this.velocityIterations=t.velocityIterations;this.warmStarting=t.warmStarting};w.b2World=function(){this.s_stack=new Vector;this.m_contactManager=new b;this.m_contactSolver=new I;this.m_island=new T};w.prototype.b2World=function(t,e){this.m_destructionListener=null;this.m_debugDraw=null;this.m_bodyList=null;this.m_contactList=null;this.m_jointList=null;this.m_controllerList=null;this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0;this.m_controllerCount=0;w.m_warmStarting=!0;w.m_continuousPhysics=!0;this.m_allowSleep=e;this.m_gravity=t;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var o=new y;this.m_groundBody=this.CreateBody(o)};w.prototype.SetDestructionListener=function(t){this.m_destructionListener=t};w.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t};w.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t};w.prototype.SetDebugDraw=function(t){this.m_debugDraw=t};w.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var o=this.m_bodyList;o;o=o.m_next)for(var i=o.m_fixtureList;i;i=i.m_next)i.m_proxy=t.CreateProxy(e.GetFatAABB(i.m_proxy),i)};w.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};w.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};w.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new d(t,this);e.m_prev=null;e.m_next=this.m_bodyList;this.m_bodyList&&(this.m_bodyList.m_prev=e);this.m_bodyList=e;++this.m_bodyCount;return e};w.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var o=e;e=e.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(o.joint);this.DestroyJoint(o.joint)}for(var i=t.m_controllerList;i;){var n=i;i=i.nextController;n.controller.RemoveBody(t)}for(var r=t.m_contactList;r;){var s=r;r=r.next;this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l);l.DestroyProxy(this.m_contactManager.m_broadPhase);l.Destroy()}t.m_fixtureList=null;t.m_fixtureCount=0;t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t==this.m_bodyList&&(this.m_bodyList=t.m_next);--this.m_bodyCount}};w.prototype.CreateJoint=function(t){var e=N.Create(t,null);e.m_prev=null;e.m_next=this.m_jointList;this.m_jointList&&(this.m_jointList.m_prev=e);this.m_jointList=e;++this.m_jointCount;e.m_edgeA.joint=e;e.m_edgeA.other=e.m_bodyB;e.m_edgeA.prev=null;e.m_edgeA.next=e.m_bodyA.m_jointList;e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA);e.m_bodyA.m_jointList=e.m_edgeA;e.m_edgeB.joint=e;e.m_edgeB.other=e.m_bodyA;e.m_edgeB.prev=null;e.m_edgeB.next=e.m_bodyB.m_jointList;e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB);e.m_bodyB.m_jointList=e.m_edgeB;var o=t.bodyA,i=t.bodyB;if(0==t.collideConnected)for(var n=i.GetContactList();n;){n.other==o&&n.contact.FlagForFiltering();n=n.next}return e};w.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t==this.m_jointList&&(this.m_jointList=t.m_next);var o=t.m_bodyA,i=t.m_bodyB;o.SetAwake(!0);i.SetAwake(!0);t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next);t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev);t.m_edgeA==o.m_jointList&&(o.m_jointList=t.m_edgeA.next);t.m_edgeA.prev=null;t.m_edgeA.next=null;t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next);t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev);t.m_edgeB==i.m_jointList&&(i.m_jointList=t.m_edgeB.next);t.m_edgeB.prev=null;t.m_edgeB.next=null;N.Destroy(t,null);--this.m_jointCount;if(0==e)for(var n=i.GetContactList();n;){n.other==o&&n.contact.FlagForFiltering();n=n.next}};w.prototype.AddController=function(t){t.m_next=this.m_controllerList;t.m_prev=null;this.m_controllerList=t;t.m_world=this;this.m_controllerCount++;return t};w.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);this.m_controllerList==t&&(this.m_controllerList=t.m_next);this.m_controllerCount--};w.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");t.m_next=this.m_controllerList;t.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=t);this.m_controllerList=t;++this.m_controllerCount;t.m_world=this;return t};w.prototype.DestroyController=function(t){t.Clear();t.m_next&&(t.m_next.m_prev=t.m_prev);t.m_prev&&(t.m_prev.m_next=t.m_next);t==this.m_controllerList&&(this.m_controllerList=t.m_next);--this.m_controllerCount};w.prototype.SetWarmStarting=function(t){w.m_warmStarting=t};w.prototype.SetContinuousPhysics=function(t){w.m_continuousPhysics=t};w.prototype.GetBodyCount=function(){return this.m_bodyCount};w.prototype.GetJointCount=function(){return this.m_jointCount};w.prototype.GetContactCount=function(){return this.m_contactCount};w.prototype.SetGravity=function(t){this.m_gravity=t};w.prototype.GetGravity=function(){return this.m_gravity};w.prototype.GetGroundBody=function(){return this.m_groundBody};w.prototype.Step=function(t,e,o){void 0===t&&(t=0);void 0===e&&(e=0);void 0===o&&(o=0);if(this.m_flags&w.e_newFixture){this.m_contactManager.FindNewContacts();this.m_flags&=~w.e_newFixture}this.m_flags|=w.e_locked;var i=w.s_timestep2;i.dt=t;i.velocityIterations=e;i.positionIterations=o;i.inv_dt=t>0?1/t:0;i.dtRatio=this.m_inv_dt0*t;i.warmStarting=w.m_warmStarting;this.m_contactManager.Collide();i.dt>0&&this.Solve(i);w.m_continuousPhysics&&i.dt>0&&this.SolveTOI(i);i.dt>0&&(this.m_inv_dt0=i.inv_dt);this.m_flags&=~w.e_locked};w.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next){t.m_force.SetZero();t.m_torque=0}};w.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,o,r,a,l,g=this.m_debugDraw.GetFlags(),m=(new i,new i,new i,new s,new s,[new i,new i,new i,new i]),c=new n(0,0,0);if(g&S.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next){l=t.m_xf;for(e=t.GetFixtureList();e;e=e.m_next){o=e.GetShape();if(0==t.IsActive()){c.Set(.5,.5,.3);this.DrawShape(o,l,c)}else if(t.GetType()==d.b2_staticBody){c.Set(.5,.9,.5);this.DrawShape(o,l,c)}else if(t.GetType()==d.b2_kinematicBody){c.Set(.5,.5,.9);this.DrawShape(o,l,c)}else if(0==t.IsAwake()){c.Set(.6,.6,.6);this.DrawShape(o,l,c)}else{c.Set(.9,.7,.7);this.DrawShape(o,l,c)}}}if(g&S.e_jointBit)for(r=this.m_jointList;r;r=r.m_next)this.DrawJoint(r);if(g&S.e_controllerBit)for(var u=this.m_controllerList;u;u=u.m_next)u.Draw(this.m_debugDraw);if(g&S.e_pairBit){c.Set(.3,.9,.9);for(var h=this.m_contactManager.m_contactList;h;h=h.GetNext()){var p=h.GetFixtureA(),_=h.GetFixtureB(),y=p.GetAABB().GetCenter(),f=_.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(y,f,c)}}if(g&S.e_aabbBit){a=this.m_contactManager.m_broadPhase;m=[new i,new i,new i,new i];for(t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var v=a.GetFatAABB(e.m_proxy);m[0].Set(v.lowerBound.x,v.lowerBound.y);m[1].Set(v.upperBound.x,v.lowerBound.y);m[2].Set(v.upperBound.x,v.upperBound.y);m[3].Set(v.lowerBound.x,v.upperBound.y);this.m_debugDraw.DrawPolygon(m,4,c)}}if(g&S.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next){l=w.s_xf;l.R=t.m_xf.R;l.position=t.GetWorldCenter();this.m_debugDraw.DrawTransform(l)}}};w.prototype.QueryAABB=function(t,e){function o(e){return t(n.GetUserData(e))}var i=this,n=i.m_contactManager.m_broadPhase;n.Query(o,e)};w.prototype.QueryShape=function(t,e,i){function n(o){var n=a.GetUserData(o)instanceof E?a.GetUserData(o):null;return _.TestOverlap(e,i,n.GetShape(),n.GetBody().GetTransform())?t(n):!0}var r=this;void 0===i&&(i=null);if(null==i){i=new o;i.SetIdentity()}var a=r.m_contactManager.m_broadPhase,l=new s;e.ComputeAABB(l,i);a.Query(n,l)};w.prototype.QueryPoint=function(t,e){function o(o){var i=n.GetUserData(o)instanceof E?n.GetUserData(o):null;return i.TestPoint(e)?t(i):!0}var i=this,n=i.m_contactManager.m_broadPhase,a=new s;a.lowerBound.Set(e.x-r.b2_linearSlop,e.y-r.b2_linearSlop);a.upperBound.Set(e.x+r.b2_linearSlop,e.y+r.b2_linearSlop);n.Query(o,a)};w.prototype.RayCast=function(t,e,o){function n(n,r){var l=s.GetUserData(r),g=l instanceof E?l:null,m=g.RayCast(a,n);if(m){var c=a.fraction,u=new i((1-c)*e.x+c*o.x,(1-c)*e.y+c*o.y);return t(g,u,a.normal,c)}return n.maxFraction}var r=this,s=r.m_contactManager.m_broadPhase,a=new m,l=new g(e,o);s.RayCast(n,l)};w.prototype.RayCastOne=function(t,e){function o(t,e,o,n){void 0===n&&(n=0);i=t;return n}var i,n=this;n.RayCast(o,t,e);return i};w.prototype.RayCastAll=function(t,e){function o(t,e,o,i){void 0===i&&(i=0);n[n.length]=t;return 1}var i=this,n=new Vector;i.RayCast(o,t,e);return n};w.prototype.GetBodyList=function(){return this.m_bodyList};w.prototype.GetJointList=function(){return this.m_jointList};w.prototype.GetContactList=function(){return this.m_contactList};w.prototype.IsLocked=function(){return(this.m_flags&w.e_locked)>0};w.prototype.Solve=function(t){for(var e,o=this.m_controllerList;o;o=o.m_next)o.Step(t);var i=this.m_island;i.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~d.e_islandFlag;for(var n=this.m_contactList;n;n=n.m_next)n.m_flags&=~B.e_islandFlag;for(var r=this.m_jointList;r;r=r.m_next)r.m_islandFlag=!1;for(var s=(parseInt(this.m_bodyCount),this.s_stack),a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&d.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=d.b2_staticBody){i.Clear();var l=0;s[l++]=a;a.m_flags|=d.e_islandFlag;for(;l>0;){e=s[--l];i.AddBody(e);0==e.IsAwake()&&e.SetAwake(!0);if(e.GetType()!=d.b2_staticBody){for(var g,m=e.m_contactList;m;m=m.next)if(!(m.contact.m_flags&B.e_islandFlag)&&1!=m.contact.IsSensor()&&0!=m.contact.IsEnabled()&&0!=m.contact.IsTouching()){i.AddContact(m.contact);m.contact.m_flags|=B.e_islandFlag;g=m.other;if(!(g.m_flags&d.e_islandFlag)){s[l++]=g;g.m_flags|=d.e_islandFlag}}for(var c=e.m_jointList;c;c=c.next)if(1!=c.joint.m_islandFlag){g=c.other;if(0!=g.IsActive()){i.AddJoint(c.joint);c.joint.m_islandFlag=!0;if(!(g.m_flags&d.e_islandFlag)){s[l++]=g;g.m_flags|=d.e_islandFlag}}}}}i.Solve(t,this.m_gravity,this.m_allowSleep);for(var u=0;u<i.m_bodyCount;++u){e=i.m_bodies[u];e.GetType()==d.b2_staticBody&&(e.m_flags&=~d.e_islandFlag)}}for(u=0;u<s.length&&s[u];++u)s[u]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=d.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()};w.prototype.SolveTOI=function(t){var e,o,i,n,s,a,l,g=this.m_island;g.Initialize(this.m_bodyCount,r.b2_maxTOIContactsPerIsland,r.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var m=w.s_queue;for(e=this.m_bodyList;e;e=e.m_next){e.m_flags&=~d.e_islandFlag;e.m_sweep.t0=0}var c;for(c=this.m_contactList;c;c=c.m_next)c.m_flags&=~(B.e_toiFlag|B.e_islandFlag);
for(l=this.m_jointList;l;l=l.m_next)l.m_islandFlag=!1;for(;;){var u=null,h=1;for(c=this.m_contactList;c;c=c.m_next)if(1!=c.IsSensor()&&0!=c.IsEnabled()&&0!=c.IsContinuous()){var p=1;if(c.m_flags&B.e_toiFlag)p=c.m_toi;else{o=c.m_fixtureA;i=c.m_fixtureB;n=o.m_body;s=i.m_body;if(!(n.GetType()==d.b2_dynamicBody&&0!=n.IsAwake()||s.GetType()==d.b2_dynamicBody&&0!=s.IsAwake()))continue;var _=n.m_sweep.t0;if(n.m_sweep.t0<s.m_sweep.t0){_=s.m_sweep.t0;n.m_sweep.Advance(_)}else if(s.m_sweep.t0<n.m_sweep.t0){_=n.m_sweep.t0;s.m_sweep.Advance(_)}p=c.ComputeTOI(n.m_sweep,s.m_sweep);r.b2Assert(p>=0&&1>=p);if(p>0&&1>p){p=(1-p)*_+p;p>1&&(p=1)}c.m_toi=p;c.m_flags|=B.e_toiFlag}if(Box2D.MIN_VALUE<p&&h>p){u=c;h=p}}if(null==u||1-100*Box2D.MIN_VALUE<h)break;o=u.m_fixtureA;i=u.m_fixtureB;n=o.m_body;s=i.m_body;w.s_backupA.Set(n.m_sweep);w.s_backupB.Set(s.m_sweep);n.Advance(h);s.Advance(h);u.Update(this.m_contactManager.m_contactListener);u.m_flags&=~B.e_toiFlag;if(1!=u.IsSensor()&&0!=u.IsEnabled()){if(0!=u.IsTouching()){var y=n;y.GetType()!=d.b2_dynamicBody&&(y=s);g.Clear();var f=0,v=0;m[f+v++]=y;y.m_flags|=d.e_islandFlag;for(;v>0;){e=m[f++];--v;g.AddBody(e);0==e.IsAwake()&&e.SetAwake(!0);if(e.GetType()==d.b2_dynamicBody){for(a=e.m_contactList;a&&g.m_contactCount!=g.m_contactCapacity;a=a.next)if(!(a.contact.m_flags&B.e_islandFlag)&&1!=a.contact.IsSensor()&&0!=a.contact.IsEnabled()&&0!=a.contact.IsTouching()){g.AddContact(a.contact);a.contact.m_flags|=B.e_islandFlag;var x=a.other;if(!(x.m_flags&d.e_islandFlag)){if(x.GetType()!=d.b2_staticBody){x.Advance(h);x.SetAwake(!0)}m[f+v]=x;++v;x.m_flags|=d.e_islandFlag}}for(var b=e.m_jointList;b;b=b.next)if(g.m_jointCount!=g.m_jointCapacity&&1!=b.joint.m_islandFlag){x=b.other;if(0!=x.IsActive()){g.AddJoint(b.joint);b.joint.m_islandFlag=!0;if(!(x.m_flags&d.e_islandFlag)){if(x.GetType()!=d.b2_staticBody){x.Advance(h);x.SetAwake(!0)}m[f+v]=x;++v;x.m_flags|=d.e_islandFlag}}}}}var S=w.s_timestep;S.warmStarting=!1;S.dt=(1-h)*t.dt;S.inv_dt=1/S.dt;S.dtRatio=0;S.velocityIterations=t.velocityIterations;S.positionIterations=t.positionIterations;g.SolveTOI(S);var A=0;for(A=0;A<g.m_bodyCount;++A){e=g.m_bodies[A];e.m_flags&=~d.e_islandFlag;if(0!=e.IsAwake()&&e.GetType()==d.b2_dynamicBody){e.SynchronizeFixtures();for(a=e.m_contactList;a;a=a.next)a.contact.m_flags&=~B.e_toiFlag}}for(A=0;A<g.m_contactCount;++A){c=g.m_contacts[A];c.m_flags&=~(B.e_toiFlag|B.e_islandFlag)}for(A=0;A<g.m_jointCount;++A){l=g.m_joints[A];l.m_islandFlag=!1}this.m_contactManager.FindNewContacts()}}else{n.m_sweep.Set(w.s_backupA);s.m_sweep.Set(w.s_backupB);n.SynchronizeTransform();s.SynchronizeTransform()}}};w.prototype.DrawJoint=function(t){var e=t.GetBodyA(),o=t.GetBodyB(),i=e.m_xf,n=o.m_xf,r=i.position,s=n.position,a=t.GetAnchorA(),l=t.GetAnchorB(),g=w.s_jointColor;switch(t.m_type){case N.e_ropeJoint:this.m_debugDraw.DrawSegment(a,l,g);break;case N.e_distanceJoint:this.m_debugDraw.DrawSegment(a,l,g);break;case N.e_pulleyJoint:var m=t instanceof L?t:null,c=m.GetGroundAnchorA(),u=m.GetGroundAnchorB();this.m_debugDraw.DrawSegment(c,a,g);this.m_debugDraw.DrawSegment(u,l,g);this.m_debugDraw.DrawSegment(c,u,g);break;case N.e_mouseJoint:this.m_debugDraw.DrawSegment(a,l,g);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(r,a,g);this.m_debugDraw.DrawSegment(a,l,g);o!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,g)}};w.prototype.DrawShape=function(e,o,i){switch(e.m_type){case _.e_circleShape:var n=e instanceof c?e:null,r=t.MulX(o,n.m_p),s=n.m_radius,a=o.R.col1;this.m_debugDraw.DrawSolidCircle(r,s,a,i);break;case _.e_polygonShape:var l=0,g=e instanceof p?e:null,m=parseInt(g.GetVertexCount()),h=g.GetVertices(),d=new Vector(m);for(l=0;m>l;++l)d[l]=t.MulX(o,h[l]);this.m_debugDraw.DrawSolidPolygon(d,m,i);break;case _.e_edgeShape:var y=e instanceof u?e:null;this.m_debugDraw.DrawSegment(t.MulX(o,y.GetVertex1()),t.MulX(o,y.GetVertex2()),i)}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new R;Box2D.Dynamics.b2World.s_xf=new o;Box2D.Dynamics.b2World.s_backupA=new e;Box2D.Dynamics.b2World.s_backupB=new e;Box2D.Dynamics.b2World.s_timestep=new R;Box2D.Dynamics.b2World.s_queue=new Vector;Box2D.Dynamics.b2World.s_jointColor=new n(.5,.8,.8);Box2D.Dynamics.b2World.e_newFixture=1;Box2D.Dynamics.b2World.e_locked=2})}();!function(){{var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),o=(Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),i=Box2D.Collision.Shapes.b2Shape,n=Box2D.Dynamics.Contacts.b2CircleContact,r=Box2D.Dynamics.Contacts.b2Contact,s=Box2D.Dynamics.Contacts.b2ContactConstraint,a=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,l=Box2D.Dynamics.Contacts.b2ContactEdge,g=Box2D.Dynamics.Contacts.b2ContactFactory,m=Box2D.Dynamics.Contacts.b2ContactRegister,c=Box2D.Dynamics.Contacts.b2ContactResult,u=Box2D.Dynamics.Contacts.b2ContactSolver,h=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,p=Box2D.Dynamics.Contacts.b2NullContact,_=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,d=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,y=Box2D.Dynamics.Contacts.b2PolygonContact,f=Box2D.Dynamics.Contacts.b2PositionSolverManifold,v=Box2D.Dynamics.b2Body,x=(Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep),b=(Box2D.Dynamics.b2World,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),S=Box2D.Common.Math.b2Mat22,A=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),C=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),E=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision),D=Box2D.Collision.b2ContactID,T=(Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold),R=(Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact),w=Box2D.Collision.b2TOIInput,B=Box2D.Collision.b2WorldManifold;Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase}Box2D.inherit(n,Box2D.Dynamics.Contacts.b2Contact);n.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;n.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};n.Create=function(){return new n};n.Destroy=function(){};n.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)};n.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),o=this.m_fixtureB.GetBody();E.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,o.m_xf)};r.b2Contact=function(){this.m_nodeA=new l;this.m_nodeB=new l;this.m_manifold=new T;this.m_oldManifold=new T};r.prototype.GetManifold=function(){return this.m_manifold};r.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),o=this.m_fixtureB.GetBody(),i=this.m_fixtureA.GetShape(),n=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),i.m_radius,o.GetTransform(),n.m_radius)};r.prototype.IsTouching=function(){return(this.m_flags&r.e_touchingFlag)==r.e_touchingFlag};r.prototype.IsContinuous=function(){return(this.m_flags&r.e_continuousFlag)==r.e_continuousFlag};r.prototype.SetSensor=function(t){t?this.m_flags|=r.e_sensorFlag:this.m_flags&=~r.e_sensorFlag};r.prototype.IsSensor=function(){return(this.m_flags&r.e_sensorFlag)==r.e_sensorFlag};r.prototype.SetEnabled=function(t){t?this.m_flags|=r.e_enabledFlag:this.m_flags&=~r.e_enabledFlag};r.prototype.IsEnabled=function(){return(this.m_flags&r.e_enabledFlag)==r.e_enabledFlag};r.prototype.GetNext=function(){return this.m_next};r.prototype.GetFixtureA=function(){return this.m_fixtureA};r.prototype.GetFixtureB=function(){return this.m_fixtureB};r.prototype.FlagForFiltering=function(){this.m_flags|=r.e_filterFlag};r.prototype.b2Contact=function(){};r.prototype.Reset=function(t,e){void 0===t&&(t=null);void 0===e&&(e=null);this.m_flags=r.e_enabledFlag;if(t&&e){(t.IsSensor()||e.IsSensor())&&(this.m_flags|=r.e_sensorFlag);var o=t.GetBody(),i=e.GetBody();(o.GetType()!=v.b2_dynamicBody||o.IsBullet()||i.GetType()!=v.b2_dynamicBody||i.IsBullet())&&(this.m_flags|=r.e_continuousFlag);this.m_fixtureA=t;this.m_fixtureB=e;this.m_manifold.m_pointCount=0;this.m_prev=null;this.m_next=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}else{this.m_fixtureA=null;this.m_fixtureB=null}};r.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=e;this.m_flags|=r.e_enabledFlag;var o=!1,n=(this.m_flags&r.e_touchingFlag)==r.e_touchingFlag,s=this.m_fixtureA.m_body,a=this.m_fixtureB.m_body,l=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&r.e_sensorFlag){if(l){var g=this.m_fixtureA.GetShape(),m=this.m_fixtureB.GetShape(),c=s.GetTransform(),u=a.GetTransform();o=i.TestOverlap(g,c,m,u)}this.m_manifold.m_pointCount=0}else{s.GetType()!=v.b2_dynamicBody||s.IsBullet()||a.GetType()!=v.b2_dynamicBody||a.IsBullet()?this.m_flags|=r.e_continuousFlag:this.m_flags&=~r.e_continuousFlag;if(l){this.Evaluate();o=this.m_manifold.m_pointCount>0;for(var h=0;h<this.m_manifold.m_pointCount;++h){var p=this.m_manifold.m_points[h];p.m_normalImpulse=0;p.m_tangentImpulse=0;for(var _=p.m_id,d=0;d<this.m_oldManifold.m_pointCount;++d){var y=this.m_oldManifold.m_points[d];if(y.m_id.key==_.key){p.m_normalImpulse=y.m_normalImpulse;p.m_tangentImpulse=y.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;if(o!=n){s.SetAwake(!0);a.SetAwake(!0)}}o?this.m_flags|=r.e_touchingFlag:this.m_flags&=~r.e_touchingFlag;0==n&&1==o&&t.BeginContact(this);1==n&&0==o&&t.EndContact(this);0==(this.m_flags&r.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)};r.prototype.Evaluate=function(){};r.prototype.ComputeTOI=function(t,e){r.s_input.proxyA.Set(this.m_fixtureA.GetShape());r.s_input.proxyB.Set(this.m_fixtureB.GetShape());r.s_input.sweepA=t;r.s_input.sweepB=e;r.s_input.tolerance=b.b2_linearSlop;return R.TimeOfImpact(r.s_input)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64;Box2D.Dynamics.Contacts.b2Contact.s_input=new w});s.b2ContactConstraint=function(){this.localPlaneNormal=new C;this.localPoint=new C;this.normal=new C;this.normalMass=new S;this.K=new S};s.prototype.b2ContactConstraint=function(){this.points=new Vector(b.b2_maxManifoldPoints);for(var t=0;t<b.b2_maxManifoldPoints;t++)this.points[t]=new a};a.b2ContactConstraintPoint=function(){this.localPoint=new C;this.rA=new C;this.rB=new C};l.b2ContactEdge=function(){};g.b2ContactFactory=function(){};g.prototype.b2ContactFactory=function(t){this.m_allocator=t;this.InitializeRegisters()};g.prototype.AddType=function(t,e,o,i){void 0===o&&(o=0);void 0===i&&(i=0);this.m_registers[o][i].createFcn=t;this.m_registers[o][i].destroyFcn=e;this.m_registers[o][i].primary=!0;if(o!=i){this.m_registers[i][o].createFcn=t;this.m_registers[i][o].destroyFcn=e;this.m_registers[i][o].primary=!1}};g.prototype.InitializeRegisters=function(){this.m_registers=new Vector(i.e_shapeTypeCount);for(var t=0;t<i.e_shapeTypeCount;t++){this.m_registers[t]=new Vector(i.e_shapeTypeCount);for(var e=0;e<i.e_shapeTypeCount;e++)this.m_registers[t][e]=new m}this.AddType(n.Create,n.Destroy,i.e_circleShape,i.e_circleShape);this.AddType(_.Create,_.Destroy,i.e_polygonShape,i.e_circleShape);this.AddType(y.Create,y.Destroy,i.e_polygonShape,i.e_polygonShape);this.AddType(h.Create,h.Destroy,i.e_edgeShape,i.e_circleShape);this.AddType(d.Create,d.Destroy,i.e_polygonShape,i.e_edgeShape)};g.prototype.Create=function(t,e){var o,i=parseInt(t.GetType()),n=parseInt(e.GetType()),r=this.m_registers[i][n];if(r.pool){o=r.pool;r.pool=o.m_next;r.poolCount--;o.Reset(t,e);return o}var s=r.createFcn;if(null!=s){if(r.primary){o=s(this.m_allocator);o.Reset(t,e);return o}o=s(this.m_allocator);o.Reset(e,t);return o}return null};g.prototype.Destroy=function(t){if(t.m_manifold.m_pointCount>0){t.m_fixtureA.m_body.SetAwake(!0);t.m_fixtureB.m_body.SetAwake(!0)}var e=parseInt(t.m_fixtureA.GetType()),o=parseInt(t.m_fixtureB.GetType()),i=this.m_registers[e][o];i.poolCount++;t.m_next=i.pool;i.pool=t;var n=i.destroyFcn;n(t,this.m_allocator)};m.b2ContactRegister=function(){};c.b2ContactResult=function(){this.position=new C;this.normal=new C;this.id=new D};u.b2ContactSolver=function(){this.m_step=new x;this.m_constraints=new Vector};u.prototype.b2ContactSolver=function(){};u.prototype.Initialize=function(t,e,o,i){void 0===o&&(o=0);var n;this.m_step.Set(t);this.m_allocator=i;var r=0;this.m_constraintCount=o;for(;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new s;for(r=0;o>r;++r){n=e[r];var a=n.m_fixtureA,l=n.m_fixtureB,g=a.m_shape,m=l.m_shape,c=g.m_radius,h=m.m_radius,p=a.m_body,_=l.m_body,d=n.GetManifold(),y=b.b2MixFriction(a.GetFriction(),l.GetFriction()),f=b.b2MixRestitution(a.GetRestitution(),l.GetRestitution()),v=p.m_linearVelocity.x,x=p.m_linearVelocity.y,S=_.m_linearVelocity.x,A=_.m_linearVelocity.y,C=p.m_angularVelocity,E=_.m_angularVelocity;b.b2Assert(d.m_pointCount>0);u.s_worldManifold.Initialize(d,p.m_xf,c,_.m_xf,h);var D=u.s_worldManifold.m_normal.x,T=u.s_worldManifold.m_normal.y,R=this.m_constraints[r];R.bodyA=p;R.bodyB=_;R.manifold=d;R.normal.x=D;R.normal.y=T;R.pointCount=d.m_pointCount;R.friction=y;R.restitution=f;R.localPlaneNormal.x=d.m_localPlaneNormal.x;R.localPlaneNormal.y=d.m_localPlaneNormal.y;R.localPoint.x=d.m_localPoint.x;R.localPoint.y=d.m_localPoint.y;R.radius=c+h;R.type=d.m_type;for(var w=0;w<R.pointCount;++w){var B=d.m_points[w],M=R.points[w];M.normalImpulse=B.m_normalImpulse;M.tangentImpulse=B.m_tangentImpulse;M.localPoint.SetV(B.m_localPoint);var I=M.rA.x=u.s_worldManifold.m_points[w].x-p.m_sweep.c.x,N=M.rA.y=u.s_worldManifold.m_points[w].y-p.m_sweep.c.y,L=M.rB.x=u.s_worldManifold.m_points[w].x-_.m_sweep.c.x,O=M.rB.y=u.s_worldManifold.m_points[w].y-_.m_sweep.c.y,P=I*T-N*D,F=L*T-O*D;P*=P;F*=F;var V=p.m_invMass+_.m_invMass+p.m_invI*P+_.m_invI*F;M.normalMass=1/V;var H=p.m_mass*p.m_invMass+_.m_mass*_.m_invMass;H+=p.m_mass*p.m_invI*P+_.m_mass*_.m_invI*F;M.equalizedMass=1/H;var k=T,G=-D,K=I*G-N*k,z=L*G-O*k;K*=K;z*=z;var U=p.m_invMass+_.m_invMass+p.m_invI*K+_.m_invI*z;M.tangentMass=1/U;M.velocityBias=0;var $=S+-E*O-v- -C*N,J=A+E*L-x-C*I,q=R.normal.x*$+R.normal.y*J;q<-b.b2_velocityThreshold&&(M.velocityBias+=-R.restitution*q)}if(2==R.pointCount){var W=R.points[0],j=R.points[1],Y=p.m_invMass,X=p.m_invI,Z=_.m_invMass,Q=_.m_invI,te=W.rA.x*T-W.rA.y*D,ee=W.rB.x*T-W.rB.y*D,oe=j.rA.x*T-j.rA.y*D,ie=j.rB.x*T-j.rB.y*D,ne=Y+Z+X*te*te+Q*ee*ee,re=Y+Z+X*oe*oe+Q*ie*ie,se=Y+Z+X*te*oe+Q*ee*ie,ae=100;if(ae*(ne*re-se*se)>ne*ne){R.K.col1.Set(ne,se);R.K.col2.Set(se,re);R.K.GetInverse(R.normalMass)}else R.pointCount=1}}};u.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var o=this.m_constraints[e],i=o.bodyA,n=o.bodyB,r=i.m_invMass,s=i.m_invI,a=n.m_invMass,l=n.m_invI,g=o.normal.x,m=o.normal.y,c=m,u=-g,h=0,p=0;if(t.warmStarting){p=o.pointCount;for(h=0;p>h;++h){var _=o.points[h];_.normalImpulse*=t.dtRatio;_.tangentImpulse*=t.dtRatio;var d=_.normalImpulse*g+_.tangentImpulse*c,y=_.normalImpulse*m+_.tangentImpulse*u;i.m_angularVelocity-=s*(_.rA.x*y-_.rA.y*d);i.m_linearVelocity.x-=r*d;i.m_linearVelocity.y-=r*y;n.m_angularVelocity+=l*(_.rB.x*y-_.rB.y*d);n.m_linearVelocity.x+=a*d;n.m_linearVelocity.y+=a*y}}else{p=o.pointCount;for(h=0;p>h;++h){var f=o.points[h];f.normalImpulse=0;f.tangentImpulse=0}}}};u.prototype.SolveVelocityConstraints=function(){for(var t,e,o=0,i=0,n=0,r=0,s=0,a=0,l=0,g=0,m=0,c=0,u=0,h=0,p=0,_=0,d=0,y=0,f=0;f<this.m_constraintCount;++f){var v=this.m_constraints[f],x=v.bodyA,b=v.bodyB,S=x.m_angularVelocity,C=b.m_angularVelocity,E=x.m_linearVelocity,D=b.m_linearVelocity,T=x.m_invMass,R=x.m_invI,w=b.m_invMass,B=b.m_invI,M=v.normal.x,I=v.normal.y,N=I,L=-M,O=v.friction;for(o=0;o<v.pointCount;o++){t=v.points[o];i=D.x-C*t.rB.y-E.x+S*t.rA.y;n=D.y+C*t.rB.x-E.y-S*t.rA.x;s=i*N+n*L;a=t.tangentMass*-s;l=O*t.normalImpulse;g=A.Clamp(t.tangentImpulse+a,-l,l);a=g-t.tangentImpulse;m=a*N;c=a*L;E.x-=T*m;E.y-=T*c;S-=R*(t.rA.x*c-t.rA.y*m);D.x+=w*m;D.y+=w*c;C+=B*(t.rB.x*c-t.rB.y*m);t.tangentImpulse=g}{parseInt(v.pointCount)}if(1==v.pointCount){t=v.points[0];i=D.x+-C*t.rB.y-E.x- -S*t.rA.y;n=D.y+C*t.rB.x-E.y-S*t.rA.x;r=i*M+n*I;a=-t.normalMass*(r-t.velocityBias);g=t.normalImpulse+a;g=g>0?g:0;a=g-t.normalImpulse;m=a*M;c=a*I;E.x-=T*m;E.y-=T*c;S-=R*(t.rA.x*c-t.rA.y*m);D.x+=w*m;D.y+=w*c;C+=B*(t.rB.x*c-t.rB.y*m);t.normalImpulse=g}else{var P=v.points[0],F=v.points[1],V=P.normalImpulse,H=F.normalImpulse,k=D.x-C*P.rB.y-E.x+S*P.rA.y,G=D.y+C*P.rB.x-E.y-S*P.rA.x,K=D.x-C*F.rB.y-E.x+S*F.rA.y,z=D.y+C*F.rB.x-E.y-S*F.rA.x,U=k*M+G*I,$=K*M+z*I,J=U-P.velocityBias,q=$-F.velocityBias;e=v.K;J-=e.col1.x*V+e.col2.x*H;q-=e.col1.y*V+e.col2.y*H;for(;;){e=v.normalMass;var W=-(e.col1.x*J+e.col2.x*q),j=-(e.col1.y*J+e.col2.y*q);if(W>=0&&j>=0){u=W-V;h=j-H;p=u*M;_=u*I;d=h*M;y=h*I;E.x-=T*(p+d);E.y-=T*(_+y);S-=R*(P.rA.x*_-P.rA.y*p+F.rA.x*y-F.rA.y*d);D.x+=w*(p+d);D.y+=w*(_+y);C+=B*(P.rB.x*_-P.rB.y*p+F.rB.x*y-F.rB.y*d);P.normalImpulse=W;F.normalImpulse=j;break}W=-P.normalMass*J;j=0;U=0;$=v.K.col1.y*W+q;if(W>=0&&$>=0){u=W-V;h=j-H;p=u*M;_=u*I;d=h*M;y=h*I;E.x-=T*(p+d);E.y-=T*(_+y);S-=R*(P.rA.x*_-P.rA.y*p+F.rA.x*y-F.rA.y*d);D.x+=w*(p+d);D.y+=w*(_+y);C+=B*(P.rB.x*_-P.rB.y*p+F.rB.x*y-F.rB.y*d);P.normalImpulse=W;F.normalImpulse=j;break}W=0;j=-F.normalMass*q;U=v.K.col2.x*j+J;$=0;if(j>=0&&U>=0){u=W-V;h=j-H;p=u*M;_=u*I;d=h*M;y=h*I;E.x-=T*(p+d);E.y-=T*(_+y);S-=R*(P.rA.x*_-P.rA.y*p+F.rA.x*y-F.rA.y*d);D.x+=w*(p+d);D.y+=w*(_+y);C+=B*(P.rB.x*_-P.rB.y*p+F.rB.x*y-F.rB.y*d);P.normalImpulse=W;F.normalImpulse=j;break}W=0;j=0;U=J;$=q;if(U>=0&&$>=0){u=W-V;h=j-H;p=u*M;_=u*I;d=h*M;y=h*I;E.x-=T*(p+d);E.y-=T*(_+y);S-=R*(P.rA.x*_-P.rA.y*p+F.rA.x*y-F.rA.y*d);D.x+=w*(p+d);D.y+=w*(_+y);C+=B*(P.rB.x*_-P.rB.y*p+F.rB.x*y-F.rB.y*d);P.normalImpulse=W;F.normalImpulse=j;break}break}}x.m_angularVelocity=S;b.m_angularVelocity=C}};u.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],o=e.manifold,i=0;i<e.pointCount;++i){var n=o.m_points[i],r=e.points[i];n.m_normalImpulse=r.normalImpulse;n.m_tangentImpulse=r.tangentImpulse}};u.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,o=0;o<this.m_constraintCount;o++){var i=this.m_constraints[o],n=i.bodyA,r=i.bodyB,s=n.m_mass*n.m_invMass,a=n.m_mass*n.m_invI,l=r.m_mass*r.m_invMass,g=r.m_mass*r.m_invI;u.s_psm.Initialize(i);for(var m=u.s_psm.m_normal,c=0;c<i.pointCount;c++){var h=i.points[c],p=u.s_psm.m_points[c],_=u.s_psm.m_separations[c],d=p.x-n.m_sweep.c.x,y=p.y-n.m_sweep.c.y,f=p.x-r.m_sweep.c.x,v=p.y-r.m_sweep.c.y;e=_>e?e:_;var x=A.Clamp(t*(_+b.b2_linearSlop),-b.b2_maxLinearCorrection,0),S=-h.equalizedMass*x,C=S*m.x,E=S*m.y;n.m_sweep.c.x-=s*C;n.m_sweep.c.y-=s*E;n.m_sweep.a-=a*(d*E-y*C);n.SynchronizeTransform();r.m_sweep.c.x+=l*C;r.m_sweep.c.y+=l*E;r.m_sweep.a+=g*(f*E-v*C);r.SynchronizeTransform()}}return e>-1.5*b.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new B;Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new f});Box2D.inherit(h,Box2D.Dynamics.Contacts.b2Contact);h.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;h.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};h.Create=function(){return new h};h.Destroy=function(){};h.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)};h.prototype.Evaluate=function(){var o=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,o.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)};h.prototype.b2CollideEdgeAndCircle=function(){};Box2D.inherit(p,Box2D.Dynamics.Contacts.b2Contact);p.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;p.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};p.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};p.prototype.Evaluate=function(){};Box2D.inherit(_,Box2D.Dynamics.Contacts.b2Contact);_.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;_.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};_.Create=function(){return new _};_.Destroy=function(){};_.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e);b.b2Assert(t.GetType()==i.e_polygonShape);b.b2Assert(e.GetType()==i.e_circleShape)};_.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,i=this.m_fixtureB.m_body;E.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)};Box2D.inherit(d,Box2D.Dynamics.Contacts.b2Contact);d.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;d.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};d.Create=function(){return new d};d.Destroy=function(){};d.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e);b.b2Assert(t.GetType()==i.e_polygonShape);b.b2Assert(e.GetType()==i.e_edgeShape)};d.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,i.m_xf)};d.prototype.b2CollidePolyAndEdge=function(){};Box2D.inherit(y,Box2D.Dynamics.Contacts.b2Contact);y.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;y.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};y.Create=function(){return new y};y.Destroy=function(){};y.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)};y.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();E.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof o?this.m_fixtureB.GetShape():null,e.m_xf)};f.b2PositionSolverManifold=function(){};f.prototype.b2PositionSolverManifold=function(){this.m_normal=new C;this.m_separations=new Vector_a2j_Number(b.b2_maxManifoldPoints);this.m_points=new Vector(b.b2_maxManifoldPoints);for(var t=0;t<b.b2_maxManifoldPoints;t++)this.m_points[t]=new C};f.prototype.Initialize=function(t){b.b2Assert(t.pointCount>0);var e,o,i=0,n=0,r=0,s=0,a=0;switch(t.type){case T.e_circles:e=t.bodyA.m_xf.R;o=t.localPoint;var l=t.bodyA.m_xf.position.x+(e.col1.x*o.x+e.col2.x*o.y),g=t.bodyA.m_xf.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=t.bodyB.m_xf.R;o=t.points[0].localPoint;var m=t.bodyB.m_xf.position.x+(e.col1.x*o.x+e.col2.x*o.y),c=t.bodyB.m_xf.position.y+(e.col1.y*o.x+e.col2.y*o.y),u=m-l,h=c-g,p=u*u+h*h;if(p>Box2D.MIN_VALUE*Box2D.MIN_VALUE){var _=Math.sqrt(p);this.m_normal.x=u/_;this.m_normal.y=h/_}else{this.m_normal.x=1;this.m_normal.y=0}this.m_points[0].x=.5*(l+m);this.m_points[0].y=.5*(g+c);this.m_separations[0]=u*this.m_normal.x+h*this.m_normal.y-t.radius;break;case T.e_faceA:e=t.bodyA.m_xf.R;o=t.localPlaneNormal;this.m_normal.x=e.col1.x*o.x+e.col2.x*o.y;this.m_normal.y=e.col1.y*o.x+e.col2.y*o.y;e=t.bodyA.m_xf.R;o=t.localPoint;s=t.bodyA.m_xf.position.x+(e.col1.x*o.x+e.col2.x*o.y);a=t.bodyA.m_xf.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=t.bodyB.m_xf.R;for(i=0;i<t.pointCount;++i){o=t.points[i].localPoint;n=t.bodyB.m_xf.position.x+(e.col1.x*o.x+e.col2.x*o.y);r=t.bodyB.m_xf.position.y+(e.col1.y*o.x+e.col2.y*o.y);this.m_separations[i]=(n-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius;this.m_points[i].x=n;this.m_points[i].y=r}break;case T.e_faceB:e=t.bodyB.m_xf.R;o=t.localPlaneNormal;this.m_normal.x=e.col1.x*o.x+e.col2.x*o.y;this.m_normal.y=e.col1.y*o.x+e.col2.y*o.y;e=t.bodyB.m_xf.R;o=t.localPoint;s=t.bodyB.m_xf.position.x+(e.col1.x*o.x+e.col2.x*o.y);a=t.bodyB.m_xf.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=t.bodyA.m_xf.R;for(i=0;i<t.pointCount;++i){o=t.points[i].localPoint;n=t.bodyA.m_xf.position.x+(e.col1.x*o.x+e.col2.x*o.y);r=t.bodyA.m_xf.position.y+(e.col1.y*o.x+e.col2.y*o.y);this.m_separations[i]=(n-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius;this.m_points[i].Set(n,r)}this.m_normal.x*=-1;this.m_normal.y*=-1}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new C;Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new C})}();!function(){var t=(Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Common.Math.b2Mat22),e=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),o=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),i=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),n=(Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Collision.Shapes.b2CircleShape,Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape,Box2D.Collision.Shapes.b2Shape,Box2D.Dynamics.Controllers.b2BuoyancyController),r=Box2D.Dynamics.Controllers.b2ConstantAccelController,s=Box2D.Dynamics.Controllers.b2ConstantForceController,a=Box2D.Dynamics.Controllers.b2Controller,l=Box2D.Dynamics.Controllers.b2ControllerEdge,g=Box2D.Dynamics.Controllers.b2GravityController,m=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(n,Box2D.Dynamics.Controllers.b2Controller);n.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;n.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new o(0,-1);this.offset=0;this.density=0;this.velocity=new o(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=!1;this.useWorldGravity=!0;this.gravity=null};n.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var t=this.m_bodyList;t;t=t.nextBody){var e=t.body;if(0!=e.IsAwake()){for(var i=new o,n=new o,r=0,s=0,a=e.GetFixtureList();a;a=a.GetNext()){var l=new o,g=a.GetShape().ComputeSubmergedArea(this.normal,this.offset,e.GetTransform(),l);r+=g;i.x+=g*l.x;i.y+=g*l.y;var m=0;m=(this.useDensity,1);s+=g*m;n.x+=g*l.x*m;n.y+=g*l.y*m}i.x/=r;i.y/=r;n.x/=s;n.y/=s;if(!(r<Box2D.MIN_VALUE)){var c=this.gravity.GetNegative();c.Multiply(this.density*r);e.ApplyForce(c,n);var u=e.GetLinearVelocityFromWorldPoint(i);u.Subtract(this.velocity);u.Multiply(-this.linearDrag*r);e.ApplyForce(u,i);e.ApplyTorque(-e.GetInertia()/e.GetMass()*r*e.GetAngularVelocity()*this.angularDrag)}}}}};n.prototype.Draw=function(t){var e=1e3,n=new o,r=new o;n.x=this.normal.x*this.offset+this.normal.y*e;n.y=this.normal.y*this.offset-this.normal.x*e;r.x=this.normal.x*this.offset-this.normal.y*e;r.y=this.normal.y*this.offset+this.normal.x*e;var s=new i(0,0,1);t.DrawSegment(n,r,s)};Box2D.inherit(r,Box2D.Dynamics.Controllers.b2Controller);r.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;r.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new o(0,0)};r.prototype.Step=function(t){for(var e=new o(this.A.x*t.dt,this.A.y*t.dt),i=this.m_bodyList;i;i=i.nextBody){var n=i.body;n.IsAwake()&&n.SetLinearVelocity(new o(n.GetLinearVelocity().x+e.x,n.GetLinearVelocity().y+e.y))}};Box2D.inherit(s,Box2D.Dynamics.Controllers.b2Controller);s.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;s.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new o(0,0)};s.prototype.Step=function(){for(var t=this.m_bodyList;t;t=t.nextBody){var e=t.body;e.IsAwake()&&e.ApplyForce(this.F,e.GetWorldCenter())}};a.b2Controller=function(){};a.prototype.Step=function(){};a.prototype.Draw=function(){};a.prototype.AddBody=function(t){var e=new l;e.controller=this;e.body=t;e.nextBody=this.m_bodyList;e.prevBody=null;this.m_bodyList=e;e.nextBody&&(e.nextBody.prevBody=e);this.m_bodyCount++;e.nextController=t.m_controllerList;e.prevController=null;t.m_controllerList=e;e.nextController&&(e.nextController.prevController=e);t.m_controllerCount++};a.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody);e.nextBody&&(e.nextBody.prevBody=e.prevBody);e.nextController&&(e.nextController.prevController=e.prevController);e.prevController&&(e.prevController.nextController=e.nextController);this.m_bodyList==e&&(this.m_bodyList=e.nextBody);t.m_controllerList==e&&(t.m_controllerList=e.nextController);t.m_controllerCount--;this.m_bodyCount--};a.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)};a.prototype.GetNext=function(){return this.m_next};a.prototype.GetWorld=function(){return this.m_world};a.prototype.GetBodyList=function(){return this.m_bodyList};l.b2ControllerEdge=function(){};Box2D.inherit(g,Box2D.Dynamics.Controllers.b2Controller);g.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;g.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=!0};g.prototype.Step=function(){var t=null,e=null,i=null,n=0,r=null,s=null,a=null,l=0,g=0,m=0,c=null;if(this.invSqr)for(t=this.m_bodyList;t;t=t.nextBody){e=t.body;i=e.GetWorldCenter();n=e.GetMass();for(r=this.m_bodyList;r!=t;r=r.nextBody){s=r.body;a=s.GetWorldCenter();l=a.x-i.x;g=a.y-i.y;m=l*l+g*g;if(!(m<Box2D.MIN_VALUE)){c=new o(l,g);c.Multiply(this.G/m/Math.sqrt(m)*n*s.GetMass());e.IsAwake()&&e.ApplyForce(c,i);c.Multiply(-1);s.IsAwake()&&s.ApplyForce(c,a)}}}else for(t=this.m_bodyList;t;t=t.nextBody){e=t.body;i=e.GetWorldCenter();n=e.GetMass();for(r=this.m_bodyList;r!=t;r=r.nextBody){s=r.body;a=s.GetWorldCenter();l=a.x-i.x;g=a.y-i.y;m=l*l+g*g;if(!(m<Box2D.MIN_VALUE)){c=new o(l,g);c.Multiply(this.G/m*n*s.GetMass());e.IsAwake()&&e.ApplyForce(c,i);c.Multiply(-1);s.IsAwake()&&s.ApplyForce(c,a)}}}};Box2D.inherit(m,Box2D.Dynamics.Controllers.b2Controller);m.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;m.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new t;this.maxTimestep=0};m.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0);
void 0===e&&(e=0);this.T.col1.x=-t;this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=-e;this.maxTimestep=t>0||e>0?1/Math.max(t,e):0};m.prototype.Step=function(t){var i=t.dt;if(!(i<=Box2D.MIN_VALUE)){i>this.maxTimestep&&this.maxTimestep>0&&(i=this.maxTimestep);for(var n=this.m_bodyList;n;n=n.nextBody){var r=n.body;if(r.IsAwake()){var s=r.GetWorldVector(e.MulMV(this.T,r.GetLocalVector(r.GetLinearVelocity())));r.SetLinearVelocity(new o(r.GetLinearVelocity().x+s.x*i,r.GetLinearVelocity().y+s.y*i))}}}}}();!function(){{var t=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),e=Box2D.Common.Math.b2Mat22,o=Box2D.Common.Math.b2Mat33,i=Box2D.Common.Math.b2Math,n=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),r=Box2D.Common.Math.b2Vec3,s=Box2D.Dynamics.Joints.b2DistanceJoint,a=Box2D.Dynamics.Joints.b2DistanceJointDef,l=Box2D.Dynamics.Joints.b2RopeJoint,g=Box2D.Dynamics.Joints.b2RopeJointDef,m=Box2D.Dynamics.Joints.b2FrictionJoint,c=Box2D.Dynamics.Joints.b2FrictionJointDef,u=Box2D.Dynamics.Joints.b2GearJoint,h=Box2D.Dynamics.Joints.b2GearJointDef,p=Box2D.Dynamics.Joints.b2Jacobian,_=Box2D.Dynamics.Joints.b2Joint,d=Box2D.Dynamics.Joints.b2JointDef,y=Box2D.Dynamics.Joints.b2JointEdge,f=Box2D.Dynamics.Joints.b2LineJoint,v=Box2D.Dynamics.Joints.b2LineJointDef,x=Box2D.Dynamics.Joints.b2MouseJoint,b=Box2D.Dynamics.Joints.b2MouseJointDef,S=Box2D.Dynamics.Joints.b2PrismaticJoint,A=Box2D.Dynamics.Joints.b2PrismaticJointDef,C=Box2D.Dynamics.Joints.b2PulleyJoint,E=Box2D.Dynamics.Joints.b2PulleyJointDef,D=Box2D.Dynamics.Joints.b2RevoluteJoint,T=Box2D.Dynamics.Joints.b2RevoluteJointDef,R=Box2D.Dynamics.Joints.b2WeldJoint,w=Box2D.Dynamics.Joints.b2WeldJointDef;Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World}Box2D.inherit(l,Box2D.Dynamics.Joints.b2Joint);l.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;l.b2RopeJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_u=new n};l.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};l.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};l.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)};l.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return 0};l.prototype.GetLength=function(){return this.m_length};l.prototype.SetLength=function(t){void 0===t&&(t=0);this.m_length=t};l.prototype.GetFrequency=function(){return this.m_frequencyHz};l.prototype.SetFrequency=function(t){void 0===t&&(t=0);this.m_frequencyHz=t};l.prototype.GetDampingRatio=function(){return this.m_dampingRatio};l.prototype.SetDampingRatio=function(t){void 0===t&&(t=0);this.m_dampingRatio=t};l.prototype.b2RopeJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA);this.m_localAnchor2.SetV(t.localAnchorB);this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_impulse=0;this.m_gamma=0;this.m_bias=0;this.m_length=t.length;this.m_maxLength=t.maxLength;this.m_limitState=_.e_inactiveLimit};l.prototype.InitVelocityConstraints=function(e){var o,i=0,n=this.m_bodyA,r=this.m_bodyB;o=n.m_xf.R;var s=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y;i=o.col1.x*s+o.col2.x*a;a=o.col1.y*s+o.col2.y*a;s=i;o=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,g=this.m_localAnchor2.y-r.m_sweep.localCenter.y;i=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=i;this.m_u.x=r.m_sweep.c.x+l-n.m_sweep.c.x-s;this.m_u.y=r.m_sweep.c.y+g-n.m_sweep.c.y-a;var m=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);this.m_length=m;var c=this.m_length-this.m_maxLength;this.m_limitState=c>0?_.e_atUpperLimit:_.e_inactiveLimit;if(m>t.b2_linearSlop){this.m_u.Multiply(1/m);var u=s*this.m_u.y-a*this.m_u.x,h=l*this.m_u.y-g*this.m_u.x,p=n.m_invMass+n.m_invI*u*u+r.m_invMass+r.m_invI*h*h;this.m_mass=0!=p?1/p:0;if(e.warmStarting){this.m_impulse*=e.dtRatio;var d=this.m_impulse*this.m_u.x,y=this.m_impulse*this.m_u.y;n.m_linearVelocity.x-=n.m_invMass*d;n.m_linearVelocity.y-=n.m_invMass*y;n.m_angularVelocity-=n.m_invI*(s*y-a*d);r.m_linearVelocity.x+=r.m_invMass*d;r.m_linearVelocity.y+=r.m_invMass*y;r.m_angularVelocity+=r.m_invI*(l*y-g*d)}else this.m_impulse=0}else{this.m_u.SetZero();this.m_mass=0;this.m_impulse=0}};l.prototype.SolveVelocityConstraints=function(t){var e,o=0,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=e.col1.x*r+e.col2.x*s;s=e.col1.y*r+e.col2.y*s;r=a;e=n.m_xf.R;var l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,g=this.m_localAnchor2.y-n.m_sweep.localCenter.y;a=e.col1.x*l+e.col2.x*g;g=e.col1.y*l+e.col2.y*g;l=a;var m=i.m_linearVelocity.x+-i.m_angularVelocity*s,c=i.m_linearVelocity.y+i.m_angularVelocity*r,u=n.m_linearVelocity.x+-n.m_angularVelocity*g,h=n.m_linearVelocity.y+n.m_angularVelocity*l,p=this.m_length-this.m_maxLength,_=this.m_u.x*(u-m)+this.m_u.y*(h-c);0>p&&(_+=t.inv_dt*p);var d=-this.m_mass*(_+this.m_bias+this.m_gamma*this.m_impulse);o=this.m_impulse;this.m_impulse=Math.min(0,this.m_impulse+d);d=this.m_impulse-o;var y=d*this.m_u.x,f=d*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*y;i.m_linearVelocity.y-=i.m_invMass*f;i.m_angularVelocity-=i.m_invI*(r*f-s*y);n.m_linearVelocity.x+=n.m_invMass*y;n.m_linearVelocity.y+=n.m_invMass*f;n.m_angularVelocity+=n.m_invI*(l*f-g*y)};l.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var o;if(this.m_frequencyHz>0)return!0;var n=this.m_bodyA,r=this.m_bodyB;o=n.m_xf.R;var s=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y,l=o.col1.x*s+o.col2.x*a;a=o.col1.y*s+o.col2.y*a;s=l;o=r.m_xf.R;var g=this.m_localAnchor2.x-r.m_sweep.localCenter.x,m=this.m_localAnchor2.y-r.m_sweep.localCenter.y;l=o.col1.x*g+o.col2.x*m;m=o.col1.y*g+o.col2.y*m;g=l;var c=r.m_sweep.c.x+g-n.m_sweep.c.x-s,u=r.m_sweep.c.y+m-n.m_sweep.c.y-a,h=Math.sqrt(c*c+u*u);c/=h;u/=h;var p=h-this.m_maxLength;p=i.Clamp(p,0,t.b2_maxLinearCorrection);var _=-this.m_mass*p;this.m_u.Set(c,u);var d=_*this.m_u.x,y=_*this.m_u.y;n.m_sweep.c.x-=n.m_invMass*d;n.m_sweep.c.y-=n.m_invMass*y;n.m_sweep.a-=n.m_invI*(s*y-a*d);r.m_sweep.c.x+=r.m_invMass*d;r.m_sweep.c.y+=r.m_invMass*y;r.m_sweep.a+=r.m_invI*(g*y-m*d);n.SynchronizeTransform();r.SynchronizeTransform();return h-this.m_maxLength<t.b2_linearSlop};Box2D.inherit(g,Box2D.Dynamics.Joints.b2JointDef);g.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;g.b2RopeJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n};g.prototype.b2RopeJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_ropeJoint;this.length=1;this.frequencyHz=0;this.dampingRatio=0};g.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i));var n=i.x-o.x,r=i.y-o.y;this.length=Math.sqrt(n*n+r*r);this.frequencyHz=0;this.dampingRatio=0};Box2D.inherit(s,Box2D.Dynamics.Joints.b2Joint);s.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;s.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_u=new n};s.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};s.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};s.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)};s.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return 0};s.prototype.GetLength=function(){return this.m_length};s.prototype.SetLength=function(t){void 0===t&&(t=0);this.m_length=t};s.prototype.GetFrequency=function(){return this.m_frequencyHz};s.prototype.SetFrequency=function(t){void 0===t&&(t=0);this.m_frequencyHz=t};s.prototype.GetDampingRatio=function(){return this.m_dampingRatio};s.prototype.SetDampingRatio=function(t){void 0===t&&(t=0);this.m_dampingRatio=t};s.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA);this.m_localAnchor2.SetV(t.localAnchorB);this.m_length=t.length;this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_impulse=0;this.m_gamma=0;this.m_bias=0};s.prototype.InitVelocityConstraints=function(e){var o,i=0,n=this.m_bodyA,r=this.m_bodyB;o=n.m_xf.R;var s=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y;i=o.col1.x*s+o.col2.x*a;a=o.col1.y*s+o.col2.y*a;s=i;o=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,g=this.m_localAnchor2.y-r.m_sweep.localCenter.y;i=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=i;this.m_u.x=r.m_sweep.c.x+l-n.m_sweep.c.x-s;this.m_u.y=r.m_sweep.c.y+g-n.m_sweep.c.y-a;var m=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);m>t.b2_linearSlop?this.m_u.Multiply(1/m):this.m_u.SetZero();var c=s*this.m_u.y-a*this.m_u.x,u=l*this.m_u.y-g*this.m_u.x,h=n.m_invMass+n.m_invI*c*c+r.m_invMass+r.m_invI*u*u;this.m_mass=0!=h?1/h:0;if(this.m_frequencyHz>0){var p=m-this.m_length,_=2*Math.PI*this.m_frequencyHz,d=2*this.m_mass*this.m_dampingRatio*_,y=this.m_mass*_*_;this.m_gamma=e.dt*(d+e.dt*y);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=p*e.dt*y*this.m_gamma;this.m_mass=h+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var f=this.m_impulse*this.m_u.x,v=this.m_impulse*this.m_u.y;n.m_linearVelocity.x-=n.m_invMass*f;n.m_linearVelocity.y-=n.m_invMass*v;n.m_angularVelocity-=n.m_invI*(s*v-a*f);r.m_linearVelocity.x+=r.m_invMass*f;r.m_linearVelocity.y+=r.m_invMass*v;r.m_angularVelocity+=r.m_invI*(l*v-g*f)}else this.m_impulse=0};s.prototype.SolveVelocityConstraints=function(){var t,e=this.m_bodyA,o=this.m_bodyB;t=e.m_xf.R;var i=this.m_localAnchor1.x-e.m_sweep.localCenter.x,n=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*i+t.col2.x*n;n=t.col1.y*i+t.col2.y*n;i=r;t=o.m_xf.R;var s=this.m_localAnchor2.x-o.m_sweep.localCenter.x,a=this.m_localAnchor2.y-o.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a;a=t.col1.y*s+t.col2.y*a;s=r;var l=e.m_linearVelocity.x+-e.m_angularVelocity*n,g=e.m_linearVelocity.y+e.m_angularVelocity*i,m=o.m_linearVelocity.x+-o.m_angularVelocity*a,c=o.m_linearVelocity.y+o.m_angularVelocity*s,u=this.m_u.x*(m-l)+this.m_u.y*(c-g),h=-this.m_mass*(u+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=h;var p=h*this.m_u.x,_=h*this.m_u.y;e.m_linearVelocity.x-=e.m_invMass*p;e.m_linearVelocity.y-=e.m_invMass*_;e.m_angularVelocity-=e.m_invI*(i*_-n*p);o.m_linearVelocity.x+=o.m_invMass*p;o.m_linearVelocity.y+=o.m_invMass*_;o.m_angularVelocity+=o.m_invI*(s*_-a*p)};s.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var o;if(this.m_frequencyHz>0)return!0;var n=this.m_bodyA,r=this.m_bodyB;o=n.m_xf.R;var s=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y,l=o.col1.x*s+o.col2.x*a;a=o.col1.y*s+o.col2.y*a;s=l;o=r.m_xf.R;var g=this.m_localAnchor2.x-r.m_sweep.localCenter.x,m=this.m_localAnchor2.y-r.m_sweep.localCenter.y;l=o.col1.x*g+o.col2.x*m;m=o.col1.y*g+o.col2.y*m;g=l;var c=r.m_sweep.c.x+g-n.m_sweep.c.x-s,u=r.m_sweep.c.y+m-n.m_sweep.c.y-a,h=Math.sqrt(c*c+u*u);c/=h;u/=h;var p=h-this.m_length;p=i.Clamp(p,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var _=-this.m_mass*p;this.m_u.Set(c,u);var d=_*this.m_u.x,y=_*this.m_u.y;n.m_sweep.c.x-=n.m_invMass*d;n.m_sweep.c.y-=n.m_invMass*y;n.m_sweep.a-=n.m_invI*(s*y-a*d);r.m_sweep.c.x+=r.m_invMass*d;r.m_sweep.c.y+=r.m_invMass*y;r.m_sweep.a+=r.m_invI*(g*y-m*d);n.SynchronizeTransform();r.SynchronizeTransform();return i.Abs(p)<t.b2_linearSlop};Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef);a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;a.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n};a.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_distanceJoint;this.length=1;this.frequencyHz=0;this.dampingRatio=0};a.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i));var n=i.x-o.x,r=i.y-o.y;this.length=Math.sqrt(n*n+r*r);this.frequencyHz=0;this.dampingRatio=0};Box2D.inherit(m,Box2D.Dynamics.Joints.b2Joint);m.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;m.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new n;this.m_localAnchorB=new n;this.m_linearMass=new e;this.m_linearImpulse=new n};m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};m.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)};m.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return t*this.m_angularImpulse};m.prototype.SetMaxForce=function(t){void 0===t&&(t=0);this.m_maxForce=t};m.prototype.GetMaxForce=function(){return this.m_maxForce};m.prototype.SetMaxTorque=function(t){void 0===t&&(t=0);this.m_maxTorque=t};m.prototype.GetMaxTorque=function(){return this.m_maxTorque};m.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchorA.SetV(t.localAnchorA);this.m_localAnchorB.SetV(t.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=t.maxForce;this.m_maxTorque=t.maxTorque};m.prototype.InitVelocityConstraints=function(t){var o,i=0,n=this.m_bodyA,r=this.m_bodyB;o=n.m_xf.R;var s=this.m_localAnchorA.x-n.m_sweep.localCenter.x,a=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=o.col1.x*s+o.col2.x*a;a=o.col1.y*s+o.col2.y*a;s=i;o=r.m_xf.R;var l=this.m_localAnchorB.x-r.m_sweep.localCenter.x,g=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=i;var m=n.m_invMass,c=r.m_invMass,u=n.m_invI,h=r.m_invI,p=new e;p.col1.x=m+c;p.col2.x=0;p.col1.y=0;p.col2.y=m+c;p.col1.x+=u*a*a;p.col2.x+=-u*s*a;p.col1.y+=-u*s*a;p.col2.y+=u*s*s;p.col1.x+=h*g*g;p.col2.x+=-h*l*g;p.col1.y+=-h*l*g;p.col2.y+=h*l*l;p.GetInverse(this.m_linearMass);this.m_angularMass=u+h;this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass);if(t.warmStarting){this.m_linearImpulse.x*=t.dtRatio;this.m_linearImpulse.y*=t.dtRatio;this.m_angularImpulse*=t.dtRatio;var _=this.m_linearImpulse;n.m_linearVelocity.x-=m*_.x;n.m_linearVelocity.y-=m*_.y;n.m_angularVelocity-=u*(s*_.y-a*_.x+this.m_angularImpulse);r.m_linearVelocity.x+=c*_.x;r.m_linearVelocity.y+=c*_.y;r.m_angularVelocity+=h*(l*_.y-g*_.x+this.m_angularImpulse)}else{this.m_linearImpulse.SetZero();this.m_angularImpulse=0}};m.prototype.SolveVelocityConstraints=function(t){var e,o=0,r=this.m_bodyA,s=this.m_bodyB,a=r.m_linearVelocity,l=r.m_angularVelocity,g=s.m_linearVelocity,m=s.m_angularVelocity,c=r.m_invMass,u=s.m_invMass,h=r.m_invI,p=s.m_invI;e=r.m_xf.R;var _=this.m_localAnchorA.x-r.m_sweep.localCenter.x,d=this.m_localAnchorA.y-r.m_sweep.localCenter.y;o=e.col1.x*_+e.col2.x*d;d=e.col1.y*_+e.col2.y*d;_=o;e=s.m_xf.R;var y=this.m_localAnchorB.x-s.m_sweep.localCenter.x,f=this.m_localAnchorB.y-s.m_sweep.localCenter.y;o=e.col1.x*y+e.col2.x*f;f=e.col1.y*y+e.col2.y*f;y=o;var v=0,x=m-l,b=-this.m_angularMass*x,S=this.m_angularImpulse;v=t.dt*this.m_maxTorque;this.m_angularImpulse=i.Clamp(this.m_angularImpulse+b,-v,v);b=this.m_angularImpulse-S;l-=h*b;m+=p*b;var A=g.x-m*f-a.x+l*d,C=g.y+m*y-a.y-l*_,E=i.MulMV(this.m_linearMass,new n(-A,-C)),D=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(E);v=t.dt*this.m_maxForce;if(this.m_linearImpulse.LengthSquared()>v*v){this.m_linearImpulse.Normalize();this.m_linearImpulse.Multiply(v)}E=i.SubtractVV(this.m_linearImpulse,D);a.x-=c*E.x;a.y-=c*E.y;l-=h*(_*E.y-d*E.x);g.x+=u*E.x;g.y+=u*E.y;m+=p*(y*E.y-f*E.x);r.m_angularVelocity=l;s.m_angularVelocity=m};m.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);return!0};Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef);c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;c.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n};c.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_frictionJoint;this.maxForce=0;this.maxTorque=0};c.prototype.Initialize=function(t,e,o){this.bodyA=t;this.bodyB=e;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(o))};Box2D.inherit(u,Box2D.Dynamics.Joints.b2Joint);u.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;u.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new n;this.m_groundAnchor2=new n;this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_J=new p};u.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};u.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};u.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)};u.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,o=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,i=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,n=e.col1.x*o+e.col2.x*i;i=e.col1.y*o+e.col2.y*i;o=n;var r=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-o*s+i*r)};u.prototype.GetRatio=function(){return this.m_ratio};u.prototype.SetRatio=function(t){void 0===t&&(t=0);this.m_ratio=t};u.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),o=parseInt(t.joint2.m_type);this.m_revolute1=null;this.m_prismatic1=null;this.m_revolute2=null;this.m_prismatic2=null;var i=0,n=0;this.m_ground1=t.joint1.GetBodyA();this.m_bodyA=t.joint1.GetBodyB();if(e==_.e_revoluteJoint){this.m_revolute1=t.joint1 instanceof D?t.joint1:null;this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);i=this.m_revolute1.GetJointAngle()}else{this.m_prismatic1=t.joint1 instanceof S?t.joint1:null;this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);i=this.m_prismatic1.GetJointTranslation()}this.m_ground2=t.joint2.GetBodyA();this.m_bodyB=t.joint2.GetBodyB();if(o==_.e_revoluteJoint){this.m_revolute2=t.joint2 instanceof D?t.joint2:null;this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);n=this.m_revolute2.GetJointAngle()}else{this.m_prismatic2=t.joint2 instanceof S?t.joint2:null;this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);n=this.m_prismatic2.GetJointTranslation()}this.m_ratio=t.ratio;this.m_constant=i+this.m_ratio*n;this.m_impulse=0};u.prototype.InitVelocityConstraints=function(t){var e,o,i=this.m_ground1,n=this.m_ground2,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,g=0,m=0,c=0,u=0,h=0;this.m_J.SetZero();if(this.m_revolute1){this.m_J.angularA=-1;h+=r.m_invI}else{e=i.m_xf.R;o=this.m_prismatic1.m_localXAxis1;a=e.col1.x*o.x+e.col2.x*o.y;l=e.col1.y*o.x+e.col2.y*o.y;e=r.m_xf.R;g=this.m_localAnchor1.x-r.m_sweep.localCenter.x;m=this.m_localAnchor1.y-r.m_sweep.localCenter.y;u=e.col1.x*g+e.col2.x*m;m=e.col1.y*g+e.col2.y*m;g=u;c=g*l-m*a;this.m_J.linearA.Set(-a,-l);this.m_J.angularA=-c;h+=r.m_invMass+r.m_invI*c*c}if(this.m_revolute2){this.m_J.angularB=-this.m_ratio;h+=this.m_ratio*this.m_ratio*s.m_invI}else{e=n.m_xf.R;o=this.m_prismatic2.m_localXAxis1;a=e.col1.x*o.x+e.col2.x*o.y;l=e.col1.y*o.x+e.col2.y*o.y;e=s.m_xf.R;g=this.m_localAnchor2.x-s.m_sweep.localCenter.x;m=this.m_localAnchor2.y-s.m_sweep.localCenter.y;u=e.col1.x*g+e.col2.x*m;m=e.col1.y*g+e.col2.y*m;g=u;c=g*l-m*a;this.m_J.linearB.Set(-this.m_ratio*a,-this.m_ratio*l);this.m_J.angularB=-this.m_ratio*c;h+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*c*c)}this.m_mass=h>0?1/h:0;if(t.warmStarting){r.m_linearVelocity.x+=r.m_invMass*this.m_impulse*this.m_J.linearA.x;r.m_linearVelocity.y+=r.m_invMass*this.m_impulse*this.m_J.linearA.y;r.m_angularVelocity+=r.m_invI*this.m_impulse*this.m_J.angularA;s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x;s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y;s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB}else this.m_impulse=0};u.prototype.SolveVelocityConstraints=function(){var t=this.m_bodyA,e=this.m_bodyB,o=this.m_J.Compute(t.m_linearVelocity,t.m_angularVelocity,e.m_linearVelocity,e.m_angularVelocity),i=-this.m_mass*o;this.m_impulse+=i;t.m_linearVelocity.x+=t.m_invMass*i*this.m_J.linearA.x;t.m_linearVelocity.y+=t.m_invMass*i*this.m_J.linearA.y;t.m_angularVelocity+=t.m_invI*i*this.m_J.angularA;e.m_linearVelocity.x+=e.m_invMass*i*this.m_J.linearB.x;e.m_linearVelocity.y+=e.m_invMass*i*this.m_J.linearB.y;e.m_angularVelocity+=e.m_invI*i*this.m_J.angularB};u.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var o=0,i=this.m_bodyA,n=this.m_bodyB,r=0,s=0;r=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation();s=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var a=this.m_constant-(r+this.m_ratio*s),l=-this.m_mass*a;i.m_sweep.c.x+=i.m_invMass*l*this.m_J.linearA.x;i.m_sweep.c.y+=i.m_invMass*l*this.m_J.linearA.y;i.m_sweep.a+=i.m_invI*l*this.m_J.angularA;n.m_sweep.c.x+=n.m_invMass*l*this.m_J.linearB.x;n.m_sweep.c.y+=n.m_invMass*l*this.m_J.linearB.y;n.m_sweep.a+=n.m_invI*l*this.m_J.angularB;i.SynchronizeTransform();n.SynchronizeTransform();return o<t.b2_linearSlop};Box2D.inherit(h,Box2D.Dynamics.Joints.b2JointDef);h.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;h.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};h.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_gearJoint;this.joint1=null;this.joint2=null;this.ratio=1};p.b2Jacobian=function(){this.linearA=new n;this.linearB=new n};p.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};p.prototype.Set=function(t,e,o,i){void 0===e&&(e=0);void 0===i&&(i=0);this.linearA.SetV(t);this.angularA=e;this.linearB.SetV(o);this.angularB=i};p.prototype.Compute=function(t,e,o,i){void 0===e&&(e=0);void 0===i&&(i=0);return this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*o.x+this.linearB.y*o.y)+this.angularB*i};_.b2Joint=function(){this.m_edgeA=new y;this.m_edgeB=new y;this.m_localCenterA=new n;this.m_localCenterB=new n};_.prototype.GetType=function(){return this.m_type};_.prototype.GetAnchorA=function(){return null};_.prototype.GetAnchorB=function(){return null};_.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return null};_.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return 0};_.prototype.GetBodyA=function(){return this.m_bodyA};_.prototype.GetBodyB=function(){return this.m_bodyB};_.prototype.GetNext=function(){return this.m_next};_.prototype.GetUserData=function(){return this.m_userData};_.prototype.SetUserData=function(t){this.m_userData=t};_.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};_.Create=function(t){var e=null;switch(t.type){case _.e_ropeJoint:e=new l(t instanceof g?t:null);break;case _.e_distanceJoint:e=new s(t instanceof a?t:null);break;case _.e_mouseJoint:e=new x(t instanceof b?t:null);break;case _.e_prismaticJoint:e=new S(t instanceof A?t:null);break;case _.e_revoluteJoint:e=new D(t instanceof T?t:null);break;case _.e_pulleyJoint:e=new C(t instanceof E?t:null);break;case _.e_gearJoint:e=new u(t instanceof h?t:null);break;case _.e_lineJoint:e=new f(t instanceof v?t:null);break;case _.e_weldJoint:e=new R(t instanceof w?t:null);break;case _.e_frictionJoint:e=new m(t instanceof c?t:null)}return e};_.Destroy=function(){};_.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB);this.m_type=e.type;this.m_prev=null;this.m_next=null;this.m_bodyA=e.bodyA;this.m_bodyB=e.bodyB;this.m_collideConnected=e.collideConnected;this.m_islandFlag=!1;this.m_userData=e.userData};_.prototype.InitVelocityConstraints=function(){};_.prototype.SolveVelocityConstraints=function(){};_.prototype.FinalizeVelocityConstraints=function(){};_.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);return!1};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_ropeJoint=10;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3});d.b2JointDef=function(){};d.prototype.b2JointDef=function(){this.type=_.e_unknownJoint;this.userData=null;this.bodyA=null;this.bodyB=null;this.collideConnected=!1};y.b2JointEdge=function(){};Box2D.inherit(f,Box2D.Dynamics.Joints.b2Joint);f.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;f.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_localXAxis1=new n;this.m_localYAxis1=new n;this.m_axis=new n;this.m_perp=new n;this.m_K=new e;this.m_impulse=new n};f.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};f.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};f.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};f.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return t*this.m_impulse.y};f.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,o=t.GetWorldPoint(this.m_localAnchor1),i=e.GetWorldPoint(this.m_localAnchor2),n=i.x-o.x,r=i.y-o.y,s=t.GetWorldVector(this.m_localXAxis1),a=s.x*n+s.y*r;return a};f.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,o=this.m_bodyB;t=e.m_xf.R;var i=this.m_localAnchor1.x-e.m_sweep.localCenter.x,n=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*i+t.col2.x*n;n=t.col1.y*i+t.col2.y*n;i=r;t=o.m_xf.R;var s=this.m_localAnchor2.x-o.m_sweep.localCenter.x,a=this.m_localAnchor2.y-o.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a;a=t.col1.y*s+t.col2.y*a;s=r;var l=e.m_sweep.c.x+i,g=e.m_sweep.c.y+n,m=o.m_sweep.c.x+s,c=o.m_sweep.c.y+a,u=m-l,h=c-g,p=e.GetWorldVector(this.m_localXAxis1),_=e.m_linearVelocity,d=o.m_linearVelocity,y=e.m_angularVelocity,f=o.m_angularVelocity,v=u*-y*p.y+h*y*p.x+(p.x*(d.x+-f*a-_.x- -y*n)+p.y*(d.y+f*s-_.y-y*i));return v};f.prototype.IsLimitEnabled=function(){return this.m_enableLimit};f.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=t};f.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};f.prototype.GetUpperLimit=function(){return this.m_upperTranslation};f.prototype.SetLimits=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=t;this.m_upperTranslation=e};f.prototype.IsMotorEnabled=function(){return this.m_enableMotor};f.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=t};f.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=t};f.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};f.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=t};f.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};f.prototype.GetMotorForce=function(){return this.m_motorImpulse};f.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA);this.m_localAnchor2.SetV(t.localAnchorB);this.m_localXAxis1.SetV(t.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorMass=0;this.m_motorImpulse=0;this.m_lowerTranslation=t.lowerTranslation;this.m_upperTranslation=t.upperTranslation;this.m_maxMotorForce=t.maxMotorForce;this.m_motorSpeed=t.motorSpeed;this.m_enableLimit=t.enableLimit;this.m_enableMotor=t.enableMotor;this.m_limitState=_.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};f.prototype.InitVelocityConstraints=function(e){var o,n=this.m_bodyA,r=this.m_bodyB,s=0;this.m_localCenterA.SetV(n.GetLocalCenter());this.m_localCenterB.SetV(r.GetLocalCenter());{var a=n.GetTransform();r.GetTransform()}o=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,g=this.m_localAnchor1.y-this.m_localCenterA.y;s=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=s;o=r.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,c=this.m_localAnchor2.y-this.m_localCenterB.y;s=o.col1.x*m+o.col2.x*c;c=o.col1.y*m+o.col2.y*c;m=s;var u=r.m_sweep.c.x+m-n.m_sweep.c.x-l,h=r.m_sweep.c.y+c-n.m_sweep.c.y-g;this.m_invMassA=n.m_invMass;this.m_invMassB=r.m_invMass;this.m_invIA=n.m_invI;this.m_invIB=r.m_invI;this.m_axis.SetV(i.MulMV(a.R,this.m_localXAxis1));this.m_a1=(u+l)*this.m_axis.y-(h+g)*this.m_axis.x;this.m_a2=m*this.m_axis.y-c*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Box2D.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(i.MulMV(a.R,this.m_localYAxis1));this.m_s1=(u+l)*this.m_perp.y-(h+g)*this.m_perp.x;this.m_s2=m*this.m_perp.y-c*this.m_perp.x;var p=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,f=this.m_invIB;this.m_K.col1.x=p+d+y*this.m_s1*this.m_s1+f*this.m_s2*this.m_s2;this.m_K.col1.y=y*this.m_s1*this.m_a1+f*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=p+d+y*this.m_a1*this.m_a1+f*this.m_a2*this.m_a2;if(this.m_enableLimit){var v=this.m_axis.x*u+this.m_axis.y*h;if(i.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop)this.m_limitState=_.e_equalLimits;else if(v<=this.m_lowerTranslation){if(this.m_limitState!=_.e_atLowerLimit){this.m_limitState=_.e_atLowerLimit;this.m_impulse.y=0}}else if(v>=this.m_upperTranslation){if(this.m_limitState!=_.e_atUpperLimit){this.m_limitState=_.e_atUpperLimit;this.m_impulse.y=0}}else{this.m_limitState=_.e_inactiveLimit;this.m_impulse.y=0}}else this.m_limitState=_.e_inactiveLimit;0==this.m_enableMotor&&(this.m_motorImpulse=0);if(e.warmStarting){this.m_impulse.x*=e.dtRatio;this.m_impulse.y*=e.dtRatio;this.m_motorImpulse*=e.dtRatio;var x=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,S=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,A=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;
n.m_linearVelocity.x-=this.m_invMassA*x;n.m_linearVelocity.y-=this.m_invMassA*b;n.m_angularVelocity-=this.m_invIA*S;r.m_linearVelocity.x+=this.m_invMassB*x;r.m_linearVelocity.y+=this.m_invMassB*b;r.m_angularVelocity+=this.m_invIB*A}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};f.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,o=this.m_bodyB,r=e.m_linearVelocity,s=e.m_angularVelocity,a=o.m_linearVelocity,l=o.m_angularVelocity,g=0,m=0,c=0,u=0;if(this.m_enableMotor&&this.m_limitState!=_.e_equalLimits){var h=this.m_axis.x*(a.x-r.x)+this.m_axis.y*(a.y-r.y)+this.m_a2*l-this.m_a1*s,p=this.m_motorMass*(this.m_motorSpeed-h),d=this.m_motorImpulse,y=t.dt*this.m_maxMotorForce;this.m_motorImpulse=i.Clamp(this.m_motorImpulse+p,-y,y);p=this.m_motorImpulse-d;g=p*this.m_axis.x;m=p*this.m_axis.y;c=p*this.m_a1;u=p*this.m_a2;r.x-=this.m_invMassA*g;r.y-=this.m_invMassA*m;s-=this.m_invIA*c;a.x+=this.m_invMassB*g;a.y+=this.m_invMassB*m;l+=this.m_invIB*u}var f=this.m_perp.x*(a.x-r.x)+this.m_perp.y*(a.y-r.y)+this.m_s2*l-this.m_s1*s;if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){var v=this.m_axis.x*(a.x-r.x)+this.m_axis.y*(a.y-r.y)+this.m_a2*l-this.m_a1*s,x=this.m_impulse.Copy(),b=this.m_K.Solve(new n,-f,-v);this.m_impulse.Add(b);this.m_limitState==_.e_atLowerLimit?this.m_impulse.y=i.Max(this.m_impulse.y,0):this.m_limitState==_.e_atUpperLimit&&(this.m_impulse.y=i.Min(this.m_impulse.y,0));var S=-f-(this.m_impulse.y-x.y)*this.m_K.col2.x,A=0;A=0!=this.m_K.col1.x?S/this.m_K.col1.x+x.x:x.x;this.m_impulse.x=A;b.x=this.m_impulse.x-x.x;b.y=this.m_impulse.y-x.y;g=b.x*this.m_perp.x+b.y*this.m_axis.x;m=b.x*this.m_perp.y+b.y*this.m_axis.y;c=b.x*this.m_s1+b.y*this.m_a1;u=b.x*this.m_s2+b.y*this.m_a2;r.x-=this.m_invMassA*g;r.y-=this.m_invMassA*m;s-=this.m_invIA*c;a.x+=this.m_invMassB*g;a.y+=this.m_invMassB*m;l+=this.m_invIB*u}else{var C=0;C=0!=this.m_K.col1.x?-f/this.m_K.col1.x:0;this.m_impulse.x+=C;g=C*this.m_perp.x;m=C*this.m_perp.y;c=C*this.m_s1;u=C*this.m_s2;r.x-=this.m_invMassA*g;r.y-=this.m_invMassA*m;s-=this.m_invIA*c;a.x+=this.m_invMassB*g;a.y+=this.m_invMassB*m;l+=this.m_invIB*u}e.m_linearVelocity.SetV(r);e.m_angularVelocity=s;o.m_linearVelocity.SetV(a);o.m_angularVelocity=l};f.prototype.SolvePositionConstraints=function(o){void 0===o&&(o=0);var r,s=this.m_bodyA,a=this.m_bodyB,l=s.m_sweep.c,g=s.m_sweep.a,m=a.m_sweep.c,c=a.m_sweep.a,u=0,h=0,p=0,_=0,d=0,y=0,f=0,v=!1,x=0,b=e.FromAngle(g),S=e.FromAngle(c);r=b;var A=this.m_localAnchor1.x-this.m_localCenterA.x,C=this.m_localAnchor1.y-this.m_localCenterA.y;u=r.col1.x*A+r.col2.x*C;C=r.col1.y*A+r.col2.y*C;A=u;r=S;var E=this.m_localAnchor2.x-this.m_localCenterB.x,D=this.m_localAnchor2.y-this.m_localCenterB.y;u=r.col1.x*E+r.col2.x*D;D=r.col1.y*E+r.col2.y*D;E=u;var T=m.x+E-l.x-A,R=m.y+D-l.y-C;if(this.m_enableLimit){this.m_axis=i.MulMV(b,this.m_localXAxis1);this.m_a1=(T+A)*this.m_axis.y-(R+C)*this.m_axis.x;this.m_a2=E*this.m_axis.y-D*this.m_axis.x;var w=this.m_axis.x*T+this.m_axis.y*R;if(i.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop){x=i.Clamp(w,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);y=i.Abs(w);v=!0}else if(w<=this.m_lowerTranslation){x=i.Clamp(w-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0);y=this.m_lowerTranslation-w;v=!0}else if(w>=this.m_upperTranslation){x=i.Clamp(w-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection);y=w-this.m_upperTranslation;v=!0}}this.m_perp=i.MulMV(b,this.m_localYAxis1);this.m_s1=(T+A)*this.m_perp.y-(R+C)*this.m_perp.x;this.m_s2=E*this.m_perp.y-D*this.m_perp.x;var B=new n,M=this.m_perp.x*T+this.m_perp.y*R;y=i.Max(y,i.Abs(M));f=0;if(v){h=this.m_invMassA;p=this.m_invMassB;_=this.m_invIA;d=this.m_invIB;this.m_K.col1.x=h+p+_*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2;this.m_K.col1.y=_*this.m_s1*this.m_a1+d*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=h+p+_*this.m_a1*this.m_a1+d*this.m_a2*this.m_a2;this.m_K.Solve(B,-M,-x)}else{h=this.m_invMassA;p=this.m_invMassB;_=this.m_invIA;d=this.m_invIB;var I=h+p+_*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,N=0;N=0!=I?-M/I:0;B.x=N;B.y=0}var L=B.x*this.m_perp.x+B.y*this.m_axis.x,O=B.x*this.m_perp.y+B.y*this.m_axis.y,P=B.x*this.m_s1+B.y*this.m_a1,F=B.x*this.m_s2+B.y*this.m_a2;l.x-=this.m_invMassA*L;l.y-=this.m_invMassA*O;g-=this.m_invIA*P;m.x+=this.m_invMassB*L;m.y+=this.m_invMassB*O;c+=this.m_invIB*F;s.m_sweep.a=g;a.m_sweep.a=c;s.SynchronizeTransform();a.SynchronizeTransform();return y<=t.b2_linearSlop&&f<=t.b2_angularSlop};Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef);v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;v.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n;this.localAxisA=new n};v.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=!1;this.lowerTranslation=0;this.upperTranslation=0;this.enableMotor=!1;this.maxMotorForce=0;this.motorSpeed=0};v.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.localAnchorA=this.bodyA.GetLocalPoint(o);this.localAnchorB=this.bodyB.GetLocalPoint(o);this.localAxisA=this.bodyA.GetLocalVector(i)};Box2D.inherit(x,Box2D.Dynamics.Joints.b2Joint);x.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;x.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new e;this.K1=new e;this.K2=new e;this.m_localAnchor=new n;this.m_target=new n;this.m_impulse=new n;this.m_mass=new e;this.m_C=new n};x.prototype.GetAnchorA=function(){return this.m_target};x.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};x.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse.x,t*this.m_impulse.y)};x.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return 0};x.prototype.GetTarget=function(){return this.m_target};x.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0);this.m_target=t};x.prototype.GetMaxForce=function(){return this.m_maxForce};x.prototype.SetMaxForce=function(t){void 0===t&&(t=0);this.m_maxForce=t};x.prototype.GetFrequency=function(){return this.m_frequencyHz};x.prototype.SetFrequency=function(t){void 0===t&&(t=0);this.m_frequencyHz=t};x.prototype.GetDampingRatio=function(){return this.m_dampingRatio};x.prototype.SetDampingRatio=function(t){void 0===t&&(t=0);this.m_dampingRatio=t};x.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t);this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,o=this.m_target.y-this.m_bodyB.m_xf.position.y,i=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*i.col1.x+o*i.col1.y;this.m_localAnchor.y=e*i.col2.x+o*i.col2.y;this.m_maxForce=t.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_beta=0;this.m_gamma=0};x.prototype.InitVelocityConstraints=function(t){var e=this.m_bodyB,o=e.GetMass(),i=2*Math.PI*this.m_frequencyHz,n=2*o*this.m_dampingRatio*i,r=o*i*i;this.m_gamma=t.dt*(n+t.dt*r);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=t.dt*r*this.m_gamma;var s;s=e.m_xf.R;var a=this.m_localAnchor.x-e.m_sweep.localCenter.x,l=this.m_localAnchor.y-e.m_sweep.localCenter.y,g=s.col1.x*a+s.col2.x*l;l=s.col1.y*a+s.col2.y*l;a=g;var m=e.m_invMass,c=e.m_invI;this.K1.col1.x=m;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=m;this.K2.col1.x=c*l*l;this.K2.col2.x=-c*a*l;this.K2.col1.y=-c*a*l;this.K2.col2.y=c*a*a;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=e.m_sweep.c.x+a-this.m_target.x;this.m_C.y=e.m_sweep.c.y+l-this.m_target.y;e.m_angularVelocity*=.98;this.m_impulse.x*=t.dtRatio;this.m_impulse.y*=t.dtRatio;e.m_linearVelocity.x+=m*this.m_impulse.x;e.m_linearVelocity.y+=m*this.m_impulse.y;e.m_angularVelocity+=c*(a*this.m_impulse.y-l*this.m_impulse.x)};x.prototype.SolveVelocityConstraints=function(t){var e,o=this.m_bodyB,i=0,n=0;e=o.m_xf.R;var r=this.m_localAnchor.x-o.m_sweep.localCenter.x,s=this.m_localAnchor.y-o.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s;s=e.col1.y*r+e.col2.y*s;r=i;var a=o.m_linearVelocity.x+-o.m_angularVelocity*s,l=o.m_linearVelocity.y+o.m_angularVelocity*r;e=this.m_mass;i=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;n=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var g=-(e.col1.x*i+e.col2.x*n),m=-(e.col1.y*i+e.col2.y*n),c=this.m_impulse.x,u=this.m_impulse.y;this.m_impulse.x+=g;this.m_impulse.y+=m;var h=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>h*h&&this.m_impulse.Multiply(h/this.m_impulse.Length());g=this.m_impulse.x-c;m=this.m_impulse.y-u;o.m_linearVelocity.x+=o.m_invMass*g;o.m_linearVelocity.y+=o.m_invMass*m;o.m_angularVelocity+=o.m_invI*(r*m-s*g)};x.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);return!0};Box2D.inherit(b,Box2D.Dynamics.Joints.b2JointDef);b.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;b.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new n};b.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=.7};Box2D.inherit(S,Box2D.Dynamics.Joints.b2Joint);S.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;S.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_localXAxis1=new n;this.m_localYAxis1=new n;this.m_axis=new n;this.m_perp=new n;this.m_K=new o;this.m_impulse=new r};S.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};S.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};S.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};S.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return t*this.m_impulse.y};S.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,o=t.GetWorldPoint(this.m_localAnchor1),i=e.GetWorldPoint(this.m_localAnchor2),n=i.x-o.x,r=i.y-o.y,s=t.GetWorldVector(this.m_localXAxis1),a=s.x*n+s.y*r;return a};S.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,o=this.m_bodyB;t=e.m_xf.R;var i=this.m_localAnchor1.x-e.m_sweep.localCenter.x,n=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*i+t.col2.x*n;n=t.col1.y*i+t.col2.y*n;i=r;t=o.m_xf.R;var s=this.m_localAnchor2.x-o.m_sweep.localCenter.x,a=this.m_localAnchor2.y-o.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a;a=t.col1.y*s+t.col2.y*a;s=r;var l=e.m_sweep.c.x+i,g=e.m_sweep.c.y+n,m=o.m_sweep.c.x+s,c=o.m_sweep.c.y+a,u=m-l,h=c-g,p=e.GetWorldVector(this.m_localXAxis1),_=e.m_linearVelocity,d=o.m_linearVelocity,y=e.m_angularVelocity,f=o.m_angularVelocity,v=u*-y*p.y+h*y*p.x+(p.x*(d.x+-f*a-_.x- -y*n)+p.y*(d.y+f*s-_.y-y*i));return v};S.prototype.IsLimitEnabled=function(){return this.m_enableLimit};S.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=t};S.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};S.prototype.GetUpperLimit=function(){return this.m_upperTranslation};S.prototype.SetLimits=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=t;this.m_upperTranslation=e};S.prototype.IsMotorEnabled=function(){return this.m_enableMotor};S.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=t};S.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=t};S.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};S.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=t};S.prototype.GetMotorForce=function(){return this.m_motorImpulse};S.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA);this.m_localAnchor2.SetV(t.localAnchorB);this.m_localXAxis1.SetV(t.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=t.referenceAngle;this.m_impulse.SetZero();this.m_motorMass=0;this.m_motorImpulse=0;this.m_lowerTranslation=t.lowerTranslation;this.m_upperTranslation=t.upperTranslation;this.m_maxMotorForce=t.maxMotorForce;this.m_motorSpeed=t.motorSpeed;this.m_enableLimit=t.enableLimit;this.m_enableMotor=t.enableMotor;this.m_limitState=_.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};S.prototype.InitVelocityConstraints=function(e){var o,n=this.m_bodyA,r=this.m_bodyB,s=0;this.m_localCenterA.SetV(n.GetLocalCenter());this.m_localCenterB.SetV(r.GetLocalCenter());{var a=n.GetTransform();r.GetTransform()}o=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,g=this.m_localAnchor1.y-this.m_localCenterA.y;s=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=s;o=r.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,c=this.m_localAnchor2.y-this.m_localCenterB.y;s=o.col1.x*m+o.col2.x*c;c=o.col1.y*m+o.col2.y*c;m=s;var u=r.m_sweep.c.x+m-n.m_sweep.c.x-l,h=r.m_sweep.c.y+c-n.m_sweep.c.y-g;this.m_invMassA=n.m_invMass;this.m_invMassB=r.m_invMass;this.m_invIA=n.m_invI;this.m_invIB=r.m_invI;this.m_axis.SetV(i.MulMV(a.R,this.m_localXAxis1));this.m_a1=(u+l)*this.m_axis.y-(h+g)*this.m_axis.x;this.m_a2=m*this.m_axis.y-c*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Box2D.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.SetV(i.MulMV(a.R,this.m_localYAxis1));this.m_s1=(u+l)*this.m_perp.y-(h+g)*this.m_perp.x;this.m_s2=m*this.m_perp.y-c*this.m_perp.x;var p=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,f=this.m_invIB;this.m_K.col1.x=p+d+y*this.m_s1*this.m_s1+f*this.m_s2*this.m_s2;this.m_K.col1.y=y*this.m_s1+f*this.m_s2;this.m_K.col1.z=y*this.m_s1*this.m_a1+f*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=y+f;this.m_K.col2.z=y*this.m_a1+f*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=p+d+y*this.m_a1*this.m_a1+f*this.m_a2*this.m_a2;if(this.m_enableLimit){var v=this.m_axis.x*u+this.m_axis.y*h;if(i.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop)this.m_limitState=_.e_equalLimits;else if(v<=this.m_lowerTranslation){if(this.m_limitState!=_.e_atLowerLimit){this.m_limitState=_.e_atLowerLimit;this.m_impulse.z=0}}else if(v>=this.m_upperTranslation){if(this.m_limitState!=_.e_atUpperLimit){this.m_limitState=_.e_atUpperLimit;this.m_impulse.z=0}}else{this.m_limitState=_.e_inactiveLimit;this.m_impulse.z=0}}else this.m_limitState=_.e_inactiveLimit;0==this.m_enableMotor&&(this.m_motorImpulse=0);if(e.warmStarting){this.m_impulse.x*=e.dtRatio;this.m_impulse.y*=e.dtRatio;this.m_motorImpulse*=e.dtRatio;var x=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,S=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,A=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*x;n.m_linearVelocity.y-=this.m_invMassA*b;n.m_angularVelocity-=this.m_invIA*S;r.m_linearVelocity.x+=this.m_invMassB*x;r.m_linearVelocity.y+=this.m_invMassB*b;r.m_angularVelocity+=this.m_invIB*A}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};S.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,o=this.m_bodyB,s=e.m_linearVelocity,a=e.m_angularVelocity,l=o.m_linearVelocity,g=o.m_angularVelocity,m=0,c=0,u=0,h=0;if(this.m_enableMotor&&this.m_limitState!=_.e_equalLimits){var p=this.m_axis.x*(l.x-s.x)+this.m_axis.y*(l.y-s.y)+this.m_a2*g-this.m_a1*a,d=this.m_motorMass*(this.m_motorSpeed-p),y=this.m_motorImpulse,f=t.dt*this.m_maxMotorForce;this.m_motorImpulse=i.Clamp(this.m_motorImpulse+d,-f,f);d=this.m_motorImpulse-y;m=d*this.m_axis.x;c=d*this.m_axis.y;u=d*this.m_a1;h=d*this.m_a2;s.x-=this.m_invMassA*m;s.y-=this.m_invMassA*c;a-=this.m_invIA*u;l.x+=this.m_invMassB*m;l.y+=this.m_invMassB*c;g+=this.m_invIB*h}var v=this.m_perp.x*(l.x-s.x)+this.m_perp.y*(l.y-s.y)+this.m_s2*g-this.m_s1*a,x=g-a;if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){var b=this.m_axis.x*(l.x-s.x)+this.m_axis.y*(l.y-s.y)+this.m_a2*g-this.m_a1*a,S=this.m_impulse.Copy(),A=this.m_K.Solve33(new r,-v,-x,-b);this.m_impulse.Add(A);this.m_limitState==_.e_atLowerLimit?this.m_impulse.z=i.Max(this.m_impulse.z,0):this.m_limitState==_.e_atUpperLimit&&(this.m_impulse.z=i.Min(this.m_impulse.z,0));var C=-v-(this.m_impulse.z-S.z)*this.m_K.col3.x,E=-x-(this.m_impulse.z-S.z)*this.m_K.col3.y,D=this.m_K.Solve22(new n,C,E);D.x+=S.x;D.y+=S.y;this.m_impulse.x=D.x;this.m_impulse.y=D.y;A.x=this.m_impulse.x-S.x;A.y=this.m_impulse.y-S.y;A.z=this.m_impulse.z-S.z;m=A.x*this.m_perp.x+A.z*this.m_axis.x;c=A.x*this.m_perp.y+A.z*this.m_axis.y;u=A.x*this.m_s1+A.y+A.z*this.m_a1;h=A.x*this.m_s2+A.y+A.z*this.m_a2;s.x-=this.m_invMassA*m;s.y-=this.m_invMassA*c;a-=this.m_invIA*u;l.x+=this.m_invMassB*m;l.y+=this.m_invMassB*c;g+=this.m_invIB*h}else{var T=this.m_K.Solve22(new n,-v,-x);this.m_impulse.x+=T.x;this.m_impulse.y+=T.y;m=T.x*this.m_perp.x;c=T.x*this.m_perp.y;u=T.x*this.m_s1+T.y;h=T.x*this.m_s2+T.y;s.x-=this.m_invMassA*m;s.y-=this.m_invMassA*c;a-=this.m_invIA*u;l.x+=this.m_invMassB*m;l.y+=this.m_invMassB*c;g+=this.m_invIB*h}e.m_linearVelocity.SetV(s);e.m_angularVelocity=a;o.m_linearVelocity.SetV(l);o.m_angularVelocity=g};S.prototype.SolvePositionConstraints=function(o){void 0===o&&(o=0);var s,a=this.m_bodyA,l=this.m_bodyB,g=a.m_sweep.c,m=a.m_sweep.a,c=l.m_sweep.c,u=l.m_sweep.a,h=0,p=0,_=0,d=0,y=0,f=0,v=0,x=!1,b=0,S=e.FromAngle(m),A=e.FromAngle(u);s=S;var C=this.m_localAnchor1.x-this.m_localCenterA.x,E=this.m_localAnchor1.y-this.m_localCenterA.y;h=s.col1.x*C+s.col2.x*E;E=s.col1.y*C+s.col2.y*E;C=h;s=A;var D=this.m_localAnchor2.x-this.m_localCenterB.x,T=this.m_localAnchor2.y-this.m_localCenterB.y;h=s.col1.x*D+s.col2.x*T;T=s.col1.y*D+s.col2.y*T;D=h;var R=c.x+D-g.x-C,w=c.y+T-g.y-E;if(this.m_enableLimit){this.m_axis=i.MulMV(S,this.m_localXAxis1);this.m_a1=(R+C)*this.m_axis.y-(w+E)*this.m_axis.x;this.m_a2=D*this.m_axis.y-T*this.m_axis.x;var B=this.m_axis.x*R+this.m_axis.y*w;if(i.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop){b=i.Clamp(B,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);f=i.Abs(B);x=!0}else if(B<=this.m_lowerTranslation){b=i.Clamp(B-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0);f=this.m_lowerTranslation-B;x=!0}else if(B>=this.m_upperTranslation){b=i.Clamp(B-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection);f=B-this.m_upperTranslation;x=!0}}this.m_perp=i.MulMV(S,this.m_localYAxis1);this.m_s1=(R+C)*this.m_perp.y-(w+E)*this.m_perp.x;this.m_s2=D*this.m_perp.y-T*this.m_perp.x;var M=new r,I=this.m_perp.x*R+this.m_perp.y*w,N=u-m-this.m_refAngle;f=i.Max(f,i.Abs(I));v=i.Abs(N);if(x){p=this.m_invMassA;_=this.m_invMassB;d=this.m_invIA;y=this.m_invIB;this.m_K.col1.x=p+_+d*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2;this.m_K.col1.y=d*this.m_s1+y*this.m_s2;this.m_K.col1.z=d*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=d+y;this.m_K.col2.z=d*this.m_a1+y*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=p+_+d*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2;this.m_K.Solve33(M,-I,-N,-b)}else{p=this.m_invMassA;_=this.m_invMassB;d=this.m_invIA;y=this.m_invIB;var L=p+_+d*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,O=d*this.m_s1+y*this.m_s2,P=d+y;this.m_K.col1.Set(L,O,0);this.m_K.col2.Set(O,P,0);var F=this.m_K.Solve22(new n,-I,-N);M.x=F.x;M.y=F.y;M.z=0}var V=M.x*this.m_perp.x+M.z*this.m_axis.x,H=M.x*this.m_perp.y+M.z*this.m_axis.y,k=M.x*this.m_s1+M.y+M.z*this.m_a1,G=M.x*this.m_s2+M.y+M.z*this.m_a2;g.x-=this.m_invMassA*V;g.y-=this.m_invMassA*H;m-=this.m_invIA*k;c.x+=this.m_invMassB*V;c.y+=this.m_invMassB*H;u+=this.m_invIB*G;a.m_sweep.a=m;l.m_sweep.a=u;a.SynchronizeTransform();l.SynchronizeTransform();return f<=t.b2_linearSlop&&v<=t.b2_angularSlop};Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef);A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;A.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n;this.localAxisA=new n};A.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.lowerTranslation=0;this.upperTranslation=0;this.enableMotor=!1;this.maxMotorForce=0;this.motorSpeed=0};A.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.localAnchorA=this.bodyA.GetLocalPoint(o);this.localAnchorB=this.bodyB.GetLocalPoint(o);this.localAxisA=this.bodyA.GetLocalVector(i);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(C,Box2D.Dynamics.Joints.b2Joint);C.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;C.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new n;this.m_groundAnchor2=new n;this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_u1=new n;this.m_u2=new n};C.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};C.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};C.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)};C.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return 0};C.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();t.Add(this.m_groundAnchor1);return t};C.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();t.Add(this.m_groundAnchor2);return t};C.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,o=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,i=t.x-e,n=t.y-o;return Math.sqrt(i*i+n*n)};C.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,o=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,i=t.x-e,n=t.y-o;return Math.sqrt(i*i+n*n)};C.prototype.GetRatio=function(){return this.m_ratio};C.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(t.localAnchorA);this.m_localAnchor2.SetV(t.localAnchorB);this.m_ratio=t.ratio;this.m_constant=t.lengthA+this.m_ratio*t.lengthB;this.m_maxLength1=i.Min(t.maxLengthA,this.m_constant-this.m_ratio*C.b2_minPulleyLength);this.m_maxLength2=i.Min(t.maxLengthB,(this.m_constant-C.b2_minPulleyLength)/this.m_ratio);this.m_impulse=0;this.m_limitImpulse1=0;this.m_limitImpulse2=0};C.prototype.InitVelocityConstraints=function(e){var o,i=this.m_bodyA,n=this.m_bodyB;o=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=o.col1.x*r+o.col2.x*s;s=o.col1.y*r+o.col2.y*s;r=a;o=n.m_xf.R;var l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,g=this.m_localAnchor2.y-n.m_sweep.localCenter.y;a=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=a;var m=i.m_sweep.c.x+r,c=i.m_sweep.c.y+s,u=n.m_sweep.c.x+l,h=n.m_sweep.c.y+g,p=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,d=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,y=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,f=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(m-p,c-d);this.m_u2.Set(u-y,h-f);var v=this.m_u1.Length(),x=this.m_u2.Length();v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero();x>t.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero();var b=this.m_constant-v-this.m_ratio*x;if(b>0){this.m_state=_.e_inactiveLimit;this.m_impulse=0}else this.m_state=_.e_atUpperLimit;if(v<this.m_maxLength1){this.m_limitState1=_.e_inactiveLimit;this.m_limitImpulse1=0}else this.m_limitState1=_.e_atUpperLimit;if(x<this.m_maxLength2){this.m_limitState2=_.e_inactiveLimit;this.m_limitImpulse2=0}else this.m_limitState2=_.e_atUpperLimit;var S=r*this.m_u1.y-s*this.m_u1.x,A=l*this.m_u2.y-g*this.m_u2.x;this.m_limitMass1=i.m_invMass+i.m_invI*S*S;this.m_limitMass2=n.m_invMass+n.m_invI*A*A;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;if(e.warmStarting){this.m_impulse*=e.dtRatio;this.m_limitImpulse1*=e.dtRatio;this.m_limitImpulse2*=e.dtRatio;var C=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,E=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,D=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,T=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;i.m_linearVelocity.x+=i.m_invMass*C;i.m_linearVelocity.y+=i.m_invMass*E;i.m_angularVelocity+=i.m_invI*(r*E-s*C);n.m_linearVelocity.x+=n.m_invMass*D;n.m_linearVelocity.y+=n.m_invMass*T;n.m_angularVelocity+=n.m_invI*(l*T-g*D)}else{this.m_impulse=0;this.m_limitImpulse1=0;this.m_limitImpulse2=0}};C.prototype.SolveVelocityConstraints=function(){var t,e=this.m_bodyA,o=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,s=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r;n=s;t=o.m_xf.R;var a=this.m_localAnchor2.x-o.m_sweep.localCenter.x,l=this.m_localAnchor2.y-o.m_sweep.localCenter.y;s=t.col1.x*a+t.col2.x*l;l=t.col1.y*a+t.col2.y*l;a=s;var g=0,m=0,c=0,u=0,h=0,p=0,d=0,y=0,f=0,v=0,x=0;if(this.m_state==_.e_atUpperLimit){g=e.m_linearVelocity.x+-e.m_angularVelocity*r;m=e.m_linearVelocity.y+e.m_angularVelocity*n;c=o.m_linearVelocity.x+-o.m_angularVelocity*l;u=o.m_linearVelocity.y+o.m_angularVelocity*a;f=-(this.m_u1.x*g+this.m_u1.y*m)-this.m_ratio*(this.m_u2.x*c+this.m_u2.y*u);v=this.m_pulleyMass*-f;x=this.m_impulse;this.m_impulse=i.Max(0,this.m_impulse+v);v=this.m_impulse-x;h=-v*this.m_u1.x;p=-v*this.m_u1.y;d=-this.m_ratio*v*this.m_u2.x;y=-this.m_ratio*v*this.m_u2.y;e.m_linearVelocity.x+=e.m_invMass*h;e.m_linearVelocity.y+=e.m_invMass*p;e.m_angularVelocity+=e.m_invI*(n*p-r*h);o.m_linearVelocity.x+=o.m_invMass*d;o.m_linearVelocity.y+=o.m_invMass*y;o.m_angularVelocity+=o.m_invI*(a*y-l*d)}if(this.m_limitState1==_.e_atUpperLimit){g=e.m_linearVelocity.x+-e.m_angularVelocity*r;m=e.m_linearVelocity.y+e.m_angularVelocity*n;f=-(this.m_u1.x*g+this.m_u1.y*m);v=-this.m_limitMass1*f;x=this.m_limitImpulse1;this.m_limitImpulse1=i.Max(0,this.m_limitImpulse1+v);v=this.m_limitImpulse1-x;h=-v*this.m_u1.x;p=-v*this.m_u1.y;e.m_linearVelocity.x+=e.m_invMass*h;e.m_linearVelocity.y+=e.m_invMass*p;e.m_angularVelocity+=e.m_invI*(n*p-r*h)}if(this.m_limitState2==_.e_atUpperLimit){c=o.m_linearVelocity.x+-o.m_angularVelocity*l;u=o.m_linearVelocity.y+o.m_angularVelocity*a;f=-(this.m_u2.x*c+this.m_u2.y*u);v=-this.m_limitMass2*f;x=this.m_limitImpulse2;this.m_limitImpulse2=i.Max(0,this.m_limitImpulse2+v);v=this.m_limitImpulse2-x;d=-v*this.m_u2.x;y=-v*this.m_u2.y;o.m_linearVelocity.x+=o.m_invMass*d;o.m_linearVelocity.y+=o.m_invMass*y;o.m_angularVelocity+=o.m_invI*(a*y-l*d)}};C.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var o,n=this.m_bodyA,r=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,a=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,l=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,m=0,c=0,u=0,h=0,p=0,d=0,y=0,f=0,v=0,x=0,b=0,S=0,A=0,C=0;if(this.m_state==_.e_atUpperLimit){o=n.m_xf.R;m=this.m_localAnchor1.x-n.m_sweep.localCenter.x;c=this.m_localAnchor1.y-n.m_sweep.localCenter.y;A=o.col1.x*m+o.col2.x*c;c=o.col1.y*m+o.col2.y*c;m=A;o=r.m_xf.R;u=this.m_localAnchor2.x-r.m_sweep.localCenter.x;h=this.m_localAnchor2.y-r.m_sweep.localCenter.y;A=o.col1.x*u+o.col2.x*h;h=o.col1.y*u+o.col2.y*h;u=A;p=n.m_sweep.c.x+m;d=n.m_sweep.c.y+c;y=r.m_sweep.c.x+u;f=r.m_sweep.c.y+h;this.m_u1.Set(p-s,d-a);this.m_u2.Set(y-l,f-g);v=this.m_u1.Length();x=this.m_u2.Length();v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero();x>t.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero();b=this.m_constant-v-this.m_ratio*x;C=i.Max(C,-b);b=i.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0);S=-this.m_pulleyMass*b;p=-S*this.m_u1.x;d=-S*this.m_u1.y;y=-this.m_ratio*S*this.m_u2.x;f=-this.m_ratio*S*this.m_u2.y;n.m_sweep.c.x+=n.m_invMass*p;n.m_sweep.c.y+=n.m_invMass*d;n.m_sweep.a+=n.m_invI*(m*d-c*p);r.m_sweep.c.x+=r.m_invMass*y;r.m_sweep.c.y+=r.m_invMass*f;r.m_sweep.a+=r.m_invI*(u*f-h*y);n.SynchronizeTransform();r.SynchronizeTransform()}if(this.m_limitState1==_.e_atUpperLimit){o=n.m_xf.R;m=this.m_localAnchor1.x-n.m_sweep.localCenter.x;c=this.m_localAnchor1.y-n.m_sweep.localCenter.y;A=o.col1.x*m+o.col2.x*c;c=o.col1.y*m+o.col2.y*c;m=A;p=n.m_sweep.c.x+m;d=n.m_sweep.c.y+c;this.m_u1.Set(p-s,d-a);v=this.m_u1.Length();if(v>t.b2_linearSlop){this.m_u1.x*=1/v;this.m_u1.y*=1/v}else this.m_u1.SetZero();b=this.m_maxLength1-v;C=i.Max(C,-b);b=i.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0);S=-this.m_limitMass1*b;p=-S*this.m_u1.x;d=-S*this.m_u1.y;n.m_sweep.c.x+=n.m_invMass*p;n.m_sweep.c.y+=n.m_invMass*d;n.m_sweep.a+=n.m_invI*(m*d-c*p);n.SynchronizeTransform()}if(this.m_limitState2==_.e_atUpperLimit){o=r.m_xf.R;u=this.m_localAnchor2.x-r.m_sweep.localCenter.x;h=this.m_localAnchor2.y-r.m_sweep.localCenter.y;A=o.col1.x*u+o.col2.x*h;h=o.col1.y*u+o.col2.y*h;u=A;y=r.m_sweep.c.x+u;f=r.m_sweep.c.y+h;this.m_u2.Set(y-l,f-g);x=this.m_u2.Length();if(x>t.b2_linearSlop){this.m_u2.x*=1/x;this.m_u2.y*=1/x}else this.m_u2.SetZero();b=this.m_maxLength2-x;C=i.Max(C,-b);b=i.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0);S=-this.m_limitMass2*b;y=-S*this.m_u2.x;f=-S*this.m_u2.y;r.m_sweep.c.x+=r.m_invMass*y;r.m_sweep.c.y+=r.m_invMass*f;r.m_sweep.a+=r.m_invI*(u*f-h*y);r.SynchronizeTransform()}return C<t.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2});Box2D.inherit(E,Box2D.Dynamics.Joints.b2JointDef);E.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;E.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new n;this.groundAnchorB=new n;this.localAnchorA=new n;this.localAnchorB=new n};E.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_pulleyJoint;this.groundAnchorA.Set(-1,1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set(-1,0);this.localAnchorB.Set(1,0);this.lengthA=0;this.maxLengthA=0;this.lengthB=0;this.maxLengthB=0;this.ratio=1;this.collideConnected=!0};E.prototype.Initialize=function(t,e,o,i,n,r,s){void 0===s&&(s=0);this.bodyA=t;this.bodyB=e;this.groundAnchorA.SetV(o);this.groundAnchorB.SetV(i);this.localAnchorA=this.bodyA.GetLocalPoint(n);this.localAnchorB=this.bodyB.GetLocalPoint(r);var a=n.x-o.x,l=n.y-o.y;this.lengthA=Math.sqrt(a*a+l*l);var g=r.x-i.x,m=r.y-i.y;this.lengthB=Math.sqrt(g*g+m*m);this.ratio=s;var c=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=c-this.ratio*C.b2_minPulleyLength;this.maxLengthB=(c-C.b2_minPulleyLength)/this.ratio};Box2D.inherit(D,Box2D.Dynamics.Joints.b2Joint);D.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;
D.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new e;this.K1=new e;this.K2=new e;this.K3=new e;this.impulse3=new r;this.impulse2=new n;this.reduced=new n;this.m_localAnchor1=new n;this.m_localAnchor2=new n;this.m_impulse=new r;this.m_mass=new o};D.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};D.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};D.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse.x,t*this.m_impulse.y)};D.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return t*this.m_impulse.z};D.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};D.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};D.prototype.IsLimitEnabled=function(){return this.m_enableLimit};D.prototype.EnableLimit=function(t){this.m_enableLimit=t};D.prototype.GetLowerLimit=function(){return this.m_lowerAngle};D.prototype.GetUpperLimit=function(){return this.m_upperAngle};D.prototype.SetLimits=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);this.m_lowerAngle=t;this.m_upperAngle=e};D.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);return this.m_enableMotor};D.prototype.EnableMotor=function(t){this.m_enableMotor=t};D.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=t};D.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};D.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0);this.m_maxMotorTorque=t};D.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};D.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA);this.m_localAnchor2.SetV(t.localAnchorB);this.m_referenceAngle=t.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=t.lowerAngle;this.m_upperAngle=t.upperAngle;this.m_maxMotorTorque=t.maxMotorTorque;this.m_motorSpeed=t.motorSpeed;this.m_enableLimit=t.enableLimit;this.m_enableMotor=t.enableMotor;this.m_limitState=_.e_inactiveLimit};D.prototype.InitVelocityConstraints=function(e){var o,n=this.m_bodyA,r=this.m_bodyB,s=0;this.m_enableMotor||this.m_enableLimit;o=n.m_xf.R;var a=this.m_localAnchor1.x-n.m_sweep.localCenter.x,l=this.m_localAnchor1.y-n.m_sweep.localCenter.y;s=o.col1.x*a+o.col2.x*l;l=o.col1.y*a+o.col2.y*l;a=s;o=r.m_xf.R;var g=this.m_localAnchor2.x-r.m_sweep.localCenter.x,m=this.m_localAnchor2.y-r.m_sweep.localCenter.y;s=o.col1.x*g+o.col2.x*m;m=o.col1.y*g+o.col2.y*m;g=s;var c=n.m_invMass,u=r.m_invMass,h=n.m_invI,p=r.m_invI;this.m_mass.col1.x=c+u+l*l*h+m*m*p;this.m_mass.col2.x=-l*a*h-m*g*p;this.m_mass.col3.x=-l*h-m*p;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=c+u+a*a*h+g*g*p;this.m_mass.col3.y=a*h+g*p;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=h+p;this.m_motorMass=1/(h+p);0==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var d=r.m_sweep.a-n.m_sweep.a-this.m_referenceAngle;if(i.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop)this.m_limitState=_.e_equalLimits;else if(d<=this.m_lowerAngle){this.m_limitState!=_.e_atLowerLimit&&(this.m_impulse.z=0);this.m_limitState=_.e_atLowerLimit}else if(d>=this.m_upperAngle){this.m_limitState!=_.e_atUpperLimit&&(this.m_impulse.z=0);this.m_limitState=_.e_atUpperLimit}else{this.m_limitState=_.e_inactiveLimit;this.m_impulse.z=0}}else this.m_limitState=_.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio;this.m_impulse.y*=e.dtRatio;this.m_motorImpulse*=e.dtRatio;var y=this.m_impulse.x,f=this.m_impulse.y;n.m_linearVelocity.x-=c*y;n.m_linearVelocity.y-=c*f;n.m_angularVelocity-=h*(a*f-l*y+this.m_motorImpulse+this.m_impulse.z);r.m_linearVelocity.x+=u*y;r.m_linearVelocity.y+=u*f;r.m_angularVelocity+=p*(g*f-m*y+this.m_motorImpulse+this.m_impulse.z)}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};D.prototype.SolveVelocityConstraints=function(t){var e,o=this.m_bodyA,n=this.m_bodyB,r=0,s=0,a=0,l=0,g=0,m=0,c=o.m_linearVelocity,u=o.m_angularVelocity,h=n.m_linearVelocity,p=n.m_angularVelocity,d=o.m_invMass,y=n.m_invMass,f=o.m_invI,v=n.m_invI;if(this.m_enableMotor&&this.m_limitState!=_.e_equalLimits){var x=p-u-this.m_motorSpeed,b=this.m_motorMass*-x,S=this.m_motorImpulse,A=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=i.Clamp(this.m_motorImpulse+b,-A,A);b=this.m_motorImpulse-S;u-=f*b;p+=v*b}if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){e=o.m_xf.R;a=this.m_localAnchor1.x-o.m_sweep.localCenter.x;l=this.m_localAnchor1.y-o.m_sweep.localCenter.y;r=e.col1.x*a+e.col2.x*l;l=e.col1.y*a+e.col2.y*l;a=r;e=n.m_xf.R;g=this.m_localAnchor2.x-n.m_sweep.localCenter.x;m=this.m_localAnchor2.y-n.m_sweep.localCenter.y;r=e.col1.x*g+e.col2.x*m;m=e.col1.y*g+e.col2.y*m;g=r;var C=h.x+-p*m-c.x- -u*l,E=h.y+p*g-c.y-u*a,D=p-u;this.m_mass.Solve33(this.impulse3,-C,-E,-D);if(this.m_limitState==_.e_equalLimits)this.m_impulse.Add(this.impulse3);else if(this.m_limitState==_.e_atLowerLimit){s=this.m_impulse.z+this.impulse3.z;if(0>s){this.m_mass.Solve22(this.reduced,-C,-E);this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=-this.m_impulse.z;this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0}}else if(this.m_limitState==_.e_atUpperLimit){s=this.m_impulse.z+this.impulse3.z;if(s>0){this.m_mass.Solve22(this.reduced,-C,-E);this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=-this.m_impulse.z;this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0}}c.x-=d*this.impulse3.x;c.y-=d*this.impulse3.y;u-=f*(a*this.impulse3.y-l*this.impulse3.x+this.impulse3.z);h.x+=y*this.impulse3.x;h.y+=y*this.impulse3.y;p+=v*(g*this.impulse3.y-m*this.impulse3.x+this.impulse3.z)}else{e=o.m_xf.R;a=this.m_localAnchor1.x-o.m_sweep.localCenter.x;l=this.m_localAnchor1.y-o.m_sweep.localCenter.y;r=e.col1.x*a+e.col2.x*l;l=e.col1.y*a+e.col2.y*l;a=r;e=n.m_xf.R;g=this.m_localAnchor2.x-n.m_sweep.localCenter.x;m=this.m_localAnchor2.y-n.m_sweep.localCenter.y;r=e.col1.x*g+e.col2.x*m;m=e.col1.y*g+e.col2.y*m;g=r;var T=h.x+-p*m-c.x- -u*l,R=h.y+p*g-c.y-u*a;this.m_mass.Solve22(this.impulse2,-T,-R);this.m_impulse.x+=this.impulse2.x;this.m_impulse.y+=this.impulse2.y;c.x-=d*this.impulse2.x;c.y-=d*this.impulse2.y;u-=f*(a*this.impulse2.y-l*this.impulse2.x);h.x+=y*this.impulse2.x;h.y+=y*this.impulse2.y;p+=v*(g*this.impulse2.y-m*this.impulse2.x)}o.m_linearVelocity.SetV(c);o.m_angularVelocity=u;n.m_linearVelocity.SetV(h);n.m_angularVelocity=p};D.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var o,n=0,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,g=0,m=0,c=0;if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){var u=s.m_sweep.a-r.m_sweep.a-this.m_referenceAngle,h=0;if(this.m_limitState==_.e_equalLimits){n=i.Clamp(u-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection);h=-this.m_motorMass*n;a=i.Abs(n)}else if(this.m_limitState==_.e_atLowerLimit){n=u-this.m_lowerAngle;a=-n;n=i.Clamp(n+t.b2_angularSlop,-t.b2_maxAngularCorrection,0);h=-this.m_motorMass*n}else if(this.m_limitState==_.e_atUpperLimit){n=u-this.m_upperAngle;a=n;n=i.Clamp(n-t.b2_angularSlop,0,t.b2_maxAngularCorrection);h=-this.m_motorMass*n}r.m_sweep.a-=r.m_invI*h;s.m_sweep.a+=s.m_invI*h;r.SynchronizeTransform();s.SynchronizeTransform()}o=r.m_xf.R;var p=this.m_localAnchor1.x-r.m_sweep.localCenter.x,d=this.m_localAnchor1.y-r.m_sweep.localCenter.y;g=o.col1.x*p+o.col2.x*d;d=o.col1.y*p+o.col2.y*d;p=g;o=s.m_xf.R;var y=this.m_localAnchor2.x-s.m_sweep.localCenter.x,f=this.m_localAnchor2.y-s.m_sweep.localCenter.y;g=o.col1.x*y+o.col2.x*f;f=o.col1.y*y+o.col2.y*f;y=g;var v=s.m_sweep.c.x+y-r.m_sweep.c.x-p,x=s.m_sweep.c.y+f-r.m_sweep.c.y-d,b=v*v+x*x,S=Math.sqrt(b);l=S;var A=r.m_invMass,C=s.m_invMass,E=r.m_invI,T=s.m_invI,R=10*t.b2_linearSlop;if(b>R*R){var w=A+C,B=1/w;m=B*-v;c=B*-x;var M=.5;r.m_sweep.c.x-=M*A*m;r.m_sweep.c.y-=M*A*c;s.m_sweep.c.x+=M*C*m;s.m_sweep.c.y+=M*C*c;v=s.m_sweep.c.x+y-r.m_sweep.c.x-p;x=s.m_sweep.c.y+f-r.m_sweep.c.y-d}this.K1.col1.x=A+C;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=A+C;this.K2.col1.x=E*d*d;this.K2.col2.x=-E*p*d;this.K2.col1.y=-E*p*d;this.K2.col2.y=E*p*p;this.K3.col1.x=T*f*f;this.K3.col2.x=-T*y*f;this.K3.col1.y=-T*y*f;this.K3.col2.y=T*y*y;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(D.tImpulse,-v,-x);m=D.tImpulse.x;c=D.tImpulse.y;r.m_sweep.c.x-=r.m_invMass*m;r.m_sweep.c.y-=r.m_invMass*c;r.m_sweep.a-=r.m_invI*(p*c-d*m);s.m_sweep.c.x+=s.m_invMass*m;s.m_sweep.c.y+=s.m_invMass*c;s.m_sweep.a+=s.m_invI*(y*c-f*m);r.SynchronizeTransform();s.SynchronizeTransform();return l<=t.b2_linearSlop&&a<=t.b2_angularSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new n});Box2D.inherit(T,Box2D.Dynamics.Joints.b2JointDef);T.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;T.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n};T.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.referenceAngle=0;this.lowerAngle=0;this.upperAngle=0;this.maxMotorTorque=0;this.motorSpeed=0;this.enableLimit=!1;this.enableMotor=!1};T.prototype.Initialize=function(t,e,o){this.bodyA=t;this.bodyB=e;this.localAnchorA=this.bodyA.GetLocalPoint(o);this.localAnchorB=this.bodyB.GetLocalPoint(o);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(R,Box2D.Dynamics.Joints.b2Joint);R.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;R.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new n;this.m_localAnchorB=new n;this.m_impulse=new r;this.m_mass=new o};R.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};R.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};R.prototype.GetReactionForce=function(t){void 0===t&&(t=0);return new n(t*this.m_impulse.x,t*this.m_impulse.y)};R.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);return t*this.m_impulse.z};R.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchorA.SetV(t.localAnchorA);this.m_localAnchorB.SetV(t.localAnchorB);this.m_referenceAngle=t.referenceAngle;this.m_impulse.SetZero();this.m_mass=new o};R.prototype.InitVelocityConstraints=function(t){var e,o=0,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchorA.x-i.m_sweep.localCenter.x,s=this.m_localAnchorA.y-i.m_sweep.localCenter.y;o=e.col1.x*r+e.col2.x*s;s=e.col1.y*r+e.col2.y*s;r=o;e=n.m_xf.R;var a=this.m_localAnchorB.x-n.m_sweep.localCenter.x,l=this.m_localAnchorB.y-n.m_sweep.localCenter.y;o=e.col1.x*a+e.col2.x*l;l=e.col1.y*a+e.col2.y*l;a=o;var g=i.m_invMass,m=n.m_invMass,c=i.m_invI,u=n.m_invI;this.m_mass.col1.x=g+m+s*s*c+l*l*u;this.m_mass.col2.x=-s*r*c-l*a*u;this.m_mass.col3.x=-s*c-l*u;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=g+m+r*r*c+a*a*u;this.m_mass.col3.y=r*c+a*u;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=c+u;if(t.warmStarting){this.m_impulse.x*=t.dtRatio;this.m_impulse.y*=t.dtRatio;this.m_impulse.z*=t.dtRatio;i.m_linearVelocity.x-=g*this.m_impulse.x;i.m_linearVelocity.y-=g*this.m_impulse.y;i.m_angularVelocity-=c*(r*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z);n.m_linearVelocity.x+=m*this.m_impulse.x;n.m_linearVelocity.y+=m*this.m_impulse.y;n.m_angularVelocity+=u*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)}else this.m_impulse.SetZero()};R.prototype.SolveVelocityConstraints=function(){var t,e=0,o=this.m_bodyA,i=this.m_bodyB,n=o.m_linearVelocity,s=o.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,g=o.m_invMass,m=i.m_invMass,c=o.m_invI,u=i.m_invI;t=o.m_xf.R;var h=this.m_localAnchorA.x-o.m_sweep.localCenter.x,p=this.m_localAnchorA.y-o.m_sweep.localCenter.y;e=t.col1.x*h+t.col2.x*p;p=t.col1.y*h+t.col2.y*p;h=e;t=i.m_xf.R;var _=this.m_localAnchorB.x-i.m_sweep.localCenter.x,d=this.m_localAnchorB.y-i.m_sweep.localCenter.y;e=t.col1.x*_+t.col2.x*d;d=t.col1.y*_+t.col2.y*d;_=e;var y=a.x-l*d-n.x+s*p,f=a.y+l*_-n.y-s*h,v=l-s,x=new r;this.m_mass.Solve33(x,-y,-f,-v);this.m_impulse.Add(x);n.x-=g*x.x;n.y-=g*x.y;s-=c*(h*x.y-p*x.x+x.z);a.x+=m*x.x;a.y+=m*x.y;l+=u*(_*x.y-d*x.x+x.z);o.m_angularVelocity=s;i.m_angularVelocity=l};R.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var o,n=0,s=this.m_bodyA,a=this.m_bodyB;o=s.m_xf.R;var l=this.m_localAnchorA.x-s.m_sweep.localCenter.x,g=this.m_localAnchorA.y-s.m_sweep.localCenter.y;n=o.col1.x*l+o.col2.x*g;g=o.col1.y*l+o.col2.y*g;l=n;o=a.m_xf.R;var m=this.m_localAnchorB.x-a.m_sweep.localCenter.x,c=this.m_localAnchorB.y-a.m_sweep.localCenter.y;n=o.col1.x*m+o.col2.x*c;c=o.col1.y*m+o.col2.y*c;m=n;var u=s.m_invMass,h=a.m_invMass,p=s.m_invI,_=a.m_invI,d=a.m_sweep.c.x+m-s.m_sweep.c.x-l,y=a.m_sweep.c.y+c-s.m_sweep.c.y-g,f=a.m_sweep.a-s.m_sweep.a-this.m_referenceAngle,v=10*t.b2_linearSlop,x=Math.sqrt(d*d+y*y),b=i.Abs(f);if(x>v){p*=1;_*=1}this.m_mass.col1.x=u+h+g*g*p+c*c*_;this.m_mass.col2.x=-g*l*p-c*m*_;this.m_mass.col3.x=-g*p-c*_;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=u+h+l*l*p+m*m*_;this.m_mass.col3.y=l*p+m*_;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=p+_;var S=new r;this.m_mass.Solve33(S,-d,-y,-f);s.m_sweep.c.x-=u*S.x;s.m_sweep.c.y-=u*S.y;s.m_sweep.a-=p*(l*S.y-g*S.x+S.z);a.m_sweep.c.x+=h*S.x;a.m_sweep.c.y+=h*S.y;a.m_sweep.a+=_*(m*S.y-c*S.x+S.z);s.SynchronizeTransform();a.SynchronizeTransform();return x<=t.b2_linearSlop&&b<=t.b2_angularSlop};Box2D.inherit(w,Box2D.Dynamics.Joints.b2JointDef);w.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;w.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new n;this.localAnchorB=new n};w.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=_.e_weldJoint;this.referenceAngle=0};w.prototype.Initialize=function(t,e,o){this.bodyA=t;this.bodyB=e;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(o));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}();!function(){var t=Box2D.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_drawScale=1;this.m_lineThickness=1;this.m_alpha=1;this.m_fillAlpha=1;this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}};t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"};t.prototype.b2DebugDraw=function(){this.m_drawFlags=0};t.prototype.SetFlags=function(t){void 0===t&&(t=0);this.m_drawFlags=t};t.prototype.GetFlags=function(){return this.m_drawFlags};t.prototype.AppendFlags=function(t){void 0===t&&(t=0);this.m_drawFlags|=t};t.prototype.ClearFlags=function(t){void 0===t&&(t=0);this.m_drawFlags&=~t};t.prototype.SetSprite=function(t){this.m_ctx=t};t.prototype.GetSprite=function(){return this.m_ctx};t.prototype.SetDrawScale=function(t){void 0===t&&(t=0);this.m_drawScale=t};t.prototype.GetDrawScale=function(){return this.m_drawScale};t.prototype.SetLineThickness=function(t){void 0===t&&(t=0);this.m_lineThickness=t;this.m_ctx.strokeWidth=t};t.prototype.GetLineThickness=function(){return this.m_lineThickness};t.prototype.SetAlpha=function(t){void 0===t&&(t=0);this.m_alpha=t};t.prototype.GetAlpha=function(){return this.m_alpha};t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0);this.m_fillAlpha=t};t.prototype.GetFillAlpha=function(){return this.m_fillAlpha};t.prototype.SetXFormScale=function(t){void 0===t&&(t=0);this.m_xformScale=t};t.prototype.GetXFormScale=function(){return this.m_xformScale};t.prototype.DrawPolygon=function(t,e,o){if(e){var i=this.m_ctx,n=this.m_drawScale;i.beginPath();i.strokeStyle=this._color(o.color,this.m_alpha);i.moveTo(t[0].x*n,t[0].y*n);for(var r=1;e>r;r++)i.lineTo(t[r].x*n,t[r].y*n);i.lineTo(t[0].x*n,t[0].y*n);i.closePath();i.stroke()}};t.prototype.DrawSolidPolygon=function(t,e,o){if(e){var i=this.m_ctx,n=this.m_drawScale;i.beginPath();i.strokeStyle=this._color(o.color,this.m_alpha);i.fillStyle=this._color(o.color,this.m_fillAlpha);i.moveTo(t[0].x*n,t[0].y*n);for(var r=1;e>r;r++)i.lineTo(t[r].x*n,t[r].y*n);i.lineTo(t[0].x*n,t[0].y*n);i.closePath();i.fill();i.stroke()}};t.prototype.DrawCircle=function(t,e,o){if(e){var i=this.m_ctx,n=this.m_drawScale;i.beginPath();i.strokeStyle=this._color(o.color,this.m_alpha);i.arc(t.x*n,t.y*n,e*n,0,2*Math.PI,!0);i.closePath();i.stroke()}};t.prototype.DrawSolidCircle=function(t,e,o,i){if(e){var n=this.m_ctx,r=this.m_drawScale,s=t.x*r,a=t.y*r;n.moveTo(0,0);n.beginPath();n.strokeStyle=this._color(i.color,this.m_alpha);n.fillStyle=this._color(i.color,this.m_fillAlpha);n.arc(s,a,e*r,0,2*Math.PI,!0);n.moveTo(s,a);n.lineTo((t.x+o.x*e)*r,(t.y+o.y*e)*r);n.closePath();n.fill();n.stroke()}};t.prototype.DrawSegment=function(t,e,o){var i=this.m_ctx,n=this.m_drawScale;i.strokeStyle=this._color(o.color,this.m_alpha);i.beginPath();i.moveTo(t.x*n,t.y*n);i.lineTo(e.x*n,e.y*n);i.closePath();i.stroke()};t.prototype.DrawTransform=function(t){var e=this.m_ctx,o=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(16711680,this.m_alpha);e.moveTo(t.position.x*o,t.position.y*o);e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*o,(t.position.y+this.m_xformScale*t.R.col1.y)*o);e.strokeStyle=this._color(65280,this.m_alpha);e.moveTo(t.position.x*o,t.position.y*o);e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*o,(t.position.y+this.m_xformScale*t.R.col2.y)*o);e.closePath();e.stroke()}}();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs;window.b2Vec2=Box2D.Common.Math.b2Vec2;window.b2BodyDef=Box2D.Dynamics.b2BodyDef;window.b2Body=Box2D.Dynamics.b2Body;window.b2FixtureDef=Box2D.Dynamics.b2FixtureDef;window.b2Fixture=Box2D.Dynamics.b2Fixture;window.b2World=Box2D.Dynamics.b2World;window.b2MassData=Box2D.Collision.Shapes.b2MassData;window.b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape;window.b2CircleShape=Box2D.Collision.Shapes.b2CircleShape;window.b2DebugDraw=Box2D.Dynamics.b2DebugDraw;window.b2ContactListener=Box2D.Dynamics.b2ContactListener;window.b2DistanceJointDef=Box2D.Dynamics.Joints.b2DistanceJointDef;window.b2RevoluteJointDef=Box2D.Dynamics.Joints.b2RevoluteJointDef;window.b2PulleyJointDef=Box2D.Dynamics.Joints.b2PulleyJointDef;window.b2PrismaticJointDef=Box2D.Dynamics.Joints.b2PrismaticJointDef;window.b2LineJointDef=Box2D.Dynamics.Joints.b2LineJointDef;window.b2WeldJointDef=Box2D.Dynamics.Joints.b2WeldJointDef;window.b2GearJointDef=Box2D.Dynamics.Joints.b2GearJointDef;window.b2MouseJointDef=Box2D.Dynamics.Joints.b2MouseJointDef;window.b2RopeJointDef=Box2D.Dynamics.Joints.b2RopeJointDef;window.b2_dynamicBody=Box2D.Dynamics.b2Body.b2_dynamicBody;window.b2_staticBody=Box2D.Dynamics.b2Body.b2_staticBody;window.b2_kinematicBody=Box2D.Dynamics.b2Body.b2_kinematicBody;!function(){var t={},e=null,o=!0,i=!1;try{"undefined"!=typeof AudioContext?e=new AudioContext:"undefined"!=typeof webkitAudioContext?e=new webkitAudioContext:o=!1}catch(n){o=!1}if(!o)if("undefined"!=typeof Audio)try{new Audio}catch(n){i=!0}else i=!0;console.log("usingWebAudio "+o);if(o){var r="undefined"==typeof e.createGain?e.createGainNode():e.createGain();r.gain.value=1;r.connect(e.destination)}var s=function(){this._volume=1;this._muted=!1;this.usingWebAudio=o;this.noAudio=i;this._howls=[]};s.prototype={volume:function(t){var e=this;t=parseFloat(t);if(t>=0&&1>=t){e._volume=t;o&&(r.gain.value=t);for(var i in e._howls)if(e._howls.hasOwnProperty(i)&&e._howls[i]._webAudio===!1)for(var n=0;n<e._howls[i]._audioNode.length;n++)e._howls[i]._audioNode[n].volume=e._howls[i]._volume*e._volume;return e}return o?r.gain.value:e._volume},mute:function(){this._setMuted(!0);return this},unmute:function(){this._setMuted(!1);return this},_setMuted:function(t){var e=this;if(t!=e._muted){e._muted=t;o&&(r.gain.value=t?0:e._volume);for(var i in e._howls)if(e._howls.hasOwnProperty(i)&&e._howls[i]._webAudio===!1)for(var n=0;n<e._howls[i]._audioNode.length;n++)e._howls[i]._audioNode[n].muted=t}}};var a=new s,l=null;if(!i){l=new Audio;var g={mp3:!!l.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!l.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!l.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!l.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!l.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(l.canPlayType("audio/x-m4a;")||l.canPlayType("audio/m4a;")||l.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(l.canPlayType("audio/x-mp4;")||l.canPlayType("audio/mp4;")||l.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!l.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")};console.log(g);window.audioCodecs=g}var m=function(t){var e=this;e._autoplay=t.autoplay||!1;e._buffer=t.buffer||!1;e._duration=t.duration||0;e._format=t.format||null;e._loop=t.loop||!1;e._loaded=!1;e._sprite=t.sprite||{};e._src=t.src||"";e._pos3d=t.pos3d||[0,0,-.5];e._volume=void 0!==t.volume?t.volume:1;e._urls=t.urls||[];e._rate=t.rate||1;e._model=t.model||null;e._onload=[t.onload||function(){}];e._onloaderror=[t.onloaderror||function(){}];e._onend=[t.onend||function(){}];e._onpause=[t.onpause||function(){}];e._onplay=[t.onplay||function(){}];e._onendTimer=[];e._webAudio=o&&!e._buffer;e._audioNode=[];e._webAudio&&e._setupAudioNode();a._howls.push(e);e.load()};m.prototype={load:function(){var e=this,o=null;if(!i){for(var n=0;n<e._urls.length;n++){var r,l;if(e._format)r=e._format;else{l=e._urls[n].toLowerCase().split("?")[0];r=l.match(/.+\.([^?]+)(\?|$)/);r=r&&r.length>=2?r:l.match(/data\:audio\/([^?]+);/);if(!r){e.on("loaderror");return}r=r[1]}if(g[r]){o=e._urls[n];break}}if(!o){if(!(e._urls.length>0)){e.on("loaderror");return}o=e._urls[e._urls.length-1]}e._src=o;if(e._webAudio)c(e,o);else{var m=new Audio;m.addEventListener("error",function(){m.error&&4===m.error.code&&(s.noAudio=!0);e.on("loaderror",{type:m.error?m.error.code:0})},!1);e._audioNode.push(m);m.src=o;m._pos=0;m.preload="auto";m.volume=a._muted?0:e._volume*a.volume();t[o]=e;var u=function(){e._duration=Math.ceil(10*m.duration)/10;0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]});if(!e._loaded){e._loaded=!0;e.on("load")}e._autoplay&&e.play();m.removeEventListener("canplaythrough",u,!1)};m.addEventListener("canplaythrough",u,!1);m.load()}return e}e.on("loaderror")},urls:function(t){var e=this;if(t){e.stop();e._urls="string"==typeof t?[t]:t;e._loaded=!1;e.load();return e}return e._urls},play:function(t,o){var i=this;"function"==typeof t&&(o=t);t&&"function"!=typeof t||(t="_default");if(!i._loaded){i.on("load",function(){i.play(t,o)});return i}if(!i._sprite[t]){"function"==typeof o&&o();return i}i._inactiveNode(function(n){n._sprite=t;var r=n._pos>0?n._pos:i._sprite[t][0]/1e3,s=0;if(i._webAudio){s=i._sprite[t][1]/1e3-n._pos;n._pos>0&&(r=i._sprite[t][0]/1e3+r)}else s=i._sprite[t][1]/1e3-(r-i._sprite[t][0]/1e3);var l,g=!(!i._loop&&!i._sprite[t][2]),m="string"==typeof o?o:Math.round(Date.now()*Math.random())+"";!function(){var e={id:m,sprite:t,loop:g};l=setTimeout(function(){!i._webAudio&&g&&i.stop(e.id).play(t,e.id);if(i._webAudio&&!g){i._nodeById(e.id).paused=!0;i._nodeById(e.id)._pos=0}i._webAudio||g||i.stop(e.id);i.on("end",m)},1e3*s);i._onendTimer.push({timer:l,id:e.id})}();if(i._webAudio){var c=i._sprite[t][0]/1e3,u=i._sprite[t][1]/1e3;n.id=m;n.paused=!1;h(i,[g,c,u],m);i._playStart=e.currentTime;n.gain.value=i._volume;"undefined"==typeof n.bufferSource.start?n.bufferSource.noteGrainOn(0,r,s):n.bufferSource.start(0,r,s)}else{if(4!==n.readyState&&(n.readyState||!navigator.isCocoonJS)){i._clearEndTimer(m);!function(){var e=i,r=t,s=o,a=n,l=function(){e.play(r,s);a.removeEventListener("canplaythrough",l,!1)};a.addEventListener("canplaythrough",l,!1)}();return i}n.readyState=4;n.id=m;n.currentTime=r;n.muted=a._muted||n.muted;n.volume=i._volume*a.volume();setTimeout(function(){n.play()},0)}i.on("play");"function"==typeof o&&o(m);return i});return i},pause:function(t){var e=this;if(!e._loaded){e.on("play",function(){e.pause(t)});return e}e._clearEndTimer(t);var o=t?e._nodeById(t):e._activeNode();if(o){o._pos=e.pos(null,t);if(e._webAudio){if(!o.bufferSource||o.paused)return e;o.paused=!0;"undefined"==typeof o.bufferSource.stop?o.bufferSource.noteOff(0):o.bufferSource.stop(0)}else o.pause()}e.on("pause");return e},stop:function(t){var e=this;if(!e._loaded){e.on("play",function(){e.stop(t)});return e}e._clearEndTimer(t);var o=t?e._nodeById(t):e._activeNode();if(o){o._pos=0;if(e._webAudio){if(!o.bufferSource||o.paused)return e;o.paused=!0;"undefined"==typeof o.bufferSource.stop?o.bufferSource.noteOff(0):o.bufferSource.stop(0)}else if(!isNaN(o.duration)){o.pause();o.currentTime=0}}return e},mute:function(t){var e=this;if(!e._loaded){e.on("play",function(){e.mute(t)});return e}var o=t?e._nodeById(t):e._activeNode();o&&(e._webAudio?o.gain.value=0:o.muted=!0);return e},unmute:function(t){var e=this;if(!e._loaded){e.on("play",function(){e.unmute(t)});return e}var o=t?e._nodeById(t):e._activeNode();o&&(e._webAudio?o.gain.value=e._volume:o.muted=!1);return e},volume:function(t,e){var o=this;t=parseFloat(t);if(t>=0&&1>=t){o._volume=t;if(!o._loaded){o.on("play",function(){o.volume(t,e)});return o}var i=e?o._nodeById(e):o._activeNode();i&&(o._webAudio?i.gain.value=t:i.volume=t*a.volume());return o}return o._volume},loop:function(t){var e=this;if("boolean"==typeof t){e._loop=t;return e}return e._loop},sprite:function(t){var e=this;if("object"==typeof t){e._sprite=t;return e}return e._sprite},pos:function(t,o){var i=this;if(!i._loaded){i.on("load",function(){i.pos(t)});return"number"==typeof t?i:i._pos||0}t=parseFloat(t);var n=o?i._nodeById(o):i._activeNode();if(n){if(t>=0){i.pause(o);n._pos=t;i.play(n._sprite,o);return i}return i._webAudio?n._pos+(e.currentTime-i._playStart):n.currentTime}if(t>=0)return i;for(var r=0;r<i._audioNode.length;r++)if(i._audioNode[r].paused&&4===i._audioNode[r].readyState)return i._webAudio?i._audioNode[r]._pos:i._audioNode[r].currentTime},pos3d:function(t,e,o,i){var n=this;e="undefined"!=typeof e&&e?e:0;o="undefined"!=typeof o&&o?o:-.5;if(!n._loaded){n.on("play",function(){n.pos3d(t,e,o,i)});return n}if(!(t>=0||0>t))return n._pos3d;if(n._webAudio){var r=i?n._nodeById(i):n._activeNode();if(r){n._pos3d=[t,e,o];r.panner.setPosition(t,e,o);r.panner.panningModel=n._model||"HRTF"}}return n},fade:function(t,e,o,i,n){var r=this,s=Math.abs(t-e),a=t>e?"down":"up",l=s/.01,g=o/l;if(!r._loaded){r.on("load",function(){r.fade(t,e,o,i,n)});return r}r.volume(t,n);for(var m=1;l>=m;m++)!function(){var t=r._volume+("up"===a?.01:-.01)*m,o=Math.round(1e3*t)/1e3,s=e;setTimeout(function(){r.volume(o,n);o===s&&i&&i()},g*m)}()},fadeIn:function(t,e,o){return this.volume(0).play().fade(0,t,e,o)},fadeOut:function(t,e,o,i){var n=this;return n.fade(n._volume,t,e,function(){o&&o();n.pause(i);n.on("end")},i)},_nodeById:function(t){for(var e=this,o=e._audioNode[0],i=0;i<e._audioNode.length;i++)if(e._audioNode[i].id===t){o=e._audioNode[i];break}return o},_activeNode:function(){for(var t=this,e=null,o=0;o<t._audioNode.length;o++)if(!t._audioNode[o].paused){e=t._audioNode[o];break}t._drainPool();return e},_inactiveNode:function(t){for(var e=this,o=null,i=0;i<e._audioNode.length;i++)if(e._audioNode[i].paused&&4===e._audioNode[i].readyState){t(e._audioNode[i]);o=!0;break}e._drainPool();if(!o){var n;if(e._webAudio){n=e._setupAudioNode();t(n)}else{e.load();n=e._audioNode[e._audioNode.length-1];var r=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",s=function(){n.removeEventListener(r,s,!1);t(n)};n.addEventListener(r,s,!1)}}},_drainPool:function(){var t,e=this,o=0;for(t=0;t<e._audioNode.length;t++)e._audioNode[t].paused&&o++;for(t=e._audioNode.length-1;t>=0&&!(5>=o);t--)if(e._audioNode[t].paused){e._webAudio&&e._audioNode[t].disconnect(0);o--;e._audioNode.splice(t,1)}},_clearEndTimer:function(t){for(var e=this,o=0,i=0;i<e._onendTimer.length;i++)if(e._onendTimer[i].id===t){o=i;break}var n=e._onendTimer[o];if(n){clearTimeout(n.timer);e._onendTimer.splice(o,1)}},_setupAudioNode:function(){var t=this,o=t._audioNode,i=t._audioNode.length;o[i]="undefined"==typeof e.createGain?e.createGainNode():e.createGain();o[i].gain.value=t._volume;o[i].paused=!0;o[i]._pos=0;o[i].readyState=4;o[i].connect(r);o[i].panner=e.createPanner();o[i].panner.panningModel=t._model||"equalpower";o[i].panner.setPosition(t._pos3d[0],t._pos3d[1],t._pos3d[2]);o[i].panner.connect(o[i]);return o[i]},on:function(t,e){var o=this,i=o["_on"+t];if("function"==typeof e)i.push(e);else for(var n=0;n<i.length;n++)e?i[n].call(o,e):i[n].call(o);return o},off:function(t,e){for(var o=this,i=o["_on"+t],n=e.toString(),r=0;r<i.length;r++)if(n===i[r].toString()){i.splice(r,1);break}return o},unload:function(){for(var e=this,o=e._audioNode,i=0;i<e._audioNode.length;i++){o[i].paused||e.stop(o[i].id);e._webAudio?o[i].disconnect(0):o[i].src=""}for(i=0;i<e._onendTimer.length;i++)clearTimeout(e._onendTimer[i].timer);var n=a._howls.indexOf(e);null!==n&&n>=0&&a._howls.splice(n,1);delete t[e._src];e=null}};if(o)var c=function(o,i){if(i in t){o._duration=t[i].duration;u(o)}else{var n=new XMLHttpRequest;n.open("GET",i,!0);n.responseType="arraybuffer";n.onload=function(){e.decodeAudioData(n.response,function(e){if(e){t[i]=e;u(o,e)}},function(){o.on("loaderror")})};n.onerror=function(){console.log("loading sound error");if(o._webAudio){o._buffer=!0;o._webAudio=!1;o._audioNode=[];delete o._gainNode;o.load()}};try{n.send()}catch(r){console.log("loading sound error:",i);n.onerror()}}},u=function(t,e){t._duration=e?e.duration:t._duration;0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]});if(!t._loaded){t._loaded=!0;t.on("load")}t._autoplay&&t.play()},h=function(o,i,n){var r=o._nodeById(n);r.bufferSource=e.createBufferSource();r.bufferSource.buffer=t[o._src];r.bufferSource.connect(r.panner);r.bufferSource.loop=i[0];if(i[0]){r.bufferSource.loopStart=i[1];r.bufferSource.loopEnd=i[1]+i[2]}r.bufferSource.playbackRate.value=o._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:a,Howl:m}});if("undefined"!=typeof exports){exports.Howler=a;exports.Howl=m}if("undefined"!=typeof window){window.Howler=a;window.Howl=m}}();!function(t,e){"use strict";function o(){if(!i.READY){f.determineEventTypes();y.each(i.gestures,function(t){x.register(t)});f.onTouch(i.DOCUMENT,h,x.detect);f.onTouch(i.DOCUMENT,p,x.detect);i.READY=!0}}var i=function b(t,e){return new b.Instance(t,e||{})};i.VERSION="1.1.3";i.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};i.DOCUMENT=document;i.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled;i.HAS_TOUCHEVENTS="ontouchstart"in t;i.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent);i.NO_MOUSEEVENTS=i.HAS_TOUCHEVENTS&&i.IS_MOBILE||i.HAS_POINTEREVENTS;i.CALCULATE_INTERVAL=25;var n={},r=i.DIRECTION_DOWN="down",s=i.DIRECTION_LEFT="left",a=i.DIRECTION_UP="up",l=i.DIRECTION_RIGHT="right",g=i.POINTER_MOUSE="mouse",m=i.POINTER_TOUCH="touch",c=i.POINTER_PEN="pen",u=i.EVENT_START="start",h=i.EVENT_MOVE="move",p=i.EVENT_END="end",_=i.EVENT_RELEASE="release",d=i.EVENT_TOUCH="touch";i.READY=!1;i.plugins=i.plugins||{};i.gestures=i.gestures||{};var y=i.utils={extend:function(t,o,i){for(var n in o)!o.hasOwnProperty(n)||t[n]!==e&&i||(t[n]=o[n]);return t},on:function(t,e,o){t.addEventListener(e,o,!1)},off:function(t,e,o){t.removeEventListener(e,o,!1)},each:function(t,o,i){var n,r;
if("forEach"in t)t.forEach(o,i);else if(t.length!==e){for(n=0,r=t.length;r>n;n++)if(o.call(i,t[n],n,t)===!1)return}else for(n in t)if(t.hasOwnProperty(n)&&o.call(i,t[n],n,t)===!1)return},inStr:function(t,e){return t.indexOf(e)>-1},inArray:function(t,e){if(t.indexOf){var o=t.indexOf(e);return-1===o?!1:o}for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return!1},toArray:function(t){return Array.prototype.slice.call(t,0)},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],o=[],i=[],n=[],r=Math.min,s=Math.max;if(1===t.length)return{pageX:t[0].pageX,pageY:t[0].pageY,clientX:t[0].clientX,clientY:t[0].clientY};y.each(t,function(t){e.push(t.pageX);o.push(t.pageY);i.push(t.clientX);n.push(t.clientY)});return{pageX:(r.apply(Math,e)+s.apply(Math,e))/2,pageY:(r.apply(Math,o)+s.apply(Math,o))/2,clientX:(r.apply(Math,i)+s.apply(Math,i))/2,clientY:(r.apply(Math,n)+s.apply(Math,n))/2}},getVelocity:function(t,e,o){return{x:Math.abs(e/t)||0,y:Math.abs(o/t)||0}},getAngle:function(t,e){var o=e.clientX-t.clientX,i=e.clientY-t.clientY;return 180*Math.atan2(i,o)/Math.PI},getDirection:function(t,e){var o=Math.abs(t.clientX-e.clientX),i=Math.abs(t.clientY-e.clientY);return o>=i?t.clientX-e.clientX>0?s:l:t.clientY-e.clientY>0?a:r},getDistance:function(t,e){var o=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(o*o+i*i)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==a||t==r},setPrefixedCss:function(t,e,o,i){var n=["","Webkit","Moz","O","ms"];e=y.toCamelCase(e);for(var r=0;r<n.length;r++){var s=e;n[r]&&(s=n[r]+s.slice(0,1).toUpperCase()+s.slice(1));if(s in t.style){t.style[s]=(null==i||i)&&o||"";break}}},toggleBehavior:function(t,e,o){if(e&&t&&t.style){y.each(e,function(e,i){y.setPrefixedCss(t,i,e,o)});var i=o&&function(){return!1};"none"==e.userSelect&&(t.onselectstart=i);"none"==e.userDrag&&(t.ondragstart=i)}},toCamelCase:function(t){return t.replace(/[_-]([a-z])/g,function(t){return t[1].toUpperCase()})}},f=i.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(t,e,o,i){var n=e.split(" ");y.each(n,function(e){y.on(t,e,o);i&&i(e)})},off:function(t,e,o,i){var n=e.split(" ");y.each(n,function(e){y.off(t,e,o);i&&i(e)})},onTouch:function(t,e,o){var r=this,s=function(n){n.event&&n.event.event_&&(n=n.event.event_);var s,a=n.type.toLowerCase(),l=i.HAS_POINTEREVENTS,g=y.inStr(a,"mouse");if(!g||!r.preventMouseEvents){if(g&&e==u&&0===n.button){r.preventMouseEvents=!1;r.shouldDetect=!0}else if(l&&e==u)r.shouldDetect=1===n.buttons||v.matchType(m,n);else if(!g&&e==u){r.preventMouseEvents=!0;r.shouldDetect=!0}l&&e!=p&&v.updatePointer(e,n);r.shouldDetect&&(s=r.doDetect.call(r,n,e,t,o));if(s==p){r.preventMouseEvents=!1;r.shouldDetect=!1;v.reset()}l&&e==p&&v.updatePointer(e,n)}};this.on(t,n[e],s);return s},doDetect:function(t,e,o,i){var n=this.getTouchList(t,e),r=n.length,s=e,a=n.trigger,l=r;if(e==u)a=d;else if(e==p){a=_;l=n.length-(t.changedTouches?t.changedTouches.length:1)}l>0&&this.started&&(s=h);this.started=!0;var g=this.collectEventData(o,s,n,t);e!=p&&i.call(x,g);if(a){g.changedLength=l;g.eventType=a;i.call(x,g);g.eventType=s;delete g.changedLength}if(s==p){i.call(x,g);this.started=!1}return s},determineEventTypes:function(){var e;e=i.HAS_POINTEREVENTS?t.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:i.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];n[u]=e[0];n[h]=e[1];n[p]=e[2];return n},getTouchList:function(t,e){if(i.HAS_POINTEREVENTS)return v.getTouchList();if(t.touches){if(e==h)return t.touches;var o=[],n=[].concat(y.toArray(t.touches),y.toArray(t.changedTouches)),r=[];y.each(n,function(t){y.inArray(o,t.identifier)===!1&&r.push(t);o.push(t.identifier)});return r}t.identifier=1;return[t]},collectEventData:function(t,e,o,i){var n=m;y.inStr(i.type,"mouse")||v.matchType(g,i)?n=g:v.matchType(c,i)&&(n=c);return{center:y.getCenter(o),timeStamp:Date.now(),target:i.target,touches:o,eventType:e,pointerType:n,srcEvent:i,preventDefault:function(){var t=this.srcEvent;t.preventManipulation&&t.preventManipulation();t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return x.stopDetect()}}}},v=i.PointerEvent={pointers:{},getTouchList:function(){var t=[];y.each(this.pointers,function(e){t.push(e)});return t},updatePointer:function(t,e){if(t==p)delete this.pointers[e.pointerId];else{e.identifier=e.pointerId;this.pointers[e.pointerId]=e}},matchType:function(t,e){if(!e.pointerType)return!1;var o=e.pointerType,i={};i[g]=o===(e.MSPOINTER_TYPE_MOUSE||g);i[m]=o===(e.MSPOINTER_TYPE_TOUCH||m);i[c]=o===(e.MSPOINTER_TYPE_PEN||c);return i[t]},reset:function(){this.pointers={}}},x=i.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){if(!this.current){this.stopped=!1;this.current={inst:t,startEvent:y.extend({},e),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""};this.detect(e)}},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst,o=e.options;y.each(this.gestures,function(i){!this.stopped&&e.enabled&&o[i.name]&&i.handler.call(i,t,e)},this);this.current&&(this.current.lastEvent=t);t.eventType==p&&this.stopDetect();return t}},stopDetect:function(){this.previous=y.extend({},this.current);this.current=null;this.stopped=!0},getCalculatedData:function(t,e,o,n,r){var s=this.current,a=!1,l=s.lastCalcEvent,g=s.lastCalcData;if(l&&t.timeStamp-l.timeStamp>i.CALCULATE_INTERVAL){e=l.center;o=t.timeStamp-l.timeStamp;n=t.center.clientX-l.center.clientX;r=t.center.clientY-l.center.clientY;a=!0}(t.eventType==d||t.eventType==_)&&(s.futureCalcEvent=t);if(!s.lastCalcEvent||a){g.velocity=y.getVelocity(o,n,r);g.angle=y.getAngle(e,t.center);g.direction=y.getDirection(e,t.center);s.lastCalcEvent=s.futureCalcEvent||t;s.futureCalcEvent=t}t.velocityX=g.velocity.x;t.velocityY=g.velocity.y;t.interimAngle=g.angle;t.interimDirection=g.direction},extendEventData:function(t){var e=this.current,o=e.startEvent,i=e.lastEvent||o;if(t.eventType==d||t.eventType==_){o.touches=[];y.each(t.touches,function(t){o.touches.push({clientX:t.clientX,clientY:t.clientY})})}var n=t.timeStamp-o.timeStamp,r=t.center.clientX-o.center.clientX,s=t.center.clientY-o.center.clientY;this.getCalculatedData(t,i.center,n,r,s);y.extend(t,{startEvent:o,deltaTime:n,deltaX:r,deltaY:s,distance:y.getDistance(o.center,t.center),angle:y.getAngle(o.center,t.center),direction:y.getDirection(o.center,t.center),scale:y.getScale(o.touches,t.touches),rotation:y.getRotation(o.touches,t.touches)});return t},register:function(t){var o=t.defaults||{};o[t.name]===e&&(o[t.name]=!0);y.extend(i.defaults,o,!0);t.index=t.index||1e3;this.gestures.push(t);this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0});return this.gestures}};i.Instance=function(t,e){var n=this;o();this.element=t;this.enabled=!0;y.each(e,function(t,o){delete e[o];e[y.toCamelCase(o)]=t});this.options=y.extend(y.extend({},i.defaults),e||{});this.options.behavior&&y.toggleBehavior(this.element,this.options.behavior,!0);this.eventStartHandler=f.onTouch(t,u,function(t){n.enabled&&t.eventType==u?x.startDetect(n,t):t.eventType==d&&x.detect(t)});this.eventHandlers=[]};i.Instance.prototype={on:function(t,e){var o=this;f.on(o.element,t,e,function(t){o.eventHandlers.push({gesture:t,handler:e})});return o},off:function(t,e){var o=this;f.off(o.element,t,e,function(t){var i=y.inArray({gesture:t,handler:e});i!==!1&&o.eventHandlers.splice(i,1)});return o},trigger:function(t,e){e||(e={});var o=i.DOCUMENT.createEvent("Event");o.initEvent(t,!0,!0);o.gesture=e;var n=this.element;y.hasParent(e.target,n)&&(n=e.target);n.dispatchEvent(o);return this},enable:function(t){this.enabled=t;return this},dispose:function(){var t,e;y.toggleBehavior(this.element,this.options.behavior,!1);for(t=-1;e=this.eventHandlers[++t];)y.off(this.element,e.gesture,e.handler);this.eventHandlers=[];f.off(this.element,n[u],this.eventStartHandler);return null}};!function(t){function e(e,i){var n=x.current;if(!(i.options.dragMaxTouches>0&&e.touches.length>i.options.dragMaxTouches))switch(e.eventType){case u:o=!1;break;case h:if(e.distance<i.options.dragMinDistance&&n.name!=t)return;var g=n.startEvent.center;if(n.name!=t){n.name=t;if(i.options.dragDistanceCorrection&&e.distance>0){var m=Math.abs(i.options.dragMinDistance/e.distance);g.pageX+=e.deltaX*m;g.pageY+=e.deltaY*m;g.clientX+=e.deltaX*m;g.clientY+=e.deltaY*m;e=x.extendEventData(e)}}(n.lastEvent.dragLockToAxis||i.options.dragLockToAxis&&i.options.dragLockMinDistance<=e.distance)&&(e.dragLockToAxis=!0);var c=n.lastEvent.direction;e.dragLockToAxis&&c!==e.direction&&(e.direction=y.isVertical(c)?e.deltaY<0?a:r:e.deltaX<0?s:l);if(!o){i.trigger(t+"start",e);o=!0}i.trigger(t,e);i.trigger(t+e.direction,e);var d=y.isVertical(e.direction);(i.options.dragBlockVertical&&d||i.options.dragBlockHorizontal&&!d)&&e.preventDefault();break;case _:if(o&&e.changedLength<=i.options.dragMaxTouches){i.trigger(t+"end",e);o=!1}break;case p:o=!1}}var o=!1;i.gestures.Drag={name:t,index:50,handler:e,defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag");i.gestures.Gesture={name:"gesture",index:1337,handler:function(t,e){e.trigger(this.name,t)}};!function(t){function e(e,i){var n=i.options,r=x.current;switch(e.eventType){case u:clearTimeout(o);r.name=t;o=setTimeout(function(){r&&r.name==t&&i.trigger(t,e)},n.holdTimeout);break;case h:e.distance>n.holdThreshold&&clearTimeout(o);break;case _:clearTimeout(o)}}var o;i.gestures.Hold={name:t,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:e}}("hold");i.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==_&&e.trigger(this.name,t)}};i.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(t,e){if(t.eventType==_){var o=t.touches.length,i=e.options;if(o<i.swipeMinTouches||o>i.swipeMaxTouches)return;if(t.velocityX>i.swipeVelocityX||t.velocityY>i.swipeVelocityY){e.trigger(this.name,t);e.trigger(this.name+t.direction,t)}}}};!function(t){function e(e,i){var n,r,s=i.options,a=x.current,l=x.previous;switch(e.eventType){case u:o=!1;break;case h:o=o||e.distance>s.tapMaxDistance;break;case p:if(!y.inStr(e.srcEvent.type,"cancel")&&e.deltaTime<s.tapMaxTime&&!o){n=l&&l.lastEvent&&e.timeStamp-l.lastEvent.timeStamp;r=!1;if(l&&l.name==t&&n&&n<s.doubleTapInterval&&e.distance<s.doubleTapDistance){i.trigger("doubletap",e);r=!0}if(!r||s.tapAlways){a.name=t;i.trigger(a.name,e)}}}}var o=!1;i.gestures.Tap={name:t,index:100,handler:e,defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap");i.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(t,e){if(e.options.preventMouse&&t.pointerType==g)t.stopDetect();else{e.options.preventDefault&&t.preventDefault();t.eventType==d&&e.trigger("touch",t)}}};!function(t){function e(e,i){switch(e.eventType){case u:o=!1;break;case h:if(e.touches.length<2)return;var n=Math.abs(1-e.scale),r=Math.abs(e.rotation);if(n<i.options.transformMinScale&&r<i.options.transformMinRotation)return;x.current.name=t;if(!o){i.trigger(t+"start",e);o=!0}i.trigger(t,e);r>i.options.transformMinRotation&&i.trigger("rotate",e);if(n>i.options.transformMinScale){i.trigger("pinch",e);i.trigger("pinch"+(e.scale<1?"in":"out"),e)}break;case _:if(o&&e.changedLength<2){i.trigger(t+"end",e);o=!1}}}var o=!1;i.gestures.Transform={name:t,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:e}}("transform");"function"==typeof define&&define.amd?define(function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:t.Hammer=i}(window);!function(){function t(t,e){for(var o=0;o<e.length;o+=1)if(e[o]===t)return!0;return!1}function e(t){return t.replace(/^\s+|\s+$/g,"")}function o(t,e){"use strict";var o=new i(t,e);return o.beautify()}function i(o,i){"use strict";function n(t,e){var o=0;if(t){o=t.indentation_level;!K.just_added_newline()&&t.line_indent_level>o&&(o=t.line_indent_level)}var i={mode:e,parent:t,last_text:t?t.last_text:"",last_word:t?t.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:o,line_indent_level:t?t.line_indent_level:o,start_line_index:K.get_line_number(),ternary_depth:0};return i}function a(t){var e=t.newlines,o=te.keep_array_indentation&&y(j.mode);if(o)for(i=0;e>i;i+=1)c(i>0);else{te.max_preserve_newlines&&e>te.max_preserve_newlines&&(e=te.max_preserve_newlines);if(te.preserve_newlines&&t.newlines>1){c();for(var i=1;e>i;i+=1)c(!0)}}$=t;Q[$.type]()}function g(t){t=t.replace(/\x0d/g,"");for(var e=[],o=t.indexOf("\n");-1!==o;){e.push(t.substring(0,o));t=t.substring(o+1);o=t.indexOf("\n")}t.length&&e.push(t);return e}function m(t){t=void 0===t?!1:t;if(!K.just_added_newline())if(te.preserve_newlines&&$.wanted_newline||t)c(!1,!0);else if(te.wrap_line_length){var e=K.current_line.get_character_count()+$.text.length+(K.space_before_token?1:0);e>=te.wrap_line_length&&c(!1,!0)}}function c(t,e){if(!e&&";"!==j.last_text&&","!==j.last_text&&"="!==j.last_text&&"TK_OPERATOR"!==J)for(;j.mode===l.Statement&&!j.if_block&&!j.do_block;)v();K.add_new_line(t)&&(j.multiline_frame=!0)}function u(){if(K.just_added_newline())if(te.keep_array_indentation&&y(j.mode)&&$.wanted_newline){K.current_line.push($.whitespace_before);K.space_before_token=!1}else K.set_indent(j.indentation_level)&&(j.line_indent_level=j.indentation_level)}function h(t){t=t||$.text;u();K.add_token(t)}function p(){j.indentation_level+=1}function _(){j.indentation_level>0&&(!j.parent||j.indentation_level>j.parent.indentation_level)&&(j.indentation_level-=1)}function d(t){if(j){X.push(j);Y=j}else Y=n(null,t);j=n(Y,t)}function y(t){return t===l.ArrayLiteral}function f(e){return t(e,[l.Expression,l.ForInitializer,l.Conditional])}function v(){if(X.length>0){Y=j;j=X.pop();Y.mode===l.Statement&&K.remove_redundant_indentation(Y)}}function x(){return j.parent.mode===l.ObjectLiteral&&j.mode===l.Statement&&(":"===j.last_text&&0===j.ternary_depth||"TK_RESERVED"===J&&t(j.last_text,["get","set"]))}function b(){if("TK_RESERVED"===J&&t(j.last_text,["var","let","const"])&&"TK_WORD"===$.type||"TK_RESERVED"===J&&"do"===j.last_text||"TK_RESERVED"===J&&"return"===j.last_text&&!$.wanted_newline||"TK_RESERVED"===J&&"else"===j.last_text&&("TK_RESERVED"!==$.type||"if"!==$.text)||"TK_END_EXPR"===J&&(Y.mode===l.ForInitializer||Y.mode===l.Conditional)||"TK_WORD"===J&&j.mode===l.BlockStatement&&!j.in_case&&"--"!==$.text&&"++"!==$.text&&"TK_WORD"!==$.type&&"TK_RESERVED"!==$.type||j.mode===l.ObjectLiteral&&(":"===j.last_text&&0===j.ternary_depth||"TK_RESERVED"===J&&t(j.last_text,["get","set"]))){d(l.Statement);p();"TK_RESERVED"===J&&t(j.last_text,["var","let","const"])&&"TK_WORD"===$.type&&(j.declaration_statement=!0);x()||m("TK_RESERVED"===$.type&&t($.text,["do","for","if","while"]));return!0}return!1}function S(t,o){for(var i=0;i<t.length;i++){var n=e(t[i]);if(n.charAt(0)!==o)return!1}return!0}function A(t,e){for(var o,i=0,n=t.length;n>i;i++){o=t[i];if(o&&0!==o.indexOf(e))return!1}return!0}function C(e){return t(e,["case","return","do","if","throw","else"])}function E(t){var e=z+(t||0);return 0>e||e>=ee.length?null:ee[e]}function D(){b();var e=l.Expression;if("["===$.text){if("TK_WORD"===J||")"===j.last_text){"TK_RESERVED"===J&&t(j.last_text,U.line_starters)&&(K.space_before_token=!0);d(e);h();p();te.space_in_paren&&(K.space_before_token=!0);return}e=l.ArrayLiteral;y(j.mode)&&("["===j.last_text||","===j.last_text&&("]"===q||"}"===q))&&(te.keep_array_indentation||c())}else"TK_RESERVED"===J&&"for"===j.last_text?e=l.ForInitializer:"TK_RESERVED"===J&&t(j.last_text,["if","while"])&&(e=l.Conditional);";"===j.last_text||"TK_START_BLOCK"===J?c():"TK_END_EXPR"===J||"TK_START_EXPR"===J||"TK_END_BLOCK"===J||"."===j.last_text?m($.wanted_newline):"TK_RESERVED"===J&&"("===$.text||"TK_WORD"===J||"TK_OPERATOR"===J?"TK_RESERVED"===J&&("function"===j.last_word||"typeof"===j.last_word)||"*"===j.last_text&&"function"===q?te.space_after_anon_function&&(K.space_before_token=!0):"TK_RESERVED"!==J||!t(j.last_text,U.line_starters)&&"catch"!==j.last_text||te.space_before_conditional&&(K.space_before_token=!0):K.space_before_token=!0;"("===$.text&&("TK_EQUALS"===J||"TK_OPERATOR"===J)&&(x()||m());d(e);h();te.space_in_paren&&(K.space_before_token=!0);p()}function T(){for(;j.mode===l.Statement;)v();j.multiline_frame&&m("]"===$.text&&y(j.mode)&&!te.keep_array_indentation);if(te.space_in_paren)if("TK_START_EXPR"!==J||te.space_in_empty_paren)K.space_before_token=!0;else{K.trim();K.space_before_token=!1}if("]"===$.text&&te.keep_array_indentation){h();v()}else{v();h()}K.remove_redundant_indentation(Y);if(j.do_while&&Y.mode===l.Conditional){Y.mode=l.Expression;j.do_block=!1;j.do_while=!1}}function R(){var e=E(1),o=E(2);d(o&&(":"===o.text&&t(e.type,["TK_STRING","TK_WORD","TK_RESERVED"])||t(e.text,["get","set"])&&t(o.type,["TK_WORD","TK_RESERVED"]))?t(q,["class","interface"])?l.BlockStatement:l.ObjectLiteral:l.BlockStatement);var i=!e.comments_before.length&&"}"===e.text,n=i&&"function"===j.last_word&&"TK_END_EXPR"===J;"expand"===te.brace_style||"none"===te.brace_style&&$.wanted_newline?"TK_OPERATOR"!==J&&(n||"TK_EQUALS"===J||"TK_RESERVED"===J&&C(j.last_text)&&"else"!==j.last_text)?K.space_before_token=!0:c(!1,!0):"TK_OPERATOR"!==J&&"TK_START_EXPR"!==J?"TK_START_BLOCK"===J?c():K.space_before_token=!0:y(Y.mode)&&","===j.last_text&&("}"===q?K.space_before_token=!0:c());h();p()}function w(){for(;j.mode===l.Statement;)v();var t="TK_START_BLOCK"===J;if("expand"===te.brace_style)t||c();else if(!t)if(y(j.mode)&&te.keep_array_indentation){te.keep_array_indentation=!1;c();te.keep_array_indentation=!0}else c();v();h()}function B(){"TK_RESERVED"===$.type&&j.mode!==l.ObjectLiteral&&t($.text,["set","get"])&&($.type="TK_WORD");if("TK_RESERVED"===$.type&&j.mode===l.ObjectLiteral){var e=E(1);":"==e.text&&($.type="TK_WORD")}b()||!$.wanted_newline||f(j.mode)||"TK_OPERATOR"===J&&"--"!==j.last_text&&"++"!==j.last_text||"TK_EQUALS"===J||!te.preserve_newlines&&"TK_RESERVED"===J&&t(j.last_text,["var","let","const","set","get"])||c();if(j.do_block&&!j.do_while){if("TK_RESERVED"===$.type&&"while"===$.text){K.space_before_token=!0;h();K.space_before_token=!0;j.do_while=!0;return}c();j.do_block=!1}if(j.if_block)if(j.else_block||"TK_RESERVED"!==$.type||"else"!==$.text){for(;j.mode===l.Statement;)v();j.if_block=!1;j.else_block=!1}else j.else_block=!0;if("TK_RESERVED"===$.type&&("case"===$.text||"default"===$.text&&j.in_case_statement)){c();if(j.case_body||te.jslint_happy){_();j.case_body=!1}h();j.in_case=!0;j.in_case_statement=!0}else{if("TK_RESERVED"===$.type&&"function"===$.text){if((t(j.last_text,["}",";"])||K.just_added_newline()&&!t(j.last_text,["[","{",":","=",","]))&&!K.just_added_blankline()&&!$.comments_before.length){c();c(!0)}"TK_RESERVED"===J||"TK_WORD"===J?"TK_RESERVED"===J&&t(j.last_text,["get","set","new","return","export"])?K.space_before_token=!0:"TK_RESERVED"===J&&"default"===j.last_text&&"export"===q?K.space_before_token=!0:c():"TK_OPERATOR"===J||"="===j.last_text?K.space_before_token=!0:(j.multiline_frame||!f(j.mode)&&!y(j.mode))&&c()}("TK_COMMA"===J||"TK_START_EXPR"===J||"TK_EQUALS"===J||"TK_OPERATOR"===J)&&(x()||m());if("TK_RESERVED"===$.type&&t($.text,["function","get","set"])){h();j.last_word=$.text}else{Z="NONE";if("TK_END_BLOCK"===J)if("TK_RESERVED"===$.type&&t($.text,["else","catch","finally"]))if("expand"===te.brace_style||"end-expand"===te.brace_style||"none"===te.brace_style&&$.wanted_newline)Z="NEWLINE";else{Z="SPACE";K.space_before_token=!0}else Z="NEWLINE";else if("TK_SEMICOLON"===J&&j.mode===l.BlockStatement)Z="NEWLINE";else if("TK_SEMICOLON"===J&&f(j.mode))Z="SPACE";else if("TK_STRING"===J)Z="NEWLINE";else if("TK_RESERVED"===J||"TK_WORD"===J||"*"===j.last_text&&"function"===q)Z="SPACE";else if("TK_START_BLOCK"===J)Z="NEWLINE";else if("TK_END_EXPR"===J){K.space_before_token=!0;Z="NEWLINE"}"TK_RESERVED"===$.type&&t($.text,U.line_starters)&&")"!==j.last_text&&(Z="else"===j.last_text||"export"===j.last_text?"SPACE":"NEWLINE");if("TK_RESERVED"===$.type&&t($.text,["else","catch","finally"]))if("TK_END_BLOCK"!==J||"expand"===te.brace_style||"end-expand"===te.brace_style||"none"===te.brace_style&&$.wanted_newline)c();else{K.trim(!0);var o=K.current_line;"}"!==o.last()&&c();K.space_before_token=!0}else"NEWLINE"===Z?"TK_RESERVED"===J&&C(j.last_text)?K.space_before_token=!0:"TK_END_EXPR"!==J?"TK_START_EXPR"===J&&"TK_RESERVED"===$.type&&t($.text,["var","let","const"])||":"===j.last_text||("TK_RESERVED"===$.type&&"if"===$.text&&"else"===j.last_text?K.space_before_token=!0:c()):"TK_RESERVED"===$.type&&t($.text,U.line_starters)&&")"!==j.last_text&&c():j.multiline_frame&&y(j.mode)&&","===j.last_text&&"}"===q?c():"SPACE"===Z&&(K.space_before_token=!0);h();j.last_word=$.text;"TK_RESERVED"===$.type&&"do"===$.text&&(j.do_block=!0);"TK_RESERVED"===$.type&&"if"===$.text&&(j.if_block=!0)}}}function M(){b()&&(K.space_before_token=!1);for(;j.mode===l.Statement&&!j.if_block&&!j.do_block;)v();h()}function I(){b()?K.space_before_token=!0:"TK_RESERVED"===J||"TK_WORD"===J?K.space_before_token=!0:"TK_COMMA"===J||"TK_START_EXPR"===J||"TK_EQUALS"===J||"TK_OPERATOR"===J?x()||m():c();h()}function N(){b();j.declaration_statement&&(j.declaration_assignment=!0);K.space_before_token=!0;h();K.space_before_token=!0}function L(){if(j.declaration_statement){f(j.parent.mode)&&(j.declaration_assignment=!1);h();if(j.declaration_assignment){j.declaration_assignment=!1;c(!1,!0)}else K.space_before_token=!0}else{h();if(j.mode===l.ObjectLiteral||j.mode===l.Statement&&j.parent.mode===l.ObjectLiteral){j.mode===l.Statement&&v();c()}else K.space_before_token=!0}}function O(){b();if("TK_RESERVED"===J&&C(j.last_text)){K.space_before_token=!0;h()}else if("*"!==$.text||"TK_DOT"!==J)if(":"===$.text&&j.in_case){j.case_body=!0;p();h();c();j.in_case=!1}else if("::"!==$.text){!$.wanted_newline||"--"!==$.text&&"++"!==$.text||c(!1,!0);"TK_OPERATOR"===J&&m();var e=!0,o=!0;if(t($.text,["--","++","!","~"])||t($.text,["-","+"])&&(t(J,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||t(j.last_text,U.line_starters)||","===j.last_text)){e=!1;o=!1;";"===j.last_text&&f(j.mode)&&(e=!0);"TK_RESERVED"===J||"TK_END_EXPR"===J?e=!0:"TK_OPERATOR"===J&&(e=t($.text,["--","-"])&&t(j.last_text,["--","-"])||t($.text,["++","+"])&&t(j.last_text,["++","+"]));j.mode!==l.BlockStatement&&j.mode!==l.Statement||"{"!==j.last_text&&";"!==j.last_text||c()}else if(":"===$.text)0===j.ternary_depth?e=!1:j.ternary_depth-=1;else if("?"===$.text)j.ternary_depth+=1;else if("*"===$.text&&"TK_RESERVED"===J&&"function"===j.last_text){e=!1;o=!1}K.space_before_token=K.space_before_token||e;h();K.space_before_token=o}else h();else h()}function P(){var t,o=g($.text),i=!1,n=!1,r=$.whitespace_before,s=r.length;c(!1,!0);o.length>1&&(S(o.slice(1),"*")?i=!0:A(o.slice(1),r)&&(n=!0));h(o[0]);for(t=1;t<o.length;t++){c(!1,!0);i?h(" "+e(o[t])):n&&o[t].length>s?h(o[t].substring(s)):K.add_token(o[t])}c(!1,!0)}function F(){K.space_before_token=!0;h();K.space_before_token=!0}function V(){$.wanted_newline?c(!1,!0):K.trim(!0);K.space_before_token=!0;h();c(!1,!0)}function H(){b();"TK_RESERVED"===J&&C(j.last_text)?K.space_before_token=!0:m(")"===j.last_text&&te.break_chained_methods);h()}function k(){h();"\n"===$.text[$.text.length-1]&&c()}function G(){for(;j.mode===l.Statement;)v()}var K,z,U,$,J,q,W,j,Y,X,Z,Q,te,ee=[],oe="";Q={TK_START_EXPR:D,TK_END_EXPR:T,TK_START_BLOCK:R,TK_END_BLOCK:w,TK_WORD:B,TK_RESERVED:B,TK_SEMICOLON:M,TK_STRING:I,TK_EQUALS:N,TK_OPERATOR:O,TK_COMMA:L,TK_BLOCK_COMMENT:P,TK_INLINE_COMMENT:F,TK_COMMENT:V,TK_DOT:H,TK_UNKNOWN:k,TK_EOF:G};i=i?i:{};te={};void 0!==i.braces_on_own_line&&(te.brace_style=i.braces_on_own_line?"expand":"collapse");te.brace_style=i.brace_style?i.brace_style:te.brace_style?te.brace_style:"collapse";"expand-strict"===te.brace_style&&(te.brace_style="expand");te.indent_size=i.indent_size?parseInt(i.indent_size,10):4;te.indent_char=i.indent_char?i.indent_char:" ";te.preserve_newlines=void 0===i.preserve_newlines?!0:i.preserve_newlines;te.break_chained_methods=void 0===i.break_chained_methods?!1:i.break_chained_methods;te.max_preserve_newlines=void 0===i.max_preserve_newlines?0:parseInt(i.max_preserve_newlines,10);te.space_in_paren=void 0===i.space_in_paren?!1:i.space_in_paren;te.space_in_empty_paren=void 0===i.space_in_empty_paren?!1:i.space_in_empty_paren;te.jslint_happy=void 0===i.jslint_happy?!1:i.jslint_happy;te.space_after_anon_function=void 0===i.space_after_anon_function?!1:i.space_after_anon_function;te.keep_array_indentation=void 0===i.keep_array_indentation?!1:i.keep_array_indentation;te.space_before_conditional=void 0===i.space_before_conditional?!0:i.space_before_conditional;te.unescape_strings=void 0===i.unescape_strings?!1:i.unescape_strings;te.wrap_line_length=void 0===i.wrap_line_length?0:parseInt(i.wrap_line_length,10);te.e4x=void 0===i.e4x?!1:i.e4x;te.end_with_newline=void 0===i.end_with_newline?!1:i.end_with_newline;te.jslint_happy&&(te.space_after_anon_function=!0);if(i.indent_with_tabs){te.indent_char="	";te.indent_size=1}W="";for(;te.indent_size>0;){W+=te.indent_char;te.indent_size-=1}var ie=0;if(o&&o.length){for(;" "===o.charAt(ie)||"	"===o.charAt(ie);){oe+=o.charAt(ie);ie+=1}o=o.substring(ie)}J="TK_START_BLOCK";q="";K=new r(W,oe);X=[];d(l.BlockStatement);this.beautify=function(){var t,e;U=new s(o,te,W);ee=U.tokenize();z=0;for(;t=E();){for(var i=0;i<t.comments_before.length;i++)a(t.comments_before[i]);a(t);q=j.last_text;J=t.type;j.last_text=t.text;z+=1}e=K.get_code();te.end_with_newline&&(e+="\n");return e}}function n(t){var e=0,o=-1,i=[],n=!0;this.set_indent=function(i){e=t.baseIndentLength+i*t.indent_length;o=i};this.get_character_count=function(){return e};this.is_empty=function(){return n};this.last=function(){return this._empty?null:i[i.length-1]};this.push=function(t){i.push(t);e+=t.length;n=!1};this.remove_indent=function(){if(o>0){o-=1;e-=t.indent_length}};this.trim=function(){for(;" "===this.last();){{i.pop()}e-=1}n=0===i.length};this.toString=function(){var e="";if(!this._empty){o>=0&&(e=t.indent_cache[o]);e+=i.join("")}return e}}function r(t,e){e=e||"";this.indent_cache=[e];this.baseIndentLength=e.length;this.indent_length=t.length;var o=[];this.baseIndentString=e;this.indent_string=t;this.current_line=null;this.space_before_token=!1;this.get_line_number=function(){return o.length};this.add_new_line=function(t){if(1===this.get_line_number()&&this.just_added_newline())return!1;if(t||!this.just_added_newline()){this.current_line=new n(this);o.push(this.current_line);return!0}return!1};this.add_new_line(!0);this.get_code=function(){var t=o.join("\n").replace(/[\r\n\t ]+$/,"");return t};this.set_indent=function(t){if(o.length>1){for(;t>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);this.current_line.set_indent(t);return!0}this.current_line.set_indent(0);return!1};this.add_token=function(t){this.add_space_before_token();this.current_line.push(t)};this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" ");this.space_before_token=!1};this.remove_redundant_indentation=function(t){if(!t.multiline_frame&&t.mode!==l.ForInitializer&&t.mode!==l.Conditional)for(var e=t.start_line_index,i=o.length;i>e;){o[e].remove_indent();e++}};this.trim=function(i){i=void 0===i?!1:i;this.current_line.trim(t,e);for(;i&&o.length>1&&this.current_line.is_empty();){o.pop();this.current_line=o[o.length-1];this.current_line.trim()}};this.just_added_newline=function(){return this.current_line.is_empty()};this.just_added_blankline=function(){if(this.just_added_newline()){if(1===o.length)return!0;var t=o[o.length-2];return t.is_empty()}return!1}}function s(o,i,n){function r(){var r,v=[];u=0;h="";if(d>=y)return["","TK_EOF"];var x;x=_.length?_[_.length-1]:new g("TK_START_BLOCK","{");var b=o.charAt(d);d+=1;for(;t(b,l);){if("\n"===b){u+=1;v=[]}else u&&(b===n?v.push(n):"\r"!==b&&v.push(" "));if(d>=y)return["","TK_EOF"];b=o.charAt(d);d+=1}v.length&&(h=v.join(""));if(m.test(b)){var S=!0,A=!0,C=m;if("0"===b&&y>d&&/[Xx]/.test(o.charAt(d))){S=!1;A=!1;b+=o.charAt(d);d+=1;C=/[0123456789abcdefABCDEF]/}else{b="";d-=1}for(;y>d&&C.test(o.charAt(d));){b+=o.charAt(d);d+=1;if(S&&y>d&&"."===o.charAt(d)){b+=o.charAt(d);d+=1;S=!1}if(A&&y>d&&/[Ee]/.test(o.charAt(d))){b+=o.charAt(d);d+=1;if(y>d&&/[+-]/.test(o.charAt(d))){b+=o.charAt(d);d+=1}A=!1;S=!1}}return[b,"TK_WORD"]}if(a.isIdentifierStart(o.charCodeAt(d-1))){if(y>d)for(;a.isIdentifierChar(o.charCodeAt(d));){b+=o.charAt(d);d+=1;if(d===y)break}return"TK_DOT"===x.type||"TK_RESERVED"===x.type&&t(x.text,["set","get"])||!t(b,f)?[b,"TK_WORD"]:"in"===b?[b,"TK_OPERATOR"]:[b,"TK_RESERVED"]}if("("===b||"["===b)return[b,"TK_START_EXPR"];if(")"===b||"]"===b)return[b,"TK_END_EXPR"];if("{"===b)return[b,"TK_START_BLOCK"];if("}"===b)return[b,"TK_END_BLOCK"];if(";"===b)return[b,"TK_SEMICOLON"];if("/"===b){var E="",D=!0;if("*"===o.charAt(d)){d+=1;if(y>d)for(;y>d&&("*"!==o.charAt(d)||!o.charAt(d+1)||"/"!==o.charAt(d+1));){b=o.charAt(d);E+=b;("\n"===b||"\r"===b)&&(D=!1);d+=1;if(d>=y)break}d+=2;return D&&0===u?["/*"+E+"*/","TK_INLINE_COMMENT"]:["/*"+E+"*/","TK_BLOCK_COMMENT"]}if("/"===o.charAt(d)){E=b;for(;"\r"!==o.charAt(d)&&"\n"!==o.charAt(d);){E+=o.charAt(d);d+=1;if(d>=y)break}return[E,"TK_COMMENT"]}}if("`"===b||"'"===b||'"'===b||("/"===b||i.e4x&&"<"===b&&o.slice(d-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&("TK_RESERVED"===x.type&&t(x.text,["return","case","throw","else","do","typeof","yield"])||"TK_END_EXPR"===x.type&&")"===x.text&&x.parent&&"TK_RESERVED"===x.parent.type&&t(x.parent.text,["if","while","for"])||t(x.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var T=b,R=!1,w=!1;r=b;if("/"===T)for(var B=!1;y>d&&(R||B||o.charAt(d)!==T)&&!a.newline.test(o.charAt(d));){r+=o.charAt(d);if(R)R=!1;else{R="\\"===o.charAt(d);"["===o.charAt(d)?B=!0:"]"===o.charAt(d)&&(B=!1)}d+=1}else if(i.e4x&&"<"===T){var M=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,I=o.slice(d-1),N=M.exec(I);if(N&&0===N.index){for(var L=N[2],O=0;N;){var P=!!N[1],F=N[2],V=!!N[N.length-1]||"![CDATA["===F.slice(0,8);F!==L||V||(P?--O:++O);if(0>=O)break;N=M.exec(I)}var H=N?N.index+N[0].length:I.length;d+=H-1;return[I.slice(0,H),"TK_STRING"]}}else for(;y>d&&(R||o.charAt(d)!==T&&("`"===T||!a.newline.test(o.charAt(d))));){r+=o.charAt(d);if(R){("x"===o.charAt(d)||"u"===o.charAt(d))&&(w=!0);R=!1}else R="\\"===o.charAt(d);d+=1}w&&i.unescape_strings&&(r=s(r));if(y>d&&o.charAt(d)===T){r+=T;d+=1;if("/"===T)for(;y>d&&a.isIdentifierStart(o.charCodeAt(d));){r+=o.charAt(d);d+=1}}return[r,"TK_STRING"]}if("#"===b){if(0===_.length&&"!"===o.charAt(d)){r=b;for(;y>d&&"\n"!==b;){b=o.charAt(d);r+=b;d+=1}return[e(r)+"\n","TK_UNKNOWN"]}var k="#";if(y>d&&m.test(o.charAt(d))){do{b=o.charAt(d);k+=b;d+=1}while(y>d&&"#"!==b&&"="!==b);if("#"===b);else if("["===o.charAt(d)&&"]"===o.charAt(d+1)){k+="[]";d+=2}else if("{"===o.charAt(d)&&"}"===o.charAt(d+1)){k+="{}";d+=2}return[k,"TK_WORD"]}}if("<"===b&&"<!--"===o.substring(d-1,d+3)){d+=3;
b="<!--";for(;"\n"!==o.charAt(d)&&y>d;){b+=o.charAt(d);d++}p=!0;return[b,"TK_COMMENT"]}if("-"===b&&p&&"-->"===o.substring(d-1,d+2)){p=!1;d+=2;return["-->","TK_COMMENT"]}if("."===b)return[b,"TK_DOT"];if(t(b,c)){for(;y>d&&t(b+o.charAt(d),c);){b+=o.charAt(d);d+=1;if(d>=y)break}return","===b?[b,"TK_COMMA"]:"="===b?[b,"TK_EQUALS"]:[b,"TK_OPERATOR"]}return[b,"TK_UNKNOWN"]}function s(t){for(var e,o=!1,i="",n=0,r="",s=0;o||n<t.length;){e=t.charAt(n);n++;if(o){o=!1;if("x"===e){r=t.substr(n,2);n+=2}else{if("u"!==e){i+="\\"+e;continue}r=t.substr(n,4);n+=4}if(!r.match(/^[0123456789abcdefABCDEF]+$/))return t;s=parseInt(r,16);if(s>=0&&32>s){i+="x"===e?"\\x"+r:"\\u"+r;continue}if(34===s||39===s||92===s)i+="\\"+String.fromCharCode(s);else{if("x"===e&&s>126&&255>=s)return t;i+=String.fromCharCode(s)}}else"\\"===e?o=!0:i+=e}return i}var l="\n\r	 ".split(""),m=/[0-9]/,c="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: => <%= <% %> <?= <? ?>".split(" ");this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,yield,import,export".split(",");var u,h,p,_,d,y,f=this.line_starters.concat(["do","in","else","get","set","new","catch","finally","typeof"]);this.tokenize=function(){y=o.length;d=0;p=!1;_=[];for(var t,e,i,n=null,s=[],a=[];!e||"TK_EOF"!==e.type;){i=r();t=new g(i[1],i[0],u,h);for(;"TK_INLINE_COMMENT"===t.type||"TK_COMMENT"===t.type||"TK_BLOCK_COMMENT"===t.type||"TK_UNKNOWN"===t.type;){a.push(t);i=r();t=new g(i[1],i[0],u,h)}if(a.length){t.comments_before=a;a=[]}if("TK_START_BLOCK"===t.type||"TK_START_EXPR"===t.type){t.parent=e;n=t;s.push(t)}else if(("TK_END_BLOCK"===t.type||"TK_END_EXPR"===t.type)&&n&&("]"===t.text&&"["===n.text||")"===t.text&&"("===n.text||"}"===t.text&&"}"===n.text)){t.parent=n.parent;n=s.pop()}_.push(t);e=t}return _}}var a={};!function(t){{var e="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",o="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",i=new RegExp("["+e+"]"),n=new RegExp("["+e+o+"]");t.newline=/[\n\r\u2028\u2029]/,t.isIdentifierStart=function(t){return 65>t?36===t:91>t?!0:97>t?95===t:123>t?!0:t>=170&&i.test(String.fromCharCode(t))},t.isIdentifierChar=function(t){return 48>t?36===t:58>t?!0:65>t?!1:91>t?!0:97>t?95===t:123>t?!0:t>=170&&n.test(String.fromCharCode(t))}}}(a);var l={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},g=function(t,e,o,i){this.type=t;this.text=e;this.comments_before=[];this.newlines=o||0;this.wanted_newline=o>0;this.whitespace_before=i||"";this.parent=null};"function"==typeof define&&define.amd?define([],function(){return{js_beautify:o}}):"undefined"!=typeof exports?exports.js_beautify=o:"undefined"!=typeof window?window.js_beautify=o:"undefined"!=typeof global&&(global.js_beautify=o)}();var COMPILED=!0,goog=goog||{};goog.global=this;goog.global.CLOSURE_DEFINES;goog.exportPath_=function(t,e,o){var i=t.split("."),n=o||goog.global;i[0]in n||!n.execScript||n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)i.length||void 0===e?n=n[r]?n[r]:n[r]={}:n[r]=e};goog.define=function(t,e){var o=e;COMPILED||goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,t)&&(o=goog.global.CLOSURE_DEFINES[t]);goog.exportPath_(t,o)};goog.DEBUG=!1;goog.define("goog.LOCALE","en");goog.define("goog.TRUSTED_SITE",!0);goog.provide=function(t){if(!COMPILED){if(goog.isProvided_(t))throw Error('Namespace "'+t+'" already declared.');delete goog.implicitNamespaces_[t];for(var e=t;(e=e.substring(0,e.lastIndexOf(".")))&&!goog.getObjectByName(e);)goog.implicitNamespaces_[e]=!0}goog.exportPath_(t)};goog.setTestOnly=function(t){if(COMPILED&&!goog.DEBUG){t=t||"";throw Error(": "+t)}};if(!COMPILED){goog.isProvided_=function(t){return!goog.implicitNamespaces_[t]&&!!goog.getObjectByName(t)};goog.implicitNamespaces_={}}goog.getObjectByName=function(t,e){for(var o,i=t.split("."),n=e||goog.global;o=i.shift();){if(!goog.isDefAndNotNull(n[o]))return null;n=n[o]}return n};goog.globalize=function(t,e){var o=e||goog.global;for(var i in t)o[i]=t[i]};goog.addDependency=function(t,e,o){if(goog.DEPENDENCIES_ENABLED){for(var i,n,r=t.replace(/\\/g,"/"),s=goog.dependencies_,a=0;i=e[a];a++){s.nameToPath[i]=r;r in s.pathToNames||(s.pathToNames[r]={});s.pathToNames[r][i]=!0}for(var l=0;n=o[l];l++){r in s.requires||(s.requires[r]={});s.requires[r][n]=!0}}};goog.define("goog.ENABLE_DEBUG_LOADER",!0);goog.require=function(t){if(!COMPILED){if(goog.isProvided_(t))return;if(goog.ENABLE_DEBUG_LOADER){var e=goog.getPathFromDeps_(t);if(e){goog.included_[e]=!0;goog.writeScripts_();return}}var o="goog.require could not find: "+t;goog.global.console&&goog.global.console.error(o);throw Error(o)}};goog.basePath="";goog.global.CLOSURE_BASE_PATH;goog.global.CLOSURE_NO_DEPS;goog.global.CLOSURE_IMPORT_SCRIPT;goog.nullFunction=function(){};goog.identityFunction=function(t){return t};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(t){t.getInstance=function(){if(t.instance_)return t.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=t);return t.instance_=new t}};goog.instantiatedSingletons_=[];goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;if(goog.DEPENDENCIES_ENABLED){goog.included_={};goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}};goog.inHtmlDocument_=function(){var t=goog.global.document;return"undefined"!=typeof t&&"write"in t};goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var t=goog.global.document,e=t.getElementsByTagName("script"),o=e.length-1;o>=0;--o){var i=e[o].src,n=i.lastIndexOf("?"),r=-1==n?i.length:n;if("base.js"==i.substr(r-7,7)){goog.basePath=i.substr(0,r-7);return}}};goog.importScript_=function(t){var e=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[t]&&e(t)&&(goog.dependencies_.written[t]=!0)};goog.writeScriptTag_=function(t){if(goog.inHtmlDocument_()){var e=goog.global.document;if("complete"==e.readyState){var o=/\bdeps.js$/.test(t);if(o)return!1;throw Error('Cannot write "'+t+'" after document load')}e.write('<script type="text/javascript" src="'+t+'"></script>');return!0}return!1};goog.writeScripts_=function(){function t(n){if(!(n in i.written))if(n in i.visited){if(!(n in o)){o[n]=!0;e.push(n)}}else{i.visited[n]=!0;if(n in i.requires)for(var r in i.requires[n])if(!goog.isProvided_(r)){if(!(r in i.nameToPath))throw Error("Undefined nameToPath for "+r);t(i.nameToPath[r])}if(!(n in o)){o[n]=!0;e.push(n)}}}var e=[],o={},i=goog.dependencies_;for(var n in goog.included_)i.written[n]||t(n);for(var r=0;r<e.length;r++){if(!e[r])throw Error("Undefined script input");goog.importScript_(goog.basePath+e[r])}};goog.getPathFromDeps_=function(t){return t in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[t]:null};goog.findBasePath_();goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")}goog.typeOf=function(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var o=Object.prototype.toString.call(t);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e};goog.isDef=function(t){return void 0!==t};goog.isNull=function(t){return null===t};goog.isDefAndNotNull=function(t){return null!=t};goog.isArray=function(t){return"array"==goog.typeOf(t)};goog.isArrayLike=function(t){var e=goog.typeOf(t);return"array"==e||"object"==e&&"number"==typeof t.length};goog.isDateLike=function(t){return goog.isObject(t)&&"function"==typeof t.getFullYear};goog.isString=function(t){return"string"==typeof t};goog.isBoolean=function(t){return"boolean"==typeof t};goog.isNumber=function(t){return"number"==typeof t};goog.isFunction=function(t){return"function"==goog.typeOf(t)};goog.isObject=function(t){var e=typeof t;return"object"==e&&null!=t||"function"==e};goog.getUid=function(t){return t[goog.UID_PROPERTY_]||(t[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(t){return!!t[goog.UID_PROPERTY_]};goog.removeUid=function(t){"removeAttribute"in t&&t.removeAttribute(goog.UID_PROPERTY_);try{delete t[goog.UID_PROPERTY_]}catch(e){}};goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(t){var e=goog.typeOf(t);if("object"==e||"array"==e){if(t.clone)return t.clone();var o="array"==e?[]:{};for(var i in t)o[i]=goog.cloneObject(t[i]);return o}return t};goog.bindNative_=function(t){return t.call.apply(t.bind,arguments)};goog.bindJs_=function(t,e){if(!t)throw new Error;if(arguments.length>2){var o=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(i,o);return t.apply(e,i)}}return function(){return t.apply(e,arguments)}};goog.bind=function(){goog.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bindNative_:goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){var o=e.slice();o.push.apply(o,arguments);return t.apply(this,o)}};goog.mixin=function(t,e){for(var o in e)t[o]=e[o]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};goog.globalEval=function(t){if(goog.global.execScript)goog.global.execScript(t,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_){goog.global.eval("var _et_ = 1;");if("undefined"!=typeof goog.global._et_){delete goog.global._et_;goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(t);else{var e=goog.global.document,o=e.createElement("script");o.type="text/javascript";o.defer=!1;o.appendChild(e.createTextNode(t));e.body.appendChild(o);e.body.removeChild(o)}}};goog.evalWorksForGlobals_=null;goog.cssNameMapping_;goog.cssNameMappingStyle_;goog.getCssName=function(t,e){var o,i=function(t){return goog.cssNameMapping_[t]||t},n=function(t){for(var e=t.split("-"),o=[],n=0;n<e.length;n++)o.push(i(e[n]));return o.join("-")};o=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?i:n:function(t){return t};return e?t+"-"+o(e):o(t)};goog.setCssNameMapping=function(t,e){goog.cssNameMapping_=t;goog.cssNameMappingStyle_=e};goog.global.CLOSURE_CSS_NAME_MAPPING;!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(t,e){var o=e||{};for(var i in o){var n=(""+o[i]).replace(/\$/g,"$$$$");t=t.replace(new RegExp("\\{\\$"+i+"\\}","gi"),n)}return t};goog.getMsgWithFallback=function(t){return t};goog.exportSymbol=function(t,e,o){goog.exportPath_(t,e,o)};goog.exportProperty=function(t,e,o){t[e]=o};goog.inherits=function(t,e){function o(){}o.prototype=e.prototype;t.superClass_=e.prototype;t.prototype=new o;t.prototype.constructor=t};goog.base=function(t,e){var o=arguments.callee.caller;if(goog.DEBUG&&!o)throw Error("arguments.caller not defined.  goog.base() expects not to be running in strict mode. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(o.superClass_)return o.superClass_.constructor.apply(t,Array.prototype.slice.call(arguments,1));for(var i=Array.prototype.slice.call(arguments,2),n=!1,r=t.constructor;r;r=r.superClass_&&r.superClass_.constructor)if(r.prototype[e]===o)n=!0;else if(n)return r.prototype[e].apply(t,i);if(t[e]===o)return t.constructor.prototype[e].apply(t,i);throw Error("goog.base called from a method of one name to a method of a different name")};goog.scope=function(t){t.call(goog.global)};goog.provide("goog.string");goog.provide("goog.string.Unicode");goog.string.Unicode={NBSP:" "};goog.string.startsWith=function(t,e){return 0==t.lastIndexOf(e,0)};goog.string.endsWith=function(t,e){var o=t.length-e.length;return o>=0&&t.indexOf(e,o)==o};goog.string.caseInsensitiveStartsWith=function(t,e){return 0==goog.string.caseInsensitiveCompare(e,t.substr(0,e.length))};goog.string.caseInsensitiveEndsWith=function(t,e){return 0==goog.string.caseInsensitiveCompare(e,t.substr(t.length-e.length,e.length))};goog.string.caseInsensitiveEquals=function(t,e){return t.toLowerCase()==e.toLowerCase()};goog.string.subs=function(t){for(var e=t.split("%s"),o="",i=Array.prototype.slice.call(arguments,1);i.length&&e.length>1;)o+=e.shift()+i.shift();return o+e.join("%s")};goog.string.collapseWhitespace=function(t){return t.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmpty=function(t){return/^[\s\xa0]*$/.test(t)};goog.string.isEmptySafe=function(t){return goog.string.isEmpty(goog.string.makeSafe(t))};goog.string.isBreakingWhitespace=function(t){return!/[^\t\n\r ]/.test(t)};goog.string.isAlpha=function(t){return!/[^a-zA-Z]/.test(t)};goog.string.isNumeric=function(t){return!/[^0-9]/.test(t)};goog.string.isAlphaNumeric=function(t){return!/[^a-zA-Z0-9]/.test(t)};goog.string.isSpace=function(t){return" "==t};goog.string.isUnicodeChar=function(t){return 1==t.length&&t>=" "&&"~">=t||t>=""&&"�">=t};goog.string.stripNewlines=function(t){return t.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(t){return t.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(t){return t.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(t){return t.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(t){return t.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(t){return t.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(t){return t.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(t,e){var o=String(t).toLowerCase(),i=String(e).toLowerCase();return i>o?-1:o==i?0:1};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;goog.string.numerateCompare=function(t,e){if(t==e)return 0;if(!t)return-1;if(!e)return 1;for(var o=t.toLowerCase().match(goog.string.numerateCompareRegExp_),i=e.toLowerCase().match(goog.string.numerateCompareRegExp_),n=Math.min(o.length,i.length),r=0;n>r;r++){var s=o[r],a=i[r];if(s!=a){var l=parseInt(s,10);if(!isNaN(l)){var g=parseInt(a,10);if(!isNaN(g)&&l-g)return l-g}return a>s?-1:1}}return o.length!=i.length?o.length-i.length:e>t?-1:1};goog.string.urlEncode=function(t){return encodeURIComponent(String(t))};goog.string.urlDecode=function(t){return decodeURIComponent(t.replace(/\+/g," "))};goog.string.newLineToBr=function(t,e){return t.replace(/(\r\n|\r|\n)/g,e?"<br />":"<br>")};goog.string.htmlEscape=function(t,e){if(e)return t.replace(goog.string.amperRe_,"&amp;").replace(goog.string.ltRe_,"&lt;").replace(goog.string.gtRe_,"&gt;").replace(goog.string.quotRe_,"&quot;");if(!goog.string.allRe_.test(t))return t;-1!=t.indexOf("&")&&(t=t.replace(goog.string.amperRe_,"&amp;"));-1!=t.indexOf("<")&&(t=t.replace(goog.string.ltRe_,"&lt;"));-1!=t.indexOf(">")&&(t=t.replace(goog.string.gtRe_,"&gt;"));-1!=t.indexOf('"')&&(t=t.replace(goog.string.quotRe_,"&quot;"));return t};goog.string.amperRe_=/&/g;goog.string.ltRe_=/</g;goog.string.gtRe_=/>/g;goog.string.quotRe_=/\"/g;goog.string.allRe_=/[&<>\"]/;goog.string.unescapeEntities=function(t){return goog.string.contains(t,"&")?"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(t):goog.string.unescapePureXmlEntities_(t):t};goog.string.unescapeEntitiesUsingDom_=function(t){var e={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},o=document.createElement("div");return t.replace(goog.string.HTML_ENTITY_PATTERN_,function(t,i){var n=e[t];if(n)return n;if("#"==i.charAt(0)){var r=Number("0"+i.substr(1));isNaN(r)||(n=String.fromCharCode(r))}if(!n){o.innerHTML=t+" ";n=o.firstChild.nodeValue.slice(0,-1)}return e[t]=n})};goog.string.unescapePureXmlEntities_=function(t){return t.replace(/&([^;]+);/g,function(t,e){switch(e){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==e.charAt(0)){var o=Number("0"+e.substr(1));if(!isNaN(o))return String.fromCharCode(o)}return t}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(t,e){return goog.string.newLineToBr(t.replace(/  /g," &#160;"),e)};goog.string.stripQuotes=function(t,e){for(var o=e.length,i=0;o>i;i++){var n=1==o?e:e.charAt(i);if(t.charAt(0)==n&&t.charAt(t.length-1)==n)return t.substring(1,t.length-1)}return t};goog.string.truncate=function(t,e,o){o&&(t=goog.string.unescapeEntities(t));t.length>e&&(t=t.substring(0,e-3)+"...");o&&(t=goog.string.htmlEscape(t));return t};goog.string.truncateMiddle=function(t,e,o,i){o&&(t=goog.string.unescapeEntities(t));if(i&&t.length>e){i>e&&(i=e);var n=t.length-i,r=e-i;t=t.substring(0,r)+"..."+t.substring(n)}else if(t.length>e){var s=Math.floor(e/2),a=t.length-s;s+=e%2;t=t.substring(0,s)+"..."+t.substring(a)}o&&(t=goog.string.htmlEscape(t));return t};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};goog.string.quote=function(t){t=String(t);if(t.quote)return t.quote();for(var e=['"'],o=0;o<t.length;o++){var i=t.charAt(o),n=i.charCodeAt(0);e[o+1]=goog.string.specialEscapeChars_[i]||(n>31&&127>n?i:goog.string.escapeChar(i))}e.push('"');return e.join("")};goog.string.escapeString=function(t){for(var e=[],o=0;o<t.length;o++)e[o]=goog.string.escapeChar(t.charAt(o));return e.join("")};goog.string.escapeChar=function(t){if(t in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[t];if(t in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[t]=goog.string.specialEscapeChars_[t];var e=t,o=t.charCodeAt(0);if(o>31&&127>o)e=t;else{if(256>o){e="\\x";(16>o||o>256)&&(e+="0")}else{e="\\u";4096>o&&(e+="0")}e+=o.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[t]=e};goog.string.toMap=function(t){for(var e={},o=0;o<t.length;o++)e[t.charAt(o)]=!0;return e};goog.string.contains=function(t,e){return-1!=t.indexOf(e)};goog.string.countOf=function(t,e){return t&&e?t.split(e).length-1:0};goog.string.removeAt=function(t,e,o){var i=t;e>=0&&e<t.length&&o>0&&(i=t.substr(0,e)+t.substr(e+o,t.length-e-o));return i};goog.string.remove=function(t,e){var o=new RegExp(goog.string.regExpEscape(e),"");return t.replace(o,"")};goog.string.removeAll=function(t,e){var o=new RegExp(goog.string.regExpEscape(e),"g");return t.replace(o,"")};goog.string.regExpEscape=function(t){return String(t).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(t,e){return new Array(e+1).join(t)};goog.string.padNumber=function(t,e,o){var i=goog.isDef(o)?t.toFixed(o):String(t),n=i.indexOf(".");-1==n&&(n=i.length);return goog.string.repeat("0",Math.max(0,e-n))+i};goog.string.makeSafe=function(t){return null==t?"":String(t)};goog.string.buildString=function(){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){var t=2147483648;return Math.floor(Math.random()*t).toString(36)+Math.abs(Math.floor(Math.random()*t)^goog.now()).toString(36)};goog.string.compareVersions=function(t,e){for(var o=0,i=goog.string.trim(String(t)).split("."),n=goog.string.trim(String(e)).split("."),r=Math.max(i.length,n.length),s=0;0==o&&r>s;s++){var a=i[s]||"",l=n[s]||"",g=new RegExp("(\\d*)(\\D*)","g"),m=new RegExp("(\\d*)(\\D*)","g");do{var c=g.exec(a)||["","",""],u=m.exec(l)||["","",""];if(0==c[0].length&&0==u[0].length)break;var h=0==c[1].length?0:parseInt(c[1],10),p=0==u[1].length?0:parseInt(u[1],10);o=goog.string.compareElements_(h,p)||goog.string.compareElements_(0==c[2].length,0==u[2].length)||goog.string.compareElements_(c[2],u[2])}while(0==o)}return o};goog.string.compareElements_=function(t,e){return e>t?-1:t>e?1:0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(t){for(var e=0,o=0;o<t.length;++o){e=31*e+t.charCodeAt(o);e%=goog.string.HASHCODE_MAX_}return e};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};goog.string.toNumber=function(t){var e=Number(t);return 0==e&&goog.string.isEmpty(t)?0/0:e};goog.string.isLowerCamelCase=function(t){return/^[a-z]+([A-Z][a-z]*)*$/.test(t)};goog.string.isUpperCamelCase=function(t){return/^([A-Z][a-z]*)+$/.test(t)};goog.string.toCamelCase=function(t){return String(t).replace(/\-([a-z])/g,function(t,e){return e.toUpperCase()})};goog.string.toSelectorCase=function(t){return String(t).replace(/([A-Z])/g,"-$1").toLowerCase()};goog.string.toTitleCase=function(t,e){var o=goog.isString(e)?goog.string.regExpEscape(e):"\\s";o=o?"|["+o+"]+":"";var i=new RegExp("(^"+o+")([a-z])","g");return t.replace(i,function(t,e,o){return e+o.toUpperCase()})};goog.string.parseInt=function(t){isFinite(t)&&(t=String(t));return goog.isString(t)?/^\s*-?0x/i.test(t)?parseInt(t,16):parseInt(t,10):0/0};goog.string.splitLimit=function(t,e,o){for(var i=t.split(e),n=[];o>0&&i.length;){n.push(i.shift());o--}i.length&&n.push(i.join(e));return n};goog.provide("goog.string.format");goog.require("goog.string");goog.string.format=function(){function t(t,o,i,n,r,s){if("%"==s)return"%";var a=e.shift();if("undefined"==typeof a)throw Error("[goog.string.format] Not enough arguments");arguments[0]=a;return goog.string.format.demuxes_[s].apply(null,arguments)}var e=Array.prototype.slice.call(arguments),o=e.shift();if("undefined"==typeof o)throw Error("[goog.string.format] Template required");var i=/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g;return o.replace(i,t)};goog.string.format.demuxes_={};goog.string.format.demuxes_.s=function(t,e,o){var i=t;if(isNaN(o)||""==o||i.length>=o)return i;e.indexOf("-",0)>-1?i+=goog.string.repeat(" ",o-i.length):i=goog.string.repeat(" ",o-i.length)+i;return i};goog.string.format.demuxes_.f=function(t,e,o,i,n){var r=t.toString();isNaN(n)||""==n||(r=t.toFixed(n));var s;s=0>t?"-":e.indexOf("+")>=0?"+":e.indexOf(" ")>=0?" ":"";t>=0&&(r=s+r);if(isNaN(o)||r.length>=o)return r;r=isNaN(n)?Math.abs(t).toString():Math.abs(t).toFixed(n);var a=o-r.length-s.length;if(e.indexOf("-",0)>=0)r=s+r+goog.string.repeat(" ",a);else{var l=e.indexOf("0",0)>=0?"0":" ";r=s+goog.string.repeat(l,a)+r}return r};goog.string.format.demuxes_.d=function(t,e,o,i,n,r,s,a){return goog.string.format.demuxes_.f(parseInt(t,10),e,o,i,0,r,s,a)};goog.string.format.demuxes_.i=goog.string.format.demuxes_.d;goog.string.format.demuxes_.u=goog.string.format.demuxes_.d;goog.provide("goog.debug.Error");goog.debug.Error=function(t){Error.captureStackTrace?Error.captureStackTrace(this,goog.debug.Error):this.stack=(new Error).stack||"";t&&(this.message=String(t))};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.provide("goog.dom.NodeType");goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.provide("goog.asserts");goog.provide("goog.asserts.AssertionError");goog.require("goog.debug.Error");goog.require("goog.dom.NodeType");goog.require("goog.string");goog.define("goog.asserts.ENABLE_ASSERTS",goog.DEBUG);goog.asserts.AssertionError=function(t,e){e.unshift(t);goog.debug.Error.call(this,goog.string.subs.apply(null,e));e.shift();this.messagePattern=t};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.doAssertFailure_=function(t,e,o,i){var n="Assertion failed";if(o){n+=": "+o;var r=i}else if(t){n+=": "+t;r=e}throw new goog.asserts.AssertionError(""+n,r||[])};goog.asserts.assert=function(t,e){goog.asserts.ENABLE_ASSERTS&&!t&&goog.asserts.doAssertFailure_("",null,e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.fail=function(t){if(goog.asserts.ENABLE_ASSERTS)throw new goog.asserts.AssertionError("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))};goog.asserts.assertNumber=function(t,e){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(t)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertString=function(t,e){goog.asserts.ENABLE_ASSERTS&&!goog.isString(t)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertFunction=function(t,e){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(t)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertObject=function(t,e){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(t)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertArray=function(t,e){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(t)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertBoolean=function(t,e){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(t)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertElement=function(t,e){!goog.asserts.ENABLE_ASSERTS||goog.isObject(t)&&t.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2));return t};goog.asserts.assertInstanceof=function(t,e,o){!goog.asserts.ENABLE_ASSERTS||t instanceof e||goog.asserts.doAssertFailure_("instanceof check failed.",null,o,Array.prototype.slice.call(arguments,3));return t};goog.asserts.assertObjectPrototypeIsIntact=function(){for(var t in Object.prototype)goog.asserts.fail(t+" should not be enumerable in Object.prototype.")};goog.provide("goog.array");goog.provide("goog.array.ArrayLike");goog.require("goog.asserts");goog.define("goog.NATIVE_ARRAY_PROTOTYPES",goog.TRUSTED_SITE);goog.array.ArrayLike;goog.array.peek=function(t){return t[t.length-1]};goog.array.ARRAY_PROTOTYPE_=Array.prototype;goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.indexOf?function(t,e,o){goog.asserts.assert(null!=t.length);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(t,e,o)}:function(t,e,o){var i=null==o?0:0>o?Math.max(0,t.length+o):o;if(goog.isString(t))return goog.isString(e)&&1==e.length?t.indexOf(e,i):-1;for(var n=i;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.lastIndexOf?function(t,e,o){goog.asserts.assert(null!=t.length);var i=null==o?t.length-1:o;return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(t,e,i)}:function(t,e,o){var i=null==o?t.length-1:o;0>i&&(i=Math.max(0,t.length+i));if(goog.isString(t))return goog.isString(e)&&1==e.length?t.lastIndexOf(e,i):-1;for(var n=i;n>=0;n--)if(n in t&&t[n]===e)return n;return-1};goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.forEach?function(t,e,o){goog.asserts.assert(null!=t.length);goog.array.ARRAY_PROTOTYPE_.forEach.call(t,e,o)}:function(t,e,o){for(var i=t.length,n=goog.isString(t)?t.split(""):t,r=0;i>r;r++)r in n&&e.call(o,n[r],r,t)};goog.array.forEachRight=function(t,e,o){for(var i=t.length,n=goog.isString(t)?t.split(""):t,r=i-1;r>=0;--r)r in n&&e.call(o,n[r],r,t)};goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.filter?function(t,e,o){goog.asserts.assert(null!=t.length);return goog.array.ARRAY_PROTOTYPE_.filter.call(t,e,o)}:function(t,e,o){for(var i=t.length,n=[],r=0,s=goog.isString(t)?t.split(""):t,a=0;i>a;a++)if(a in s){var l=s[a];e.call(o,l,a,t)&&(n[r++]=l)}return n};goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.map?function(t,e,o){goog.asserts.assert(null!=t.length);return goog.array.ARRAY_PROTOTYPE_.map.call(t,e,o)}:function(t,e,o){for(var i=t.length,n=new Array(i),r=goog.isString(t)?t.split(""):t,s=0;i>s;s++)s in r&&(n[s]=e.call(o,r[s],s,t));return n};goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.reduce?function(t,e,o,i){goog.asserts.assert(null!=t.length);i&&(e=goog.bind(e,i));return goog.array.ARRAY_PROTOTYPE_.reduce.call(t,e,o)}:function(t,e,o,i){var n=o;goog.array.forEach(t,function(o,r){n=e.call(i,n,o,r,t)});return n};goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.reduceRight?function(t,e,o,i){goog.asserts.assert(null!=t.length);i&&(e=goog.bind(e,i));return goog.array.ARRAY_PROTOTYPE_.reduceRight.call(t,e,o)}:function(t,e,o,i){var n=o;goog.array.forEachRight(t,function(o,r){n=e.call(i,n,o,r,t)});return n};goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.some?function(t,e,o){goog.asserts.assert(null!=t.length);return goog.array.ARRAY_PROTOTYPE_.some.call(t,e,o)}:function(t,e,o){for(var i=t.length,n=goog.isString(t)?t.split(""):t,r=0;i>r;r++)if(r in n&&e.call(o,n[r],r,t))return!0;return!1};goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.every?function(t,e,o){goog.asserts.assert(null!=t.length);return goog.array.ARRAY_PROTOTYPE_.every.call(t,e,o)}:function(t,e,o){for(var i=t.length,n=goog.isString(t)?t.split(""):t,r=0;i>r;r++)if(r in n&&!e.call(o,n[r],r,t))return!1;return!0};goog.array.count=function(t,e,o){var i=0;goog.array.forEach(t,function(t,n,r){e.call(o,t,n,r)&&++i},o);return i};goog.array.find=function(t,e,o){var i=goog.array.findIndex(t,e,o);return 0>i?null:goog.isString(t)?t.charAt(i):t[i]};goog.array.findIndex=function(t,e,o){for(var i=t.length,n=goog.isString(t)?t.split(""):t,r=0;i>r;r++)if(r in n&&e.call(o,n[r],r,t))return r;return-1};goog.array.findRight=function(t,e,o){var i=goog.array.findIndexRight(t,e,o);return 0>i?null:goog.isString(t)?t.charAt(i):t[i]};goog.array.findIndexRight=function(t,e,o){for(var i=t.length,n=goog.isString(t)?t.split(""):t,r=i-1;r>=0;r--)if(r in n&&e.call(o,n[r],r,t))return r;return-1
};goog.array.contains=function(t,e){return goog.array.indexOf(t,e)>=0};goog.array.isEmpty=function(t){return 0==t.length};goog.array.clear=function(t){if(!goog.isArray(t))for(var e=t.length-1;e>=0;e--)delete t[e];t.length=0};goog.array.insert=function(t,e){goog.array.contains(t,e)||t.push(e)};goog.array.insertAt=function(t,e,o){goog.array.splice(t,o,0,e)};goog.array.insertArrayAt=function(t,e,o){goog.partial(goog.array.splice,t,o,0).apply(null,e)};goog.array.insertBefore=function(t,e,o){var i;2==arguments.length||(i=goog.array.indexOf(t,o))<0?t.push(e):goog.array.insertAt(t,e,i)};goog.array.remove=function(t,e){var o,i=goog.array.indexOf(t,e);(o=i>=0)&&goog.array.removeAt(t,i);return o};goog.array.removeAt=function(t,e){goog.asserts.assert(null!=t.length);return 1==goog.array.ARRAY_PROTOTYPE_.splice.call(t,e,1).length};goog.array.removeIf=function(t,e,o){var i=goog.array.findIndex(t,e,o);if(i>=0){goog.array.removeAt(t,i);return!0}return!1};goog.array.concat=function(){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(t){var e=t.length;if(e>0){for(var o=new Array(e),i=0;e>i;i++)o[i]=t[i];return o}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(t){for(var e=1;e<arguments.length;e++){var o,i=arguments[e];if(goog.isArray(i)||(o=goog.isArrayLike(i))&&Object.prototype.hasOwnProperty.call(i,"callee"))t.push.apply(t,i);else if(o)for(var n=t.length,r=i.length,s=0;r>s;s++)t[n+s]=i[s];else t.push(i)}};goog.array.splice=function(t){goog.asserts.assert(null!=t.length);return goog.array.ARRAY_PROTOTYPE_.splice.apply(t,goog.array.slice(arguments,1))};goog.array.slice=function(t,e,o){goog.asserts.assert(null!=t.length);return arguments.length<=2?goog.array.ARRAY_PROTOTYPE_.slice.call(t,e):goog.array.ARRAY_PROTOTYPE_.slice.call(t,e,o)};goog.array.removeDuplicates=function(t,e,o){for(var i=e||t,n=function(){return goog.isObject(g)?"o"+goog.getUid(g):(typeof g).charAt(0)+g},r=o||n,s={},a=0,l=0;l<t.length;){var g=t[l++],m=r(g);if(!Object.prototype.hasOwnProperty.call(s,m)){s[m]=!0;i[a++]=g}}i.length=a};goog.array.binarySearch=function(t,e,o){return goog.array.binarySearch_(t,o||goog.array.defaultCompare,!1,e)};goog.array.binarySelect=function(t,e,o){return goog.array.binarySearch_(t,e,!0,void 0,o)};goog.array.binarySearch_=function(t,e,o,i,n){for(var r,s=0,a=t.length;a>s;){var l,g=s+a>>1;l=o?e.call(n,t[g],g,t):e(i,t[g]);if(l>0)s=g+1;else{a=g;r=!l}}return r?s:~s};goog.array.sort=function(t,e){goog.asserts.assert(null!=t.length);goog.array.ARRAY_PROTOTYPE_.sort.call(t,e||goog.array.defaultCompare)};goog.array.stableSort=function(t,e){function o(t,e){return n(t.value,e.value)||t.index-e.index}for(var i=0;i<t.length;i++)t[i]={index:i,value:t[i]};var n=e||goog.array.defaultCompare;goog.array.sort(t,o);for(var i=0;i<t.length;i++)t[i]=t[i].value};goog.array.sortObjectsByKey=function(t,e,o){var i=o||goog.array.defaultCompare;goog.array.sort(t,function(t,o){return i(t[e],o[e])})};goog.array.isSorted=function(t,e,o){for(var i=e||goog.array.defaultCompare,n=1;n<t.length;n++){var r=i(t[n-1],t[n]);if(r>0||0==r&&o)return!1}return!0};goog.array.equals=function(t,e,o){if(!goog.isArrayLike(t)||!goog.isArrayLike(e)||t.length!=e.length)return!1;for(var i=t.length,n=o||goog.array.defaultCompareEquality,r=0;i>r;r++)if(!n(t[r],e[r]))return!1;return!0};goog.array.compare=function(t,e,o){return goog.array.equals(t,e,o)};goog.array.compare3=function(t,e,o){for(var i=o||goog.array.defaultCompare,n=Math.min(t.length,e.length),r=0;n>r;r++){var s=i(t[r],e[r]);if(0!=s)return s}return goog.array.defaultCompare(t.length,e.length)};goog.array.defaultCompare=function(t,e){return t>e?1:e>t?-1:0};goog.array.defaultCompareEquality=function(t,e){return t===e};goog.array.binaryInsert=function(t,e,o){var i=goog.array.binarySearch(t,e,o);if(0>i){goog.array.insertAt(t,e,-(i+1));return!0}return!1};goog.array.binaryRemove=function(t,e,o){var i=goog.array.binarySearch(t,e,o);return i>=0?goog.array.removeAt(t,i):!1};goog.array.bucket=function(t,e,o){for(var i={},n=0;n<t.length;n++){var r=t[n],s=e.call(o,r,n,t);if(goog.isDef(s)){var a=i[s]||(i[s]=[]);a.push(r)}}return i};goog.array.toObject=function(t,e,o){var i={};goog.array.forEach(t,function(n,r){i[e.call(o,n,r,t)]=n});return i};goog.array.range=function(t,e,o){var i=[],n=0,r=t,s=o||1;if(void 0!==e){n=t;r=e}if(0>s*(r-n))return[];if(s>0)for(var a=n;r>a;a+=s)i.push(a);else for(var a=n;a>r;a+=s)i.push(a);return i};goog.array.repeat=function(t,e){for(var o=[],i=0;e>i;i++)o[i]=t;return o};goog.array.flatten=function(){for(var t=[],e=0;e<arguments.length;e++){var o=arguments[e];goog.isArray(o)?t.push.apply(t,goog.array.flatten.apply(null,o)):t.push(o)}return t};goog.array.rotate=function(t,e){goog.asserts.assert(null!=t.length);if(t.length){e%=t.length;e>0?goog.array.ARRAY_PROTOTYPE_.unshift.apply(t,t.splice(-e,e)):0>e&&goog.array.ARRAY_PROTOTYPE_.push.apply(t,t.splice(0,-e))}return t};goog.array.moveItem=function(t,e,o){goog.asserts.assert(e>=0&&e<t.length);goog.asserts.assert(o>=0&&o<t.length);var i=goog.array.ARRAY_PROTOTYPE_.splice.call(t,e,1);goog.array.ARRAY_PROTOTYPE_.splice.call(t,o,0,i[0])};goog.array.zip=function(){if(!arguments.length)return[];for(var t=[],e=0;!0;e++){for(var o=[],i=0;i<arguments.length;i++){var n=arguments[i];if(e>=n.length)return t;o.push(n[e])}t.push(o)}};goog.array.shuffle=function(t,e){for(var o=e||Math.random,i=t.length-1;i>0;i--){var n=Math.floor(o()*(i+1)),r=t[i];t[i]=t[n];t[n]=r}};goog.provide("goog.debug.EntryPointMonitor");goog.provide("goog.debug.entryPointRegistry");goog.require("goog.asserts");goog.debug.EntryPointMonitor=function(){};goog.debug.EntryPointMonitor.prototype.wrap;goog.debug.EntryPointMonitor.prototype.unwrap;goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=!1;goog.debug.entryPointRegistry.register=function(t){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=t;if(goog.debug.entryPointRegistry.monitorsMayExist_)for(var e=goog.debug.entryPointRegistry.monitors_,o=0;o<e.length;o++)t(goog.bind(e[o].wrap,e[o]))};goog.debug.entryPointRegistry.monitorAll=function(t){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var e=goog.bind(t.wrap,t),o=0;o<goog.debug.entryPointRegistry.refList_.length;o++)goog.debug.entryPointRegistry.refList_[o](e);goog.debug.entryPointRegistry.monitors_.push(t)};goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(t){var e=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(t==e[e.length-1],"Only the most recent monitor can be unwrapped.");for(var o=goog.bind(t.unwrap,t),i=0;i<goog.debug.entryPointRegistry.refList_.length;i++)goog.debug.entryPointRegistry.refList_[i](o);e.length--};goog.provide("goog.userAgent");goog.require("goog.string");goog.define("goog.userAgent.ASSUME_IE",!1);goog.define("goog.userAgent.ASSUME_GECKO",!1);goog.define("goog.userAgent.ASSUME_WEBKIT",!1);goog.define("goog.userAgent.ASSUME_MOBILE_WEBKIT",!1);goog.define("goog.userAgent.ASSUME_OPERA",!1);goog.define("goog.userAgent.ASSUME_ANY_VERSION",!1);goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.global.navigator?goog.global.navigator.userAgent:null};goog.userAgent.getNavigator=function(){return goog.global.navigator};goog.userAgent.init_=function(){goog.userAgent.detectedOpera_=!1;goog.userAgent.detectedIe_=!1;goog.userAgent.detectedWebkit_=!1;goog.userAgent.detectedMobile_=!1;goog.userAgent.detectedGecko_=!1;var t;if(!goog.userAgent.BROWSER_KNOWN_&&(t=goog.userAgent.getUserAgentString())){var e=goog.userAgent.getNavigator();goog.userAgent.detectedOpera_=goog.string.startsWith(t,"Opera");goog.userAgent.detectedIe_=!goog.userAgent.detectedOpera_&&(goog.string.contains(t,"MSIE")||goog.string.contains(t,"Trident"));goog.userAgent.detectedWebkit_=!goog.userAgent.detectedOpera_&&goog.string.contains(t,"WebKit");goog.userAgent.detectedMobile_=goog.userAgent.detectedWebkit_&&goog.string.contains(t,"Mobile");goog.userAgent.detectedGecko_=!goog.userAgent.detectedOpera_&&!goog.userAgent.detectedWebkit_&&!goog.userAgent.detectedIe_&&"Gecko"==e.product}};goog.userAgent.BROWSER_KNOWN_||goog.userAgent.init_();goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.userAgent.detectedOpera_;goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.userAgent.detectedIe_;goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.userAgent.detectedGecko_;goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.userAgent.detectedWebkit_;goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.detectedMobile_;goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var t=goog.userAgent.getNavigator();return t&&t.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.define("goog.userAgent.ASSUME_MAC",!1);goog.define("goog.userAgent.ASSUME_WINDOWS",!1);goog.define("goog.userAgent.ASSUME_LINUX",!1);goog.define("goog.userAgent.ASSUME_X11",!1);goog.define("goog.userAgent.ASSUME_ANDROID",!1);goog.define("goog.userAgent.ASSUME_IPHONE",!1);goog.define("goog.userAgent.ASSUME_IPAD",!1);goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD;goog.userAgent.initPlatform_=function(){goog.userAgent.detectedMac_=goog.string.contains(goog.userAgent.PLATFORM,"Mac");goog.userAgent.detectedWindows_=goog.string.contains(goog.userAgent.PLATFORM,"Win");goog.userAgent.detectedLinux_=goog.string.contains(goog.userAgent.PLATFORM,"Linux");goog.userAgent.detectedX11_=!!goog.userAgent.getNavigator()&&goog.string.contains(goog.userAgent.getNavigator().appVersion||"","X11");var t=goog.userAgent.getUserAgentString();goog.userAgent.detectedAndroid_=!!t&&goog.string.contains(t,"Android");goog.userAgent.detectedIPhone_=!!t&&goog.string.contains(t,"iPhone");goog.userAgent.detectedIPad_=!!t&&goog.string.contains(t,"iPad")};goog.userAgent.PLATFORM_KNOWN_||goog.userAgent.initPlatform_();goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.userAgent.detectedMac_;goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.userAgent.detectedWindows_;goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.detectedLinux_;goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.detectedX11_;goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.userAgent.detectedAndroid_;goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.userAgent.detectedIPhone_;goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.userAgent.detectedIPad_;goog.userAgent.determineVersion_=function(){var t,e="";if(goog.userAgent.OPERA&&goog.global.opera){var o=goog.global.opera.version;e="function"==typeof o?o():o}else{goog.userAgent.GECKO?t=/rv\:([^\);]+)(\)|;)/:goog.userAgent.IE?t=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:goog.userAgent.WEBKIT&&(t=/WebKit\/(\S+)/);if(t){var i=t.exec(goog.userAgent.getUserAgentString());e=i?i[1]:""}}if(goog.userAgent.IE){var n=goog.userAgent.getDocumentMode_();if(n>parseFloat(e))return String(n)}return e};goog.userAgent.getDocumentMode_=function(){var t=goog.global.document;return t?t.documentMode:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(t,e){return goog.string.compareVersions(t,e)};goog.userAgent.isVersionOrHigherCache_={};goog.userAgent.isVersionOrHigher=function(t){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionOrHigherCache_[t]||(goog.userAgent.isVersionOrHigherCache_[t]=goog.string.compareVersions(goog.userAgent.VERSION,t)>=0)};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;goog.userAgent.isDocumentModeOrHigher=function(t){return goog.userAgent.IE&&goog.userAgent.DOCUMENT_MODE>=t};goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;goog.userAgent.DOCUMENT_MODE=function(){var t=goog.global.document;if(!t||!goog.userAgent.IE)return void 0;var e=goog.userAgent.getDocumentMode_();return e||("CSS1Compat"==t.compatMode?parseInt(goog.userAgent.VERSION,10):5)}();goog.provide("goog.events.BrowserFeature");goog.require("goog.userAgent");goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints)};goog.provide("goog.disposable.IDisposable");goog.disposable.IDisposable=function(){};goog.disposable.IDisposable.prototype.dispose;goog.disposable.IDisposable.prototype.isDisposed;goog.provide("goog.Disposable");goog.provide("goog.dispose");goog.provide("goog.disposeAll");goog.require("goog.disposable.IDisposable");goog.Disposable=function(){if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF){goog.Disposable.INCLUDE_STACK_ON_CREATION&&(this.creationStack=(new Error).stack);goog.Disposable.instances_[goog.getUid(this)]=this}};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.define("goog.Disposable.MONITORING_MODE",0);goog.define("goog.Disposable.INCLUDE_STACK_ON_CREATION",!0);goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var t=[];for(var e in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(e)&&t.push(goog.Disposable.instances_[Number(e)]);return t};goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=!1;goog.Disposable.prototype.onDisposeCallbacks_;goog.Disposable.prototype.creationStack;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;goog.Disposable.prototype.dispose=function(){if(!this.disposed_){this.disposed_=!0;this.disposeInternal();if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF){var t=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(t))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete goog.Disposable.instances_[t]}}};goog.Disposable.prototype.registerDisposable=function(t){this.addOnDisposeCallback(goog.partial(goog.dispose,t))};goog.Disposable.prototype.addOnDisposeCallback=function(t,e){this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]);this.onDisposeCallbacks_.push(goog.bind(t,e))};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()};goog.Disposable.isDisposed=function(t){return t&&"function"==typeof t.isDisposed?t.isDisposed():!1};goog.dispose=function(t){t&&"function"==typeof t.dispose&&t.dispose()};goog.disposeAll=function(){for(var t=0,e=arguments.length;e>t;++t){var o=arguments[t];goog.isArrayLike(o)?goog.disposeAll.apply(null,o):goog.dispose(o)}};goog.provide("goog.events.Event");goog.provide("goog.events.EventLike");goog.require("goog.Disposable");goog.events.EventLike;goog.events.Event=function(t,e){this.type=t;this.target=e;this.currentTarget=this.target};goog.events.Event.prototype.disposeInternal=function(){};goog.events.Event.prototype.dispose=function(){};goog.events.Event.prototype.propagationStopped_=!1;goog.events.Event.prototype.defaultPrevented=!1;goog.events.Event.prototype.returnValue_=!0;goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0};goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};goog.events.Event.stopPropagation=function(t){t.stopPropagation()};goog.events.Event.preventDefault=function(t){t.preventDefault()};goog.provide("goog.events.EventType");goog.require("goog.userAgent");goog.events.getVendorPrefixedName_=function(t){return goog.userAgent.WEBKIT?"webkit"+t:goog.userAgent.OPERA?"o"+t.toLowerCase():t.toLowerCase()};goog.events.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",ANIMATIONSTART:goog.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:goog.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:goog.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:goog.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXTINPUT:"textinput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange"};goog.provide("goog.reflect");goog.reflect.object=function(t,e){return e};goog.reflect.sinkValue=function(t){goog.reflect.sinkValue[" "](t);return t};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(t,e){try{goog.reflect.sinkValue(t[e]);return!0}catch(o){}return!1};goog.provide("goog.events.BrowserEvent");goog.provide("goog.events.BrowserEvent.MouseButton");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Event");goog.require("goog.events.EventType");goog.require("goog.reflect");goog.require("goog.userAgent");goog.events.BrowserEvent=function(t,e){t&&this.init(t,e)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];goog.events.BrowserEvent.prototype.target=null;goog.events.BrowserEvent.prototype.currentTarget;goog.events.BrowserEvent.prototype.relatedTarget=null;goog.events.BrowserEvent.prototype.offsetX=0;goog.events.BrowserEvent.prototype.offsetY=0;goog.events.BrowserEvent.prototype.clientX=0;goog.events.BrowserEvent.prototype.clientY=0;goog.events.BrowserEvent.prototype.screenX=0;goog.events.BrowserEvent.prototype.screenY=0;goog.events.BrowserEvent.prototype.button=0;goog.events.BrowserEvent.prototype.keyCode=0;goog.events.BrowserEvent.prototype.charCode=0;goog.events.BrowserEvent.prototype.ctrlKey=!1;goog.events.BrowserEvent.prototype.altKey=!1;goog.events.BrowserEvent.prototype.shiftKey=!1;goog.events.BrowserEvent.prototype.metaKey=!1;goog.events.BrowserEvent.prototype.state;goog.events.BrowserEvent.prototype.platformModifierKey=!1;goog.events.BrowserEvent.prototype.event_=null;goog.events.BrowserEvent.prototype.init=function(t,e){var o=this.type=t.type;goog.events.Event.call(this,o);this.target=t.target||t.srcElement;this.currentTarget=e;var i=t.relatedTarget;i?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(i,"nodeName")||(i=null)):o==goog.events.EventType.MOUSEOVER?i=t.fromElement:o==goog.events.EventType.MOUSEOUT&&(i=t.toElement);this.relatedTarget=i;this.offsetX=goog.userAgent.WEBKIT||void 0!==t.offsetX?t.offsetX:t.layerX;this.offsetY=goog.userAgent.WEBKIT||void 0!==t.offsetY?t.offsetY:t.layerY;this.clientX=void 0!==t.clientX?t.clientX:t.pageX;this.clientY=void 0!==t.clientY?t.clientY:t.pageY;this.screenX=t.screenX||0;this.screenY=t.screenY||0;this.button=t.button;this.keyCode=t.keyCode||0;this.charCode=t.charCode||("keypress"==o?t.keyCode:0);this.ctrlKey=t.ctrlKey;this.altKey=t.altKey;this.shiftKey=t.shiftKey;this.metaKey=t.metaKey;this.platformModifierKey=goog.userAgent.MAC?t.metaKey:t.ctrlKey;this.state=t.state;this.event_=t;t.defaultPrevented&&this.preventDefault();delete this.propagationStopped_};goog.events.BrowserEvent.prototype.isButton=function(t){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==t:"click"==this.type?t==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[t])};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var t=this.event_;if(t.preventDefault)t.preventDefault();else{t.returnValue=!1;if(goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{var e=112,o=123;(t.ctrlKey||t.keyCode>=e&&t.keyCode<=o)&&(t.keyCode=-1)}catch(i){}}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.prototype.disposeInternal=function(){};goog.provide("goog.events.EventId");goog.events.EventId=function(t){this.id=t};goog.events.EventId.prototype.toString=function(){return this.id};goog.provide("goog.events.Listenable");goog.provide("goog.events.ListenableKey");goog.require("goog.events.EventId");goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1e6*Math.random()|0);goog.events.Listenable.addImplementation=function(t){t.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0};goog.events.Listenable.isImplementedBy=function(t){try{return!(!t||!t[goog.events.Listenable.IMPLEMENTED_BY_PROP])}catch(e){return!1}};goog.events.Listenable.prototype.listen;goog.events.Listenable.prototype.listenOnce;goog.events.Listenable.prototype.unlisten;goog.events.Listenable.prototype.unlistenByKey;goog.events.Listenable.prototype.dispatchEvent;goog.events.Listenable.prototype.removeAllListeners;goog.events.Listenable.prototype.getParentEventTarget;goog.events.Listenable.prototype.fireListeners;goog.events.Listenable.prototype.getListeners;goog.events.Listenable.prototype.getListener;goog.events.Listenable.prototype.hasListener;goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.ListenableKey.prototype.src;goog.events.ListenableKey.prototype.type;goog.events.ListenableKey.prototype.listener;goog.events.ListenableKey.prototype.capture;goog.events.ListenableKey.prototype.handler;goog.events.ListenableKey.prototype.key;goog.provide("goog.events.Listenable");goog.provide("goog.events.ListenableKey");goog.require("goog.events.EventId");goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1e6*Math.random()|0);goog.events.Listenable.addImplementation=function(t){t.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0};goog.events.Listenable.isImplementedBy=function(t){try{return!(!t||!t[goog.events.Listenable.IMPLEMENTED_BY_PROP])}catch(e){return!1}};goog.events.Listenable.prototype.listen;goog.events.Listenable.prototype.listenOnce;goog.events.Listenable.prototype.unlisten;goog.events.Listenable.prototype.unlistenByKey;goog.events.Listenable.prototype.dispatchEvent;goog.events.Listenable.prototype.removeAllListeners;goog.events.Listenable.prototype.getParentEventTarget;goog.events.Listenable.prototype.fireListeners;goog.events.Listenable.prototype.getListeners;goog.events.Listenable.prototype.getListener;goog.events.Listenable.prototype.hasListener;goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.ListenableKey.prototype.src;goog.events.ListenableKey.prototype.type;goog.events.ListenableKey.prototype.listener;goog.events.ListenableKey.prototype.capture;goog.events.ListenableKey.prototype.handler;goog.events.ListenableKey.prototype.key;goog.provide("goog.events.Listener");goog.require("goog.events.ListenableKey");goog.events.Listener=function(t,e,o,i,n,r){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=(new Error).stack);this.listener=t;this.proxy=e;this.src=o;this.type=i;this.capture=!!n;this.handler=r;this.key=goog.events.ListenableKey.reserveKey();this.callOnce=!1;this.removed=!1};goog.define("goog.events.Listener.ENABLE_MONITORING",!1);goog.events.Listener.prototype.creationStack;goog.events.Listener.prototype.markAsRemoved=function(){this.removed=!0;this.listener=null;this.proxy=null;this.src=null;this.handler=null};goog.provide("goog.object");goog.object.forEach=function(t,e,o){for(var i in t)e.call(o,t[i],i,t)};goog.object.filter=function(t,e,o){var i={};for(var n in t)e.call(o,t[n],n,t)&&(i[n]=t[n]);return i};goog.object.map=function(t,e,o){var i={};for(var n in t)i[n]=e.call(o,t[n],n,t);return i};goog.object.some=function(t,e,o){for(var i in t)if(e.call(o,t[i],i,t))return!0;return!1};goog.object.every=function(t,e,o){for(var i in t)if(!e.call(o,t[i],i,t))return!1;return!0};goog.object.getCount=function(t){var e=0;for(var o in t)e++;return e};goog.object.getAnyKey=function(t){for(var e in t)return e};goog.object.getAnyValue=function(t){for(var e in t)return t[e]};goog.object.contains=function(t,e){return goog.object.containsValue(t,e)};goog.object.getValues=function(t){var e=[],o=0;for(var i in t)e[o++]=t[i];return e};goog.object.getKeys=function(t){var e=[],o=0;for(var i in t)e[o++]=i;return e};goog.object.getValueByKeys=function(t,e){for(var o=goog.isArrayLike(e),i=o?e:arguments,n=o?0:1;n<i.length;n++){t=t[i[n]];if(!goog.isDef(t))break}return t};goog.object.containsKey=function(t,e){return e in t};goog.object.containsValue=function(t,e){for(var o in t)if(t[o]==e)return!0;return!1};goog.object.findKey=function(t,e,o){for(var i in t)if(e.call(o,t[i],i,t))return i;return void 0};goog.object.findValue=function(t,e,o){var i=goog.object.findKey(t,e,o);return i&&t[i]};goog.object.isEmpty=function(t){for(var e in t)return!1;return!0};goog.object.clear=function(t){for(var e in t)delete t[e]};goog.object.remove=function(t,e){var o;(o=e in t)&&delete t[e];return o};goog.object.add=function(t,e,o){if(e in t)throw Error('The object already contains the key "'+e+'"');goog.object.set(t,e,o)};goog.object.get=function(t,e,o){return e in t?t[e]:o};goog.object.set=function(t,e,o){t[e]=o};goog.object.setIfUndefined=function(t,e,o){return e in t?t[e]:t[e]=o};goog.object.clone=function(t){var e={};for(var o in t)e[o]=t[o];return e};goog.object.unsafeClone=function(t){var e=goog.typeOf(t);if("object"==e||"array"==e){if(t.clone)return t.clone();var o="array"==e?[]:{};for(var i in t)o[i]=goog.object.unsafeClone(t[i]);return o}return t};goog.object.transpose=function(t){var e={};for(var o in t)e[t[o]]=o;return e};goog.object.PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.object.extend=function(t){for(var e,o,i=1;i<arguments.length;i++){o=arguments[i];for(e in o)t[e]=o[e];for(var n=0;n<goog.object.PROTOTYPE_FIELDS_.length;n++){e=goog.object.PROTOTYPE_FIELDS_[n];Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])}}};goog.object.create=function(){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(t%2)throw Error("Uneven number of arguments");for(var e={},o=0;t>o;o+=2)e[arguments[o]]=arguments[o+1];return e};goog.object.createSet=function(){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var e={},o=0;t>o;o++)e[arguments[o]]=!0;return e};goog.object.createImmutableView=function(t){var e=t;if(Object.isFrozen&&!Object.isFrozen(t)){e=Object.create(t);Object.freeze(e)}return e};goog.object.isImmutableView=function(t){return!!Object.isFrozen&&Object.isFrozen(t)};goog.provide("goog.events.ListenerMap");goog.require("goog.array");goog.require("goog.events.Listener");goog.require("goog.object");goog.events.ListenerMap=function(t){this.src=t;this.listeners={};this.typeCount_=0};goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_};goog.events.ListenerMap.prototype.getListenerCount=function(){var t=0;for(var e in this.listeners)t+=this.listeners[e].length;return t};goog.events.ListenerMap.prototype.add=function(t,e,o,i,n){var r=this.listeners[t];if(!r){r=this.listeners[t]=[];this.typeCount_++}var s,a=goog.events.ListenerMap.findListenerIndex_(r,e,i,n);if(a>-1){s=r[a];o||(s.callOnce=!1)}else{s=new goog.events.Listener(e,null,this.src,t,!!i,n);s.callOnce=o;r.push(s)}return s};goog.events.ListenerMap.prototype.remove=function(t,e,o,i){if(!(t in this.listeners))return!1;var n=this.listeners[t],r=goog.events.ListenerMap.findListenerIndex_(n,e,o,i);if(r>-1){var s=n[r];s.markAsRemoved();goog.array.removeAt(n,r);if(0==n.length){delete this.listeners[t];this.typeCount_--}return!0}return!1};goog.events.ListenerMap.prototype.removeByKey=function(t){var e=t.type;
if(!(e in this.listeners))return!1;var o=goog.array.remove(this.listeners[e],t);if(o){t.markAsRemoved();if(0==this.listeners[e].length){delete this.listeners[e];this.typeCount_--}}return o};goog.events.ListenerMap.prototype.removeAll=function(t){var e=0;for(var o in this.listeners)if(!t||o==t){for(var i=this.listeners[o],n=0;n<i.length;n++){++e;i[n].markAsRemoved()}delete this.listeners[o];this.typeCount_--}return e};goog.events.ListenerMap.prototype.getListeners=function(t,e){var o=this.listeners[t],i=[];if(o)for(var n=0;n<o.length;++n){var r=o[n];r.capture==e&&i.push(r)}return i};goog.events.ListenerMap.prototype.getListener=function(t,e,o,i){var n=this.listeners[t],r=-1;n&&(r=goog.events.ListenerMap.findListenerIndex_(n,e,o,i));return r>-1?n[r]:null};goog.events.ListenerMap.prototype.hasListener=function(t,e){var o=goog.isDef(t),i=goog.isDef(e);return goog.object.some(this.listeners,function(n){for(var r=0;r<n.length;++r)if(!(o&&n[r].type!=t||i&&n[r].capture!=e))return!0;return!1})};goog.events.ListenerMap.findListenerIndex_=function(t,e,o,i){for(var n=0;n<t.length;++n){var r=t[n];if(!r.removed&&r.listener==e&&r.capture==!!o&&r.handler==i)return n}return-1};goog.provide("goog.events");goog.provide("goog.events.CaptureSimulationMode");goog.provide("goog.events.Key");goog.provide("goog.events.ListenableType");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.debug.entryPointRegistry");goog.require("goog.events.BrowserEvent");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Listenable");goog.require("goog.events.ListenerMap");goog.events.Key;goog.events.ListenableType;goog.events.listeners_={};goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1e6*Math.random()|0);goog.events.onString_="on";goog.events.onStringMap_={};goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2};goog.define("goog.events.CAPTURE_SIMULATION_MODE",2);goog.events.listenerCountEstimate_=0;goog.events.listen=function(t,e,o,i,n){if(goog.isArray(e)){for(var r=0;r<e.length;r++)goog.events.listen(t,e[r],o,i,n);return null}o=goog.events.wrapListener_(o);return goog.events.Listenable.isImplementedBy(t)?t.listen(e,o,i,n):goog.events.listen_(t,e,o,!1,i,n)};goog.events.listen_=function(t,e,o,i,n,r){if(!e)throw Error("Invalid event type");var s=!!n;if(s&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL){goog.asserts.fail("Can not register capture listener in IE8-.");return null}if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT)return null}var a=goog.events.getListenerMap_(t);a||(t[goog.events.LISTENER_MAP_PROP_]=a=new goog.events.ListenerMap(t));var l=a.add(e,o,i,n,r);if(l.proxy)return l;var g=goog.events.getProxy();l.proxy=g;g.src=t;g.listener=l;t.addEventListener?t.addEventListener(e,g,s):t.attachEvent(goog.events.getOnString_(e),g);goog.events.listenerCountEstimate_++;return l};goog.events.getProxy=function(){var t=goog.events.handleBrowserEvent_,e=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(o){return t.call(e.src,e.listener,o)}:function(o){var i=t.call(e.src,e.listener,o);return i?void 0:i};return e};goog.events.listenOnce=function(t,e,o,i,n){if(goog.isArray(e)){for(var r=0;r<e.length;r++)goog.events.listenOnce(t,e[r],o,i,n);return null}o=goog.events.wrapListener_(o);return goog.events.Listenable.isImplementedBy(t)?t.listenOnce(e,o,i,n):goog.events.listen_(t,e,o,!0,i,n)};goog.events.listenWithWrapper=function(t,e,o,i,n){e.listen(t,o,i,n)};goog.events.unlisten=function(t,e,o,i,n){if(goog.isArray(e)){for(var r=0;r<e.length;r++)goog.events.unlisten(t,e[r],o,i,n);return null}o=goog.events.wrapListener_(o);if(goog.events.Listenable.isImplementedBy(t))return t.unlisten(e,o,i,n);if(!t)return!1;var s=!!i,a=goog.events.getListenerMap_(t);if(a){var l=a.getListener(e,o,s,n);if(l)return goog.events.unlistenByKey(l)}return!1};goog.events.unlistenByKey=function(t){if(goog.isNumber(t))return!1;var e=t;if(!e||e.removed)return!1;var o=e.src;if(goog.events.Listenable.isImplementedBy(o))return o.unlistenByKey(e);var i=e.type,n=e.proxy;o.removeEventListener?o.removeEventListener(i,n,e.capture):o.detachEvent&&o.detachEvent(goog.events.getOnString_(i),n);goog.events.listenerCountEstimate_--;var r=goog.events.getListenerMap_(o);if(r){r.removeByKey(e);if(0==r.getTypeCount()){r.src=null;o[goog.events.LISTENER_MAP_PROP_]=null}}else e.markAsRemoved();return!0};goog.events.unlistenWithWrapper=function(t,e,o,i,n){e.unlisten(t,o,i,n)};goog.events.removeAll=function(t,e){if(!t)return 0;if(goog.events.Listenable.isImplementedBy(t))return t.removeAllListeners(e);var o=goog.events.getListenerMap_(t);if(!o)return 0;var i=0;for(var n in o.listeners)if(!e||n==e)for(var r=goog.array.clone(o.listeners[n]),s=0;s<r.length;++s)goog.events.unlistenByKey(r[s])&&++i;return i};goog.events.removeAllNativeListeners=function(){goog.events.listenerCountEstimate_=0;return 0};goog.events.getListeners=function(t,e,o){if(goog.events.Listenable.isImplementedBy(t))return t.getListeners(e,o);if(!t)return[];var i=goog.events.getListenerMap_(t);return i?i.getListeners(e,o):[]};goog.events.getListener=function(t,e,o,i,n){e=e;o=goog.events.wrapListener_(o);var r=!!i;if(goog.events.Listenable.isImplementedBy(t))return t.getListener(e,o,r,n);if(!t)return null;var s=goog.events.getListenerMap_(t);return s?s.getListener(e,o,r,n):null};goog.events.hasListener=function(t,e,o){if(goog.events.Listenable.isImplementedBy(t))return t.hasListener(e,o);var i=goog.events.getListenerMap_(t);return!!i&&i.hasListener(e,o)};goog.events.expose=function(t){var e=[];for(var o in t)e.push(t[o]&&t[o].id?o+" = "+t[o]+" ("+t[o].id+")":o+" = "+t[o]);return e.join("\n")};goog.events.getOnString_=function(t){return t in goog.events.onStringMap_?goog.events.onStringMap_[t]:goog.events.onStringMap_[t]=goog.events.onString_+t};goog.events.fireListeners=function(t,e,o,i){return goog.events.Listenable.isImplementedBy(t)?t.fireListeners(e,o,i):goog.events.fireListeners_(t,e,o,i)};goog.events.fireListeners_=function(t,e,o,i){var n=1,r=goog.events.getListenerMap_(t);if(r){var s=r.listeners[e];if(s){s=goog.array.clone(s);for(var a=0;a<s.length;a++){var l=s[a];l&&l.capture==o&&!l.removed&&(n&=goog.events.fireListener(l,i)!==!1)}}}return Boolean(n)};goog.events.fireListener=function(t,e){var o=t.listener,i=t.handler||t.src;t.callOnce&&goog.events.unlistenByKey(t);return o.call(i,e)};goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_};goog.events.dispatchEvent=function(t,e){goog.asserts.assert(goog.events.Listenable.isImplementedBy(t),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance.");return t.dispatchEvent(e)};goog.events.protectBrowserEventEntryPoint=function(t){goog.events.handleBrowserEvent_=t.protectEntryPoint(goog.events.handleBrowserEvent_)};goog.events.handleBrowserEvent_=function(t,e){if(t.removed)return!0;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var o=e||goog.getObjectByName("window.event"),i=new goog.events.BrowserEvent(o,this),n=!0;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(o)){goog.events.markIeEvent_(o);for(var r=[],s=i.currentTarget;s;s=s.parentNode)r.push(s);for(var a=t.type,l=r.length-1;!i.propagationStopped_&&l>=0;l--){i.currentTarget=r[l];n&=goog.events.fireListeners_(r[l],a,!0,i)}for(var l=0;!i.propagationStopped_&&l<r.length;l++){i.currentTarget=r[l];n&=goog.events.fireListeners_(r[l],a,!1,i)}}}else n=goog.events.fireListener(t,i);return n}return goog.events.fireListener(t,new goog.events.BrowserEvent(e,this))};goog.events.markIeEvent_=function(t){var e=!1;if(0==t.keyCode)try{t.keyCode=-1;return}catch(o){e=!0}(e||void 0==t.returnValue)&&(t.returnValue=!0)};goog.events.isMarkedIeEvent_=function(t){return t.keyCode<0||void 0!=t.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(t){return t+"_"+goog.events.uniqueIdCounter_++};goog.events.getListenerMap_=function(t){var e=t[goog.events.LISTENER_MAP_PROP_];return e instanceof goog.events.ListenerMap?e:null};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1e9*Math.random()>>>0);goog.events.wrapListener_=function(t){goog.asserts.assert(t,"Listener can not be null.");if(goog.isFunction(t))return t;goog.asserts.assert(t.handleEvent,"An object listener must have handleEvent method.");return t[goog.events.LISTENER_WRAPPER_PROP_]||(t[goog.events.LISTENER_WRAPPER_PROP_]=function(e){return t.handleEvent(e)})};goog.debug.entryPointRegistry.register(function(t){goog.events.handleBrowserEvent_=t(goog.events.handleBrowserEvent_)});goog.provide("goog.events.EventTarget");goog.require("goog.Disposable");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.events");goog.require("goog.events.Event");goog.require("goog.events.Listenable");goog.require("goog.events.ListenerMap");goog.require("goog.object");goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_=new goog.events.ListenerMap(this);this.actualEventTarget_=this};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1e3;goog.events.EventTarget.prototype.parentEventTarget_=null;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};goog.events.EventTarget.prototype.setParentEventTarget=function(t){this.parentEventTarget_=t};goog.events.EventTarget.prototype.addEventListener=function(t,e,o,i){goog.events.listen(this,t,e,o,i)};goog.events.EventTarget.prototype.removeEventListener=function(t,e,o,i){goog.events.unlisten(this,t,e,o,i)};goog.events.EventTarget.prototype.dispatchEvent=function(t){this.assertInitialized_();var e,o=this.getParentEventTarget();if(o){e=[];for(var i=1;o;o=o.getParentEventTarget()){e.push(o);goog.asserts.assert(++i<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,t,e)};goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};goog.events.EventTarget.prototype.listen=function(t,e,o,i){this.assertInitialized_();return this.eventTargetListeners_.add(String(t),e,!1,o,i)};goog.events.EventTarget.prototype.listenOnce=function(t,e,o,i){return this.eventTargetListeners_.add(String(t),e,!0,o,i)};goog.events.EventTarget.prototype.unlisten=function(t,e,o,i){return this.eventTargetListeners_.remove(String(t),e,o,i)};goog.events.EventTarget.prototype.unlistenByKey=function(t){return this.eventTargetListeners_.removeByKey(t)};goog.events.EventTarget.prototype.removeAllListeners=function(t){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(t):0};goog.events.EventTarget.prototype.fireListeners=function(t,e,o){var i=this.eventTargetListeners_.listeners[String(t)];if(!i)return!0;i=goog.array.clone(i);for(var n=!0,r=0;r<i.length;++r){var s=i[r];if(s&&!s.removed&&s.capture==e){var a=s.listener.target||this;if(a.isShieldEvent&&a.isShieldEvent(o))continue;var l=s.listener,g=s.handler||s.src;s.callOnce&&this.unlistenByKey(s);n=l.call(g,o)!==!1&&n}}return n&&0!=o.returnValue_};goog.events.EventTarget.prototype.getListeners=function(t,e){return this.eventTargetListeners_.getListeners(String(t),e)};goog.events.EventTarget.prototype.getListener=function(t,e,o,i){return this.eventTargetListeners_.getListener(String(t),e,o,i)};goog.events.EventTarget.prototype.hasListener=function(t,e){var o=goog.isDef(t)?String(t):void 0;return this.eventTargetListeners_.hasListener(o,e)};goog.events.EventTarget.prototype.setTargetForTesting=function(t){this.actualEventTarget_=t};goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")};goog.events.EventTarget.dispatchEventInternal_=function(t,e,o){var i=e.type||e;if(goog.isString(e))e=new goog.events.Event(e,t);else if(e instanceof goog.events.Event)e.target=e.target||t;else{var n=e;e=new goog.events.Event(i,t);goog.object.extend(e,n)}var r,s=!0;if(o)for(var a=o.length-1;!e.propagationStopped_&&a>=0;a--){r=e.currentTarget=o[a];s=r.fireListeners(i,!0,e)&&s}if(!e.propagationStopped_){r=e.currentTarget=t;s=r.fireListeners(i,!0,e)&&s;e.propagationStopped_||(s=r.fireListeners(i,!1,e)&&s)}if(o)for(a=0;!e.propagationStopped_&&a<o.length;a++){r=e.currentTarget=o[a];s=r.fireListeners(i,!1,e)&&s}return s};goog.provide("goog.events.KeyCodes");goog.require("goog.userAgent");goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,PHANTOM:255};goog.events.KeyCodes.isTextModifyingKeyEvent=function(t){if(t.altKey&&!t.ctrlKey||t.metaKey||t.keyCode>=goog.events.KeyCodes.F1&&t.keyCode<=goog.events.KeyCodes.F12)return!1;switch(t.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return!1;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;default:return t.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||t.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};goog.events.KeyCodes.firesKeyPressEvent=function(t,e,o,i,n){if(!(goog.userAgent.IE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525")))return!0;if(goog.userAgent.MAC&&n)return goog.events.KeyCodes.isCharacterKey(t);if(n&&!i)return!1;goog.isNumber(e)&&(e=goog.events.KeyCodes.normalizeKeyCode(e));if(!o&&(e==goog.events.KeyCodes.CTRL||e==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&e==goog.events.KeyCodes.META))return!1;if(goog.userAgent.WEBKIT&&i&&o)switch(t){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return!1}if(goog.userAgent.IE&&i&&e==t)return!1;switch(t){case goog.events.KeyCodes.ENTER:return!(goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9));case goog.events.KeyCodes.ESC:return!goog.userAgent.WEBKIT}return goog.events.KeyCodes.isCharacterKey(t)};goog.events.KeyCodes.isCharacterKey=function(t){if(t>=goog.events.KeyCodes.ZERO&&t<=goog.events.KeyCodes.NINE)return!0;if(t>=goog.events.KeyCodes.NUM_ZERO&&t<=goog.events.KeyCodes.NUM_MULTIPLY)return!0;if(t>=goog.events.KeyCodes.A&&t<=goog.events.KeyCodes.Z)return!0;if(goog.userAgent.WEBKIT&&0==t)return!0;switch(t){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return!0;default:return!1}};goog.events.KeyCodes.normalizeKeyCode=function(t){return goog.userAgent.GECKO?goog.events.KeyCodes.normalizeGeckoKeyCode(t):goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.KeyCodes.normalizeMacWebKitKeyCode(t):t};goog.events.KeyCodes.normalizeGeckoKeyCode=function(t){switch(t){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return t}};goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(t){switch(t){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return t}};goog.provide("goog.events.KeyEvent");goog.provide("goog.events.KeyHandler");goog.provide("goog.events.KeyHandler.EventType");goog.require("goog.events");goog.require("goog.events.BrowserEvent");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.userAgent");goog.events.KeyHandler=function(t,e){goog.events.EventTarget.call(this);t&&this.attach(t,e)};goog.inherits(goog.events.KeyHandler,goog.events.EventTarget);goog.events.KeyHandler.prototype.element_=null;goog.events.KeyHandler.prototype.keyPressKey_=null;goog.events.KeyHandler.prototype.keyDownKey_=null;goog.events.KeyHandler.prototype.keyUpKey_=null;goog.events.KeyHandler.prototype.lastKey_=-1;goog.events.KeyHandler.prototype.keyCode_=-1;goog.events.KeyHandler.prototype.altKey_=!1;goog.events.KeyHandler.EventType={KEY:"key"};goog.events.KeyHandler.safariKey_={3:goog.events.KeyCodes.ENTER,12:goog.events.KeyCodes.NUMLOCK,63232:goog.events.KeyCodes.UP,63233:goog.events.KeyCodes.DOWN,63234:goog.events.KeyCodes.LEFT,63235:goog.events.KeyCodes.RIGHT,63236:goog.events.KeyCodes.F1,63237:goog.events.KeyCodes.F2,63238:goog.events.KeyCodes.F3,63239:goog.events.KeyCodes.F4,63240:goog.events.KeyCodes.F5,63241:goog.events.KeyCodes.F6,63242:goog.events.KeyCodes.F7,63243:goog.events.KeyCodes.F8,63244:goog.events.KeyCodes.F9,63245:goog.events.KeyCodes.F10,63246:goog.events.KeyCodes.F11,63247:goog.events.KeyCodes.F12,63248:goog.events.KeyCodes.PRINT_SCREEN,63272:goog.events.KeyCodes.DELETE,63273:goog.events.KeyCodes.HOME,63275:goog.events.KeyCodes.END,63276:goog.events.KeyCodes.PAGE_UP,63277:goog.events.KeyCodes.PAGE_DOWN,63289:goog.events.KeyCodes.NUMLOCK,63302:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.keyIdentifier_={Up:goog.events.KeyCodes.UP,Down:goog.events.KeyCodes.DOWN,Left:goog.events.KeyCodes.LEFT,Right:goog.events.KeyCodes.RIGHT,Enter:goog.events.KeyCodes.ENTER,F1:goog.events.KeyCodes.F1,F2:goog.events.KeyCodes.F2,F3:goog.events.KeyCodes.F3,F4:goog.events.KeyCodes.F4,F5:goog.events.KeyCodes.F5,F6:goog.events.KeyCodes.F6,F7:goog.events.KeyCodes.F7,F8:goog.events.KeyCodes.F8,F9:goog.events.KeyCodes.F9,F10:goog.events.KeyCodes.F10,F11:goog.events.KeyCodes.F11,F12:goog.events.KeyCodes.F12,"U+007F":goog.events.KeyCodes.DELETE,Home:goog.events.KeyCodes.HOME,End:goog.events.KeyCodes.END,PageUp:goog.events.KeyCodes.PAGE_UP,PageDown:goog.events.KeyCodes.PAGE_DOWN,Insert:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.USES_KEYDOWN_=goog.userAgent.IE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525");goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_=goog.userAgent.MAC&&goog.userAgent.GECKO;goog.events.KeyHandler.prototype.handleKeyDown_=function(t){if(goog.userAgent.WEBKIT&&(this.lastKey_==goog.events.KeyCodes.CTRL&&!t.ctrlKey||this.lastKey_==goog.events.KeyCodes.ALT&&!t.altKey||goog.userAgent.MAC&&this.lastKey_==goog.events.KeyCodes.META&&!t.metaKey)){this.lastKey_=-1;this.keyCode_=-1}-1==this.lastKey_&&(t.ctrlKey&&t.keyCode!=goog.events.KeyCodes.CTRL?this.lastKey_=goog.events.KeyCodes.CTRL:t.altKey&&t.keyCode!=goog.events.KeyCodes.ALT?this.lastKey_=goog.events.KeyCodes.ALT:t.metaKey&&t.keyCode!=goog.events.KeyCodes.META&&(this.lastKey_=goog.events.KeyCodes.META));if(goog.events.KeyHandler.USES_KEYDOWN_&&!goog.events.KeyCodes.firesKeyPressEvent(t.keyCode,this.lastKey_,t.shiftKey,t.ctrlKey,t.altKey))this.handleEvent(t);else{this.keyCode_=goog.events.KeyCodes.normalizeKeyCode(t.keyCode);goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(this.altKey_=t.altKey)}};goog.events.KeyHandler.prototype.resetState=function(){this.lastKey_=-1;this.keyCode_=-1};goog.events.KeyHandler.prototype.handleKeyup_=function(t){this.handleEvent(t,!0);this.resetState();this.altKey_=t.altKey};goog.events.KeyHandler.prototype.handleEvent=function(t,e){var o,i,n=t.getBrowserEvent(),r=n.altKey;if(goog.userAgent.IE&&t.type==goog.events.EventType.KEYPRESS){o=this.keyCode_;i=o!=goog.events.KeyCodes.ENTER&&o!=goog.events.KeyCodes.ESC?n.keyCode:0}else if(goog.userAgent.WEBKIT&&t.type==goog.events.EventType.KEYPRESS){o=this.keyCode_;i=n.charCode>=0&&n.charCode<63232&&goog.events.KeyCodes.isCharacterKey(o)?n.charCode:0}else if(goog.userAgent.OPERA){o=this.keyCode_;i=goog.events.KeyCodes.isCharacterKey(o)?n.keyCode:0}else{o=n.keyCode||this.keyCode_;i=n.charCode||0;goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(r=this.altKey_);goog.userAgent.MAC&&i==goog.events.KeyCodes.QUESTION_MARK&&o==goog.events.KeyCodes.WIN_KEY&&(o=goog.events.KeyCodes.SLASH)}o=goog.events.KeyCodes.normalizeKeyCode(o);var s=o,a=n.keyIdentifier;o?o>=63232&&o in goog.events.KeyHandler.safariKey_?s=goog.events.KeyHandler.safariKey_[o]:25==o&&t.shiftKey&&(s=9):a&&a in goog.events.KeyHandler.keyIdentifier_&&(s=goog.events.KeyHandler.keyIdentifier_[a]);var l=s==this.lastKey_;this.lastKey_=s;var g=new goog.events.KeyEvent(s,i,l,n,e);g.altKey=r;this.dispatchEvent(g)};goog.events.KeyHandler.prototype.getElement=function(){return this.element_};goog.events.KeyHandler.prototype.attach=function(t,e){this.keyUpKey_&&this.detach();this.element_=t;this.keyPressKey_=goog.events.listen(this.element_,goog.events.EventType.KEYPRESS,this,e);this.keyDownKey_=goog.events.listen(this.element_,goog.events.EventType.KEYDOWN,this.handleKeyDown_,e,this);this.keyUpKey_=goog.events.listen(this.element_,goog.events.EventType.KEYUP,this.handleKeyup_,e,this)};goog.events.KeyHandler.prototype.detach=function(){if(this.keyPressKey_){goog.events.unlistenByKey(this.keyPressKey_);goog.events.unlistenByKey(this.keyDownKey_);goog.events.unlistenByKey(this.keyUpKey_);this.keyPressKey_=null;this.keyDownKey_=null;this.keyUpKey_=null}this.element_=null;this.lastKey_=-1;this.keyCode_=-1};goog.events.KeyHandler.prototype.disposeInternal=function(){goog.events.KeyHandler.superClass_.disposeInternal.call(this);this.detach()};goog.events.KeyEvent=function(t,e,o,i,n){goog.events.BrowserEvent.call(this,i);this.type=n?"keyup":"keydown";this.keyCode=t;this.charCode=e;this.repeat=o};goog.inherits(goog.events.KeyEvent,goog.events.BrowserEvent);goog.provide("goog.dom.BrowserFeature");goog.require("goog.userAgent");goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE};goog.provide("goog.dom.TagName");goog.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDI:"BDI",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",COMMAND:"COMMAND",DATA:"DATA",DATALIST:"DATALIST",DD:"DD",DEL:"DEL",DETAILS:"DETAILS",DFN:"DFN",DIALOG:"DIALOG",DIR:"DIR",DIV:"DIV",DL:"DL",DT:"DT",EM:"EM",EMBED:"EMBED",FIELDSET:"FIELDSET",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FONT:"FONT",FOOTER:"FOOTER",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HEADER:"HEADER",HGROUP:"HGROUP",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",KEYGEN:"KEYGEN",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MARK:"MARK",MATH:"MATH",MENU:"MENU",META:"META",METER:"METER",NAV:"NAV",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",OUTPUT:"OUTPUT",P:"P",PARAM:"PARAM",PRE:"PRE",PROGRESS:"PROGRESS",Q:"Q",RP:"RP",RT:"RT",RUBY:"RUBY",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SECTION:"SECTION",SELECT:"SELECT",SMALL:"SMALL",SOURCE:"SOURCE",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUMMARY:"SUMMARY",SUP:"SUP",SVG:"SVG",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TIME:"TIME",TITLE:"TITLE",TR:"TR",TRACK:"TRACK",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO",WBR:"WBR"};goog.provide("goog.dom.classes");goog.require("goog.array");goog.dom.classes.set=function(t,e){t.className=e};goog.dom.classes.get=function(t){var e=t.className;return goog.isString(e)&&e.match(/\S+/g)||[]};goog.dom.classes.add=function(t){var e=goog.dom.classes.get(t),o=goog.array.slice(arguments,1),i=e.length+o.length;goog.dom.classes.add_(e,o);goog.dom.classes.set(t,e.join(" "));return e.length==i};goog.dom.classes.remove=function(t){var e=goog.dom.classes.get(t),o=goog.array.slice(arguments,1),i=goog.dom.classes.getDifference_(e,o);goog.dom.classes.set(t,i.join(" "));return i.length==e.length-o.length};goog.dom.classes.add_=function(t,e){for(var o=0;o<e.length;o++)goog.array.contains(t,e[o])||t.push(e[o])};goog.dom.classes.getDifference_=function(t,e){return goog.array.filter(t,function(t){return!goog.array.contains(e,t)})};goog.dom.classes.swap=function(t,e,o){for(var i=goog.dom.classes.get(t),n=!1,r=0;r<i.length;r++)if(i[r]==e){goog.array.splice(i,r--,1);n=!0}if(n){i.push(o);goog.dom.classes.set(t,i.join(" "))}return n};goog.dom.classes.addRemove=function(t,e,o){var i=goog.dom.classes.get(t);goog.isString(e)?goog.array.remove(i,e):goog.isArray(e)&&(i=goog.dom.classes.getDifference_(i,e));goog.isString(o)&&!goog.array.contains(i,o)?i.push(o):goog.isArray(o)&&goog.dom.classes.add_(i,o);goog.dom.classes.set(t,i.join(" "))};goog.dom.classes.has=function(t,e){return goog.array.contains(goog.dom.classes.get(t),e)};goog.dom.classes.enable=function(t,e,o){o?goog.dom.classes.add(t,e):goog.dom.classes.remove(t,e)};goog.dom.classes.toggle=function(t,e){var o=!goog.dom.classes.has(t,e);goog.dom.classes.enable(t,e,o);return o};goog.provide("goog.functions");goog.functions.constant=function(t){return function(){return t}};goog.functions.FALSE=goog.functions.constant(!1);goog.functions.TRUE=goog.functions.constant(!0);goog.functions.NULL=goog.functions.constant(null);goog.functions.identity=function(t){return t};goog.functions.error=function(t){return function(){throw Error(t)}};goog.functions.fail=function(t){return function(){throw t}};goog.functions.lock=function(t,e){e=e||0;return function(){return t.apply(this,Array.prototype.slice.call(arguments,0,e))}};goog.functions.nth=function(t){return function(){return arguments[t]}};goog.functions.withReturnValue=function(t,e){return goog.functions.sequence(t,goog.functions.constant(e))};goog.functions.compose=function(){var t=arguments,e=t.length;return function(){var o;e&&(o=t[e-1].apply(this,arguments));for(var i=e-2;i>=0;i--)o=t[i].call(this,o);return o}};goog.functions.sequence=function(){var t=arguments,e=t.length;return function(){for(var o,i=0;e>i;i++)o=t[i].apply(this,arguments);return o}};goog.functions.and=function(){var t=arguments,e=t.length;return function(){for(var o=0;e>o;o++)if(!t[o].apply(this,arguments))return!1;return!0}};goog.functions.or=function(){var t=arguments,e=t.length;return function(){for(var o=0;e>o;o++)if(t[o].apply(this,arguments))return!0;return!1}};goog.functions.not=function(t){return function(){return!t.apply(this,arguments)}};goog.functions.create=function(t){var e=function(){};e.prototype=t.prototype;var o=new e;t.apply(o,Array.prototype.slice.call(arguments,1));return o};goog.define("goog.functions.CACHE_RETURN_VALUE",!0);goog.functions.cacheReturnValue=function(t){var e,o=!1;return function(){if(!goog.functions.CACHE_RETURN_VALUE)return t();if(!o){e=t();o=!0}return e}};goog.provide("goog.math");goog.require("goog.array");goog.require("goog.asserts");goog.math.randomInt=function(t){return Math.floor(Math.random()*t)};goog.math.uniformRandom=function(t,e){return t+Math.random()*(e-t)};goog.math.clamp=function(t,e,o){return Math.min(Math.max(t,e),o)};goog.math.modulo=function(t,e){var o=t%e;return 0>o*e?o+e:o};goog.math.lerp=function(t,e,o){return t+o*(e-t)};goog.math.nearlyEquals=function(t,e,o){return Math.abs(t-e)<=(o||1e-6)};goog.math.standardAngle=function(t){return goog.math.modulo(t,360)};goog.math.toRadians=function(t){return t*Math.PI/180};goog.math.toDegrees=function(t){return 180*t/Math.PI};goog.math.angleDx=function(t,e){return e*Math.cos(goog.math.toRadians(t))};goog.math.angleDy=function(t,e){return e*Math.sin(goog.math.toRadians(t))};goog.math.angle=function(t,e,o,i){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(i-e,o-t)))};goog.math.angleDifference=function(t,e){var o=goog.math.standardAngle(e)-goog.math.standardAngle(t);o>180?o-=360:-180>=o&&(o=360+o);return o};goog.math.sign=function(t){return 0==t?0:0>t?-1:1};goog.math.longestCommonSubsequence=function(t,e,o,i){for(var n=o||function(t,e){return t==e},r=i||function(e){return t[e]},s=t.length,a=e.length,l=[],g=0;s+1>g;g++){l[g]=[];l[g][0]=0}for(var m=0;a+1>m;m++)l[0][m]=0;for(g=1;s>=g;g++)for(m=1;a>=m;m++)l[g][m]=n(t[g-1],e[m-1])?l[g-1][m-1]+1:Math.max(l[g-1][m],l[g][m-1]);for(var c=[],g=s,m=a;g>0&&m>0;)if(n(t[g-1],e[m-1])){c.unshift(r(g-1,m-1));g--;m--}else l[g-1][m]>l[g][m-1]?g--:m--;return c};goog.math.sum=function(){return goog.array.reduce(arguments,function(t,e){return t+e},0)};goog.math.average=function(){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.sampleVariance=function(){var t=arguments.length;if(2>t)return 0;var e=goog.math.average.apply(null,arguments),o=goog.math.sum.apply(null,goog.array.map(arguments,function(t){return Math.pow(t-e,2)}))/(t-1);return o};goog.math.standardDeviation=function(){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))
};goog.math.isInt=function(t){return isFinite(t)&&t%1==0};goog.math.isFiniteNumber=function(t){return isFinite(t)&&!isNaN(t)};goog.math.safeFloor=function(t,e){goog.asserts.assert(!goog.isDef(e)||e>0);return Math.floor(t+(e||2e-15))};goog.math.safeCeil=function(t,e){goog.asserts.assert(!goog.isDef(e)||e>0);return Math.ceil(t-(e||2e-15))};goog.provide("goog.math.Coordinate");goog.require("goog.math");goog.math.Coordinate=function(t,e){this.x=goog.isDef(t)?t:0;this.y=goog.isDef(e)?e:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"});goog.math.Coordinate.equals=function(t,e){return t==e?!0:t&&e?t.x==e.x&&t.y==e.y:!1};goog.math.Coordinate.distance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)};goog.math.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)};goog.math.Coordinate.azimuth=function(t){return goog.math.angle(0,0,t.x,t.y)};goog.math.Coordinate.squaredDistance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return o*o+i*i};goog.math.Coordinate.difference=function(t,e){return new goog.math.Coordinate(t.x-e.x,t.y-e.y)};goog.math.Coordinate.sum=function(t,e){return new goog.math.Coordinate(t.x+e.x,t.y+e.y)};goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};goog.math.Coordinate.prototype.translate=function(t,e){if(t instanceof goog.math.Coordinate){this.x+=t.x;this.y+=t.y}else{this.x+=t;goog.isNumber(e)&&(this.y+=e)}return this};goog.math.Coordinate.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;this.x*=t;this.y*=o;return this};goog.provide("goog.math.Size");goog.math.Size=function(t,e){this.width=t;this.height=e};goog.math.Size.equals=function(t,e){return t==e?!0:t&&e?t.width==e.width&&t.height==e.height:!1};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"});goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return!this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Size.prototype.fitsInside=function(t){return this.width<=t.width&&this.height<=t.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;this.width*=t;this.height*=o;return this};goog.math.Size.prototype.scaleToFit=function(t){var e=this.aspectRatio()>t.aspectRatio()?t.width/this.width:t.height/this.height;return this.scale(e)};goog.provide("goog.dom");goog.provide("goog.dom.Appendable");goog.provide("goog.dom.DomHelper");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom.BrowserFeature");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.classes");goog.require("goog.functions");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");goog.require("goog.userAgent");goog.define("goog.dom.ASSUME_QUIRKS_MODE",!1);goog.define("goog.dom.ASSUME_STANDARDS_MODE",!1);goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.getDomHelper=function(t){return t?new goog.dom.DomHelper(goog.dom.getOwnerDocument(t)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.defaultDomHelper_;goog.dom.getDocument=function(){return document};goog.dom.getElement=function(t){return goog.dom.getElementHelper_(document,t)};goog.dom.getElementHelper_=function(t,e){return goog.isString(e)?t.getElementById(e):e};goog.dom.getRequiredElement=function(t){return goog.dom.getRequiredElementHelper_(document,t)};goog.dom.getRequiredElementHelper_=function(t,e){goog.asserts.assertString(e);var o=goog.dom.getElementHelper_(t,e);o=goog.asserts.assertElement(o,"No element found with id: "+e);return o};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagNameAndClass=function(t,e,o){return goog.dom.getElementsByTagNameAndClass_(document,t,e,o)};goog.dom.getElementsByClass=function(t,e){var o=e||document;return goog.dom.canUseQuerySelector_(o)?o.querySelectorAll("."+t):o.getElementsByClassName?o.getElementsByClassName(t):goog.dom.getElementsByTagNameAndClass_(document,"*",t,e)};goog.dom.getElementByClass=function(t,e){var o=e||document,i=null;i=goog.dom.canUseQuerySelector_(o)?o.querySelector("."+t):goog.dom.getElementsByClass(t,e)[0];return i||null};goog.dom.canUseQuerySelector_=function(t){return!(!t.querySelectorAll||!t.querySelector)};goog.dom.getElementsByTagNameAndClass_=function(t,e,o,i){var n=i||t,r=e&&"*"!=e?e.toUpperCase():"";if(goog.dom.canUseQuerySelector_(n)&&(r||o)){var s=r+(o?"."+o:"");return n.querySelectorAll(s)}if(o&&n.getElementsByClassName){var a=n.getElementsByClassName(o);if(r){for(var l,g={},m=0,c=0;l=a[c];c++)r==l.nodeName&&(g[m++]=l);g.length=m;return g}return a}var a=n.getElementsByTagName(r||"*");if(o){for(var l,g={},m=0,c=0;l=a[c];c++){var u=l.className;"function"==typeof u.split&&goog.array.contains(u.split(/\s+/),o)&&(g[m++]=l)}g.length=m;return g}return a};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(t,e){goog.object.forEach(e,function(e,o){"style"==o?t.style.cssText=e:"class"==o?t.className=e:"for"==o?t.htmlFor=e:o in goog.dom.DIRECT_ATTRIBUTE_MAP_?t.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[o],e):goog.string.startsWith(o,"aria-")||goog.string.startsWith(o,"data-")?t.setAttribute(o,e):t[o]=e})};goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(t){return goog.dom.getViewportSize_(t||window)};goog.dom.getViewportSize_=function(t){var e=t.document,o=goog.dom.isCss1CompatMode_(e)?e.documentElement:e.body;return new goog.math.Size(o.clientWidth,o.clientHeight)};goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeight_=function(t){var e=t.document,o=0;if(e){var i=goog.dom.getViewportSize_(t).height,n=e.body,r=e.documentElement;if(goog.dom.isCss1CompatMode_(e)&&r.scrollHeight)o=r.scrollHeight!=i?r.scrollHeight:r.offsetHeight;else{var s=r.scrollHeight,a=r.offsetHeight;if(r.clientHeight!=a){s=n.scrollHeight;a=n.offsetHeight}o=s>i?s>a?s:a:a>s?s:a}}return o};goog.dom.getPageScroll=function(t){var e=t||goog.global||window;return goog.dom.getDomHelper(e.document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};goog.dom.getDocumentScroll_=function(t){var e=goog.dom.getDocumentScrollElement_(t),o=goog.dom.getWindow_(t);return goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&o.pageYOffset!=e.scrollTop?new goog.math.Coordinate(e.scrollLeft,e.scrollTop):new goog.math.Coordinate(o.pageXOffset||e.scrollLeft,o.pageYOffset||e.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};goog.dom.getDocumentScrollElement_=function(t){return!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(t)?t.documentElement:t.body||t.documentElement};goog.dom.getWindow=function(t){return t?goog.dom.getWindow_(t):window};goog.dom.getWindow_=function(t){return t.parentWindow||t.defaultView};goog.dom.createDom=function(){return goog.dom.createDom_(document,arguments)};goog.dom.createDom_=function(t,e){var o=e[0],i=e[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&i&&(i.name||i.type)){var n=["<",o];i.name&&n.push(' name="',goog.string.htmlEscape(i.name),'"');if(i.type){n.push(' type="',goog.string.htmlEscape(i.type),'"');var r={};goog.object.extend(r,i);delete r.type;i=r}n.push(">");o=n.join("")}var s=t.createElement(o);i&&(goog.isString(i)?s.className=i:goog.isArray(i)?goog.dom.classes.add.apply(null,[s].concat(i)):goog.dom.setProperties(s,i));e.length>2&&goog.dom.append_(t,s,e,2);return s};goog.dom.append_=function(t,e,o,i){function n(o){o&&e.appendChild(goog.isString(o)?t.createTextNode(o):o)}for(var r=i;r<o.length;r++){var s=o[r];goog.isArrayLike(s)&&!goog.dom.isNodeLike(s)?goog.array.forEach(goog.dom.isNodeList(s)?goog.array.toArray(s):s,n):n(s)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(t){return document.createElement(t)};goog.dom.createTextNode=function(t){return document.createTextNode(String(t))};goog.dom.createTable=function(t,e,o){return goog.dom.createTable_(document,t,e,!!o)};goog.dom.createTable_=function(t,e,o,i){for(var n=["<tr>"],r=0;o>r;r++)n.push(i?"<td>&nbsp;</td>":"<td></td>");n.push("</tr>");n=n.join("");var s=["<table>"];for(r=0;e>r;r++)s.push(n);s.push("</table>");var a=t.createElement(goog.dom.TagName.DIV);a.innerHTML=s.join("");return a.removeChild(a.firstChild)};goog.dom.htmlToDocumentFragment=function(t){return goog.dom.htmlToDocumentFragment_(document,t)};goog.dom.htmlToDocumentFragment_=function(t,e){var o=t.createElement("div");if(goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT){o.innerHTML="<br>"+e;o.removeChild(o.firstChild)}else o.innerHTML=e;if(1==o.childNodes.length)return o.removeChild(o.firstChild);for(var i=t.createDocumentFragment();o.firstChild;)i.appendChild(o.firstChild);return i};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(t){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==t.compatMode};goog.dom.canHaveChildren=function(t){if(t.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(t.tagName){case goog.dom.TagName.APPLET:case goog.dom.TagName.AREA:case goog.dom.TagName.BASE:case goog.dom.TagName.BR:case goog.dom.TagName.COL:case goog.dom.TagName.COMMAND:case goog.dom.TagName.EMBED:case goog.dom.TagName.FRAME:case goog.dom.TagName.HR:case goog.dom.TagName.IMG:case goog.dom.TagName.INPUT:case goog.dom.TagName.IFRAME:case goog.dom.TagName.ISINDEX:case goog.dom.TagName.KEYGEN:case goog.dom.TagName.LINK:case goog.dom.TagName.NOFRAMES:case goog.dom.TagName.NOSCRIPT:case goog.dom.TagName.META:case goog.dom.TagName.OBJECT:case goog.dom.TagName.PARAM:case goog.dom.TagName.SCRIPT:case goog.dom.TagName.SOURCE:case goog.dom.TagName.STYLE:case goog.dom.TagName.TRACK:case goog.dom.TagName.WBR:return!1}return!0};goog.dom.appendChild=function(t,e){t.appendChild(e)};goog.dom.append=function(t){goog.dom.append_(goog.dom.getOwnerDocument(t),t,arguments,1)};goog.dom.removeChildren=function(t){for(var e;e=t.firstChild;)t.removeChild(e)};goog.dom.insertSiblingBefore=function(t,e){e.parentNode&&e.parentNode.insertBefore(t,e)};goog.dom.insertSiblingAfter=function(t,e){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)};goog.dom.insertChildAt=function(t,e,o){t.insertBefore(e,t.childNodes[o]||null)};goog.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null};goog.dom.replaceNode=function(t,e){var o=e.parentNode;o&&o.replaceChild(t,e)};goog.dom.flattenElement=function(t){var e,o=t.parentNode;if(o&&o.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(t.removeNode)return t.removeNode(!1);for(;e=t.firstChild;)o.insertBefore(e,t);return goog.dom.removeNode(t)}};goog.dom.getChildren=function(t){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=t.children?t.children:goog.array.filter(t.childNodes,function(t){return t.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(t){return void 0!=t.firstElementChild?t.firstElementChild:goog.dom.getNextElementNode_(t.firstChild,!0)};goog.dom.getLastElementChild=function(t){return void 0!=t.lastElementChild?t.lastElementChild:goog.dom.getNextElementNode_(t.lastChild,!1)};goog.dom.getNextElementSibling=function(t){return void 0!=t.nextElementSibling?t.nextElementSibling:goog.dom.getNextElementNode_(t.nextSibling,!0)};goog.dom.getPreviousElementSibling=function(t){return void 0!=t.previousElementSibling?t.previousElementSibling:goog.dom.getNextElementNode_(t.previousSibling,!1)};goog.dom.getNextElementNode_=function(t,e){for(;t&&t.nodeType!=goog.dom.NodeType.ELEMENT;)t=e?t.nextSibling:t.previousSibling;return t};goog.dom.getNextNode=function(t){if(!t)return null;if(t.firstChild)return t.firstChild;for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null};goog.dom.getPreviousNode=function(t){if(!t)return null;if(!t.previousSibling)return t.parentNode;t=t.previousSibling;for(;t&&t.lastChild;)t=t.lastChild;return t};goog.dom.isNodeLike=function(t){return goog.isObject(t)&&t.nodeType>0};goog.dom.isElement=function(t){return goog.isObject(t)&&t.nodeType==goog.dom.NodeType.ELEMENT};goog.dom.isWindow=function(t){return goog.isObject(t)&&t.window==t};goog.dom.getParentElement=function(t){if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY){var e=goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10");if(!(e&&goog.global.SVGElement&&t instanceof goog.global.SVGElement))return t.parentElement}var o=t.parentNode;return goog.dom.isElement(o)?o:null};goog.dom.contains=function(t,e){if(t.contains&&e.nodeType==goog.dom.NodeType.ELEMENT)return t==e||t.contains(e);if("undefined"!=typeof t.compareDocumentPosition)return t==e||Boolean(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t};goog.dom.compareNodeOrder=function(t,e){if(t==e)return 0;if(t.compareDocumentPosition)return 2&t.compareDocumentPosition(e)?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(t.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(e.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in t||t.parentNode&&"sourceIndex"in t.parentNode){var o=t.nodeType==goog.dom.NodeType.ELEMENT,i=e.nodeType==goog.dom.NodeType.ELEMENT;if(o&&i)return t.sourceIndex-e.sourceIndex;var n=t.parentNode,r=e.parentNode;return n==r?goog.dom.compareSiblingOrder_(t,e):!o&&goog.dom.contains(n,e)?-1*goog.dom.compareParentsDescendantNodeIe_(t,e):!i&&goog.dom.contains(r,t)?goog.dom.compareParentsDescendantNodeIe_(e,t):(o?t.sourceIndex:n.sourceIndex)-(i?e.sourceIndex:r.sourceIndex)}var s,a,l=goog.dom.getOwnerDocument(t);s=l.createRange();s.selectNode(t);s.collapse(!0);a=l.createRange();a.selectNode(e);a.collapse(!0);return s.compareBoundaryPoints(goog.global.Range.START_TO_END,a)};goog.dom.compareParentsDescendantNodeIe_=function(t,e){var o=t.parentNode;if(o==e)return-1;for(var i=e;i.parentNode!=o;)i=i.parentNode;return goog.dom.compareSiblingOrder_(i,t)};goog.dom.compareSiblingOrder_=function(t,e){for(var o=e;o=o.previousSibling;)if(o==t)return-1;return 1};goog.dom.findCommonAncestor=function(){var t,e=arguments.length;if(!e)return null;if(1==e)return arguments[0];var o=[],i=1/0;for(t=0;e>t;t++){for(var n=[],r=arguments[t];r;){n.unshift(r);r=r.parentNode}o.push(n);i=Math.min(i,n.length)}var s=null;for(t=0;i>t;t++){for(var a=o[0][t],l=1;e>l;l++)if(a!=o[l][t])return s;s=a}return s};goog.dom.getOwnerDocument=function(t){return t.nodeType==goog.dom.NodeType.DOCUMENT?t:t.ownerDocument||t.document};goog.dom.getFrameContentDocument=function(t){var e=t.contentDocument||t.contentWindow.document;return e};goog.dom.getFrameContentWindow=function(t){return t.contentWindow||goog.dom.getWindow(goog.dom.getFrameContentDocument(t))};goog.dom.setTextContent=function(t,e){goog.asserts.assert(null!=t,"goog.dom.setTextContent expects a non-null value for node");if("textContent"in t)t.textContent=e;else if(t.nodeType==goog.dom.NodeType.TEXT)t.data=e;else if(t.firstChild&&t.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;t.lastChild!=t.firstChild;)t.removeChild(t.lastChild);t.firstChild.data=e}else{goog.dom.removeChildren(t);var o=goog.dom.getOwnerDocument(t);t.appendChild(o.createTextNode(String(e)))}};goog.dom.getOuterHtml=function(t){if("outerHTML"in t)return t.outerHTML;var e=goog.dom.getOwnerDocument(t),o=e.createElement("div");o.appendChild(t.cloneNode(!0));return o.innerHTML};goog.dom.findNode=function(t,e){var o=[],i=goog.dom.findNodes_(t,e,o,!0);return i?o[0]:void 0};goog.dom.findNodes=function(t,e){var o=[];goog.dom.findNodes_(t,e,o,!1);return o};goog.dom.findNodes_=function(t,e,o,i){if(null!=t)for(var n=t.firstChild;n;){if(e(n)){o.push(n);if(i)return!0}if(goog.dom.findNodes_(n,e,o,i))return!0;n=n.nextSibling}return!1};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(t){return goog.dom.hasSpecifiedTabIndex_(t)&&goog.dom.isTabIndexFocusable_(t)};goog.dom.setFocusableTabIndex=function(t,e){if(e)t.tabIndex=0;else{t.tabIndex=-1;t.removeAttribute("tabIndex")}};goog.dom.isFocusable=function(t){var e;e=goog.dom.nativelySupportsFocus_(t)?!t.disabled&&(!goog.dom.hasSpecifiedTabIndex_(t)||goog.dom.isTabIndexFocusable_(t)):goog.dom.isFocusableTabIndex(t);return e&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(t):e};goog.dom.hasSpecifiedTabIndex_=function(t){var e=t.getAttributeNode("tabindex");return goog.isDefAndNotNull(e)&&e.specified};goog.dom.isTabIndexFocusable_=function(t){var e=t.tabIndex;return goog.isNumber(e)&&e>=0&&32768>e};goog.dom.nativelySupportsFocus_=function(t){return t.tagName==goog.dom.TagName.A||t.tagName==goog.dom.TagName.INPUT||t.tagName==goog.dom.TagName.TEXTAREA||t.tagName==goog.dom.TagName.SELECT||t.tagName==goog.dom.TagName.BUTTON};goog.dom.hasNonZeroBoundingRect_=function(t){var e=goog.isFunction(t.getBoundingClientRect)?t.getBoundingClientRect():{height:t.offsetHeight,width:t.offsetWidth};return goog.isDefAndNotNull(e)&&e.height>0&&e.width>0};goog.dom.getTextContent=function(t){var e;if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&"innerText"in t)e=goog.string.canonicalizeNewlines(t.innerText);else{var o=[];goog.dom.getTextContent_(t,o,!0);e=o.join("")}e=e.replace(/ \xAD /g," ").replace(/\xAD/g,"");e=e.replace(/\u200B/g,"");goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(e=e.replace(/ +/g," "));" "!=e&&(e=e.replace(/^\s*/,""));return e};goog.dom.getRawTextContent=function(t){var e=[];goog.dom.getTextContent_(t,e,!1);return e.join("")};goog.dom.getTextContent_=function(t,e,o){if(t.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(t.nodeType==goog.dom.NodeType.TEXT)e.push(o?String(t.nodeValue).replace(/(\r\n|\r|\n)/g,""):t.nodeValue);else if(t.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)e.push(goog.dom.PREDEFINED_TAG_VALUES_[t.nodeName]);else for(var i=t.firstChild;i;){goog.dom.getTextContent_(i,e,o);i=i.nextSibling}};goog.dom.getNodeTextLength=function(t){return goog.dom.getTextContent(t).length};goog.dom.getNodeTextOffset=function(t,e){for(var o=e||goog.dom.getOwnerDocument(t).body,i=[];t&&t!=o;){for(var n=t;n=n.previousSibling;)i.unshift(goog.dom.getTextContent(n));t=t.parentNode}return goog.string.trimLeft(i.join("")).replace(/ +/g," ").length};goog.dom.getNodeAtOffset=function(t,e,o){for(var i=[t],n=0,r=null;i.length>0&&e>n;){r=i.pop();if(r.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(r.nodeType==goog.dom.NodeType.TEXT){var s=r.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");n+=s.length}else if(r.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)n+=goog.dom.PREDEFINED_TAG_VALUES_[r.nodeName].length;else for(var a=r.childNodes.length-1;a>=0;a--)i.push(r.childNodes[a])}if(goog.isObject(o)){o.remainder=r?r.nodeValue.length+e-n-1:0;o.node=r}return r};goog.dom.isNodeList=function(t){if(t&&"number"==typeof t.length){if(goog.isObject(t))return"function"==typeof t.item||"string"==typeof t.item;if(goog.isFunction(t))return"function"==typeof t.item}return!1};goog.dom.getAncestorByTagNameAndClass=function(t,e,o){if(!e&&!o)return null;var i=e?e.toUpperCase():null;return goog.dom.getAncestor(t,function(t){return!(i&&t.nodeName!=i||o&&!goog.dom.classes.has(t,o))},!0)};goog.dom.getAncestorByClass=function(t,e){return goog.dom.getAncestorByTagNameAndClass(t,null,e)};goog.dom.getAncestor=function(t,e,o,i){o||(t=t.parentNode);for(var n=null==i,r=0;t&&(n||i>=r);){if(e(t))return t;t=t.parentNode;r++}return null};goog.dom.getActiveElement=function(t){try{return t&&t.activeElement}catch(e){}return null};goog.dom.devicePixelRatio_;goog.dom.getPixelRatio=goog.functions.cacheReturnValue(function(){var t=goog.dom.getWindow(),e=goog.userAgent.GECKO&&goog.userAgent.MOBILE;return goog.isDef(t.devicePixelRatio)&&!e?t.devicePixelRatio:t.matchMedia?goog.dom.matchesPixelRatio_(.75)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(3)||1:1});goog.dom.matchesPixelRatio_=function(t){var e=goog.dom.getWindow(),o="(-webkit-min-device-pixel-ratio: "+t+"),(min--moz-device-pixel-ratio: "+t+"),(min-resolution: "+t+"dppx)";return e.matchMedia(o).matches?t:0};goog.dom.DomHelper=function(t){this.document_=t||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(t){this.document_=t};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(t){return goog.dom.getElementHelper_(this.document_,t)};goog.dom.DomHelper.prototype.getRequiredElement=function(t){return goog.dom.getRequiredElementHelper_(this.document_,t)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(t,e,o){return goog.dom.getElementsByTagNameAndClass_(this.document_,t,e,o)};goog.dom.DomHelper.prototype.getElementsByClass=function(t,e){var o=e||this.document_;return goog.dom.getElementsByClass(t,o)};goog.dom.DomHelper.prototype.getElementByClass=function(t,e){var o=e||this.document_;return goog.dom.getElementByClass(t,o)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(t){return goog.dom.getViewportSize(t||this.getWindow())};goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.Appendable;goog.dom.DomHelper.prototype.createDom=function(){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(t){return this.document_.createElement(t)};goog.dom.DomHelper.prototype.createTextNode=function(t){return this.document_.createTextNode(String(t))};goog.dom.DomHelper.prototype.createTable=function(t,e,o){return goog.dom.createTable_(this.document_,t,e,!!o)};goog.dom.DomHelper.prototype.htmlToDocumentFragment=function(t){return goog.dom.htmlToDocumentFragment_(this.document_,t)};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(t){return goog.dom.getActiveElement(t||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.provide("goog.dom.vendor");goog.require("goog.string");goog.require("goog.userAgent");goog.dom.vendor.getVendorJsPrefix=function(){return goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.IE?"ms":goog.userAgent.OPERA?"O":null};goog.dom.vendor.getVendorPrefix=function(){return goog.userAgent.WEBKIT?"-webkit":goog.userAgent.GECKO?"-moz":goog.userAgent.IE?"-ms":goog.userAgent.OPERA?"-o":null};goog.dom.vendor.getPrefixedPropertyName=function(t,e){if(e&&t in e)return t;var o=goog.dom.vendor.getVendorJsPrefix();if(o){o=o.toLowerCase();var i=o+goog.string.toTitleCase(t);return!goog.isDef(e)||i in e?i:null}return null};goog.dom.vendor.getPrefixedEventType=function(t){var e=goog.dom.vendor.getVendorJsPrefix()||"";return(e+t).toLowerCase()};goog.provide("goog.math.Box");goog.require("goog.math.Coordinate");goog.math.Box=function(t,e,o,i){this.top=t;this.right=e;this.bottom=o;this.left=i};goog.math.Box.boundingBox=function(){for(var t=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),e=1;e<arguments.length;e++){var o=arguments[e];t.top=Math.min(t.top,o.y);t.right=Math.max(t.right,o.x);t.bottom=Math.max(t.bottom,o.y);t.left=Math.min(t.left,o.x)}return t};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};goog.DEBUG&&(goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"});goog.math.Box.prototype.contains=function(t){return goog.math.Box.contains(this,t)};goog.math.Box.prototype.expand=function(t,e,o,i){if(goog.isObject(t)){this.top-=t.top;this.right+=t.right;this.bottom+=t.bottom;this.left-=t.left}else{this.top-=t;this.right+=e;this.bottom+=o;this.left-=i}return this};goog.math.Box.prototype.expandToInclude=function(t){this.left=Math.min(this.left,t.left);this.top=Math.min(this.top,t.top);this.right=Math.max(this.right,t.right);this.bottom=Math.max(this.bottom,t.bottom)};goog.math.Box.equals=function(t,e){return t==e?!0:t&&e?t.top==e.top&&t.right==e.right&&t.bottom==e.bottom&&t.left==e.left:!1};goog.math.Box.contains=function(t,e){return t&&e?e instanceof goog.math.Box?e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom:e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom:!1};goog.math.Box.relativePositionX=function(t,e){return e.x<t.left?e.x-t.left:e.x>t.right?e.x-t.right:0};goog.math.Box.relativePositionY=function(t,e){return e.y<t.top?e.y-t.top:e.y>t.bottom?e.y-t.bottom:0};goog.math.Box.distance=function(t,e){var o=goog.math.Box.relativePositionX(t,e),i=goog.math.Box.relativePositionY(t,e);return Math.sqrt(o*o+i*i)};goog.math.Box.intersects=function(t,e){return t.left<=e.right&&e.left<=t.right&&t.top<=e.bottom&&e.top<=t.bottom};goog.math.Box.intersectsWithPadding=function(t,e,o){return t.left<=e.right+o&&e.left<=t.right+o&&t.top<=e.bottom+o&&e.top<=t.bottom+o};goog.math.Box.prototype.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};goog.math.Box.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};goog.math.Box.prototype.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};goog.math.Box.prototype.translate=function(t,e){if(t instanceof goog.math.Coordinate){this.left+=t.x;this.right+=t.x;this.top+=t.y;this.bottom+=t.y}else{this.left+=t;this.right+=t;if(goog.isNumber(e)){this.top+=e;this.bottom+=e}}return this};goog.math.Box.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;this.left*=t;this.right*=t;this.top*=o;this.bottom*=o;return this};goog.provide("goog.math.Rect");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.math.Rect=function(t,e,o,i){this.left=t;this.top=e;this.width=o;this.height=i};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){var t=this.left+this.width,e=this.top+this.height;return new goog.math.Box(this.top,t,e,this.left)};goog.math.Rect.createFromBox=function(t){return new goog.math.Rect(t.left,t.top,t.right-t.left,t.bottom-t.top)};goog.DEBUG&&(goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"});goog.math.Rect.equals=function(t,e){return t==e?!0:t&&e?t.left==e.left&&t.width==e.width&&t.top==e.top&&t.height==e.height:!1};goog.math.Rect.prototype.intersection=function(t){var e=Math.max(this.left,t.left),o=Math.min(this.left+this.width,t.left+t.width);if(o>=e){var i=Math.max(this.top,t.top),n=Math.min(this.top+this.height,t.top+t.height);if(n>=i){this.left=e;this.top=i;this.width=o-e;
this.height=n-i;return!0}}return!1};goog.math.Rect.intersection=function(t,e){var o=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width);if(i>=o){var n=Math.max(t.top,e.top),r=Math.min(t.top+t.height,e.top+e.height);if(r>=n)return new goog.math.Rect(o,n,i-o,r-n)}return null};goog.math.Rect.intersects=function(t,e){return t.left<=e.left+e.width&&e.left<=t.left+t.width&&t.top<=e.top+e.height&&e.top<=t.top+t.height};goog.math.Rect.prototype.intersects=function(t){return goog.math.Rect.intersects(this,t)};goog.math.Rect.difference=function(t,e){var o=goog.math.Rect.intersection(t,e);if(!o||!o.height||!o.width)return[t.clone()];var i=[],n=t.top,r=t.height,s=t.left+t.width,a=t.top+t.height,l=e.left+e.width,g=e.top+e.height;if(e.top>t.top){i.push(new goog.math.Rect(t.left,t.top,t.width,e.top-t.top));n=e.top;r-=e.top-t.top}if(a>g){i.push(new goog.math.Rect(t.left,g,t.width,a-g));r=g-n}e.left>t.left&&i.push(new goog.math.Rect(t.left,n,e.left-t.left,r));s>l&&i.push(new goog.math.Rect(l,n,s-l,r));return i};goog.math.Rect.prototype.difference=function(t){return goog.math.Rect.difference(this,t)};goog.math.Rect.prototype.boundingRect=function(t){var e=Math.max(this.left+this.width,t.left+t.width),o=Math.max(this.top+this.height,t.top+t.height);this.left=Math.min(this.left,t.left);this.top=Math.min(this.top,t.top);this.width=e-this.left;this.height=o-this.top};goog.math.Rect.boundingRect=function(t,e){if(!t||!e)return null;var o=t.clone();o.boundingRect(e);return o};goog.math.Rect.prototype.contains=function(t){return t instanceof goog.math.Rect?this.left<=t.left&&this.left+this.width>=t.left+t.width&&this.top<=t.top&&this.top+this.height>=t.top+t.height:t.x>=this.left&&t.x<=this.left+this.width&&t.y>=this.top&&t.y<=this.top+this.height};goog.math.Rect.prototype.squaredDistance=function(t){var e=t.x<this.left?this.left-t.x:Math.max(t.x-(this.left+this.width),0),o=t.y<this.top?this.top-t.y:Math.max(t.y-(this.top+this.height),0);return e*e+o*o};goog.math.Rect.prototype.distance=function(t){return Math.sqrt(this.squaredDistance(t))};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)};goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)};goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)};goog.math.Rect.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Rect.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Rect.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Rect.prototype.translate=function(t,e){if(t instanceof goog.math.Coordinate){this.left+=t.x;this.top+=t.y}else{this.left+=t;goog.isNumber(e)&&(this.top+=e)}return this};goog.math.Rect.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;this.left*=t;this.width*=t;this.top*=o;this.height*=o;return this};goog.provide("goog.style");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.vendor");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Rect");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");goog.require("goog.userAgent");goog.define("goog.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS",!1);goog.style.setStyle=function(t,e,o){goog.isString(e)?goog.style.setStyle_(t,o,e):goog.object.forEach(e,goog.partial(goog.style.setStyle_,t))};goog.style.setStyle_=function(t,e,o){var i=goog.style.getVendorJsStyleName_(t,o);i&&(t.style[i]=e)};goog.style.getVendorJsStyleName_=function(t,e){var o=goog.string.toCamelCase(e);if(void 0===t.style[o]){var i=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(e);if(void 0!==t.style[i])return i}return o};goog.style.getVendorStyleName_=function(t,e){var o=goog.string.toCamelCase(e);if(void 0===t.style[o]){var i=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(e);if(void 0!==t.style[i])return goog.dom.vendor.getVendorPrefix()+"-"+e}return e};goog.style.getStyle=function(t,e){var o=t.style[goog.string.toCamelCase(e)];return"undefined"!=typeof o?o:t.style[goog.style.getVendorJsStyleName_(t,e)]||""};goog.style.getComputedStyle=function(t,e){var o=goog.dom.getOwnerDocument(t);if(o.defaultView&&o.defaultView.getComputedStyle){var i=o.defaultView.getComputedStyle(t,null);if(i)return i[e]||i.getPropertyValue(e)||""}return""};goog.style.getCascadedStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:null};goog.style.getStyle_=function(t,e){return goog.style.getComputedStyle(t,e)||goog.style.getCascadedStyle(t,e)||t.style&&t.style[e]};goog.style.getComputedBoxSizing=function(t){return goog.style.getStyle_(t,"boxSizing")||goog.style.getStyle_(t,"MozBoxSizing")||goog.style.getStyle_(t,"WebkitBoxSizing")||null};goog.style.getComputedPosition=function(t){return goog.style.getStyle_(t,"position")};goog.style.getBackgroundColor=function(t){return goog.style.getStyle_(t,"backgroundColor")};goog.style.getComputedOverflowX=function(t){return goog.style.getStyle_(t,"overflowX")};goog.style.getComputedOverflowY=function(t){return goog.style.getStyle_(t,"overflowY")};goog.style.getComputedZIndex=function(t){return goog.style.getStyle_(t,"zIndex")};goog.style.getComputedTextAlign=function(t){return goog.style.getStyle_(t,"textAlign")};goog.style.getComputedCursor=function(t){return goog.style.getStyle_(t,"cursor")};goog.style.setPosition=function(t,e,o){var i,n,r=goog.userAgent.GECKO&&(goog.userAgent.MAC||goog.userAgent.X11)&&goog.userAgent.isVersionOrHigher("1.9");if(e instanceof goog.math.Coordinate){i=e.x;n=e.y}else{i=e;n=o}t.style.left=goog.style.getPixelStyleValue_(i,r);t.style.top=goog.style.getPixelStyleValue_(n,r)};goog.style.getPosition=function(t){return new goog.math.Coordinate(t.offsetLeft,t.offsetTop)};goog.style.getClientViewportElement=function(t){var e;e=t?goog.dom.getOwnerDocument(t):goog.dom.getDocument();return!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||goog.dom.getDomHelper(e).isCss1CompatMode()?e.documentElement:e.body};goog.style.getViewportPageOffset=function(t){var e=t.body,o=t.documentElement,i=e.scrollLeft||o.scrollLeft,n=e.scrollTop||o.scrollTop;return new goog.math.Coordinate(i,n)};goog.style.getBoundingClientRect_=function(t){var e;try{e=t.getBoundingClientRect()}catch(o){return{left:0,top:0,right:0,bottom:0}}if(goog.userAgent.IE&&t.ownerDocument.body){var i=t.ownerDocument;e.left-=i.documentElement.clientLeft+i.body.clientLeft;e.top-=i.documentElement.clientTop+i.body.clientTop}return e};goog.style.getOffsetParent=function(t){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8))return t.offsetParent;for(var e=goog.dom.getOwnerDocument(t),o=goog.style.getStyle_(t,"position"),i="fixed"==o||"absolute"==o,n=t.parentNode;n&&n!=e;n=n.parentNode){o=goog.style.getStyle_(n,"position");i=i&&"static"==o&&n!=e.documentElement&&n!=e.body;if(!i&&(n.scrollWidth>n.clientWidth||n.scrollHeight>n.clientHeight||"fixed"==o||"absolute"==o||"relative"==o))return n}return null};goog.style.getVisibleRectForElement=function(t){for(var e=new goog.math.Box(0,1/0,1/0,0),o=goog.dom.getDomHelper(t),i=o.getDocument().body,n=o.getDocument().documentElement,r=o.getDocumentScrollElement(),s=t;s=goog.style.getOffsetParent(s);)if(!(goog.userAgent.IE&&0==s.clientWidth||goog.userAgent.WEBKIT&&0==s.clientHeight&&s==i||s==i||s==n||"visible"==goog.style.getStyle_(s,"overflow"))){var a=goog.style.getPageOffset(s),l=goog.style.getClientLeftTop(s);a.x+=l.x;a.y+=l.y;e.top=Math.max(e.top,a.y);e.right=Math.min(e.right,a.x+s.clientWidth);e.bottom=Math.min(e.bottom,a.y+s.clientHeight);e.left=Math.max(e.left,a.x)}var g=r.scrollLeft,m=r.scrollTop;e.left=Math.max(e.left,g);e.top=Math.max(e.top,m);var c=o.getViewportSize();e.right=Math.min(e.right,g+c.width);e.bottom=Math.min(e.bottom,m+c.height);return e.top>=0&&e.left>=0&&e.bottom>e.top&&e.right>e.left?e:null};goog.style.getContainerOffsetToScrollInto=function(t,e,o){var i=goog.style.getPageOffset(t),n=goog.style.getPageOffset(e),r=goog.style.getBorderBox(e),s=i.x-n.x-r.left,a=i.y-n.y-r.top,l=e.clientWidth-t.offsetWidth,g=e.clientHeight-t.offsetHeight,m=e.scrollLeft,c=e.scrollTop;if(o){m+=s-l/2;c+=a-g/2}else{m+=Math.min(s,Math.max(s-l,0));c+=Math.min(a,Math.max(a-g,0))}return new goog.math.Coordinate(m,c)};goog.style.scrollIntoContainerView=function(t,e,o){var i=goog.style.getContainerOffsetToScrollInto(t,e,o);e.scrollLeft=i.x;e.scrollTop=i.y};goog.style.getClientLeftTop=function(t){if(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("1.9")){var e=parseFloat(goog.style.getComputedStyle(t,"borderLeftWidth"));if(goog.style.isRightToLeft(t)){var o=t.offsetWidth-t.clientWidth-e-parseFloat(goog.style.getComputedStyle(t,"borderRightWidth"));e+=o}return new goog.math.Coordinate(e,parseFloat(goog.style.getComputedStyle(t,"borderTopWidth")))}return new goog.math.Coordinate(t.clientLeft,t.clientTop)};goog.style.getPageOffset=function(t){var e,o=goog.dom.getOwnerDocument(t),i=goog.style.getStyle_(t,"position");goog.asserts.assertObject(t,"Parameter is required");var n=!goog.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS&&goog.userAgent.GECKO&&o.getBoxObjectFor&&!t.getBoundingClientRect&&"absolute"==i&&(e=o.getBoxObjectFor(t))&&(e.screenX<0||e.screenY<0),r=new goog.math.Coordinate(0,0),s=goog.style.getClientViewportElement(o);if(t==s)return r;if(goog.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS||t.getBoundingClientRect){e=goog.style.getBoundingClientRect_(t);var a=goog.dom.getDomHelper(o).getDocumentScroll();r.x=e.left+a.x;r.y=e.top+a.y}else if(o.getBoxObjectFor&&!n){e=o.getBoxObjectFor(t);var l=o.getBoxObjectFor(s);r.x=e.screenX-l.screenX;r.y=e.screenY-l.screenY}else{var g=t;do{r.x+=g.offsetLeft;r.y+=g.offsetTop;if(g!=t){r.x+=g.clientLeft||0;r.y+=g.clientTop||0}if(goog.userAgent.WEBKIT&&"fixed"==goog.style.getComputedPosition(g)){r.x+=o.body.scrollLeft;r.y+=o.body.scrollTop;break}g=g.offsetParent}while(g&&g!=t);(goog.userAgent.OPERA||goog.userAgent.WEBKIT&&"absolute"==i)&&(r.y-=o.body.offsetTop);for(g=t;(g=goog.style.getOffsetParent(g))&&g!=o.body&&g!=s;){r.x-=g.scrollLeft;goog.userAgent.OPERA&&"TR"==g.tagName||(r.y-=g.scrollTop)}}return r};goog.style.getPageOffsetLeft=function(t){return goog.style.getPageOffset(t).x};goog.style.getPageOffsetTop=function(t){return goog.style.getPageOffset(t).y};goog.style.getFramedPageOffset=function(t,e){var o=new goog.math.Coordinate(0,0),i=goog.dom.getWindow(goog.dom.getOwnerDocument(t)),n=t;do{var r=i==e?goog.style.getPageOffset(n):goog.style.getClientPositionForElement_(goog.asserts.assert(n));o.x+=r.x;o.y+=r.y}while(i&&i!=e&&(n=i.frameElement)&&(i=i.parent));return o};goog.style.translateRectForAnotherFrame=function(t,e,o){if(e.getDocument()!=o.getDocument()){var i=e.getDocument().body,n=goog.style.getFramedPageOffset(i,o.getWindow());n=goog.math.Coordinate.difference(n,goog.style.getPageOffset(i));goog.userAgent.IE&&!e.isCss1CompatMode()&&(n=goog.math.Coordinate.difference(n,e.getDocumentScroll()));t.left+=n.x;t.top+=n.y}};goog.style.getRelativePosition=function(t,e){var o=goog.style.getClientPosition(t),i=goog.style.getClientPosition(e);return new goog.math.Coordinate(o.x-i.x,o.y-i.y)};goog.style.getClientPositionForElement_=function(t){var e;if(goog.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS||t.getBoundingClientRect){var o=goog.style.getBoundingClientRect_(t);e=new goog.math.Coordinate(o.left,o.top)}else{var i=goog.dom.getDomHelper(t).getDocumentScroll(),n=goog.style.getPageOffset(t);e=new goog.math.Coordinate(n.x-i.x,n.y-i.y)}return goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher(12)?goog.math.Coordinate.sum(e,goog.style.getCssTranslation(t)):e};goog.style.getClientPosition=function(t){goog.asserts.assert(t);if(t.nodeType==goog.dom.NodeType.ELEMENT)return goog.style.getClientPositionForElement_(t);var e=goog.isFunction(t.getBrowserEvent),o=t;t.targetTouches?o=t.targetTouches[0]:e&&t.getBrowserEvent().targetTouches&&(o=t.getBrowserEvent().targetTouches[0]);return new goog.math.Coordinate(o.clientX,o.clientY)};goog.style.setPageOffset=function(t,e,o){var i=goog.style.getPageOffset(t);if(e instanceof goog.math.Coordinate){o=e.y;e=e.x}var n=e-i.x,r=o-i.y;goog.style.setPosition(t,t.offsetLeft+n,t.offsetTop+r)};goog.style.setSize=function(t,e,o){var i;if(e instanceof goog.math.Size){i=e.height;e=e.width}else{if(void 0==o)throw Error("missing height argument");i=o}goog.style.setWidth(t,e);goog.style.setHeight(t,i)};goog.style.getPixelStyleValue_=function(t,e){"number"==typeof t&&(t=(e?Math.round(t):t)+"px");return t};goog.style.setHeight=function(t,e){t.style.height=goog.style.getPixelStyleValue_(e,!0)};goog.style.setWidth=function(t,e){t.style.width=goog.style.getPixelStyleValue_(e,!0)};goog.style.getSize=function(t){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,t)};goog.style.evaluateWithTemporaryDisplay_=function(t,e){if("none"!=goog.style.getStyle_(e,"display"))return t(e);var o=e.style,i=o.display,n=o.visibility,r=o.position;o.visibility="hidden";o.position="absolute";o.display="inline";var s=t(e);o.display=i;o.position=r;o.visibility=n;return s};goog.style.getSizeWithDisplay_=function(t){var e=t.offsetWidth,o=t.offsetHeight,i=goog.userAgent.WEBKIT&&!e&&!o;if((!goog.isDef(e)||i)&&t.getBoundingClientRect){var n=goog.style.getBoundingClientRect_(t);return new goog.math.Size(n.right-n.left,n.bottom-n.top)}return new goog.math.Size(e,o)};goog.style.getTransformedSize=function(t){if(!t.getBoundingClientRect)return null;var e=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,t);return new goog.math.Size(e.right-e.left,e.bottom-e.top)};goog.style.getBounds=function(t){var e=goog.style.getPageOffset(t),o=goog.style.getSize(t);return new goog.math.Rect(e.x,e.y,o.width,o.height)};goog.style.toCamelCase=function(t){return goog.string.toCamelCase(String(t))};goog.style.toSelectorCase=function(t){return goog.string.toSelectorCase(t)};goog.style.getOpacity=function(t){var e=t.style,o="";if("opacity"in e)o=e.opacity;else if("MozOpacity"in e)o=e.MozOpacity;else if("filter"in e){var i=e.filter.match(/alpha\(opacity=([\d.]+)\)/);i&&(o=String(i[1]/100))}return""==o?o:Number(o)};goog.style.setOpacity=function(t,e){var o=t.style;"opacity"in o?o.opacity=e:"MozOpacity"in o?o.MozOpacity=e:"filter"in o&&(o.filter=""===e?"":"alpha(opacity="+100*e+")")};goog.style.setTransparentBackgroundImage=function(t,e){var o=t.style;if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8"))o.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+e+'", sizingMethod="crop")';else{o.backgroundImage="url("+e+")";o.backgroundPosition="top left";o.backgroundRepeat="no-repeat"}};goog.style.clearTransparentBackgroundImage=function(t){var e=t.style;"filter"in e?e.filter="":e.backgroundImage="none"};goog.style.showElement=function(t,e){goog.style.setElementShown(t,e)};goog.style.setElementShown=function(t,e){t.style.display=e?"":"none"};goog.style.isElementShown=function(t){return"none"!=t.style.display};goog.style.installStyles=function(t,e){var o=goog.dom.getDomHelper(e),i=null,n=o.getDocument();if(goog.userAgent.IE&&n.createStyleSheet){i=n.createStyleSheet();goog.style.setStyles(i,t)}else{var r=o.getElementsByTagNameAndClass("head")[0];if(!r){var s=o.getElementsByTagNameAndClass("body")[0];r=o.createDom("head");s.parentNode.insertBefore(r,s)}i=o.createDom("style");goog.style.setStyles(i,t);o.appendChild(r,i)}return i};goog.style.uninstallStyles=function(t){var e=t.ownerNode||t.owningElement||t;goog.dom.removeNode(e)};goog.style.setStyles=function(t,e){goog.userAgent.IE&&goog.isDef(t.cssText)?t.cssText=e:t.innerHTML=e};goog.style.setPreWrap=function(t){var e=t.style;if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")){e.whiteSpace="pre";e.wordWrap="break-word"}else e.whiteSpace=goog.userAgent.GECKO?"-moz-pre-wrap":"pre-wrap"};goog.style.setInlineBlock=function(t){var e=t.style;e.position="relative";if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")){e.zoom="1";e.display="inline"}else e.display=goog.userAgent.GECKO?goog.userAgent.isVersionOrHigher("1.9a")?"inline-block":"-moz-inline-box":"inline-block"};goog.style.isRightToLeft=function(t){return"rtl"==goog.style.getStyle_(t,"direction")};goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT?"WebkitUserSelect":null;goog.style.isUnselectable=function(t){return goog.style.unselectableStyle_?"none"==t.style[goog.style.unselectableStyle_].toLowerCase():goog.userAgent.IE||goog.userAgent.OPERA?"on"==t.getAttribute("unselectable"):!1};goog.style.setUnselectable=function(t,e,o){var i=o?null:t.getElementsByTagName("*"),n=goog.style.unselectableStyle_;if(n){var r=e?"none":"";t.style[n]=r;if(i)for(var s,a=0;s=i[a];a++)s.style[n]=r}else if(goog.userAgent.IE||goog.userAgent.OPERA){var r=e?"on":"";t.setAttribute("unselectable",r);if(i)for(var s,a=0;s=i[a];a++)s.setAttribute("unselectable",r)}};goog.style.getBorderBoxSize=function(t){return new goog.math.Size(t.offsetWidth,t.offsetHeight)};goog.style.setBorderBoxSize=function(t,e){var o=goog.dom.getOwnerDocument(t),i=goog.dom.getDomHelper(o).isCss1CompatMode();if(!goog.userAgent.IE||i&&goog.userAgent.isVersionOrHigher("8"))goog.style.setBoxSizingSize_(t,e,"border-box");else{var n=t.style;if(i){var r=goog.style.getPaddingBox(t),s=goog.style.getBorderBox(t);n.pixelWidth=e.width-s.left-r.left-r.right-s.right;n.pixelHeight=e.height-s.top-r.top-r.bottom-s.bottom}else{n.pixelWidth=e.width;n.pixelHeight=e.height}}};goog.style.getContentBoxSize=function(t){var e=goog.dom.getOwnerDocument(t),o=goog.userAgent.IE&&t.currentStyle;if(o&&goog.dom.getDomHelper(e).isCss1CompatMode()&&"auto"!=o.width&&"auto"!=o.height&&!o.boxSizing){var i=goog.style.getIePixelValue_(t,o.width,"width","pixelWidth"),n=goog.style.getIePixelValue_(t,o.height,"height","pixelHeight");return new goog.math.Size(i,n)}var r=goog.style.getBorderBoxSize(t),s=goog.style.getPaddingBox(t),a=goog.style.getBorderBox(t);return new goog.math.Size(r.width-a.left-s.left-s.right-a.right,r.height-a.top-s.top-s.bottom-a.bottom)};goog.style.setContentBoxSize=function(t,e){var o=goog.dom.getOwnerDocument(t),i=goog.dom.getDomHelper(o).isCss1CompatMode();if(!goog.userAgent.IE||i&&goog.userAgent.isVersionOrHigher("8"))goog.style.setBoxSizingSize_(t,e,"content-box");else{var n=t.style;if(i){n.pixelWidth=e.width;n.pixelHeight=e.height}else{var r=goog.style.getPaddingBox(t),s=goog.style.getBorderBox(t);n.pixelWidth=e.width+s.left+r.left+r.right+s.right;n.pixelHeight=e.height+s.top+r.top+r.bottom+s.bottom}}};goog.style.setBoxSizingSize_=function(t,e,o){var i=t.style;goog.userAgent.GECKO?i.MozBoxSizing=o:goog.userAgent.WEBKIT?i.WebkitBoxSizing=o:i.boxSizing=o;i.width=Math.max(e.width,0)+"px";i.height=Math.max(e.height,0)+"px"};goog.style.getIePixelValue_=function(t,e,o,i){if(/^\d+px?$/.test(e))return parseInt(e,10);var n=t.style[o],r=t.runtimeStyle[o];t.runtimeStyle[o]=t.currentStyle[o];t.style[o]=e;var s=t.style[i];t.style[o]=n;t.runtimeStyle[o]=r;return s};goog.style.getIePixelDistance_=function(t,e){var o=goog.style.getCascadedStyle(t,e);return o?goog.style.getIePixelValue_(t,o,"left","pixelLeft"):0};goog.style.getBox_=function(t,e){if(goog.userAgent.IE){var o=goog.style.getIePixelDistance_(t,e+"Left"),i=goog.style.getIePixelDistance_(t,e+"Right"),n=goog.style.getIePixelDistance_(t,e+"Top"),r=goog.style.getIePixelDistance_(t,e+"Bottom");return new goog.math.Box(n,i,r,o)}var o=goog.style.getComputedStyle(t,e+"Left"),i=goog.style.getComputedStyle(t,e+"Right"),n=goog.style.getComputedStyle(t,e+"Top"),r=goog.style.getComputedStyle(t,e+"Bottom");return new goog.math.Box(parseFloat(n),parseFloat(i),parseFloat(r),parseFloat(o))};goog.style.getPaddingBox=function(t){return goog.style.getBox_(t,"padding")};goog.style.getMarginBox=function(t){return goog.style.getBox_(t,"margin")};goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6};goog.style.getIePixelBorder_=function(t,e){if("none"==goog.style.getCascadedStyle(t,e+"Style"))return 0;var o=goog.style.getCascadedStyle(t,e+"Width");return o in goog.style.ieBorderWidthKeywords_?goog.style.ieBorderWidthKeywords_[o]:goog.style.getIePixelValue_(t,o,"left","pixelLeft")};goog.style.getBorderBox=function(t){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var e=goog.style.getIePixelBorder_(t,"borderLeft"),o=goog.style.getIePixelBorder_(t,"borderRight"),i=goog.style.getIePixelBorder_(t,"borderTop"),n=goog.style.getIePixelBorder_(t,"borderBottom");return new goog.math.Box(i,o,n,e)}var e=goog.style.getComputedStyle(t,"borderLeftWidth"),o=goog.style.getComputedStyle(t,"borderRightWidth"),i=goog.style.getComputedStyle(t,"borderTopWidth"),n=goog.style.getComputedStyle(t,"borderBottomWidth");return new goog.math.Box(parseFloat(i),parseFloat(o),parseFloat(n),parseFloat(e))};goog.style.getFontFamily=function(t){var e=goog.dom.getOwnerDocument(t),o="";if(e.body.createTextRange){var i=e.body.createTextRange();i.moveToElementText(t);try{o=i.queryCommandValue("FontName")}catch(n){o=""}}o||(o=goog.style.getStyle_(t,"fontFamily"));var r=o.split(",");r.length>1&&(o=r[0]);return goog.string.stripQuotes(o,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;goog.style.getLengthUnits=function(t){var e=t.match(goog.style.lengthUnitRegex_);return e&&e[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,"in":1,mm:1,pc:1,pt:1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1};goog.style.getFontSize=function(t){var e=goog.style.getStyle_(t,"fontSize"),o=goog.style.getLengthUnits(e);if(e&&"px"==o)return parseInt(e,10);if(goog.userAgent.IE){if(o in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(t,e,"left","pixelLeft");if(t.parentNode&&t.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&o in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_){var i=t.parentNode,n=goog.style.getStyle_(i,"fontSize");return goog.style.getIePixelValue_(i,e==n?"1em":e,"left","pixelLeft")}}var r=goog.dom.createDom("span",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(t,r);e=r.offsetHeight;goog.dom.removeNode(r);return e};goog.style.parseStyleAttribute=function(t){var e={};goog.array.forEach(t.split(/\s*;\s*/),function(t){var o=t.split(/\s*:\s*/);2==o.length&&(e[goog.string.toCamelCase(o[0].toLowerCase())]=o[1])});return e};goog.style.toStyleAttribute=function(t){var e=[];goog.object.forEach(t,function(t,o){e.push(goog.string.toSelectorCase(o),":",t,";")});return e.join("")};goog.style.setFloat=function(t,e){t.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=e};goog.style.getFloat=function(t){return t.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};goog.style.getScrollbarWidth=function(t){var e=goog.dom.createElement("div");t&&(e.className=t);e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";var o=goog.dom.createElement("div");goog.style.setSize(o,"200px","200px");e.appendChild(o);goog.dom.appendChild(goog.dom.getDocument().body,e);var i=e.offsetWidth-e.clientWidth;goog.dom.removeNode(e);return i};goog.style.MATRIX_TRANSLATION_REGEX_=new RegExp("matrix\\([0-9\\.\\-]+, [0-9\\.\\-]+, [0-9\\.\\-]+, [0-9\\.\\-]+, ([0-9\\.\\-]+)p?x?, ([0-9\\.\\-]+)p?x?\\)");goog.style.getCssTranslation=function(t){var e;goog.userAgent.IE?e="-ms-transform":goog.userAgent.WEBKIT?e="-webkit-transform":goog.userAgent.OPERA?e="-o-transform":goog.userAgent.GECKO&&(e="-moz-transform");var o;e&&(o=goog.style.getStyle_(t,e));o||(o=goog.style.getStyle_(t,"transform"));if(!o)return new goog.math.Coordinate(0,0);var i=o.match(goog.style.MATRIX_TRANSLATION_REGEX_);return i?new goog.math.Coordinate(parseFloat(i[1]),parseFloat(i[2])):new goog.math.Coordinate(0,0)};goog.provide("goog.dom");goog.provide("goog.dom.Appendable");goog.provide("goog.dom.DomHelper");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom.BrowserFeature");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.classes");goog.require("goog.functions");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");goog.require("goog.userAgent");goog.define("goog.dom.ASSUME_QUIRKS_MODE",!1);goog.define("goog.dom.ASSUME_STANDARDS_MODE",!1);goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.getDomHelper=function(t){return t?new goog.dom.DomHelper(goog.dom.getOwnerDocument(t)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.defaultDomHelper_;goog.dom.getDocument=function(){return document};goog.dom.getElement=function(t){return goog.dom.getElementHelper_(document,t)};goog.dom.getElementHelper_=function(t,e){return goog.isString(e)?t.getElementById(e):e};goog.dom.getRequiredElement=function(t){return goog.dom.getRequiredElementHelper_(document,t)};goog.dom.getRequiredElementHelper_=function(t,e){goog.asserts.assertString(e);var o=goog.dom.getElementHelper_(t,e);o=goog.asserts.assertElement(o,"No element found with id: "+e);return o};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagNameAndClass=function(t,e,o){return goog.dom.getElementsByTagNameAndClass_(document,t,e,o)};goog.dom.getElementsByClass=function(t,e){var o=e||document;return goog.dom.canUseQuerySelector_(o)?o.querySelectorAll("."+t):o.getElementsByClassName?o.getElementsByClassName(t):goog.dom.getElementsByTagNameAndClass_(document,"*",t,e)};goog.dom.getElementByClass=function(t,e){var o=e||document,i=null;i=goog.dom.canUseQuerySelector_(o)?o.querySelector("."+t):goog.dom.getElementsByClass(t,e)[0];return i||null};goog.dom.canUseQuerySelector_=function(t){return!(!t.querySelectorAll||!t.querySelector)};goog.dom.getElementsByTagNameAndClass_=function(t,e,o,i){var n=i||t,r=e&&"*"!=e?e.toUpperCase():"";if(goog.dom.canUseQuerySelector_(n)&&(r||o)){var s=r+(o?"."+o:"");return n.querySelectorAll(s)}if(o&&n.getElementsByClassName){var a=n.getElementsByClassName(o);if(r){for(var l,g={},m=0,c=0;l=a[c];c++)r==l.nodeName&&(g[m++]=l);g.length=m;return g}return a}var a=n.getElementsByTagName(r||"*");if(o){for(var l,g={},m=0,c=0;l=a[c];c++){var u=l.className;"function"==typeof u.split&&goog.array.contains(u.split(/\s+/),o)&&(g[m++]=l)}g.length=m;return g}return a};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(t,e){goog.object.forEach(e,function(e,o){"style"==o?t.style.cssText=e:"class"==o?t.className=e:"for"==o?t.htmlFor=e:o in goog.dom.DIRECT_ATTRIBUTE_MAP_?t.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[o],e):goog.string.startsWith(o,"aria-")||goog.string.startsWith(o,"data-")?t.setAttribute(o,e):t[o]=e})};goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(t){return goog.dom.getViewportSize_(t||window)};goog.dom.getViewportSize_=function(t){var e=t.document,o=goog.dom.isCss1CompatMode_(e)?e.documentElement:e.body;return new goog.math.Size(o.clientWidth,o.clientHeight)};goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeight_=function(t){var e=t.document,o=0;if(e){var i=goog.dom.getViewportSize_(t).height,n=e.body,r=e.documentElement;if(goog.dom.isCss1CompatMode_(e)&&r.scrollHeight)o=r.scrollHeight!=i?r.scrollHeight:r.offsetHeight;else{var s=r.scrollHeight,a=r.offsetHeight;if(r.clientHeight!=a){s=n.scrollHeight;a=n.offsetHeight}o=s>i?s>a?s:a:a>s?s:a}}return o};goog.dom.getPageScroll=function(t){var e=t||goog.global||window;return goog.dom.getDomHelper(e.document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};goog.dom.getDocumentScroll_=function(t){var e=goog.dom.getDocumentScrollElement_(t),o=goog.dom.getWindow_(t);return goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&o.pageYOffset!=e.scrollTop?new goog.math.Coordinate(e.scrollLeft,e.scrollTop):new goog.math.Coordinate(o.pageXOffset||e.scrollLeft,o.pageYOffset||e.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};goog.dom.getDocumentScrollElement_=function(t){return!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(t)?t.documentElement:t.body||t.documentElement};goog.dom.getWindow=function(t){return t?goog.dom.getWindow_(t):window};goog.dom.getWindow_=function(t){return t.parentWindow||t.defaultView};goog.dom.createDom=function(){return goog.dom.createDom_(document,arguments)};goog.dom.createDom_=function(t,e){var o=e[0],i=e[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&i&&(i.name||i.type)){var n=["<",o];i.name&&n.push(' name="',goog.string.htmlEscape(i.name),'"');if(i.type){n.push(' type="',goog.string.htmlEscape(i.type),'"');var r={};goog.object.extend(r,i);delete r.type;i=r}n.push(">");o=n.join("")}var s=t.createElement(o);i&&(goog.isString(i)?s.className=i:goog.isArray(i)?goog.dom.classes.add.apply(null,[s].concat(i)):goog.dom.setProperties(s,i));e.length>2&&goog.dom.append_(t,s,e,2);return s};goog.dom.append_=function(t,e,o,i){function n(o){o&&e.appendChild(goog.isString(o)?t.createTextNode(o):o)}for(var r=i;r<o.length;r++){var s=o[r];goog.isArrayLike(s)&&!goog.dom.isNodeLike(s)?goog.array.forEach(goog.dom.isNodeList(s)?goog.array.toArray(s):s,n):n(s)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(t){return document.createElement(t)};goog.dom.createTextNode=function(t){return document.createTextNode(String(t))};goog.dom.createTable=function(t,e,o){return goog.dom.createTable_(document,t,e,!!o)};goog.dom.createTable_=function(t,e,o,i){for(var n=["<tr>"],r=0;o>r;r++)n.push(i?"<td>&nbsp;</td>":"<td></td>");n.push("</tr>");n=n.join("");var s=["<table>"];for(r=0;e>r;r++)s.push(n);s.push("</table>");var a=t.createElement(goog.dom.TagName.DIV);a.innerHTML=s.join("");return a.removeChild(a.firstChild)};goog.dom.htmlToDocumentFragment=function(t){return goog.dom.htmlToDocumentFragment_(document,t)};goog.dom.htmlToDocumentFragment_=function(t,e){var o=t.createElement("div");if(goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT){o.innerHTML="<br>"+e;o.removeChild(o.firstChild)}else o.innerHTML=e;if(1==o.childNodes.length)return o.removeChild(o.firstChild);for(var i=t.createDocumentFragment();o.firstChild;)i.appendChild(o.firstChild);return i};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(t){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==t.compatMode};goog.dom.canHaveChildren=function(t){if(t.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(t.tagName){case goog.dom.TagName.APPLET:case goog.dom.TagName.AREA:case goog.dom.TagName.BASE:case goog.dom.TagName.BR:case goog.dom.TagName.COL:case goog.dom.TagName.COMMAND:case goog.dom.TagName.EMBED:case goog.dom.TagName.FRAME:case goog.dom.TagName.HR:case goog.dom.TagName.IMG:case goog.dom.TagName.INPUT:case goog.dom.TagName.IFRAME:case goog.dom.TagName.ISINDEX:case goog.dom.TagName.KEYGEN:case goog.dom.TagName.LINK:case goog.dom.TagName.NOFRAMES:case goog.dom.TagName.NOSCRIPT:case goog.dom.TagName.META:case goog.dom.TagName.OBJECT:case goog.dom.TagName.PARAM:case goog.dom.TagName.SCRIPT:case goog.dom.TagName.SOURCE:case goog.dom.TagName.STYLE:case goog.dom.TagName.TRACK:case goog.dom.TagName.WBR:return!1
}return!0};goog.dom.appendChild=function(t,e){t.appendChild(e)};goog.dom.append=function(t){goog.dom.append_(goog.dom.getOwnerDocument(t),t,arguments,1)};goog.dom.removeChildren=function(t){for(var e;e=t.firstChild;)t.removeChild(e)};goog.dom.insertSiblingBefore=function(t,e){e.parentNode&&e.parentNode.insertBefore(t,e)};goog.dom.insertSiblingAfter=function(t,e){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)};goog.dom.insertChildAt=function(t,e,o){t.insertBefore(e,t.childNodes[o]||null)};goog.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null};goog.dom.replaceNode=function(t,e){var o=e.parentNode;o&&o.replaceChild(t,e)};goog.dom.flattenElement=function(t){var e,o=t.parentNode;if(o&&o.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(t.removeNode)return t.removeNode(!1);for(;e=t.firstChild;)o.insertBefore(e,t);return goog.dom.removeNode(t)}};goog.dom.getChildren=function(t){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=t.children?t.children:goog.array.filter(t.childNodes,function(t){return t.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(t){return void 0!=t.firstElementChild?t.firstElementChild:goog.dom.getNextElementNode_(t.firstChild,!0)};goog.dom.getLastElementChild=function(t){return void 0!=t.lastElementChild?t.lastElementChild:goog.dom.getNextElementNode_(t.lastChild,!1)};goog.dom.getNextElementSibling=function(t){return void 0!=t.nextElementSibling?t.nextElementSibling:goog.dom.getNextElementNode_(t.nextSibling,!0)};goog.dom.getPreviousElementSibling=function(t){return void 0!=t.previousElementSibling?t.previousElementSibling:goog.dom.getNextElementNode_(t.previousSibling,!1)};goog.dom.getNextElementNode_=function(t,e){for(;t&&t.nodeType!=goog.dom.NodeType.ELEMENT;)t=e?t.nextSibling:t.previousSibling;return t};goog.dom.getNextNode=function(t){if(!t)return null;if(t.firstChild)return t.firstChild;for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null};goog.dom.getPreviousNode=function(t){if(!t)return null;if(!t.previousSibling)return t.parentNode;t=t.previousSibling;for(;t&&t.lastChild;)t=t.lastChild;return t};goog.dom.isNodeLike=function(t){return goog.isObject(t)&&t.nodeType>0};goog.dom.isElement=function(t){return goog.isObject(t)&&t.nodeType==goog.dom.NodeType.ELEMENT};goog.dom.isWindow=function(t){return goog.isObject(t)&&t.window==t};goog.dom.getParentElement=function(t){if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY){var e=goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10");if(!(e&&goog.global.SVGElement&&t instanceof goog.global.SVGElement))return t.parentElement}var o=t.parentNode;return goog.dom.isElement(o)?o:null};goog.dom.contains=function(t,e){if(t.contains&&e.nodeType==goog.dom.NodeType.ELEMENT)return t==e||t.contains(e);if("undefined"!=typeof t.compareDocumentPosition)return t==e||Boolean(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t};goog.dom.compareNodeOrder=function(t,e){if(t==e)return 0;if(t.compareDocumentPosition)return 2&t.compareDocumentPosition(e)?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(t.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(e.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in t||t.parentNode&&"sourceIndex"in t.parentNode){var o=t.nodeType==goog.dom.NodeType.ELEMENT,i=e.nodeType==goog.dom.NodeType.ELEMENT;if(o&&i)return t.sourceIndex-e.sourceIndex;var n=t.parentNode,r=e.parentNode;return n==r?goog.dom.compareSiblingOrder_(t,e):!o&&goog.dom.contains(n,e)?-1*goog.dom.compareParentsDescendantNodeIe_(t,e):!i&&goog.dom.contains(r,t)?goog.dom.compareParentsDescendantNodeIe_(e,t):(o?t.sourceIndex:n.sourceIndex)-(i?e.sourceIndex:r.sourceIndex)}var s,a,l=goog.dom.getOwnerDocument(t);s=l.createRange();s.selectNode(t);s.collapse(!0);a=l.createRange();a.selectNode(e);a.collapse(!0);return s.compareBoundaryPoints(goog.global.Range.START_TO_END,a)};goog.dom.compareParentsDescendantNodeIe_=function(t,e){var o=t.parentNode;if(o==e)return-1;for(var i=e;i.parentNode!=o;)i=i.parentNode;return goog.dom.compareSiblingOrder_(i,t)};goog.dom.compareSiblingOrder_=function(t,e){for(var o=e;o=o.previousSibling;)if(o==t)return-1;return 1};goog.dom.findCommonAncestor=function(){var t,e=arguments.length;if(!e)return null;if(1==e)return arguments[0];var o=[],i=1/0;for(t=0;e>t;t++){for(var n=[],r=arguments[t];r;){n.unshift(r);r=r.parentNode}o.push(n);i=Math.min(i,n.length)}var s=null;for(t=0;i>t;t++){for(var a=o[0][t],l=1;e>l;l++)if(a!=o[l][t])return s;s=a}return s};goog.dom.getOwnerDocument=function(t){return t.nodeType==goog.dom.NodeType.DOCUMENT?t:t.ownerDocument||t.document};goog.dom.getFrameContentDocument=function(t){var e=t.contentDocument||t.contentWindow.document;return e};goog.dom.getFrameContentWindow=function(t){return t.contentWindow||goog.dom.getWindow(goog.dom.getFrameContentDocument(t))};goog.dom.setTextContent=function(t,e){goog.asserts.assert(null!=t,"goog.dom.setTextContent expects a non-null value for node");if("textContent"in t)t.textContent=e;else if(t.nodeType==goog.dom.NodeType.TEXT)t.data=e;else if(t.firstChild&&t.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;t.lastChild!=t.firstChild;)t.removeChild(t.lastChild);t.firstChild.data=e}else{goog.dom.removeChildren(t);var o=goog.dom.getOwnerDocument(t);t.appendChild(o.createTextNode(String(e)))}};goog.dom.getOuterHtml=function(t){if("outerHTML"in t)return t.outerHTML;var e=goog.dom.getOwnerDocument(t),o=e.createElement("div");o.appendChild(t.cloneNode(!0));return o.innerHTML};goog.dom.findNode=function(t,e){var o=[],i=goog.dom.findNodes_(t,e,o,!0);return i?o[0]:void 0};goog.dom.findNodes=function(t,e){var o=[];goog.dom.findNodes_(t,e,o,!1);return o};goog.dom.findNodes_=function(t,e,o,i){if(null!=t)for(var n=t.firstChild;n;){if(e(n)){o.push(n);if(i)return!0}if(goog.dom.findNodes_(n,e,o,i))return!0;n=n.nextSibling}return!1};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(t){return goog.dom.hasSpecifiedTabIndex_(t)&&goog.dom.isTabIndexFocusable_(t)};goog.dom.setFocusableTabIndex=function(t,e){if(e)t.tabIndex=0;else{t.tabIndex=-1;t.removeAttribute("tabIndex")}};goog.dom.isFocusable=function(t){var e;e=goog.dom.nativelySupportsFocus_(t)?!t.disabled&&(!goog.dom.hasSpecifiedTabIndex_(t)||goog.dom.isTabIndexFocusable_(t)):goog.dom.isFocusableTabIndex(t);return e&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(t):e};goog.dom.hasSpecifiedTabIndex_=function(t){var e=t.getAttributeNode("tabindex");return goog.isDefAndNotNull(e)&&e.specified};goog.dom.isTabIndexFocusable_=function(t){var e=t.tabIndex;return goog.isNumber(e)&&e>=0&&32768>e};goog.dom.nativelySupportsFocus_=function(t){return t.tagName==goog.dom.TagName.A||t.tagName==goog.dom.TagName.INPUT||t.tagName==goog.dom.TagName.TEXTAREA||t.tagName==goog.dom.TagName.SELECT||t.tagName==goog.dom.TagName.BUTTON};goog.dom.hasNonZeroBoundingRect_=function(t){var e=goog.isFunction(t.getBoundingClientRect)?t.getBoundingClientRect():{height:t.offsetHeight,width:t.offsetWidth};return goog.isDefAndNotNull(e)&&e.height>0&&e.width>0};goog.dom.getTextContent=function(t){var e;if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&"innerText"in t)e=goog.string.canonicalizeNewlines(t.innerText);else{var o=[];goog.dom.getTextContent_(t,o,!0);e=o.join("")}e=e.replace(/ \xAD /g," ").replace(/\xAD/g,"");e=e.replace(/\u200B/g,"");goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(e=e.replace(/ +/g," "));" "!=e&&(e=e.replace(/^\s*/,""));return e};goog.dom.getRawTextContent=function(t){var e=[];goog.dom.getTextContent_(t,e,!1);return e.join("")};goog.dom.getTextContent_=function(t,e,o){if(t.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(t.nodeType==goog.dom.NodeType.TEXT)e.push(o?String(t.nodeValue).replace(/(\r\n|\r|\n)/g,""):t.nodeValue);else if(t.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)e.push(goog.dom.PREDEFINED_TAG_VALUES_[t.nodeName]);else for(var i=t.firstChild;i;){goog.dom.getTextContent_(i,e,o);i=i.nextSibling}};goog.dom.getNodeTextLength=function(t){return goog.dom.getTextContent(t).length};goog.dom.getNodeTextOffset=function(t,e){for(var o=e||goog.dom.getOwnerDocument(t).body,i=[];t&&t!=o;){for(var n=t;n=n.previousSibling;)i.unshift(goog.dom.getTextContent(n));t=t.parentNode}return goog.string.trimLeft(i.join("")).replace(/ +/g," ").length};goog.dom.getNodeAtOffset=function(t,e,o){for(var i=[t],n=0,r=null;i.length>0&&e>n;){r=i.pop();if(r.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(r.nodeType==goog.dom.NodeType.TEXT){var s=r.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");n+=s.length}else if(r.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)n+=goog.dom.PREDEFINED_TAG_VALUES_[r.nodeName].length;else for(var a=r.childNodes.length-1;a>=0;a--)i.push(r.childNodes[a])}if(goog.isObject(o)){o.remainder=r?r.nodeValue.length+e-n-1:0;o.node=r}return r};goog.dom.isNodeList=function(t){if(t&&"number"==typeof t.length){if(goog.isObject(t))return"function"==typeof t.item||"string"==typeof t.item;if(goog.isFunction(t))return"function"==typeof t.item}return!1};goog.dom.getAncestorByTagNameAndClass=function(t,e,o){if(!e&&!o)return null;var i=e?e.toUpperCase():null;return goog.dom.getAncestor(t,function(t){return!(i&&t.nodeName!=i||o&&!goog.dom.classes.has(t,o))},!0)};goog.dom.getAncestorByClass=function(t,e){return goog.dom.getAncestorByTagNameAndClass(t,null,e)};goog.dom.getAncestor=function(t,e,o,i){o||(t=t.parentNode);for(var n=null==i,r=0;t&&(n||i>=r);){if(e(t))return t;t=t.parentNode;r++}return null};goog.dom.getActiveElement=function(t){try{return t&&t.activeElement}catch(e){}return null};goog.dom.devicePixelRatio_;goog.dom.getPixelRatio=goog.functions.cacheReturnValue(function(){var t=goog.dom.getWindow(),e=goog.userAgent.GECKO&&goog.userAgent.MOBILE;return goog.isDef(t.devicePixelRatio)&&!e?t.devicePixelRatio:t.matchMedia?goog.dom.matchesPixelRatio_(.75)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(3)||1:1});goog.dom.matchesPixelRatio_=function(t){var e=goog.dom.getWindow(),o="(-webkit-min-device-pixel-ratio: "+t+"),(min--moz-device-pixel-ratio: "+t+"),(min-resolution: "+t+"dppx)";return e.matchMedia(o).matches?t:0};goog.dom.DomHelper=function(t){this.document_=t||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(t){this.document_=t};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(t){return goog.dom.getElementHelper_(this.document_,t)};goog.dom.DomHelper.prototype.getRequiredElement=function(t){return goog.dom.getRequiredElementHelper_(this.document_,t)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(t,e,o){return goog.dom.getElementsByTagNameAndClass_(this.document_,t,e,o)};goog.dom.DomHelper.prototype.getElementsByClass=function(t,e){var o=e||this.document_;return goog.dom.getElementsByClass(t,o)};goog.dom.DomHelper.prototype.getElementByClass=function(t,e){var o=e||this.document_;return goog.dom.getElementByClass(t,o)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(t){return goog.dom.getViewportSize(t||this.getWindow())};goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.Appendable;goog.dom.DomHelper.prototype.createDom=function(){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(t){return this.document_.createElement(t)};goog.dom.DomHelper.prototype.createTextNode=function(t){return this.document_.createTextNode(String(t))};goog.dom.DomHelper.prototype.createTable=function(t,e,o){return goog.dom.createTable_(this.document_,t,e,!!o)};goog.dom.DomHelper.prototype.htmlToDocumentFragment=function(t){return goog.dom.htmlToDocumentFragment_(this.document_,t)};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(t){return goog.dom.getActiveElement(t||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.provide("goog.structs.InversionMap");goog.require("goog.array");goog.structs.InversionMap=function(t,e,o){this.rangeArray=null;if(t.length!=e.length)return null;this.storeInversion_(t,o);this.values=e};goog.structs.InversionMap.prototype.storeInversion_=function(t,e){this.rangeArray=t;for(var o=1;o<t.length;o++)null==t[o]?t[o]=t[o-1]+1:e&&(t[o]+=t[o-1])};goog.structs.InversionMap.prototype.spliceInversion=function(t,e,o){var i=new goog.structs.InversionMap(t,e,o),n=i.rangeArray[0],r=goog.array.peek(i.rangeArray),s=this.getLeast(n),a=this.getLeast(r);n!=this.rangeArray[s]&&s++;var l=a-s+1;goog.partial(goog.array.splice,this.rangeArray,s,l).apply(null,i.rangeArray);goog.partial(goog.array.splice,this.values,s,l).apply(null,i.values)};goog.structs.InversionMap.prototype.at=function(t){var e=this.getLeast(t);return 0>e?null:this.values[e]};goog.structs.InversionMap.prototype.getLeast=function(t){for(var e=this.rangeArray,o=0,i=e.length;i-o>8;){var n=i+o>>1;e[n]<=t?o=n:i=n}for(;i>o&&!(t<e[o]);++o);return o-1};goog.provide("goog.i18n.GraphemeBreak");goog.require("goog.structs.InversionMap");goog.i18n.GraphemeBreak.property={ANY:0,CONTROL:1,EXTEND:2,PREPEND:3,SPACING_MARK:4,INDIC_CONSONANT:5,VIRAMA:6,L:7,V:8,T:9,LV:10,LVT:11,CR:12,LF:13,REGIONAL_INDICATOR:14};goog.i18n.GraphemeBreak.inversions_=null;goog.i18n.GraphemeBreak.applyLegacyBreakRules_=function(t,e){var o=goog.i18n.GraphemeBreak.property;return t==o.CR&&e==o.LF?!1:t==o.CONTROL||t==o.CR||t==o.LF?!0:e==o.CONTROL||e==o.CR||e==o.LF?!0:(t!=o.L||e!=o.L&&e!=o.V&&e!=o.LV&&e!=o.LVT)&&(t!=o.LV&&t!=o.V||e!=o.V&&e!=o.T)&&(t!=o.LVT&&t!=o.T||e!=o.T)?e==o.EXTEND||e==o.VIRAMA?!1:t==o.VIRAMA&&e==o.INDIC_CONSONANT?!1:!0:!1};goog.i18n.GraphemeBreak.getBreakProp_=function(t){if(t>=44032&&55203>=t){var e=goog.i18n.GraphemeBreak.property;return t%28==16?e.LV:e.LVT}goog.i18n.GraphemeBreak.inversions_||(goog.i18n.GraphemeBreak.inversions_=new goog.structs.InversionMap([0,10,1,2,1,18,95,33,13,1,594,112,275,7,263,45,1,1,1,2,1,2,1,1,56,5,11,11,48,21,16,1,101,7,1,1,6,2,2,1,4,33,1,1,1,30,27,91,11,58,9,34,4,1,9,1,3,1,5,43,3,136,31,1,17,37,1,1,1,1,3,8,4,1,2,1,7,8,2,2,21,8,1,2,17,39,1,1,1,2,6,6,1,9,5,4,2,2,12,2,15,2,1,17,39,2,3,12,4,8,6,17,2,3,14,1,17,39,1,1,3,8,4,1,20,2,29,1,2,17,39,1,1,2,1,6,6,9,6,4,2,2,13,1,16,1,18,41,1,1,1,12,1,9,1,41,3,17,37,4,3,5,7,8,3,2,8,2,30,2,17,39,1,1,1,1,2,1,3,1,5,1,8,9,1,3,2,30,2,17,38,3,1,2,5,7,1,9,1,10,2,30,2,22,48,5,1,2,6,7,19,2,13,46,2,1,1,1,6,1,12,8,50,46,2,1,1,1,9,11,6,14,2,58,2,27,1,1,1,1,1,4,2,49,14,1,4,1,1,2,5,48,9,1,57,33,12,4,1,6,1,2,2,2,1,16,2,4,2,2,4,3,1,3,2,7,3,4,13,1,1,1,2,6,1,1,14,1,98,96,72,88,349,3,931,15,2,1,14,15,2,1,14,15,2,15,15,14,35,17,2,1,7,8,1,2,9,1,1,9,1,45,3,155,1,87,31,3,4,2,9,1,6,3,20,19,29,44,9,3,2,1,69,23,2,3,4,45,6,2,1,1,1,8,1,1,1,2,8,6,13,128,4,1,14,33,1,1,5,1,1,5,1,1,1,7,31,9,12,2,1,7,23,1,4,2,2,2,2,2,11,3,2,36,2,1,1,2,3,1,1,3,2,12,36,8,8,2,2,21,3,128,3,1,13,1,7,4,1,4,2,1,203,64,523,1,2,2,24,7,49,16,96,33,3070,3,141,1,96,32,554,6,105,2,30164,4,1,10,33,1,80,2,272,1,3,1,4,1,23,2,2,1,24,30,4,4,3,8,1,1,13,2,16,34,16,1,27,18,24,24,4,8,2,23,11,1,1,12,32,3,1,5,3,3,36,1,2,4,2,1,3,1,69,35,6,2,2,2,2,12,1,8,1,1,18,16,1,3,6,1,5,48,1,1,3,2,2,5,2,1,1,32,9,1,2,2,5,1,1,201,14,2,1,1,9,8,2,1,2,1,2,1,1,1,18,11184,27,49,1028,1024,6942,1,737,16,16,7,216,1,158,2,89,3,513,1,2051,15,40,7,1,1472,1,1,1,53,14,1,57,2,1,45,3,4,2,1,1,2,1,66,3,36,5,1,6,2,75,2,1,48,3,9,1,1,1258,1,1,1,2,6,1,1,22681,62,4,25042,1,1,3,3,1,5,8,8,2,7,30,4,148,3,8097,26,790017,255],[1,13,1,12,1,0,1,0,1,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,1,0,2,0,2,0,2,0,2,1,0,2,0,2,0,2,0,1,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,4,0,5,2,4,2,0,4,2,4,6,4,0,2,5,0,2,0,5,2,4,0,5,2,0,2,4,2,4,6,0,2,5,0,2,0,5,0,2,4,0,5,2,4,2,6,2,5,0,2,0,2,4,0,5,2,0,4,2,4,6,0,2,0,2,4,0,5,2,0,2,4,2,4,6,2,5,0,2,0,5,0,2,0,5,2,4,2,4,6,0,2,0,4,0,5,0,2,4,2,6,2,5,0,2,0,4,0,5,2,0,4,2,4,2,4,2,4,2,6,2,5,0,2,0,4,0,5,0,2,4,2,4,6,0,2,0,2,0,4,0,5,6,2,4,2,4,2,4,0,5,0,2,0,4,2,6,0,2,0,5,0,2,0,4,2,0,2,0,5,0,2,0,2,0,2,0,2,0,4,5,2,4,2,6,0,2,0,2,0,2,0,5,0,2,4,2,0,6,4,2,5,0,5,0,4,2,5,2,5,0,5,0,5,2,5,2,0,4,2,0,2,5,0,2,0,7,8,9,0,2,0,5,2,6,0,5,2,6,0,5,2,0,5,2,5,0,2,4,2,4,2,4,2,6,2,0,2,0,2,0,2,0,5,2,4,2,4,2,4,2,0,5,0,5,0,4,0,4,0,5,2,4,0,5,0,5,4,2,4,2,6,0,2,0,2,4,2,0,2,4,0,5,2,4,2,4,2,4,2,4,6,5,0,2,0,2,4,0,5,4,2,4,2,6,4,5,0,5,0,5,0,2,4,2,4,2,4,2,6,0,5,4,2,4,2,0,5,0,2,0,2,4,2,0,2,0,4,2,0,2,0,1,2,1,0,1,0,1,0,2,0,2,0,6,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,6,5,2,5,4,2,4,0,5,0,5,0,5,0,5,0,4,0,5,4,6,0,2,0,5,0,2,0,5,2,4,6,0,7,2,4,0,5,0,5,2,4,2,4,2,4,6,0,5,2,4,2,4,2,0,2,0,2,4,0,5,0,5,0,5,0,5,2,0,2,0,2,0,2,0,2,0,5,4,2,4,0,4,6,0,5,0,5,0,5,0,4,2,4,2,4,0,4,6,0,11,8,9,0,2,0,2,0,2,0,2,0,1,0,2,0,1,0,2,0,2,0,2,6,0,4,2,4,0,2,6,0,2,4,0,4,2,4,6,2,0,1,0,2,0,2,4,2,6,0,2,4,0,4,2,4,6,0,2,4,2,4,2,6,2,0,4,2,0,2,4,2,0,4,2,1,2,0,2,0,2,0,2,0,14,0,1,2],!0));return goog.i18n.GraphemeBreak.inversions_.at(t)};goog.i18n.GraphemeBreak.hasGraphemeBreak=function(t,e,o){var i=goog.i18n.GraphemeBreak.getBreakProp_(t),n=goog.i18n.GraphemeBreak.getBreakProp_(e),r=goog.i18n.GraphemeBreak.property;return goog.i18n.GraphemeBreak.applyLegacyBreakRules_(i,n)&&!(o&&(i==r.PREPEND||n==r.SPACING_MARK))};goog.provide("goog.format");goog.require("goog.i18n.GraphemeBreak");goog.require("goog.string");goog.require("goog.userAgent");goog.format.fileSize=function(t,e){return goog.format.numBytesToString(t,e,!1)};goog.format.isConvertableScaledNumber=function(t){return goog.format.SCALED_NUMERIC_RE_.test(t)};goog.format.stringToNumericValue=function(t){return goog.string.endsWith(t,"B")?goog.format.stringToNumericValue_(t,goog.format.NUMERIC_SCALES_BINARY_):goog.format.stringToNumericValue_(t,goog.format.NUMERIC_SCALES_SI_)};goog.format.stringToNumBytes=function(t){return goog.format.stringToNumericValue_(t,goog.format.NUMERIC_SCALES_BINARY_)};goog.format.numericValueToString=function(t,e){return goog.format.numericValueToString_(t,goog.format.NUMERIC_SCALES_SI_,e)};goog.format.numBytesToString=function(t,e,o,i){var n="";(!goog.isDef(o)||o)&&(n="B");return goog.format.numericValueToString_(t,goog.format.NUMERIC_SCALES_BINARY_,e,n,i)};goog.format.stringToNumericValue_=function(t,e){var o=t.match(goog.format.SCALED_NUMERIC_RE_);if(!o)return 0/0;var i=o[1]*e[o[2]];return i};goog.format.numericValueToString_=function(t,e,o,i,n){var r=goog.format.NUMERIC_SCALE_PREFIXES_,s=t,a="",l="",g=1;0>t&&(t=-t);for(var m=0;m<r.length;m++){var c=r[m];g=e[c];if(t>=g||1>=g&&t>.1*g){a=c;break}}if(a){i&&(a+=i);n&&(l=" ")}else g=1;var u=Math.pow(10,goog.isDef(o)?o:2);return Math.round(s/g*u)/u+l+a};goog.format.SCALED_NUMERIC_RE_=/^([-]?\d+\.?\d*)([K,M,G,T,P,k,m,u,n]?)[B]?$/;goog.format.NUMERIC_SCALE_PREFIXES_=["P","T","G","M","K","","m","u","n"];goog.format.NUMERIC_SCALES_SI_={"":1,n:1e-9,u:1e-6,m:.001,k:1e3,K:1e3,M:1e6,G:1e9,T:1e12,P:1e15};goog.format.NUMERIC_SCALES_BINARY_={"":1,n:Math.pow(1024,-3),u:Math.pow(1024,-2),m:1/1024,k:1024,K:1024,M:Math.pow(1024,2),G:Math.pow(1024,3),T:Math.pow(1024,4),P:Math.pow(1024,5)};goog.format.FIRST_GRAPHEME_EXTEND_=768;goog.format.isTreatedAsBreakingSpace_=function(t){return t<=goog.format.WbrToken_.SPACE||t>=4096&&(t>=8192&&8198>=t||t>=8200&&8203>=t||5760==t||6158==t||8232==t||8233==t||8287==t||12288==t)};goog.format.isInvisibleFormattingCharacter_=function(t){return t>=8204&&8207>=t||t>=8234&&8238>=t};goog.format.insertWordBreaksGeneric_=function(t,e,o){var i=o||10;if(i>t.length)return t;for(var n=[],r=0,s=0,a=0,l=0,g=0;g<t.length;g++){var m=l;l=t.charCodeAt(g);var c=l>=goog.format.FIRST_GRAPHEME_EXTEND_&&!e(m,l,!0);if(r>=i&&!goog.format.isTreatedAsBreakingSpace_(l)&&!c){n.push(t.substring(a,g),goog.format.WORD_BREAK_HTML);a=g;r=0}if(s){if(l==goog.format.WbrToken_.GT&&s==goog.format.WbrToken_.LT)s=0;else if(l==goog.format.WbrToken_.SEMI_COLON&&s==goog.format.WbrToken_.AMP){s=0;r++}}else l==goog.format.WbrToken_.LT||l==goog.format.WbrToken_.AMP?s=l:goog.format.isTreatedAsBreakingSpace_(l)?r=0:goog.format.isInvisibleFormattingCharacter_(l)||r++}n.push(t.substr(a));return n.join("")};goog.format.insertWordBreaks=function(t,e){return goog.format.insertWordBreaksGeneric_(t,goog.i18n.GraphemeBreak.hasGraphemeBreak,e)};goog.format.conservativelyHasGraphemeBreak_=function(t,e){return e>=1024&&1315>e};goog.format.insertWordBreaksBasic=function(t,e){return goog.format.insertWordBreaksGeneric_(t,goog.format.conservativelyHasGraphemeBreak_,e)};goog.format.IS_IE8_OR_ABOVE_=goog.userAgent.IE&&goog.userAgent.isVersionOrHigher(8);goog.format.WORD_BREAK_HTML=goog.userAgent.WEBKIT?"<wbr></wbr>":goog.userAgent.OPERA?"&shy;":goog.format.IS_IE8_OR_ABOVE_?"&#8203;":"<wbr>";goog.format.WbrToken_={LT:60,GT:62,AMP:38,SEMI_COLON:59,SPACE:32};goog.provide("goog.i18n.bidi");goog.provide("goog.i18n.bidi.Dir");goog.provide("goog.i18n.bidi.Format");goog.define("goog.i18n.bidi.FORCE_RTL",!1);goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3));goog.i18n.bidi.Format={LRE:"‪",RLE:"‫",PDF:"‬",LRM:"‎",RLM:"‏"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0,UNKNOWN:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(t,e){return"number"==typeof t?t>0?goog.i18n.bidi.Dir.LTR:0>t?goog.i18n.bidi.Dir.RTL:e?null:goog.i18n.bidi.Dir.NEUTRAL:null==t?null:t?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.ltrChars_="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿";goog.i18n.bidi.rtlChars_="֑-߿‏יִ-﷿ﹰ-ﻼ";goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(t,e){return e?t.replace(goog.i18n.bidi.htmlSkipReg_,""):t};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(t,e){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;goog.i18n.bidi.hasAnyLtr=function(t,e){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(t){return goog.i18n.bidi.rtlRe_.test(t)};goog.i18n.bidi.isLtrChar=function(t){return goog.i18n.bidi.ltrRe_.test(t)};goog.i18n.bidi.isNeutralChar=function(t){return!goog.i18n.bidi.isLtrChar(t)&&!goog.i18n.bidi.isRtlChar(t)};goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(t,e){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;goog.i18n.bidi.startsWithLtr=function(t,e){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(t,e){t=goog.i18n.bidi.stripHtmlIfNeeded_(t,e);return goog.i18n.bidi.isRequiredLtrRe_.test(t)||!goog.i18n.bidi.hasAnyLtr(t)&&!goog.i18n.bidi.hasAnyRtl(t)};goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(t,e){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;goog.i18n.bidi.endsWithRtl=function(t,e){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=new RegExp("^(ar|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)","i");goog.i18n.bidi.isRtlLanguage=function(t){return goog.i18n.bidi.rtlLocalesRe_.test(t)};goog.i18n.bidi.bracketGuardHtmlRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(&lt;.*?(&gt;)+)/g;goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;goog.i18n.bidi.guardBracketInHtml=function(t,e){var o=void 0===e?goog.i18n.bidi.hasAnyRtl(t):e;return o?t.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=rtl>$&</span>"):t.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=ltr>$&</span>")};goog.i18n.bidi.guardBracketInText=function(t,e){var o=void 0===e?goog.i18n.bidi.hasAnyRtl(t):e,i=o?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return t.replace(goog.i18n.bidi.bracketGuardTextRe_,i+"$&"+i)};goog.i18n.bidi.enforceRtlInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+t+"</span>"};goog.i18n.bidi.enforceRtlInText=function(t){return goog.i18n.bidi.Format.RLE+t+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.enforceLtrInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+t+"</span>"};goog.i18n.bidi.enforceLtrInText=function(t){return goog.i18n.bidi.Format.LRE+t+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;goog.i18n.bidi.mirrorCSS=function(t){return t.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;goog.i18n.bidi.normalizeHebrewQuote=function(t){return t.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1״").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1׳")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/\d/;goog.i18n.bidi.rtlDetectionThreshold_=.4;goog.i18n.bidi.estimateDirection=function(t,e){for(var o=0,i=0,n=!1,r=goog.i18n.bidi.stripHtmlIfNeeded_(t,e).split(goog.i18n.bidi.wordSeparatorRe_),s=0;s<r.length;s++){var a=r[s];if(goog.i18n.bidi.startsWithRtl(a)){o++;i++}else goog.i18n.bidi.isRequiredLtrRe_.test(a)?n=!0:goog.i18n.bidi.hasAnyLtr(a)?i++:goog.i18n.bidi.hasNumeralsRe_.test(a)&&(n=!0)}return 0==i?n?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:o/i>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.detectRtlDirectionality=function(t,e){return goog.i18n.bidi.estimateDirection(t,e)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(t,e){if(t){e=goog.i18n.bidi.toDir(e);if(e){t.style.textAlign=e==goog.i18n.bidi.Dir.RTL?"right":"left";t.dir=e==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"}}};goog.provide("goog.i18n.bidi");goog.provide("goog.i18n.bidi.Dir");goog.provide("goog.i18n.bidi.Format");goog.define("goog.i18n.bidi.FORCE_RTL",!1);goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3));goog.i18n.bidi.Format={LRE:"‪",RLE:"‫",PDF:"‬",LRM:"‎",RLM:"‏"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0,UNKNOWN:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(t,e){return"number"==typeof t?t>0?goog.i18n.bidi.Dir.LTR:0>t?goog.i18n.bidi.Dir.RTL:e?null:goog.i18n.bidi.Dir.NEUTRAL:null==t?null:t?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR
};goog.i18n.bidi.ltrChars_="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿";goog.i18n.bidi.rtlChars_="֑-߿‏יִ-﷿ﹰ-ﻼ";goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(t,e){return e?t.replace(goog.i18n.bidi.htmlSkipReg_,""):t};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(t,e){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;goog.i18n.bidi.hasAnyLtr=function(t,e){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(t){return goog.i18n.bidi.rtlRe_.test(t)};goog.i18n.bidi.isLtrChar=function(t){return goog.i18n.bidi.ltrRe_.test(t)};goog.i18n.bidi.isNeutralChar=function(t){return!goog.i18n.bidi.isLtrChar(t)&&!goog.i18n.bidi.isRtlChar(t)};goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(t,e){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;goog.i18n.bidi.startsWithLtr=function(t,e){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(t,e){t=goog.i18n.bidi.stripHtmlIfNeeded_(t,e);return goog.i18n.bidi.isRequiredLtrRe_.test(t)||!goog.i18n.bidi.hasAnyLtr(t)&&!goog.i18n.bidi.hasAnyRtl(t)};goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(t,e){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;goog.i18n.bidi.endsWithRtl=function(t,e){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=new RegExp("^(ar|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)","i");goog.i18n.bidi.isRtlLanguage=function(t){return goog.i18n.bidi.rtlLocalesRe_.test(t)};goog.i18n.bidi.bracketGuardHtmlRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(&lt;.*?(&gt;)+)/g;goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;goog.i18n.bidi.guardBracketInHtml=function(t,e){var o=void 0===e?goog.i18n.bidi.hasAnyRtl(t):e;return o?t.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=rtl>$&</span>"):t.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=ltr>$&</span>")};goog.i18n.bidi.guardBracketInText=function(t,e){var o=void 0===e?goog.i18n.bidi.hasAnyRtl(t):e,i=o?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return t.replace(goog.i18n.bidi.bracketGuardTextRe_,i+"$&"+i)};goog.i18n.bidi.enforceRtlInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+t+"</span>"};goog.i18n.bidi.enforceRtlInText=function(t){return goog.i18n.bidi.Format.RLE+t+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.enforceLtrInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+t+"</span>"};goog.i18n.bidi.enforceLtrInText=function(t){return goog.i18n.bidi.Format.LRE+t+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;goog.i18n.bidi.mirrorCSS=function(t){return t.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;goog.i18n.bidi.normalizeHebrewQuote=function(t){return t.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1״").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1׳")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/\d/;goog.i18n.bidi.rtlDetectionThreshold_=.4;goog.i18n.bidi.estimateDirection=function(t,e){for(var o=0,i=0,n=!1,r=goog.i18n.bidi.stripHtmlIfNeeded_(t,e).split(goog.i18n.bidi.wordSeparatorRe_),s=0;s<r.length;s++){var a=r[s];if(goog.i18n.bidi.startsWithRtl(a)){o++;i++}else goog.i18n.bidi.isRequiredLtrRe_.test(a)?n=!0:goog.i18n.bidi.hasAnyLtr(a)?i++:goog.i18n.bidi.hasNumeralsRe_.test(a)&&(n=!0)}return 0==i?n?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:o/i>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.detectRtlDirectionality=function(t,e){return goog.i18n.bidi.estimateDirection(t,e)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(t,e){if(t){e=goog.i18n.bidi.toDir(e);if(e){t.style.textAlign=e==goog.i18n.bidi.Dir.RTL?"right":"left";t.dir=e==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"}}};goog.provide("goog.i18n.bidi");goog.provide("goog.i18n.bidi.Dir");goog.provide("goog.i18n.bidi.Format");goog.define("goog.i18n.bidi.FORCE_RTL",!1);goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3));goog.i18n.bidi.Format={LRE:"‪",RLE:"‫",PDF:"‬",LRM:"‎",RLM:"‏"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0,UNKNOWN:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(t,e){return"number"==typeof t?t>0?goog.i18n.bidi.Dir.LTR:0>t?goog.i18n.bidi.Dir.RTL:e?null:goog.i18n.bidi.Dir.NEUTRAL:null==t?null:t?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.ltrChars_="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿";goog.i18n.bidi.rtlChars_="֑-߿‏יִ-﷿ﹰ-ﻼ";goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(t,e){return e?t.replace(goog.i18n.bidi.htmlSkipReg_,""):t};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(t,e){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;goog.i18n.bidi.hasAnyLtr=function(t,e){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(t){return goog.i18n.bidi.rtlRe_.test(t)};goog.i18n.bidi.isLtrChar=function(t){return goog.i18n.bidi.ltrRe_.test(t)};goog.i18n.bidi.isNeutralChar=function(t){return!goog.i18n.bidi.isLtrChar(t)&&!goog.i18n.bidi.isRtlChar(t)};goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(t,e){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;goog.i18n.bidi.startsWithLtr=function(t,e){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(t,e){t=goog.i18n.bidi.stripHtmlIfNeeded_(t,e);return goog.i18n.bidi.isRequiredLtrRe_.test(t)||!goog.i18n.bidi.hasAnyLtr(t)&&!goog.i18n.bidi.hasAnyRtl(t)};goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(t,e){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;goog.i18n.bidi.endsWithRtl=function(t,e){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=new RegExp("^(ar|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)","i");goog.i18n.bidi.isRtlLanguage=function(t){return goog.i18n.bidi.rtlLocalesRe_.test(t)};goog.i18n.bidi.bracketGuardHtmlRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(&lt;.*?(&gt;)+)/g;goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;goog.i18n.bidi.guardBracketInHtml=function(t,e){var o=void 0===e?goog.i18n.bidi.hasAnyRtl(t):e;return o?t.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=rtl>$&</span>"):t.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=ltr>$&</span>")};goog.i18n.bidi.guardBracketInText=function(t,e){var o=void 0===e?goog.i18n.bidi.hasAnyRtl(t):e,i=o?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return t.replace(goog.i18n.bidi.bracketGuardTextRe_,i+"$&"+i)};goog.i18n.bidi.enforceRtlInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+t+"</span>"};goog.i18n.bidi.enforceRtlInText=function(t){return goog.i18n.bidi.Format.RLE+t+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.enforceLtrInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+t+"</span>"};goog.i18n.bidi.enforceLtrInText=function(t){return goog.i18n.bidi.Format.LRE+t+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;goog.i18n.bidi.mirrorCSS=function(t){return t.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;goog.i18n.bidi.normalizeHebrewQuote=function(t){return t.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1״").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1׳")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/\d/;goog.i18n.bidi.rtlDetectionThreshold_=.4;goog.i18n.bidi.estimateDirection=function(t,e){for(var o=0,i=0,n=!1,r=goog.i18n.bidi.stripHtmlIfNeeded_(t,e).split(goog.i18n.bidi.wordSeparatorRe_),s=0;s<r.length;s++){var a=r[s];if(goog.i18n.bidi.startsWithRtl(a)){o++;i++}else goog.i18n.bidi.isRequiredLtrRe_.test(a)?n=!0:goog.i18n.bidi.hasAnyLtr(a)?i++:goog.i18n.bidi.hasNumeralsRe_.test(a)&&(n=!0)}return 0==i?n?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:o/i>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.detectRtlDirectionality=function(t,e){return goog.i18n.bidi.estimateDirection(t,e)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(t,e){if(t){e=goog.i18n.bidi.toDir(e);if(e){t.style.textAlign=e==goog.i18n.bidi.Dir.RTL?"right":"left";t.dir=e==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"}}};goog.provide("goog.i18n.BidiFormatter");goog.require("goog.i18n.bidi");goog.require("goog.i18n.bidi.Dir");goog.require("goog.i18n.bidi.Format");goog.require("goog.string");goog.i18n.BidiFormatter=function(t,e){this.contextDir_=goog.i18n.bidi.toDir(t,!0);this.alwaysSpan_=!!e};goog.i18n.BidiFormatter.prototype.getContextDir=function(){return this.contextDir_};goog.i18n.BidiFormatter.prototype.getAlwaysSpan=function(){return this.alwaysSpan_};goog.i18n.BidiFormatter.prototype.setContextDir=function(t){this.contextDir_=goog.i18n.bidi.toDir(t,!0)};goog.i18n.BidiFormatter.prototype.setAlwaysSpan=function(t){this.alwaysSpan_=t};goog.i18n.BidiFormatter.prototype.estimateDirection=goog.i18n.bidi.estimateDirection;goog.i18n.BidiFormatter.prototype.areDirectionalitiesOpposite_=function(t,e){return 0>t*e};goog.i18n.BidiFormatter.prototype.dirResetIfNeeded_=function(t,e,o,i){return i&&(this.areDirectionalitiesOpposite_(e,this.contextDir_)||this.contextDir_==goog.i18n.bidi.Dir.LTR&&goog.i18n.bidi.endsWithRtl(t,o)||this.contextDir_==goog.i18n.bidi.Dir.RTL&&goog.i18n.bidi.endsWithLtr(t,o))?this.contextDir_==goog.i18n.bidi.Dir.LTR?goog.i18n.bidi.Format.LRM:goog.i18n.bidi.Format.RLM:""};goog.i18n.BidiFormatter.prototype.dirAttrValue=function(t,e){return this.knownDirAttrValue(this.estimateDirection(t,e))};goog.i18n.BidiFormatter.prototype.knownDirAttrValue=function(t){var e=t==goog.i18n.bidi.Dir.NEUTRAL?this.contextDir_:t;return e==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"};goog.i18n.BidiFormatter.prototype.dirAttr=function(t,e){return this.knownDirAttr(this.estimateDirection(t,e))};goog.i18n.BidiFormatter.prototype.knownDirAttr=function(t){return t!=this.contextDir_?t==goog.i18n.bidi.Dir.RTL?'dir="rtl"':t==goog.i18n.bidi.Dir.LTR?'dir="ltr"':"":""};goog.i18n.BidiFormatter.prototype.spanWrap=function(t,e,o){return this.spanWrapWithKnownDir(null,t,e,o)};goog.i18n.BidiFormatter.prototype.spanWrapWithKnownDir=function(t,e,o,i){null==t&&(t=this.estimateDirection(e,o));return this.spanWrapWithKnownDir_(t,e,o,i)};goog.i18n.BidiFormatter.prototype.spanWrapWithKnownDir_=function(t,e,o,i){i=i||void 0==i;o||(e=goog.string.htmlEscape(e));var n=[],r=t!=goog.i18n.bidi.Dir.NEUTRAL&&t!=this.contextDir_;if(this.alwaysSpan_||r){n.push("<span");r&&n.push(t==goog.i18n.bidi.Dir.RTL?' dir="rtl"':' dir="ltr"');n.push(">"+e+"</span>")}else n.push(e);n.push(this.dirResetIfNeeded_(e,t,!0,i));return n.join("")};goog.i18n.BidiFormatter.prototype.unicodeWrap=function(t,e,o){return this.unicodeWrapWithKnownDir(null,t,e,o)};goog.i18n.BidiFormatter.prototype.unicodeWrapWithKnownDir=function(t,e,o,i){null==t&&(t=this.estimateDirection(e,o));return this.unicodeWrapWithKnownDir_(t,e,o,i)};goog.i18n.BidiFormatter.prototype.unicodeWrapWithKnownDir_=function(t,e,o,i){i=i||void 0==i;var n=[];if(t!=goog.i18n.bidi.Dir.NEUTRAL&&t!=this.contextDir_){n.push(t==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.Format.RLE:goog.i18n.bidi.Format.LRE);n.push(e);n.push(goog.i18n.bidi.Format.PDF)}else n.push(e);n.push(this.dirResetIfNeeded_(e,t,o,i));return n.join("")};goog.i18n.BidiFormatter.prototype.markAfter=function(t,e){return this.markAfterKnownDir(null,t,e)};goog.i18n.BidiFormatter.prototype.markAfterKnownDir=function(t,e,o){null==t&&(t=this.estimateDirection(e,o));return this.dirResetIfNeeded_(e,t,o,!0)};goog.i18n.BidiFormatter.prototype.mark=function(){switch(this.contextDir_){case goog.i18n.bidi.Dir.LTR:return goog.i18n.bidi.Format.LRM;case goog.i18n.bidi.Dir.RTL:return goog.i18n.bidi.Format.RLM;default:return""}};goog.i18n.BidiFormatter.prototype.startEdge=function(){return this.contextDir_==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT};goog.i18n.BidiFormatter.prototype.endEdge=function(){return this.contextDir_==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT};goog.provide("goog.soy.data");goog.provide("goog.soy.data.SanitizedContent");goog.provide("goog.soy.data.SanitizedContentKind");goog.require("goog.i18n.bidi.Dir");goog.soy.data.SanitizedContentKind={HTML:goog.DEBUG?{sanitizedContentKindHtml:!0}:{},JS:goog.DEBUG?{sanitizedContentJsStrChars:!0}:{},JS_STR_CHARS:goog.DEBUG?{sanitizedContentJsStrChars:!0}:{},URI:goog.DEBUG?{sanitizedContentUri:!0}:{},ATTRIBUTES:goog.DEBUG?{sanitizedContentHtmlAttribute:!0}:{},CSS:goog.DEBUG?{sanitizedContentCss:!0}:{},TEXT:goog.DEBUG?{sanitizedContentKindText:!0}:{}};goog.soy.data.SanitizedContent=function(){throw Error("Do not instantiate directly")};goog.soy.data.SanitizedContent.prototype.contentKind;goog.soy.data.SanitizedContent.prototype.contentDir=null;goog.soy.data.SanitizedContent.prototype.content;goog.soy.data.SanitizedContent.prototype.toString=function(){return this.content};goog.provide("goog.soy");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.soy.data");goog.require("goog.string");goog.define("goog.soy.REQUIRE_STRICT_AUTOESCAPE",!1);goog.soy.renderElement=function(t,e,o,i){t.innerHTML=goog.soy.ensureTemplateOutputHtml_(e(o||goog.soy.defaultTemplateData_,void 0,i))};goog.soy.renderAsFragment=function(t,e,o,i){var n=i||goog.dom.getDomHelper(),r=goog.soy.ensureTemplateOutputHtml_(t(e||goog.soy.defaultTemplateData_,void 0,o));goog.soy.assertFirstTagValid_(r);return n.htmlToDocumentFragment(r)};goog.soy.renderAsElement=function(t,e,o,i){var n=i||goog.dom.getDomHelper(),r=n.createElement(goog.dom.TagName.DIV),s=goog.soy.ensureTemplateOutputHtml_(t(e||goog.soy.defaultTemplateData_,void 0,o));goog.soy.assertFirstTagValid_(s);r.innerHTML=s;if(1==r.childNodes.length){var a=r.firstChild;if(a.nodeType==goog.dom.NodeType.ELEMENT)return a}return r};goog.soy.ensureTemplateOutputHtml_=function(t){if(!goog.soy.REQUIRE_STRICT_AUTOESCAPE&&!goog.isObject(t))return String(t);if(t instanceof goog.soy.data.SanitizedContent){t=t;var e=goog.soy.data.SanitizedContentKind;if(t.contentKind===e.HTML)return goog.asserts.assertString(t.content);if(t.contentKind===e.TEXT)return goog.string.htmlEscape(t.content)}goog.asserts.fail("Soy template output is unsafe for use as HTML: "+t);return"zSoyz"};goog.soy.assertFirstTagValid_=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=t.match(goog.soy.INVALID_TAG_TO_RENDER_);goog.asserts.assert(!e,"This template starts with a %s, which cannot be a child of a <div>, as required by soy internals. Consider using goog.soy.renderElement instead.\nTemplate output: %s",e&&e[0],t)}};goog.soy.INVALID_TAG_TO_RENDER_=/^<(body|caption|col|colgroup|head|html|tr|td|tbody|thead|tfoot)>/i;goog.soy.defaultTemplateData_={};goog.provide("goog.soy.data");goog.provide("goog.soy.data.SanitizedContent");goog.provide("goog.soy.data.SanitizedContentKind");goog.require("goog.i18n.bidi.Dir");goog.soy.data.SanitizedContentKind={HTML:goog.DEBUG?{sanitizedContentKindHtml:!0}:{},JS:goog.DEBUG?{sanitizedContentJsStrChars:!0}:{},JS_STR_CHARS:goog.DEBUG?{sanitizedContentJsStrChars:!0}:{},URI:goog.DEBUG?{sanitizedContentUri:!0}:{},ATTRIBUTES:goog.DEBUG?{sanitizedContentHtmlAttribute:!0}:{},CSS:goog.DEBUG?{sanitizedContentCss:!0}:{},TEXT:goog.DEBUG?{sanitizedContentKindText:!0}:{}};goog.soy.data.SanitizedContent=function(){throw Error("Do not instantiate directly")};goog.soy.data.SanitizedContent.prototype.contentKind;goog.soy.data.SanitizedContent.prototype.contentDir=null;goog.soy.data.SanitizedContent.prototype.content;goog.soy.data.SanitizedContent.prototype.toString=function(){return this.content};goog.provide("goog.string.StringBuffer");goog.string.StringBuffer=function(t){null!=t&&this.append.apply(this,arguments)};goog.string.StringBuffer.prototype.buffer_="";goog.string.StringBuffer.prototype.set=function(t){this.buffer_=""+t};goog.string.StringBuffer.prototype.append=function(t,e){this.buffer_+=t;if(null!=e)for(var o=1;o<arguments.length;o++)this.buffer_+=arguments[o];return this};goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""};goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length};goog.string.StringBuffer.prototype.toString=function(){return this.buffer_};goog.provide("soy");goog.provide("soy.StringBuilder");goog.provide("soy.esc");goog.provide("soydata");goog.provide("soydata.SanitizedHtml");goog.provide("soydata.SanitizedHtmlAttribute");goog.provide("soydata.SanitizedJs");goog.provide("soydata.SanitizedJsStrChars");goog.provide("soydata.SanitizedUri");goog.provide("soydata.VERY_UNSAFE");goog.require("goog.asserts");goog.require("goog.dom.DomHelper");goog.require("goog.format");goog.require("goog.i18n.BidiFormatter");goog.require("goog.i18n.bidi");goog.require("goog.soy");goog.require("goog.soy.data.SanitizedContentKind");goog.require("goog.string");goog.require("goog.string.StringBuffer");soy.StringBuilder=goog.string.StringBuffer;soydata.SanitizedContentKind=goog.soy.data.SanitizedContentKind;soydata.SanitizedHtml=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedHtml,goog.soy.data.SanitizedContent);soydata.SanitizedHtml.prototype.contentKind=soydata.SanitizedContentKind.HTML;soydata.SanitizedJs=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedJs,goog.soy.data.SanitizedContent);soydata.SanitizedJs.prototype.contentKind=soydata.SanitizedContentKind.JS;soydata.SanitizedJsStrChars=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedJsStrChars,goog.soy.data.SanitizedContent);soydata.SanitizedJsStrChars.prototype.contentKind=soydata.SanitizedContentKind.JS_STR_CHARS;soydata.SanitizedUri=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedUri,goog.soy.data.SanitizedContent);soydata.SanitizedUri.prototype.contentKind=soydata.SanitizedContentKind.URI;soydata.SanitizedHtmlAttribute=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedHtmlAttribute,goog.soy.data.SanitizedContent);soydata.SanitizedHtmlAttribute.prototype.contentKind=soydata.SanitizedContentKind.ATTRIBUTES;soydata.SanitizedCss=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedCss,goog.soy.data.SanitizedContent);soydata.SanitizedCss.prototype.contentKind=soydata.SanitizedContentKind.CSS;soydata.UnsanitizedText=function(t){this.content=String(t)};goog.inherits(soydata.UnsanitizedText,goog.soy.data.SanitizedContent);soydata.UnsanitizedText.prototype.contentKind=soydata.SanitizedContentKind.TEXT;soydata.$$makeSanitizedContentFactory_=function(t){function e(){}e.prototype=t.prototype;return function(t){var o=new e;o.content=String(t);return o}};soydata.markUnsanitizedText=function(t){return new soydata.UnsanitizedText(t)};soydata.VERY_UNSAFE.ordainSanitizedHtml=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedHtml);soydata.VERY_UNSAFE.ordainSanitizedJs=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedJs);soydata.VERY_UNSAFE.ordainSanitizedJsStrChars=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedJsStrChars);soydata.VERY_UNSAFE.ordainSanitizedUri=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedUri);soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedHtmlAttribute);soydata.VERY_UNSAFE.ordainSanitizedCss=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedCss);soy.renderElement=goog.soy.renderElement;soy.renderAsFragment=function(t,e,o,i){return goog.soy.renderAsFragment(t,e,i,new goog.dom.DomHelper(o))};soy.renderAsElement=function(t,e,o,i){return goog.soy.renderAsElement(t,e,i,new goog.dom.DomHelper(o))};soy.$$augmentMap=function(t,e){function o(){}o.prototype=t;var i=new o;for(var n in e)i[n]=e[n];return i};soy.$$checkMapKey=function(t){if("string"!=typeof t)throw Error("Map literal's key expression must evaluate to string (encountered type \""+typeof t+'").');return t};soy.$$getMapKeys=function(t){var e=[];for(var o in t)e.push(o);return e};soy.$$getDelTemplateId=function(t){return t};soy.$$DELEGATE_REGISTRY_PRIORITIES_={};soy.$$DELEGATE_REGISTRY_FUNCTIONS_={};soy.$$registerDelegateFn=function(t,e,o,i){var n="key_"+t+":"+e,r=soy.$$DELEGATE_REGISTRY_PRIORITIES_[n];if(void 0===r||o>r){soy.$$DELEGATE_REGISTRY_PRIORITIES_[n]=o;soy.$$DELEGATE_REGISTRY_FUNCTIONS_[n]=i}else if(o==r)throw Error('Encountered two active delegates with the same priority ("'+t+":"+e+'").')};soy.$$getDelegateFn=function(t,e,o){var i=soy.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+t+":"+e];i||""==e||(i=soy.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+t+":"]);if(i)return i;if(o)return soy.$$EMPTY_TEMPLATE_FN_;throw Error('Found no active impl for delegate call to "'+t+":"+e+'" (and not allowemptydefault="true").')};soy.$$EMPTY_TEMPLATE_FN_=function(){return""};soy.$$escapeHtml=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return t.content}return soy.esc.$$escapeHtmlHelper(t)};soy.$$cleanHtml=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return t.content}return soy.$$stripHtmlTags(t,soy.esc.$$SAFE_TAG_WHITELIST_)};soy.$$escapeHtmlRcdata=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return soy.esc.$$normalizeHtmlHelper(t.content)}return soy.esc.$$escapeHtmlHelper(t)};soy.$$HTML5_VOID_ELEMENTS_=new RegExp("^<(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\\b");soy.$$stripHtmlTags=function(t,e){if(!e)return String(t).replace(soy.esc.$$HTML_TAG_REGEX_,"").replace(soy.esc.$$LT_REGEX_,"&lt;");var o=String(t).replace(/\[/g,"&#91;"),i=[];o=o.replace(soy.esc.$$HTML_TAG_REGEX_,function(t,o){if(o){o=o.toLowerCase();if(e.hasOwnProperty(o)&&e[o]){var n="/"===t.charAt(1)?"</":"<",r=i.length;i[r]=n+o+">";return"["+r+"]"}}return""});o=soy.esc.$$normalizeHtmlHelper(o);var n=soy.$$balanceTags_(i);o=o.replace(/\[(\d+)\]/g,function(t,e){return i[e]});return o+n};soy.$$balanceTags_=function(t){for(var e=[],o=0,i=t.length;i>o;++o){var n=t[o];if("/"===n.charAt(1)){for(var r=e.length-1;r>=0&&e[r]!=n;)r--;if(0>r)t[o]="";else{t[o]=e.slice(r).reverse().join("");e.length=r}}else soy.$$HTML5_VOID_ELEMENTS_.test(n)||e.push("</"+n.substring(1))}return e.reverse().join("")};soy.$$escapeHtmlAttribute=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return soy.esc.$$normalizeHtmlHelper(soy.$$stripHtmlTags(t.content))}return soy.esc.$$escapeHtmlHelper(t)};soy.$$escapeHtmlAttributeNospace=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return soy.esc.$$normalizeHtmlNospaceHelper(soy.$$stripHtmlTags(t.content))}return soy.esc.$$escapeHtmlNospaceHelper(t)};soy.$$filterHtmlAttributes=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.ATTRIBUTES){goog.asserts.assert(t.constructor===soydata.SanitizedHtmlAttribute);return t.content.replace(/([^"'\s])$/,"$1 ")}return soy.esc.$$filterHtmlAttributesHelper(t)};soy.$$filterHtmlElementName=function(t){return soy.esc.$$filterHtmlElementNameHelper(t)};soy.$$escapeJs=function(t){return soy.$$escapeJsString(t)};soy.$$escapeJsString=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.JS_STR_CHARS){goog.asserts.assert(t.constructor===soydata.SanitizedJsStrChars);return t.content}return soy.esc.$$escapeJsStringHelper(t)};soy.$$escapeJsValue=function(t){if(null==t)return" null ";if(t.contentKind==goog.soy.data.SanitizedContentKind.JS){goog.asserts.assert(t.constructor===soydata.SanitizedJs);return t.content}switch(typeof t){case"boolean":case"number":return" "+t+" ";default:return"'"+soy.esc.$$escapeJsStringHelper(String(t))+"'"}};soy.$$escapeJsRegex=function(t){return soy.esc.$$escapeJsRegexHelper(t)};soy.$$problematicUriMarks_=/['()]/g;soy.$$pctEncode_=function(t){return"%"+t.charCodeAt(0).toString(16)};soy.$$escapeUri=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.URI){goog.asserts.assert(t.constructor===soydata.SanitizedUri);return soy.$$normalizeUri(t)}var e=soy.esc.$$escapeUriHelper(t);soy.$$problematicUriMarks_.lastIndex=0;return soy.$$problematicUriMarks_.test(e)?e.replace(soy.$$problematicUriMarks_,soy.$$pctEncode_):e};soy.$$normalizeUri=function(t){return soy.esc.$$normalizeUriHelper(t)};soy.$$filterNormalizeUri=function(t){if(t&&t.contentKind==goog.soy.data.SanitizedContentKind.URI){goog.asserts.assert(t.constructor===soydata.SanitizedUri);return soy.$$normalizeUri(t)}return soy.esc.$$filterNormalizeUriHelper(t)};soy.$$escapeCssString=function(t){return soy.esc.$$escapeCssStringHelper(t)};soy.$$filterCssValue=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.CSS){goog.asserts.assert(t.constructor===soydata.SanitizedCss);return t.content}return null==t?"":soy.esc.$$filterCssValueHelper(t)};soy.$$filterNoAutoescape=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.TEXT){goog.asserts.fail("Tainted SanitizedContentKind.TEXT for |noAutoescape: `%s`",[t.content]);return"zSoyz"}return String(t)};soy.$$changeNewlineToBr=function(t){return goog.string.newLineToBr(String(t),!1)};soy.$$insertWordBreaks=function(t,e){return goog.format.insertWordBreaks(String(t),e)};soy.$$truncate=function(t,e,o){t=String(t);if(t.length<=e)return t;o&&(e>3?e-=3:o=!1);soy.$$isHighSurrogate_(t.charAt(e-1))&&soy.$$isLowSurrogate_(t.charAt(e))&&(e-=1);t=t.substring(0,e);o&&(t+="...");return t};soy.$$isHighSurrogate_=function(t){return t>=55296&&56319>=t};soy.$$isLowSurrogate_=function(t){return t>=56320&&57343>=t};soy.$$bidiFormatterCache_={};soy.$$getBidiFormatterInstance_=function(t){return soy.$$bidiFormatterCache_[t]||(soy.$$bidiFormatterCache_[t]=new goog.i18n.BidiFormatter(t))};soy.$$bidiTextDir=function(t,e){return t?goog.i18n.bidi.detectRtlDirectionality(t,e)?-1:1:0};soy.$$bidiDirAttr=function(t,e,o){return soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute(soy.$$getBidiFormatterInstance_(t).dirAttr(e,o))};soy.$$bidiMarkAfter=function(t,e,o){var i=soy.$$getBidiFormatterInstance_(t);return i.markAfter(e,o)};soy.$$bidiSpanWrap=function(t,e){var o=soy.$$getBidiFormatterInstance_(t);return o.spanWrap(e+"",!0)};soy.$$bidiUnicodeWrap=function(t,e){var o=soy.$$getBidiFormatterInstance_(t);return o.unicodeWrap(e+"",!0)};soy.esc.$$escapeUriHelper=function(t){return goog.string.urlEncode(String(t))};soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_={"\x00":"&#0;",'"':"&quot;","&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;","	":"&#9;","\n":"&#10;","":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;","-":"&#45;","/":"&#47;","=":"&#61;","`":"&#96;","":"&#133;"," ":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_[t]};soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_={"\x00":"\\x00","\b":"\\x08","	":"\\t","\n":"\\n","":"\\x0b","\f":"\\f","\r":"\\r",'"':"\\x22","&":"\\x26","'":"\\x27","/":"\\/","<":"\\x3c","=":"\\x3d",">":"\\x3e","\\":"\\\\","":"\\x85","\u2028":"\\u2028","\u2029":"\\u2029",$:"\\x24","(":"\\x28",")":"\\x29","*":"\\x2a","+":"\\x2b",",":"\\x2c","-":"\\x2d",".":"\\x2e",":":"\\x3a","?":"\\x3f","[":"\\x5b","]":"\\x5d","^":"\\x5e","{":"\\x7b","|":"\\x7c","}":"\\x7d"};soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_[t]};soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_={"\x00":"\\0 ","\b":"\\8 ","	":"\\9 ","\n":"\\a ","":"\\b ","\f":"\\c ","\r":"\\d ",'"':"\\22 ","&":"\\26 ","'":"\\27 ","(":"\\28 ",")":"\\29 ","*":"\\2a ","/":"\\2f ",":":"\\3a ",";":"\\3b ","<":"\\3c ","=":"\\3d ",">":"\\3e ","@":"\\40 ","\\":"\\5c ","{":"\\7b ","}":"\\7d ","":"\\85 "," ":"\\a0 ","\u2028":"\\2028 ","\u2029":"\\2029 "};
soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_[t]};soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_={"\x00":"%00","":"%01","":"%02","":"%03","":"%04","":"%05","":"%06","":"%07","\b":"%08","	":"%09","\n":"%0A","":"%0B","\f":"%0C","\r":"%0D","":"%0E","":"%0F","":"%10","":"%11","":"%12","":"%13","":"%14","":"%15","":"%16","":"%17","":"%18","":"%19","":"%1A","":"%1B","":"%1C","":"%1D","":"%1E","":"%1F"," ":"%20",'"':"%22","'":"%27","(":"%28",")":"%29","<":"%3C",">":"%3E","\\":"%5C","{":"%7B","}":"%7D","":"%7F","":"%C2%85"," ":"%C2%A0","\u2028":"%E2%80%A8","\u2029":"%E2%80%A9","！":"%EF%BC%81","＃":"%EF%BC%83","＄":"%EF%BC%84","＆":"%EF%BC%86","＇":"%EF%BC%87","（":"%EF%BC%88","）":"%EF%BC%89","＊":"%EF%BC%8A","＋":"%EF%BC%8B","，":"%EF%BC%8C","／":"%EF%BC%8F","：":"%EF%BC%9A","；":"%EF%BC%9B","＝":"%EF%BC%9D","？":"%EF%BC%9F","＠":"%EF%BC%A0","［":"%EF%BC%BB","］":"%EF%BC%BD"};soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_[t]};soy.esc.$$MATCHER_FOR_ESCAPE_HTML_=/[\x00\x22\x26\x27\x3c\x3e]/g;soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_=/[\x00\x22\x27\x3c\x3e]/g;soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x26\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_=/[\x00\x08-\x0d\x22\x26\x27\/\x3c-\x3e\\\x85\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_=/[\x00\x08-\x0d\x22\x24\x26-\/\x3a\x3c-\x3f\x5b-\x5e\x7b-\x7d\x85\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_=/[\x00\x08-\x0d\x22\x26-\x2a\/\x3a-\x3e@\\\x7b\x7d\x85\xa0\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=/[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g;soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_=/^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i;soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_=/^(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i;soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTES_=/^(?!style|on|action|archive|background|cite|classid|codebase|data|dsync|href|longdesc|src|usemap)(?:[a-z0-9_$:-]*)$/i;soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_=/^(?!script|style|title|textarea|xmp|no)[a-z0-9_$:-]*$/i;soy.esc.$$escapeHtmlHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$normalizeHtmlHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$escapeHtmlNospaceHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$normalizeHtmlNospaceHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$escapeJsStringHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)};soy.esc.$$escapeJsRegexHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)};soy.esc.$$escapeCssStringHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_)};soy.esc.$$filterCssValueHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_.test(e)){goog.asserts.fail("Bad value `%s` for |filterCssValue",[e]);return"zSoyz"}return e};soy.esc.$$normalizeUriHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)};soy.esc.$$filterNormalizeUriHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_.test(e)){goog.asserts.fail("Bad value `%s` for |filterNormalizeUri",[e]);return"#zSoyz"}return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)};soy.esc.$$filterHtmlAttributesHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTES_.test(e)){goog.asserts.fail("Bad value `%s` for |filterHtmlAttributes",[e]);return"zSoyz"}return e};soy.esc.$$filterHtmlElementNameHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_.test(e)){goog.asserts.fail("Bad value `%s` for |filterHtmlElementName",[e]);return"zSoyz"}return e};soy.esc.$$HTML_TAG_REGEX_=/<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g;soy.esc.$$LT_REGEX_=/</g;soy.esc.$$SAFE_TAG_WHITELIST_={b:1,br:1,em:1,i:1,s:1,sub:1,sup:1,u:1};goog.provide("soy");goog.provide("soy.StringBuilder");goog.provide("soy.esc");goog.provide("soydata");goog.provide("soydata.SanitizedHtml");goog.provide("soydata.SanitizedHtmlAttribute");goog.provide("soydata.SanitizedJs");goog.provide("soydata.SanitizedJsStrChars");goog.provide("soydata.SanitizedUri");goog.provide("soydata.VERY_UNSAFE");goog.require("goog.asserts");goog.require("goog.dom.DomHelper");goog.require("goog.format");goog.require("goog.i18n.BidiFormatter");goog.require("goog.i18n.bidi");goog.require("goog.soy");goog.require("goog.soy.data.SanitizedContentKind");goog.require("goog.string");goog.require("goog.string.StringBuffer");soy.StringBuilder=goog.string.StringBuffer;soydata.SanitizedContentKind=goog.soy.data.SanitizedContentKind;soydata.SanitizedHtml=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedHtml,goog.soy.data.SanitizedContent);soydata.SanitizedHtml.prototype.contentKind=soydata.SanitizedContentKind.HTML;soydata.SanitizedJs=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedJs,goog.soy.data.SanitizedContent);soydata.SanitizedJs.prototype.contentKind=soydata.SanitizedContentKind.JS;soydata.SanitizedJsStrChars=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedJsStrChars,goog.soy.data.SanitizedContent);soydata.SanitizedJsStrChars.prototype.contentKind=soydata.SanitizedContentKind.JS_STR_CHARS;soydata.SanitizedUri=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedUri,goog.soy.data.SanitizedContent);soydata.SanitizedUri.prototype.contentKind=soydata.SanitizedContentKind.URI;soydata.SanitizedHtmlAttribute=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedHtmlAttribute,goog.soy.data.SanitizedContent);soydata.SanitizedHtmlAttribute.prototype.contentKind=soydata.SanitizedContentKind.ATTRIBUTES;soydata.SanitizedCss=function(){goog.soy.data.SanitizedContent.call(this)};goog.inherits(soydata.SanitizedCss,goog.soy.data.SanitizedContent);soydata.SanitizedCss.prototype.contentKind=soydata.SanitizedContentKind.CSS;soydata.UnsanitizedText=function(t){this.content=String(t)};goog.inherits(soydata.UnsanitizedText,goog.soy.data.SanitizedContent);soydata.UnsanitizedText.prototype.contentKind=soydata.SanitizedContentKind.TEXT;soydata.$$makeSanitizedContentFactory_=function(t){function e(){}e.prototype=t.prototype;return function(t){var o=new e;o.content=String(t);return o}};soydata.markUnsanitizedText=function(t){return new soydata.UnsanitizedText(t)};soydata.VERY_UNSAFE.ordainSanitizedHtml=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedHtml);soydata.VERY_UNSAFE.ordainSanitizedJs=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedJs);soydata.VERY_UNSAFE.ordainSanitizedJsStrChars=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedJsStrChars);soydata.VERY_UNSAFE.ordainSanitizedUri=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedUri);soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedHtmlAttribute);soydata.VERY_UNSAFE.ordainSanitizedCss=soydata.$$makeSanitizedContentFactory_(soydata.SanitizedCss);soy.renderElement=goog.soy.renderElement;soy.renderAsFragment=function(t,e,o,i){return goog.soy.renderAsFragment(t,e,i,new goog.dom.DomHelper(o))};soy.renderAsElement=function(t,e,o,i){return goog.soy.renderAsElement(t,e,i,new goog.dom.DomHelper(o))};soy.$$augmentMap=function(t,e){function o(){}o.prototype=t;var i=new o;for(var n in e)i[n]=e[n];return i};soy.$$checkMapKey=function(t){if("string"!=typeof t)throw Error("Map literal's key expression must evaluate to string (encountered type \""+typeof t+'").');return t};soy.$$getMapKeys=function(t){var e=[];for(var o in t)e.push(o);return e};soy.$$getDelTemplateId=function(t){return t};soy.$$DELEGATE_REGISTRY_PRIORITIES_={};soy.$$DELEGATE_REGISTRY_FUNCTIONS_={};soy.$$registerDelegateFn=function(t,e,o,i){var n="key_"+t+":"+e,r=soy.$$DELEGATE_REGISTRY_PRIORITIES_[n];if(void 0===r||o>r){soy.$$DELEGATE_REGISTRY_PRIORITIES_[n]=o;soy.$$DELEGATE_REGISTRY_FUNCTIONS_[n]=i}else if(o==r)throw Error('Encountered two active delegates with the same priority ("'+t+":"+e+'").')};soy.$$getDelegateFn=function(t,e,o){var i=soy.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+t+":"+e];i||""==e||(i=soy.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+t+":"]);if(i)return i;if(o)return soy.$$EMPTY_TEMPLATE_FN_;throw Error('Found no active impl for delegate call to "'+t+":"+e+'" (and not allowemptydefault="true").')};soy.$$EMPTY_TEMPLATE_FN_=function(){return""};soy.$$escapeHtml=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return t.content}return soy.esc.$$escapeHtmlHelper(t)};soy.$$cleanHtml=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return t.content}return soy.$$stripHtmlTags(t,soy.esc.$$SAFE_TAG_WHITELIST_)};soy.$$escapeHtmlRcdata=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return soy.esc.$$normalizeHtmlHelper(t.content)}return soy.esc.$$escapeHtmlHelper(t)};soy.$$HTML5_VOID_ELEMENTS_=new RegExp("^<(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\\b");soy.$$stripHtmlTags=function(t,e){if(!e)return String(t).replace(soy.esc.$$HTML_TAG_REGEX_,"").replace(soy.esc.$$LT_REGEX_,"&lt;");var o=String(t).replace(/\[/g,"&#91;"),i=[];o=o.replace(soy.esc.$$HTML_TAG_REGEX_,function(t,o){if(o){o=o.toLowerCase();if(e.hasOwnProperty(o)&&e[o]){var n="/"===t.charAt(1)?"</":"<",r=i.length;i[r]=n+o+">";return"["+r+"]"}}return""});o=soy.esc.$$normalizeHtmlHelper(o);var n=soy.$$balanceTags_(i);o=o.replace(/\[(\d+)\]/g,function(t,e){return i[e]});return o+n};soy.$$balanceTags_=function(t){for(var e=[],o=0,i=t.length;i>o;++o){var n=t[o];if("/"===n.charAt(1)){for(var r=e.length-1;r>=0&&e[r]!=n;)r--;if(0>r)t[o]="";else{t[o]=e.slice(r).reverse().join("");e.length=r}}else soy.$$HTML5_VOID_ELEMENTS_.test(n)||e.push("</"+n.substring(1))}return e.reverse().join("")};soy.$$escapeHtmlAttribute=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return soy.esc.$$normalizeHtmlHelper(soy.$$stripHtmlTags(t.content))}return soy.esc.$$escapeHtmlHelper(t)};soy.$$escapeHtmlAttributeNospace=function(t){if(t&&t.contentKind&&t.contentKind===goog.soy.data.SanitizedContentKind.HTML){goog.asserts.assert(t.constructor===soydata.SanitizedHtml);return soy.esc.$$normalizeHtmlNospaceHelper(soy.$$stripHtmlTags(t.content))}return soy.esc.$$escapeHtmlNospaceHelper(t)};soy.$$filterHtmlAttributes=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.ATTRIBUTES){goog.asserts.assert(t.constructor===soydata.SanitizedHtmlAttribute);return t.content.replace(/([^"'\s])$/,"$1 ")}return soy.esc.$$filterHtmlAttributesHelper(t)};soy.$$filterHtmlElementName=function(t){return soy.esc.$$filterHtmlElementNameHelper(t)};soy.$$escapeJs=function(t){return soy.$$escapeJsString(t)};soy.$$escapeJsString=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.JS_STR_CHARS){goog.asserts.assert(t.constructor===soydata.SanitizedJsStrChars);return t.content}return soy.esc.$$escapeJsStringHelper(t)};soy.$$escapeJsValue=function(t){if(null==t)return" null ";if(t.contentKind==goog.soy.data.SanitizedContentKind.JS){goog.asserts.assert(t.constructor===soydata.SanitizedJs);return t.content}switch(typeof t){case"boolean":case"number":return" "+t+" ";default:return"'"+soy.esc.$$escapeJsStringHelper(String(t))+"'"}};soy.$$escapeJsRegex=function(t){return soy.esc.$$escapeJsRegexHelper(t)};soy.$$problematicUriMarks_=/['()]/g;soy.$$pctEncode_=function(t){return"%"+t.charCodeAt(0).toString(16)};soy.$$escapeUri=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.URI){goog.asserts.assert(t.constructor===soydata.SanitizedUri);return soy.$$normalizeUri(t)}var e=soy.esc.$$escapeUriHelper(t);soy.$$problematicUriMarks_.lastIndex=0;return soy.$$problematicUriMarks_.test(e)?e.replace(soy.$$problematicUriMarks_,soy.$$pctEncode_):e};soy.$$normalizeUri=function(t){return soy.esc.$$normalizeUriHelper(t)};soy.$$filterNormalizeUri=function(t){if(t&&t.contentKind==goog.soy.data.SanitizedContentKind.URI){goog.asserts.assert(t.constructor===soydata.SanitizedUri);return soy.$$normalizeUri(t)}return soy.esc.$$filterNormalizeUriHelper(t)};soy.$$escapeCssString=function(t){return soy.esc.$$escapeCssStringHelper(t)};soy.$$filterCssValue=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.CSS){goog.asserts.assert(t.constructor===soydata.SanitizedCss);return t.content}return null==t?"":soy.esc.$$filterCssValueHelper(t)};soy.$$filterNoAutoescape=function(t){if(t&&t.contentKind===goog.soy.data.SanitizedContentKind.TEXT){goog.asserts.fail("Tainted SanitizedContentKind.TEXT for |noAutoescape: `%s`",[t.content]);return"zSoyz"}return String(t)};soy.$$changeNewlineToBr=function(t){return goog.string.newLineToBr(String(t),!1)};soy.$$insertWordBreaks=function(t,e){return goog.format.insertWordBreaks(String(t),e)};soy.$$truncate=function(t,e,o){t=String(t);if(t.length<=e)return t;o&&(e>3?e-=3:o=!1);soy.$$isHighSurrogate_(t.charAt(e-1))&&soy.$$isLowSurrogate_(t.charAt(e))&&(e-=1);t=t.substring(0,e);o&&(t+="...");return t};soy.$$isHighSurrogate_=function(t){return t>=55296&&56319>=t};soy.$$isLowSurrogate_=function(t){return t>=56320&&57343>=t};soy.$$bidiFormatterCache_={};soy.$$getBidiFormatterInstance_=function(t){return soy.$$bidiFormatterCache_[t]||(soy.$$bidiFormatterCache_[t]=new goog.i18n.BidiFormatter(t))};soy.$$bidiTextDir=function(t,e){return t?goog.i18n.bidi.detectRtlDirectionality(t,e)?-1:1:0};soy.$$bidiDirAttr=function(t,e,o){return soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute(soy.$$getBidiFormatterInstance_(t).dirAttr(e,o))};soy.$$bidiMarkAfter=function(t,e,o){var i=soy.$$getBidiFormatterInstance_(t);return i.markAfter(e,o)};soy.$$bidiSpanWrap=function(t,e){var o=soy.$$getBidiFormatterInstance_(t);return o.spanWrap(e+"",!0)};soy.$$bidiUnicodeWrap=function(t,e){var o=soy.$$getBidiFormatterInstance_(t);return o.unicodeWrap(e+"",!0)};soy.esc.$$escapeUriHelper=function(t){return goog.string.urlEncode(String(t))};soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_={"\x00":"&#0;",'"':"&quot;","&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;","	":"&#9;","\n":"&#10;","":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;","-":"&#45;","/":"&#47;","=":"&#61;","`":"&#96;","":"&#133;"," ":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_[t]};soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_={"\x00":"\\x00","\b":"\\x08","	":"\\t","\n":"\\n","":"\\x0b","\f":"\\f","\r":"\\r",'"':"\\x22","&":"\\x26","'":"\\x27","/":"\\/","<":"\\x3c","=":"\\x3d",">":"\\x3e","\\":"\\\\","":"\\x85","\u2028":"\\u2028","\u2029":"\\u2029",$:"\\x24","(":"\\x28",")":"\\x29","*":"\\x2a","+":"\\x2b",",":"\\x2c","-":"\\x2d",".":"\\x2e",":":"\\x3a","?":"\\x3f","[":"\\x5b","]":"\\x5d","^":"\\x5e","{":"\\x7b","|":"\\x7c","}":"\\x7d"};soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_[t]};soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_={"\x00":"\\0 ","\b":"\\8 ","	":"\\9 ","\n":"\\a ","":"\\b ","\f":"\\c ","\r":"\\d ",'"':"\\22 ","&":"\\26 ","'":"\\27 ","(":"\\28 ",")":"\\29 ","*":"\\2a ","/":"\\2f ",":":"\\3a ",";":"\\3b ","<":"\\3c ","=":"\\3d ",">":"\\3e ","@":"\\40 ","\\":"\\5c ","{":"\\7b ","}":"\\7d ","":"\\85 "," ":"\\a0 ","\u2028":"\\2028 ","\u2029":"\\2029 "};soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_[t]};soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_={"\x00":"%00","":"%01","":"%02","":"%03","":"%04","":"%05","":"%06","":"%07","\b":"%08","	":"%09","\n":"%0A","":"%0B","\f":"%0C","\r":"%0D","":"%0E","":"%0F","":"%10","":"%11","":"%12","":"%13","":"%14","":"%15","":"%16","":"%17","":"%18","":"%19","":"%1A","":"%1B","":"%1C","":"%1D","":"%1E","":"%1F"," ":"%20",'"':"%22","'":"%27","(":"%28",")":"%29","<":"%3C",">":"%3E","\\":"%5C","{":"%7B","}":"%7D","":"%7F","":"%C2%85"," ":"%C2%A0","\u2028":"%E2%80%A8","\u2029":"%E2%80%A9","！":"%EF%BC%81","＃":"%EF%BC%83","＄":"%EF%BC%84","＆":"%EF%BC%86","＇":"%EF%BC%87","（":"%EF%BC%88","）":"%EF%BC%89","＊":"%EF%BC%8A","＋":"%EF%BC%8B","，":"%EF%BC%8C","／":"%EF%BC%8F","：":"%EF%BC%9A","；":"%EF%BC%9B","＝":"%EF%BC%9D","？":"%EF%BC%9F","＠":"%EF%BC%A0","［":"%EF%BC%BB","］":"%EF%BC%BD"};soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=function(t){return soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_[t]};soy.esc.$$MATCHER_FOR_ESCAPE_HTML_=/[\x00\x22\x26\x27\x3c\x3e]/g;soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_=/[\x00\x22\x27\x3c\x3e]/g;soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x26\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_=/[\x00\x08-\x0d\x22\x26\x27\/\x3c-\x3e\\\x85\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_=/[\x00\x08-\x0d\x22\x24\x26-\/\x3a\x3c-\x3f\x5b-\x5e\x7b-\x7d\x85\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_=/[\x00\x08-\x0d\x22\x26-\x2a\/\x3a-\x3e@\\\x7b\x7d\x85\xa0\u2028\u2029]/g;soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=/[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g;soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_=/^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i;soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_=/^(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i;soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTES_=/^(?!style|on|action|archive|background|cite|classid|codebase|data|dsync|href|longdesc|src|usemap)(?:[a-z0-9_$:-]*)$/i;soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_=/^(?!script|style|title|textarea|xmp|no)[a-z0-9_$:-]*$/i;soy.esc.$$escapeHtmlHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$normalizeHtmlHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$escapeHtmlNospaceHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$normalizeHtmlNospaceHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)};soy.esc.$$escapeJsStringHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)};soy.esc.$$escapeJsRegexHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)};soy.esc.$$escapeCssStringHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_)};soy.esc.$$filterCssValueHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_.test(e)){goog.asserts.fail("Bad value `%s` for |filterCssValue",[e]);return"zSoyz"}return e};soy.esc.$$normalizeUriHelper=function(t){var e=String(t);return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)};soy.esc.$$filterNormalizeUriHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_.test(e)){goog.asserts.fail("Bad value `%s` for |filterNormalizeUri",[e]);return"#zSoyz"}return e.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)};soy.esc.$$filterHtmlAttributesHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTES_.test(e)){goog.asserts.fail("Bad value `%s` for |filterHtmlAttributes",[e]);return"zSoyz"}return e};soy.esc.$$filterHtmlElementNameHelper=function(t){var e=String(t);if(!soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_.test(e)){goog.asserts.fail("Bad value `%s` for |filterHtmlElementName",[e]);return"zSoyz"}return e};soy.esc.$$HTML_TAG_REGEX_=/<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g;soy.esc.$$LT_REGEX_=/</g;soy.esc.$$SAFE_TAG_WHITELIST_={b:1,br:1,em:1,i:1,s:1,sub:1,sup:1,u:1};goog.provide("lime.css");goog.require("soy");goog.require("soydata");lime.css.css=function(){return"."+goog.getCssName("lime-director")+" {position:absolute; -webkit-transform-origin: 0 0; -moz-transform-origin: 0 0; -o-transform-origin: 0 0; image-rendering:  optimizeSpeed; overflow: hidden;}."+goog.getCssName("lime-director")+" div, ."+goog.getCssName("lime-director")+" img, ."+goog.getCssName("lime-director")+" canvas {-webkit-transform-origin: 0 0; -moz-transform-origin: 0 0; -o-transform-origin: 0 0; position: absolute; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; -moz-user-select: none; -webkit-user-select: none; -webkit-user-drag: none;}."+goog.getCssName("lime-scene")+" {position:absolute; width:100%; height:100%; left: 0px; top: 0px; overflow: hidden; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;}."+goog.getCssName("lime-fps")+" {float: left; background: #333; color: #fff; position: absolute; top:0px; left: 0px; padding:2px 4px;}div."+goog.getCssName("lime-layer")+" {position: absolute; left: 0px; top: 0px; width:0px; height:0px; border: none !important;}."+goog.getCssName("lime-cover")+" {position: absolute; left: 0px; top: 0px;}."+goog.getCssName("lime-button")+" {cursor: pointer;}"};goog.provide("lime.userAgent");goog.require("goog.userAgent");!function(){var t=goog.userAgent.getUserAgentString();lime.userAgent.IOS=goog.userAgent.WEBKIT&&goog.userAgent.MOBILE&&/(ipod|iphone|ipad)/i.test(t);lime.userAgent.IOS5=lime.userAgent.IOS&&goog.isFunction(Object.freeze);lime.userAgent.ANDROID=goog.userAgent.WEBKIT&&goog.userAgent.MOBILE&&/(android)/i.test(t);lime.userAgent.WINPHONE=goog.userAgent.MOBILE&&/(iemobile)/i.test(t);lime.userAgent.IPAD=lime.userAgent.IOS&&/(ipad)/i.test(t);lime.userAgent.IPHONE4=lime.userAgent.IOS&&goog.global.devicePixelRatio>=2;lime.userAgent.PLAYBOOK=goog.userAgent.WEBKIT&&/playbook/i.test(t);lime.userAgent.CHROME=goog.userAgent.WEBKIT&&/Chrome\//i.test(t);lime.userAgent.SUPPORTS_TOUCH=goog.isDef(document.ontouchmove)}();goog.provide("lime");goog.require("goog.style");goog.require("lime.css");goog.require("lime.userAgent");!function(){var t=[[],[]],e=[[],[]];lime.setObjectDirty=function(o,i,n){var r=n?e:t,s=i||0;goog.array.insert(r[s],o)};lime.clearObjectDirty=function(){};lime.updateDirtyObjects=function(){for(var o,i=0;2>i;i++){for(;t[i].length;){o=t[i][0];o.update(i);o.dirty_=0;o==t[i][0]&&t[i].shift()}t[i]=[]}e=[[],[]]}}();lime.Dirty={POSITION:1,SCALE:2,CONTENT:4,FONT:8,ALPHA:16,VISIBILITY:32,LAYOUT:64,ROTATION:128,ALL:7};lime.AutoResize={NONE:0,LEFT:1,WIDTH:2,RIGHT:4,TOP:8,HEIGHT:16,BOTTOM:32,ALL:63};lime.Transition={POSITION:1,SCALE:2,SIZE:3,ROTATION:4,OPACITY:5};goog.style.installStyles(lime.css.css(null,null));goog.provide("goog.math.Vec2");goog.require("goog.math");goog.require("goog.math.Coordinate");goog.math.Vec2=function(t,e){this.x=t;this.y=e};goog.inherits(goog.math.Vec2,goog.math.Coordinate);goog.math.Vec2.randomUnit=function(){var t=Math.random()*Math.PI*2;return new goog.math.Vec2(Math.cos(t),Math.sin(t))};goog.math.Vec2.random=function(){var t=Math.sqrt(Math.random()),e=Math.random()*Math.PI*2;return new goog.math.Vec2(Math.cos(e)*t,Math.sin(e)*t)};goog.math.Vec2.fromCoordinate=function(t){return new goog.math.Vec2(t.x,t.y)};goog.math.Vec2.prototype.clone=function(){return new goog.math.Vec2(this.x,this.y)};goog.math.Vec2.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};goog.math.Vec2.prototype.squaredMagnitude=function(){return this.x*this.x+this.y*this.y};goog.math.Vec2.prototype.scale=goog.math.Coordinate.prototype.scale;goog.math.Vec2.prototype.invert=function(){this.x=-this.x;this.y=-this.y;return this};goog.math.Vec2.prototype.normalize=function(){return this.scale(1/this.magnitude())};goog.math.Vec2.prototype.add=function(t){this.x+=t.x;this.y+=t.y;return this};goog.math.Vec2.prototype.subtract=function(t){this.x-=t.x;this.y-=t.y;return this};goog.math.Vec2.prototype.rotate=function(t){var e=Math.cos(t),o=Math.sin(t),i=this.x*e-this.y*o,n=this.y*e+this.x*o;this.x=i;this.y=n;return this};goog.math.Vec2.rotateAroundPoint=function(t,e,o){var i=t.clone();return i.subtract(e).rotate(o).add(e)};goog.math.Vec2.prototype.equals=function(t){return this==t||!!t&&this.x==t.x&&this.y==t.y};goog.math.Vec2.distance=goog.math.Coordinate.distance;goog.math.Vec2.squaredDistance=goog.math.Coordinate.squaredDistance;goog.math.Vec2.equals=goog.math.Coordinate.equals;goog.math.Vec2.sum=function(t,e){return new goog.math.Vec2(t.x+e.x,t.y+e.y)};goog.math.Vec2.difference=function(t,e){return new goog.math.Vec2(t.x-e.x,t.y-e.y)};goog.math.Vec2.dot=function(t,e){return t.x*e.x+t.y*e.y};goog.math.Vec2.lerp=function(t,e,o){return new goog.math.Vec2(goog.math.lerp(t.x,e.x,o),goog.math.lerp(t.y,e.y,o))};goog.provide("lime.DirtyObject");lime.DirtyObject=function(){};lime.DirtyObject.prototype.update=function(){};goog.provide("goog.math.Box.size");goog.provide("goog.math.Size.scaleVec2");goog.require("goog.math.Box");goog.require("goog.math.Size");goog.math.Box.prototype.size=function(){return new goog.math.Size(this.right-this.left,this.bottom-this.top)};goog.math.Size.prototype.scaleVec2=function(t){this.width*=t.x;this.height*=t.y;return this};goog.provide("goog.math.Box.size");goog.provide("goog.math.Size.scaleVec2");goog.require("goog.math.Box");goog.require("goog.math.Size");goog.math.Box.prototype.size=function(){return new goog.math.Size(this.right-this.left,this.bottom-this.top)};goog.math.Size.prototype.scaleVec2=function(t){this.width*=t.x;this.height*=t.y;return this};goog.provide("lime.Renderer");lime.Renderer=function(){};lime.Renderer.prototype.draw=goog.nullFunction;lime.Renderer.prototype.getType=function(){return this.base?this.base:this};lime.Renderer.prototype.makeSubRenderer=function(t){goog.object.extend(t,this);t.base=this.getType();return t};goog.provide("lime.Renderer.CANVAS");goog.require("goog.math.Box.size");goog.require("goog.math.Size.scaleVec2");goog.require("lime.Renderer");lime.Renderer.CANVAS=new lime.Renderer;lime.Renderer.CANVAS.updateLayout=function(){};lime.Renderer.CANVAS.drawCanvas=function(){var t,e=this.measureContents(),o=12;if(this.domElement){this.boundsCache&&this.boundsCache.contains(e)&&(t=this.boundsCache.size().area()/e.size().area())&&1.6>t&&t>.5?e=this.boundsCache:1!=this.staticCanvas&&0!=this.children_.length&&(this instanceof lime.Scene||e.expand(o,o,o,o));this.boundsCache=e;var i=e.size(),n=i.clone().ceil();if(this.domElement.width!=n.width||this.domElement.height!=n.height){this.domElement.width=n.width;this.domElement.height=n.height;this.redraw_=1}var r=this.getScale().clone();this.transitionsActive_[lime.Transition.SCALE]&&(r=this.transitionsActive_[lime.Transition.SCALE]);0!=n.width&&r.scale(i.width/n.width);var s=this.getFrame();this.ax=s.left-e.left;this.ay=s.top-e.top;var a=this.getSize().clone().scaleVec2(this.getAnchorPoint()),l=this.getPosition().clone();this.transitionsActive_[lime.Transition.POSITION]&&(l=this.transitionsActive_[lime.Transition.POSITION]);l.x-=a.width+this.ax;l.y-=a.height+this.ay;lime.style.setTransformOrigin(this.domElement,(this.ax+a.width)/n.width*100,(this.ay+a.height)/n.height*100,!0);if(!this.transitionsActiveSet_[lime.Transition.POSITION]&&!this.transitionsActiveSet_[lime.Transition.SCALE]&&!this.transitionsActiveSet_[lime.Transition.ROTATION]){var g=-this.getRotation();goog.isDef(this.transitionsActive_[lime.Transition.ROTATION])&&(g=-this.transitionsActive_[lime.Transition.ROTATION]);lime.style.setTransform(this.domElement,(new lime.style.Transform).setPrecision(.1).translate(l.x,l.y).rotate(g).scale(r.x,r.y))}this.keyframe&&this.keyframe.started&&(this.redraw_=1);if(this.redraw_){var m=this.domElement.getContext("2d");m.clearRect(0,0,n.width,n.height);m.save();m.translate(this.ax,this.ay);var c=this.getSize(),u=this.getAnchorPoint();m.translate(c.width*u.x,c.height*u.y);this.renderer.drawCanvasObject.call(this,m);m.restore();this.redraw_=0}}};lime.Renderer.CANVAS.update=function(){};lime.Renderer.CANVAS.drawCanvasObject=function(t){if(this.inTree_){if(this.mask_!=this.activeMask_){this.activeMask_&&lime.Renderer.DOM.removeMask.call(this);this.mask_&&lime.Renderer.DOM.addMask.call(this)}if(!this.maskTarget_&&!this.hidden_&&0!=this.opacity_&&1!=this.isMask){1!=this.opacity_&&(t.globalAlpha*=this.opacity_);if(this.mask_){lime.Renderer.DOM.calculateMaskPosition.call(this.mask_);var e=this.activeMask_,o=this.scale_;t.save();t.save();t.translate(e.mPos.x,e.mPos.y);t.rotate(-e.mRot);this.needsDomElement&&t.rotate(this.getRotation()*Math.PI/180);t.beginPath();t.moveTo(0,0);t.lineTo(e.mWidth/o.x,0);t.lineTo(e.mWidth/o.x,e.mHeight/o.y);t.lineTo(0,e.mHeight/o.y);t.closePath();t.restore();t.clip()}this.renderer.draw.call(this,t);for(var i,n=new goog.math.Coordinate(0,0),r=0;i=this.children_[r];r++){var s=i.localToParent(n).clone(),a=i.getRotation(),o=i.getScale();t.save();t.translate(s.x,s.y);t.scale(o.x,o.y);0!=a&&t.rotate(-a*Math.PI/180);this.renderer.drawCanvasObject.call(i,t);t.restore()}1!=this.opacity_&&(t.globalAlpha/=this.opacity_);this.activeMask_&&t.restore()
}}};goog.provide("lime.style");goog.provide("lime.style.Transform");goog.require("goog.dom");goog.require("goog.style");goog.require("lime.userAgent");!function(){var t=goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.OPERA?"O":goog.userAgent.IE?"ms":"",e=goog.dom.createDom("div").style;lime.style.transformProperty="-"+t.toLowerCase()+"-transform";lime.style.tryProperty=function(t){return void 0!==e[t]?t:!1};lime.style.getCSSproperty=function(e){var o=e.charAt(0).toLowerCase()+e.substr(1),i=t+e;return lime.style.tryProperty(e)?e:lime.style.tryProperty(o)?o:lime.style.tryProperty(i)?i:void 0}}();lime.style.setBorderRadius=function(){var t=lime.style.getCSSproperty("BorderRadius"),e=function(t,e){return(goog.isArray(t)?t.join(e+" "):t)+e};return function(o,i,n,r){var s=r?"%":"px",a=goog.isDef(n)?n:i,l=e(i,s)+"/"+e(a,s);l!=o.border_radius_cache_&&(o.style[t]=o.border_radius_cache_=l)}}();lime.style.Transform=function(t){this.values=[];this.precision=1;this.enable3D_=!0;this.opt_precision&&this.setPrecision(t)};lime.style.Transform.prototype.set3DAllowed=function(t){this.enable3D_=t;return this};lime.style.Transform.prototype.scale=function(t,e){this.values.push("scale("+t+","+e+")");return this};lime.style.Transform.prototype.rotate=function(t,e){var o;o=this.enable3D_&&(lime.userAgent.IOS||lime.userAgent.PLAYBOOK)?"rotate3d(0, 0, 1, "+t+(e?e:"deg")+")":"rotate("+t+(e?e:"deg")+")";0!=t&&this.values.push(o);return this};lime.style.Transform.prototype.translate=function(t,e,o){var i=1/this.precision,n="translate";this.enable3D_&&(lime.userAgent.CHROME||lime.userAgent.IOS||lime.userAgent.PLAYBOOK)&&(n+="3d");n+="("+t*i+"px,"+e*i+"px";this.enable3D_&&(lime.userAgent.CHROME||lime.userAgent.IOS||lime.userAgent.PLAYBOOK)&&(n+=","+(o?o:0)*i+"px");this.values.push(n+")");return this};lime.style.Transform.prototype.setPrecision=function(t){if(1!=this.precision){var e=1/this.precision;this.scale(e,e);this.precision=1}if(1!=t){this.scale(t,t);this.precision=t}return this};lime.style.Transform.prototype.toString=function(){1!=this.precision&&this.setPrecision(1);return this.values.join(" ")};lime.style.setTransform=function(){var t=lime.style.getCSSproperty("Transform");return function(e,o){var i=o.toString();i!=e.transform_cache_&&(e.style[t]=e.transform_cache_=i);lime.transformSet_=1}}();lime.style.setTransformOrigin=function(){var t=lime.style.getCSSproperty("TransformOrigin");return function(e,o,i,n){var r=n?"%":"px",s=o+r+" "+i+r;s!=e.transform_origin_cache_&&(e.style[t]=e.transform_origin_cache_=s)}}();!function(){var t=lime.style.getCSSproperty("Transition");lime.style.isTransitionsSupported=!!t&&!goog.userAgent.OPERA;var e=function(t,e){if(!t.length)return t;for(var o=t.split("),"),i=0;i<o.length-1;i++)o[i]+=")";o=goog.array.filter(o,function(t){return-1==t.indexOf(e)});return o.join(",")};lime.style.setTransition=function(o,i,n,r){if(t){var s=e(o.style[t],i);s.length&&(s+=", ");s+=i+" "+n+"s cubic-bezier("+r[1]+","+r[2]+","+r[3]+","+r[4]+")";o.style[t]=s}};lime.style.clearTransition=function(o,i){t&&o&&(o.style[t]=e(o.style[t],i))};lime.style.setSize=function(t,e,o){if(t.width_cache_!=e||t.height_cache_!=o){t.width_cache_=e;t.height_cache_=o;return goog.style.setSize(t,e,o)}return void 0}}();goog.provide("lime.Renderer.DOM");goog.require("goog.dom");goog.require("lime.Renderer");goog.require("lime.style");lime.Renderer.DOM=new lime.Renderer;lime.Renderer.DOM.updateLayout=function(){for(var t,e,o=0,i=0;e=this.children_[i];i++){t=e instanceof lime.Node?e.rootElement:e;if(t!=this.domElement.childNodes[o]){goog.dom.contains(this.containerElement,t)&&goog.dom.removeNode(t);lime.Renderer.DOM.appendAt_(this.containerElement,t,o++)}else o++}};lime.Renderer.DOM.drawSizePosition=function(){var t=this.getSize(),e=this.getPosition(),o=this.getScale(),i=this.getCSS3DTransformsAllowed();this.transitionsActive_[lime.Transition.POSITION]&&(e=this.transitionsActive_[lime.Transition.POSITION]);var n=t.width,r=t.height,s=o.clone();this.transitionsActive_[lime.Transition.SCALE]&&(s=this.transitionsActive_[lime.Transition.SCALE].clone());lime.style.setSize(this.domElement,n,r);lime.style.setTransformOrigin(this.domElement,100*this.anchorPoint_.x,100*this.anchorPoint_.y,!0);var a=this.anchorPoint_.x*n,l=this.anchorPoint_.y*r,g=e.x-a,m=e.y-l,c=this.stroke_?this.stroke_.width_:0;a-c==0&&l-c==0||this.domElement!=this.containerElement||!this.children_.length||lime.Renderer.DOM.makeContainer.call(this);this.domElement!=this.containerElement&&(this.transitionsActiveSet_[lime.Transition.POSITION]||this.transitionsActiveSet_[lime.Transition.SCALE]||this.transitionsActiveSet_[lime.Transition.ROTATION]||lime.style.setTransform(this.containerElement,(new lime.style.Transform).set3DAllowed(i).translate(a-c,l-c)));if(this.mask_!=this.activeMask_){this.activeMask_&&lime.Renderer.DOM.removeMask.call(this);this.mask_&&lime.Renderer.DOM.addMask.call(this)}var u=(new lime.style.Transform).setPrecision(.1).set3DAllowed(i);if(this.mask_){lime.Renderer.DOM.calculateMaskPosition.call(this.mask_);u.setPrecision(.1).translate(-this.mask_.mX-a,-this.mask_.mY-l).rotate(this.mask_.mRot,"rad").translate(a,l).setPrecision(1)}var h=-this.getRotation();goog.isDef(this.transitionsActive_[lime.Transition.ROTATION])&&(h=-this.transitionsActive_[lime.Transition.ROTATION]);u.translate(g,m).rotate(h).scale(s.x,s.y);this.transitionsActiveSet_[lime.Transition.POSITION]||this.transitionsActiveSet_[lime.Transition.SCALE]||this.transitionsActiveSet_[lime.Transition.ROTATION]||lime.style.setTransform(this.domElement,u)};lime.Renderer.DOM.update=function(){if(this.domElement&&!this.isMask){lime.Renderer.DOM.drawSizePosition.call(this);if(!this.transitionsActiveSet_[lime.Transition.OPACITY]){var t=this.opacity_;goog.isDef(this.transitionsActive_[lime.Transition.OPACITY])&&(t=this.transitionsActive_[lime.Transition.OPACITY]);this.getDirty()&lime.Dirty.ALPHA&&goog.style.setOpacity(this.domElement,t)}this.getDirty()&lime.Dirty.VISIBILITY&&(this.domElement.style.display=this.hidden_?"none":"block");this.maskTarget_||this.renderer.draw.call(this,this.domElement)}};lime.Renderer.DOM.calculateMaskPosition=function(){if(goog.isDef(this.targetNode)&&this.targetNode.inTree_){var t=this.targetNode,e=this.getFrame(),o=new goog.math.Coordinate(e.left,e.top),i=new goog.math.Coordinate(e.right,e.top),n=new goog.math.Coordinate(e.right,e.bottom),r=t.getParent();o=this.localToNode(o,r);i=this.localToNode(i,r);n=this.localToNode(n,r);var s=Math.atan2(o.y-i.y,i.x-o.x),a=i.x-o.x,l=o.y-i.y,g=n.x-i.x,m=n.y-i.y,c=Math.cos(s),u=Math.sin(s);this.mWidth=Math.round(Math.sqrt(a*a+l*l));this.mHeight=Math.round(Math.sqrt(g*g+m*m));if(t.renderer.getType()==lime.Renderer.DOM){var h=t.rootElement;goog.style.setSize(h,this.mWidth,this.mHeight);lime.style.setTransform(h,(new lime.style.Transform).setPrecision(.1).set3DAllowed(this.getCSS3DTransformsAllowed()).translate(o.x,o.y).rotate(-s,"rad"))}this.renderer.getType()==lime.Renderer.DOM&&(this.domElement.style.display="none");this.mPos=t.parentToLocal(o.clone());this.mSet=!0;this.mX=c*o.x-u*o.y;this.mY=c*o.y+u*o.x;this.mRot=s}};lime.Renderer.DOM.appendAt_=function(t,e,o){void 0==o||t.childNodes.length<=o?t.appendChild(e):t.insertBefore(e,t.childNodes[o])};lime.Renderer.DOM.makeContainer=function(){this.containerElement=goog.dom.createDom("div");for(var t,e=document.createDocumentFragment();t=this.domElement.firstChild;){this.domElement.removeChild(t);e.appendChild(t)}this.containerElement.appendChild(e);this.domElement.appendChild(this.containerElement)};lime.Renderer.DOM.removeMask=function(){if(this.domElement!=this.rootElement){if(this.renderer.getType()==lime.Renderer.DOM){goog.dom.removeNode(this.domElement);goog.dom.replaceNode(this.domElement,this.rootElement);this.rootElement=this.domElement}this.activeMask_.isMask=0;this.activeMask_=null}};lime.Renderer.DOM.addMask=function(){if(this.renderer.getType()==lime.Renderer.DOM){this.rootElement=goog.dom.createDom("div");this.rootElement.style.cssText="position:absolute;overflow:hidden;";lime.style.setTransformOrigin(this.rootElement,0,0);goog.dom.replaceNode(this.rootElement,this.domElement);this.rootElement.appendChild(this.domElement)}this.mask_.isMask=1;this.mask_.targetNode=this;this.activeMask_=this.mask_;this.mask_.setDirty(lime.Dirty.POSITION)};goog.provide("lime.Node");goog.require("goog.events.EventTarget");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.math.Vec2");goog.require("lime");goog.require("lime.DirtyObject");goog.require("lime.Renderer.CANVAS");goog.require("lime.Renderer.DOM");lime.Node=function(){goog.events.EventTarget.call(this);this.children_=[];this.parent_=null;this.transitionsAdd_={};this.transitionsActive_={};this.transitionsActiveSet_={};this.transitionsClear_={};this.allow3DCSSTransform_=!0;this.inTree_=!1;this.director_=null;this.scene_=null;this.eventHandlers_={};this.setScale(1);this.setPosition(0,0);this.setSize(0,0);this.setAnchorPoint(.5,.5);this.setRotation(0);this.setAutoResize(lime.AutoResize.NONE);this.opacity_=1;this.setMask(null);this.setRenderer(this.supportedRenderers[0].getType());this.setDirty(lime.Dirty.LAYOUT)};goog.inherits(lime.Node,goog.events.EventTarget);lime.Node.prototype.supportedRenderers=[lime.Renderer.DOM,lime.Renderer.CANVAS];lime.Node.prototype.setRenderer=function(t){if(!this.renderer||this.renderer.getType()!=t){for(var e=-1,o=0;o<this.supportedRenderers.length;o++)if(this.supportedRenderers[o].getType()==t){e=o;break}if(-1==e)return this;this.renderer=this.supportedRenderers[o];this.setDirty(lime.Dirty.LAYOUT);for(var i,o=0;i=this.children_[o];o++)i.setRenderer(t)}return this};lime.Node.prototype.needsDomElement=function(){return!(this.parent_&&this.parent_.renderer.getType()==lime.Renderer.CANVAS)};lime.Node.prototype.getDeepestDomElement=function(){return this.getDeepestParentWithDom().domElement};lime.Node.prototype.getDeepestParentWithDom=function(){if(this.needsDomElement()){this.updateDomElement();return this}return this.parent_?this.parent_.getDeepestParentWithDom():null};lime.Node.prototype.getParentStack_=function(){if(!this.parent_||this instanceof lime.Scene)return[];var t=this.parent_.children_.indexOf(this),e=this.parent_.getParentStack_();e.push(t);return e};lime.Node.compareNode=function(t,e){if(t==e)return 0;for(var o=t.getParentStack_(),i=e.getParentStack_(),n=0;;){if(o.length<=n)return 1;if(i.length<=n)return-1;if(o[n]!=i[n])return o[n]>i[n]?-1:1;n++}};lime.Node.prototype.getDirty=function(){return this.dirty_};lime.Node.prototype.setDirty=function(t,e,o){t&&!this.dirty_&&lime.setObjectDirty(this,e,o);var i=this.dirty_;this.dirty_|=t;if(t==lime.Dirty.LAYOUT&&!(i&lime.Dirty.LAYOUT))for(var n,r=0;n=this.children_[r];r++)n instanceof lime.Node&&n.setDirty(lime.Dirty.LAYOUT);if(!goog.isDef(this.dirty_)||!t){this.dirty_=0;lime.clearObjectDirty(this,e,o)}if(t&&this.maskTarget_){this.mSet=!1;this.maskTarget_.setDirty(-1)}return this};lime.Node.prototype.getScale=function(){return this.scale_};lime.Node.prototype.setScale=function(t){this.scale_=1==arguments.length&&goog.isNumber(t)?new goog.math.Vec2(t,t):2==arguments.length?new goog.math.Vec2(arguments[0],arguments[1]):t;return this.transitionsActive_[lime.Transition.SCALE]?this:this.setDirty(lime.Dirty.SCALE)};lime.Node.prototype.getPosition=function(){return this.position_};lime.Node.prototype.setPosition=function(t){this.position_=arguments.length>=2?new goog.math.Coordinate(arguments[0],arguments[1]):t;return this.transitionsActive_[lime.Transition.POSITION]?this:this.setDirty(lime.Dirty.POSITION)};lime.Node.prototype.getMask=function(){return this.mask_};lime.Node.prototype.setMask=function(t){if(t==this.mask_)return this;if(this.mask_){this.mask_.releaseDependencies();delete this.mask_.maskTarget_}this.mask_=t;if(this.mask_){this.mask_.setupDependencies();this.mask_.maskTarget_=this}return this.setDirty(lime.Dirty.CONTENT)};lime.Node.prototype.getAnchorPoint=function(){return this.anchorPoint_};lime.Node.prototype.setAnchorPoint=function(t){this.anchorPoint_=2==arguments.length?new goog.math.Vec2(arguments[0],arguments[1]):t;return this.setDirty(lime.Dirty.POSITION)};lime.Node.prototype.getRotation=function(){return this.rotation_=this.rotation_%360};lime.Node.prototype.setRotation=function(t){this.rotation_=t;return this.transitionsActive_[lime.Transition.ROTATION]?this:this.setDirty(lime.Dirty.POSITION)};lime.Node.prototype.getHidden=function(){return this.hidden_};lime.Node.prototype.setHidden=function(t){if(this.hidden_!=t){this.hidden_=t;this.setDirty(lime.Dirty.VISIBILITY);this.autoHide_=0}return this};lime.Node.prototype.getSize=function(){return this.size_};lime.Node.prototype.setSize=function(t){var e,o,i=this.size_;e=2==arguments.length?new goog.math.Size(arguments[0],arguments[1]):t;var n=this.getAnchorPoint();if(i&&this.children_.length)for(var r=0;r<this.children_.length;r++){var s=this.children_[r];if(s.getAutoResize){var a=s.getAutoResize();if(a==lime.AutoResize.NONE)continue;var l=s.getBoundingBox(),g=i.width,m=l.left+n.x*i.width,c=l.right-l.left,u=g-l.right-n.x*i.width;a&lime.AutoResize.LEFT&&(g-=m);a&lime.AutoResize.WIDTH&&(g-=c);a&lime.AutoResize.RIGHT&&(g-=u);if(g!=i.width){o=(e.width-g)/(i.width-g);a&lime.AutoResize.LEFT&&(m*=o);a&lime.AutoResize.WIDTH&&(c*=o)}g=i.height;var h=l.top+n.y*i.height,p=l.bottom-l.top,_=g-l.bottom-n.y*i.height;a&lime.AutoResize.TOP&&(g-=h);a&lime.AutoResize.HEIGHT&&(g-=p);a&lime.AutoResize.BOTTOM&&(g-=_);if(g!=i.height){o=(e.height-g)/(i.height-g);a&lime.AutoResize.TOP&&(h*=o);a&lime.AutoResize.HEIGHT&&(p*=o)}var d=s.getAnchorPoint();s.setSize(c,p);s.setPosition(m+d.x*c-n.x*e.width,h+d.y*p-n.y*e.height)}}this.size_=e;return this.setDirty(lime.Dirty.SCALE)};lime.Node.prototype.getAutoResize=function(){return this.autoResize_};lime.Node.prototype.setAutoResize=function(t){this.autoResize_=t;return this.setDirty(lime.Dirty.ALL)};lime.Node.prototype.setAllow3DCSSTransforms=function(t){this.allow3DCSSTransform_=t;return this};lime.Node.prototype.getCSS3DTransformsAllowed=function(){return this.allow3DCSSTransform_};lime.Node.prototype.screenToLocal=function(t){if(!this.inTree_)return t;var e=this.getParent().screenToLocal(t);return this.parentToLocal(e)};lime.Node.prototype.parentToLocal=function(t){if(!this.getParent())return null;t.x-=this.position_.x;t.y-=this.position_.y;t.x/=this.scale_.x;t.y/=this.scale_.y;if(0!=this.rotation_){var e=t.clone(),o=this.rotation_*Math.PI/180,i=Math.cos(o),n=Math.sin(o);t.x=i*e.x-n*e.y;t.y=i*e.y+n*e.x}return t};lime.Node.prototype.localToScreen=function(t){return this.inTree_?this.getParent().localToScreen(this.localToParent(t)):t};lime.Node.prototype.localToParent=function(t){if(!this.getParent())return t;var e=t.clone();if(0!=this.rotation_){var o=-this.rotation_*Math.PI/180,i=Math.cos(o),n=Math.sin(o);e.x=i*t.x-n*t.y;e.y=i*t.y+n*t.x}e.x*=this.scale_.x;e.y*=this.scale_.y;e.x+=this.position_.x;e.y+=this.position_.y;return e};lime.Node.prototype.localToNode=function(t,e){return this.inTree_?e.screenToLocal(this.localToScreen(t)):t};lime.Node.prototype.getOpacity=function(){return this.opacity_};lime.Node.prototype.setOpacity=function(t){this.opacity_=t;var e=this.getHidden();if(0!=this.opacity_||e)0!=this.opacity_&&e&&this.autoHide_&&this.setHidden(!1);else{this.setHidden(!0);this.autoHide_=1}if(goog.isDef(this.transitionsActive_[lime.Transition.OPACITY]))return this;this.setDirty(lime.Dirty.ALPHA);return this};lime.Node.prototype.createDomElement=function(){var t=this.renderer&&this.renderer.getType()==lime.Renderer.CANVAS?"canvas":"div",e=function(){this.domElement=this.rootElement=this.containerElement=goog.dom.createDom(t);this.domClassName&&goog.dom.classes.add(this.domElement,this.domClassName);this.dirty_|=-1};if(this.domElement){var o=this.domElement.tagName.toLowerCase();if(o!=t){var i=this.rootElement;e.call(this);i.parentNode&&i.parentNode.replaceChild(this.rootElement,i)}}else e.call(this)};lime.Node.prototype.updateDomElement=function(){this.needsDomElement()?this.createDomElement():this.removeDomElement()};lime.Node.prototype.removeDomElement=function(){if(this.rootElement){goog.dom.removeNode(this.rootElement);delete this.domElement;delete this.rootElement;delete this.containerElement}};lime.Node.prototype.updateLayout=function(){this.dirty_&=~lime.Dirty.LAYOUT;this.updateDomElement();if(this.parent_&&this.parent_.dirty_&lime.Dirty.LAYOUT)this.parent_.updateLayout();else if(this.needsDomElement()){for(var t,e=0;t=this.children_[e];e++)t instanceof lime.Node&&t.updateLayout();this.renderer.updateLayout.call(this)}};lime.Node.prototype.update=function(t){{var e,o,i=t||0;goog.getUid(this)}this.dirty_&lime.Dirty.LAYOUT&&this.updateLayout();var n=this.renderer.getType()==lime.Renderer.DOM||i;if(n){for(var r in this.transitionsClear_){delete this.transitionsActive_[r];delete this.transitionsActiveSet_[r];e=lime.Node.getPropertyForTransition(parseInt(r,10));lime.style.clearTransition(this.domElement,e);this.domElement!=this.containerElement&&lime.style.clearTransition(this.continerElement,e)}var s=0;for(r in this.transitionsAdd_){o=this.transitionsAdd_[r];if(!o[3]){o[3]=1;if(r==lime.Transition.POSITION&&this.positionDrawn_!=this.position_){this.setDirty(lime.Dirty.POSITION,0,!0);s=1}if(r==lime.Transition.SCALE&&this.scaleDrawn_!=this.scale_){this.setDirty(lime.Dirty.SCALE,0,!0);s=1}if(r==lime.Transition.OPACITY&&this.opacityDrawn_!=this.opacity_){this.setDirty(lime.Dirty.ALPHA,0,!0);s=1}if(r==lime.Transition.ROTATION&&this.rotationDrawn_!=this.rotation_){this.setDirty(lime.Dirty.ROTATION,0,!0);s=1}}}if(!s)for(r in this.transitionsAdd_){o=this.transitionsAdd_[r];e=lime.Node.getPropertyForTransition(parseInt(r,10));if(this.renderer.getType()==lime.Renderer.DOM||"opacity"!=e){this.transitionsActive_[r]=o[0];lime.style.setTransition(this.domElement,e,o[1],o[2]);this.domElement!=this.containerElement&&e==lime.style.transformProperty&&lime.style.setTransition(this.containerElement,e,o[1],o[2])}delete this.transitionsAdd_[r]}this.positionDrawn_=this.position_;this.scaleDrawn_=this.scale_;this.opacityDrawn_=this.opacity_;this.rotationDrawn_=this.rotation_;this.transitionsClear_={}}if(i)this.renderer.drawCanvas.call(this);else{if(this.renderer.getType()==lime.Renderer.CANVAS){var a=this.getDeepestParentWithDom();a.redraw_=1;a!=this||this.dirty_!=lime.Dirty.POSITION||this.mask_||(a.redraw_=0);lime.setObjectDirty(this.getDeepestParentWithDom(),1)}this.renderer.update.call(this)}if(n)for(r in this.transitionsActive_)this.transitionsActive_[r]&&(this.transitionsActiveSet_[r]=!0);if(this.dependencies_)for(var r=0;r<this.dependencies_.length;r++)this.dependencies_[r].setDirty(lime.Dirty.ALL);this.setDirty(0,i)};lime.Node.getPropertyForTransition=function(t){return t==lime.Transition.OPACITY?"opacity":lime.style.transformProperty};lime.Node.prototype.getParent=function(){return this.parent_?this.parent_:null};lime.Node.prototype.appendChild=function(t,e){t instanceof lime.Node&&t.getParent()?t.getParent().removeChild(t):t.parentNode&&goog.dom.removeNode(t);t.parent_=this;void 0==e?this.children_.push(t):goog.array.insertAt(this.children_,t,e);this.renderer.getType()!=lime.Renderer.DOM&&t.setRenderer(this.renderer.getType());if(t instanceof lime.Node){this.inTree_&&t.wasAddedToTree();t.setDirty(lime.Dirty.LAYOUT)}return this.setDirty(lime.Dirty.LAYOUT)};lime.Node.prototype.getNumberOfChildren=function(){return this.children_.length};lime.Node.prototype.getChildAt=function(t){return t>=0&&this.getNumberOfChildren()>t?this.children_[t]:null};lime.Node.prototype.getChildIndex=function(t){return this.children_.indexOf(t)};lime.Node.prototype.removeChild=function(t){return this.removeChildAt(this.getChildIndex(t))};lime.Node.prototype.removeChildAt=function(t){if(t>=0&&this.getNumberOfChildren()>t){var e=this.getChildAt(t);e.maskTarget_&&e.maskTarget_.setMask(null);if(e instanceof lime.Node){this.inTree_&&e.wasRemovedFromTree();e.removeDomElement();e.parent_=null}else goog.dom.removeNode(e);this.children_.splice(t,1);return this.setDirty(lime.Dirty.LAYOUT)}return this};lime.Node.prototype.removeAllChildren=function(){for(;this.getNumberOfChildren();)this.removeChildAt(0);return this};lime.Node.prototype.setChildIndex=function(t,e){var o=this.getChildIndex(t);if(-1!=o&&o!=e){this.children_.splice(o,1);goog.array.insertAt(this.children_,t,e);this.getDirector()&&this.getDirector().eventDispatcher.updateDispatchOrder(t);return this.setDirty(lime.Dirty.LAYOUT)}return this};lime.Node.prototype.listen=function(t){var e=goog.events.EventTarget.prototype.listen.apply(this,arguments);if(lime.userAgent.SUPPORTS_TOUCH&&"mouse"==t.substring(0,5))return e;goog.isDef(this.eventHandlers_[t])||(this.eventHandlers_[t]=[0,0]);if(this.inTree_&&0==this.eventHandlers_[t][0]){this.eventHandlers_[t][0]=1;this.getDirector().eventDispatcher.register(this,t)}this.eventHandlers_[t][1]++;return e};lime.Node.prototype.unlisten=function(t){goog.events.EventTarget.prototype.unlisten.apply(this,arguments);if(!lime.userAgent.SUPPORTS_TOUCH||"mouse"!=t.substring(0,5)){if(this.inTree_&&1==this.eventHandlers_[t][1]){this.eventHandlers_[t][0]=0;this.getDirector().eventDispatcher.release(this,t)}this.eventHandlers_[t][1]--;this.eventHandlers_[t][1]||delete this.eventHandlers_[t]}};lime.Node.prototype.getDirector=function(){return this.inTree_?this.director_:null};lime.Node.prototype.getScene=function(){return this.inTree_?this.scene_:null};lime.Node.prototype.wasRemovedFromTree=function(){var t;this.dependencySet_||this.removeDependency(this.getParent());for(var e=0;t=this.children_[e];e++)t instanceof lime.Node&&t.wasRemovedFromTree();for(var o in this.eventHandlers_){this.eventHandlers_[o][0]=0;!this.getDirector();this.getDirector().eventDispatcher.release(this,o)}this.getDirector().eventDispatcher.updateDispatchOrder(this);this.inTree_=!1;this.director_=null;this.scene_=null};lime.Node.prototype.wasAddedToTree=function(){this.inTree_=!0;this.director_=this.parent_.getDirector();this.scene_=this.parent_.getScene();for(var t,e=0;t=this.children_[e];e++)t instanceof lime.Node&&t.wasAddedToTree();for(var o in this.eventHandlers_){this.eventHandlers_[o][0]=1;this.getDirector().eventDispatcher.register(this,o)}this.dependencySet_&&this.setupDependencies();this.getDirector().eventDispatcher.updateDispatchOrder(this)};lime.Node.prototype.setupDependencies=function(){this.dependencySet_=!0;this.inTree_&&this.addDependency(this.getParent())};lime.Node.prototype.addDependency=function(t){t.dependencies_||(t.dependencies_=[]);goog.array.insert(t.dependencies_,this);t||t.getParent()instanceof lime.Scene||this.addDependency(t.getParent())};lime.Node.prototype.removeDependency=function(t){if(t&&t.dependencies_){goog.array.remove(t.dependencies_,this);this.removeDependency(t.getParent())}};lime.Node.prototype.releaseDependencies=function(){delete this.dependencySet_;this.removeDependency(this.getParent())};lime.Node.prototype.getFrame=function(){var t=this.getSize(),e=this.getAnchorPoint();return new goog.math.Box(-t.height*e.y,t.width*(1-e.x),t.height*(1-e.y),-t.width*e.x)};lime.Node.prototype.getBoundingBox=function(t){var e=t||this.getFrame(),o=new goog.math.Coordinate(e.left,e.top),i=new goog.math.Coordinate(e.right,e.top),n=new goog.math.Coordinate(e.left,e.bottom),r=new goog.math.Coordinate(e.right,e.bottom);o=this.localToParent(o);i=this.localToParent(i);n=this.localToParent(n);r=this.localToParent(r);return new goog.math.Box(Math.floor(Math.min(o.y,i.y,n.y,r.y)),Math.ceil(Math.max(o.x,i.x,n.x,r.x)),Math.ceil(Math.max(o.y,i.y,n.y,r.y)),Math.floor(Math.min(o.x,i.x,n.x,r.x)))};lime.Node.prototype.measureContents=function(){var t=this.getFrame();t.left==t.right&&this.children_.length&&(t=this.children_[0].getBoundingBox(this.children_[0].measureContents()));for(var e,o=0;e=this.children_[o];o++)1!=e.isMask&&t.expandToInclude(e.getBoundingBox(e.measureContents()));return t};lime.Node.prototype.addTransition=function(t,e,o,i){this.transitionsAdd_[t]=[e,o,i,0]};lime.Node.prototype.clearTransition=function(t){this.transitionsClear_[t]=1};lime.Node.prototype.hitTest=function(t){for(var e=this;e;e=e.parent_)if(e.hidden_)return!1;var o=this.screenToLocal(t.screenPosition);if(this.getFrame().contains(o)){t.position=o;return!0}return!1};lime.Node.prototype.runAction=function(t){t.addTarget(this);t.play()};lime.Node.prototype.getRelativeQuality=throwDeprecated.bind(null,"getRelativeQuality");lime.Node.prototype.calcRelativeQuality=throwDeprecated.bind(null,"calcRelativeQuality");lime.Node.prototype.setQuality=throwDeprecated.bind(null,"setQuality");lime.Node.prototype.getQuality=throwDeprecated.bind(null,"getQuality");goog.provide("goog.color.names");goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};goog.provide("goog.color");goog.require("goog.color.names");goog.require("goog.math");goog.color.Rgb;goog.color.Hsv;goog.color.Hsl;goog.color.parse=function(t){var e={};t=String(t);var o=goog.color.prependHashIfNecessaryHelper(t);if(goog.color.isValidHexColor_(o)){e.hex=goog.color.normalizeHex(o);e.type="hex";return e}var i=goog.color.isValidRgbColor_(t);if(i.length){e.hex=goog.color.rgbArrayToHex(i);e.type="rgb";return e}if(goog.color.names){var n=goog.color.names[t.toLowerCase()];if(n){e.hex=n;e.type="named";return e}}throw Error(t+" is not a valid color string")};goog.color.isValidColor=function(t){var e=goog.color.prependHashIfNecessaryHelper(t);return!!(goog.color.isValidHexColor_(e)||goog.color.isValidRgbColor_(t).length||goog.color.names&&goog.color.names[t.toLowerCase()])};goog.color.parseRgb=function(t){var e=goog.color.isValidRgbColor_(t);if(!e.length)throw Error(t+" is not a valid RGB color");return e};goog.color.hexToRgbStyle=function(t){return goog.color.rgbStyle_(goog.color.hexToRgb(t))};goog.color.hexTripletRe_=/#(.)(.)(.)/;goog.color.normalizeHex=function(t){if(!goog.color.isValidHexColor_(t))throw Error("'"+t+"' is not a valid hex color");4==t.length&&(t=t.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3"));return t.toLowerCase()};goog.color.hexToRgb=function(t){t=goog.color.normalizeHex(t);var e=parseInt(t.substr(1,2),16),o=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16);return[e,o,i]};goog.color.rgbToHex=function(t,e,o){t=Number(t);e=Number(e);o=Number(o);if(isNaN(t)||0>t||t>255||isNaN(e)||0>e||e>255||isNaN(o)||0>o||o>255)throw Error('"('+t+","+e+","+o+'") is not a valid RGB color');var i=goog.color.prependZeroIfNecessaryHelper(t.toString(16)),n=goog.color.prependZeroIfNecessaryHelper(e.toString(16)),r=goog.color.prependZeroIfNecessaryHelper(o.toString(16));return"#"+i+n+r};goog.color.rgbArrayToHex=function(t){return goog.color.rgbToHex(t[0],t[1],t[2])};goog.color.rgbToHsl=function(t,e,o){var i=t/255,n=e/255,r=o/255,s=Math.max(i,n,r),a=Math.min(i,n,r),l=0,g=0,m=.5*(s+a);if(s!=a){s==i?l=60*(n-r)/(s-a):s==n?l=60*(r-i)/(s-a)+120:s==r&&(l=60*(i-n)/(s-a)+240);g=m>0&&.5>=m?(s-a)/(2*m):(s-a)/(2-2*m)}return[Math.round(l+360)%360,g,m]};goog.color.rgbArrayToHsl=function(t){return goog.color.rgbToHsl(t[0],t[1],t[2])};goog.color.hueToRgb_=function(t,e,o){0>o?o+=1:o>1&&(o-=1);return 1>6*o?t+6*(e-t)*o:1>2*o?e:2>3*o?t+(e-t)*(2/3-o)*6:t};goog.color.hslToRgb=function(t,e,o){var i=0,n=0,r=0,s=t/360;if(0==e)i=n=r=255*o;else{var a=0,l=0;l=.5>o?o*(1+e):o+e-e*o;a=2*o-l;i=255*goog.color.hueToRgb_(a,l,s+1/3);n=255*goog.color.hueToRgb_(a,l,s);r=255*goog.color.hueToRgb_(a,l,s-1/3)}return[Math.round(i),Math.round(n),Math.round(r)]};goog.color.hslArrayToRgb=function(t){return goog.color.hslToRgb(t[0],t[1],t[2])};goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i;goog.color.isValidHexColor_=function(t){return goog.color.validHexColorRe_.test(t)};goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/;goog.color.isNormalizedHexColor_=function(t){return goog.color.normalizedHexColorRe_.test(t)};goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;goog.color.isValidRgbColor_=function(t){var e=t.match(goog.color.rgbColorRe_);if(e){var o=Number(e[1]),i=Number(e[2]),n=Number(e[3]);if(o>=0&&255>=o&&i>=0&&255>=i&&n>=0&&255>=n)return[o,i,n]}return[]};goog.color.prependZeroIfNecessaryHelper=function(t){return 1==t.length?"0"+t:t};goog.color.prependHashIfNecessaryHelper=function(t){return"#"==t.charAt(0)?t:"#"+t};goog.color.rgbStyle_=function(t){return"rgb("+t.join(",")+")"};goog.color.hsvToRgb=function(t,e,o){var i=0,n=0,r=0;if(0==e){i=o;n=o;r=o}else{var s=Math.floor(t/60),a=t/60-s,l=o*(1-e),g=o*(1-e*a),m=o*(1-e*(1-a));switch(s){case 1:i=g;n=o;r=l;break;case 2:i=l;n=o;r=m;break;case 3:i=l;n=g;r=o;break;case 4:i=m;n=l;r=o;break;case 5:i=o;n=l;r=g;break;case 6:case 0:i=o;n=m;r=l}}return[Math.floor(i),Math.floor(n),Math.floor(r)]};goog.color.rgbToHsv=function(t,e,o){var i,n,r=Math.max(Math.max(t,e),o),s=Math.min(Math.min(t,e),o),a=r;if(s==r){i=0;n=0}else{var l=r-s;n=l/r;i=t==r?(e-o)/l:e==r?2+(o-t)/l:4+(t-e)/l;i*=60;0>i&&(i+=360);i>360&&(i-=360)}return[i,n,a]};goog.color.rgbArrayToHsv=function(t){return goog.color.rgbToHsv(t[0],t[1],t[2])};goog.color.hsvArrayToRgb=function(t){return goog.color.hsvToRgb(t[0],t[1],t[2])
};goog.color.hexToHsl=function(t){var e=goog.color.hexToRgb(t);return goog.color.rgbToHsl(e[0],e[1],e[2])};goog.color.hslToHex=function(t,e,o){return goog.color.rgbArrayToHex(goog.color.hslToRgb(t,e,o))};goog.color.hslArrayToHex=function(t){return goog.color.rgbArrayToHex(goog.color.hslToRgb(t[0],t[1],t[2]))};goog.color.hexToHsv=function(t){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(t))};goog.color.hsvToHex=function(t,e,o){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(t,e,o))};goog.color.hsvArrayToHex=function(t){return goog.color.hsvToHex(t[0],t[1],t[2])};goog.color.hslDistance=function(t,e){var o,i;o=t[2]<=.5?t[1]*t[2]:t[1]*(1-t[2]);i=e[2]<=.5?e[1]*e[2]:e[1]*(1-e[2]);var n=t[0]/360,r=e[0]/360,s=2*(n-r)*Math.PI;return(t[2]-e[2])*(t[2]-e[2])+o*o+i*i-2*o*i*Math.cos(s)};goog.color.blend=function(t,e,o){o=goog.math.clamp(o,0,1);return[Math.round(o*t[0]+(1-o)*e[0]),Math.round(o*t[1]+(1-o)*e[1]),Math.round(o*t[2]+(1-o)*e[2])]};goog.color.darken=function(t,e){var o=[0,0,0];return goog.color.blend(o,t,e)};goog.color.lighten=function(t,e){var o=[255,255,255];return goog.color.blend(o,t,e)};goog.color.highContrast=function(t,e){for(var o=[],i=0;i<e.length;i++)o.push({color:e[i],diff:goog.color.yiqBrightnessDiff_(e[i],t)+goog.color.colorDiff_(e[i],t)});o.sort(function(t,e){return e.diff-t.diff});return o[0].color};goog.color.yiqBrightness_=function(t){return Math.round((299*t[0]+587*t[1]+114*t[2])/1e3)};goog.color.yiqBrightnessDiff_=function(t,e){return Math.abs(goog.color.yiqBrightness_(t)-goog.color.yiqBrightness_(e))};goog.color.colorDiff_=function(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])+Math.abs(t[2]-e[2])};goog.provide("goog.color.alpha");goog.require("goog.color");goog.color.alpha.parse=function(t){var e={};t=String(t);var o=goog.color.prependHashIfNecessaryHelper(t);if(goog.color.alpha.isValidAlphaHexColor_(o)){e.hex=goog.color.alpha.normalizeAlphaHex_(o);e.type="hex";return e}var i=goog.color.alpha.isValidRgbaColor_(t);if(i.length){e.hex=goog.color.alpha.rgbaArrayToHex(i);e.type="rgba";return e}var n=goog.color.alpha.isValidHslaColor_(t);if(n.length){e.hex=goog.color.alpha.hslaArrayToHex(n);e.type="hsla";return e}throw Error(t+" is not a valid color string")};goog.color.alpha.hexToRgbaStyle=function(t){return goog.color.alpha.rgbaStyle_(goog.color.alpha.hexToRgba(t))};goog.color.alpha.extractHexColor=function(t){if(goog.color.alpha.isValidAlphaHexColor_(t)){var e=goog.color.prependHashIfNecessaryHelper(t),o=goog.color.alpha.normalizeAlphaHex_(e);return o.substring(0,7)}throw Error(t+" is not a valid 8-hex color string")};goog.color.alpha.extractAlpha=function(t){if(goog.color.alpha.isValidAlphaHexColor_(t)){var e=goog.color.prependHashIfNecessaryHelper(t),o=goog.color.alpha.normalizeAlphaHex_(e);return o.substring(7,9)}throw Error(t+" is not a valid 8-hex color string")};goog.color.alpha.hexQuadrupletRe_=/#(.)(.)(.)(.)/;goog.color.alpha.normalizeAlphaHex_=function(t){if(!goog.color.alpha.isValidAlphaHexColor_(t))throw Error("'"+t+"' is not a valid alpha hex color");5==t.length&&(t=t.replace(goog.color.alpha.hexQuadrupletRe_,"#$1$1$2$2$3$3$4$4"));return t.toLowerCase()};goog.color.alpha.hexToRgba=function(t){t=goog.color.alpha.normalizeAlphaHex_(t);var e=parseInt(t.substr(1,2),16),o=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16),n=parseInt(t.substr(7,2),16);return[e,o,i,n/255]};goog.color.alpha.rgbaToHex=function(t,e,o,i){var n=Math.floor(255*i);if(isNaN(n)||0>n||n>255)throw Error('"('+t+","+e+","+o+","+i+'") is not a valid RGBA color');var r=goog.color.prependZeroIfNecessaryHelper(n.toString(16));return goog.color.rgbToHex(t,e,o)+r};goog.color.alpha.hslaToHex=function(t,e,o,i){var n=Math.floor(255*i);if(isNaN(n)||0>n||n>255)throw Error('"('+t+","+e+","+o+","+i+'") is not a valid HSLA color');var r=goog.color.prependZeroIfNecessaryHelper(n.toString(16));return goog.color.hslToHex(t,e/100,o/100)+r};goog.color.alpha.rgbaArrayToHex=function(t){return goog.color.alpha.rgbaToHex(t[0],t[1],t[2],t[3])};goog.color.alpha.rgbaToRgbaStyle=function(t,e,o,i){if(isNaN(t)||0>t||t>255||isNaN(e)||0>e||e>255||isNaN(o)||0>o||o>255||isNaN(i)||0>i||i>1)throw Error('"('+t+","+e+","+o+","+i+')" is not a valid RGBA color');return goog.color.alpha.rgbaStyle_([t,e,o,i])};goog.color.alpha.rgbaArrayToRgbaStyle=function(t){return goog.color.alpha.rgbaToRgbaStyle(t[0],t[1],t[2],t[3])};goog.color.alpha.hslaArrayToHex=function(t){return goog.color.alpha.hslaToHex(t[0],t[1],t[2],t[3])};goog.color.alpha.hslaArrayToRgbaStyle=function(t){return goog.color.alpha.hslaToRgbaStyle(t[0],t[1],t[2],t[3])};goog.color.alpha.hslaToRgbaStyle=function(t,e,o,i){return goog.color.alpha.rgbaStyle_(goog.color.alpha.hslaToRgba(t,e,o,i))};goog.color.alpha.hslaToRgba=function(t,e,o,i){return goog.color.hslToRgb(t,e/100,o/100).concat(i)};goog.color.alpha.rgbaToHsla=function(t,e,o,i){return goog.color.rgbToHsl(t,e,o).concat(i)};goog.color.alpha.rgbaArrayToHsla=function(t){return goog.color.alpha.rgbaToHsla(t[0],t[1],t[2],t[3])};goog.color.alpha.validAlphaHexColorRe_=/^#(?:[0-9a-f]{4}){1,2}$/i;goog.color.alpha.isValidAlphaHexColor_=function(t){return goog.color.alpha.validAlphaHexColorRe_.test(t)};goog.color.alpha.normalizedAlphaHexColorRe_=/^#[0-9a-f]{8}$/;goog.color.alpha.isNormalizedAlphaHexColor_=function(t){return goog.color.alpha.normalizedAlphaHexColorRe_.test(t)};goog.color.alpha.rgbaColorRe_=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i;goog.color.alpha.hslaColorRe_=/^(?:hsla)\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\%,\s?(0|[1-9]\d{0,2})\%,\s?(0|1|0\.\d{0,10})\)$/i;goog.color.alpha.isValidRgbaColor_=function(t){var e=t.match(goog.color.alpha.rgbaColorRe_);if(e){var o=Number(e[1]),i=Number(e[2]),n=Number(e[3]),r=Number(e[4]);if(o>=0&&255>=o&&i>=0&&255>=i&&n>=0&&255>=n&&r>=0&&1>=r)return[o,i,n,r]}return[]};goog.color.alpha.isValidHslaColor_=function(t){var e=t.match(goog.color.alpha.hslaColorRe_);if(e){var o=Number(e[1]),i=Number(e[2]),n=Number(e[3]),r=Number(e[4]);if(o>=0&&360>=o&&i>=0&&100>=i&&n>=0&&100>=n&&r>=0&&1>=r)return[o,i,n,r]}return[]};goog.color.alpha.rgbaStyle_=function(t){var e=t.slice(0);e[3]=Math.round(1e3*t[3])/1e3;return"rgba("+e.join(",")+")"};goog.color.alpha.hsvaToHex=function(t,e,o,i){var n=Math.floor(255*i);return goog.color.hsvArrayToHex([t,e,o])+goog.color.prependZeroIfNecessaryHelper(n.toString(16))};goog.color.alpha.hsvaArrayToHex=function(t){return goog.color.alpha.hsvaToHex(t[0],t[1],t[2],t[3])};goog.provide("lime.fill.Fill");goog.require("goog.events.EventTarget");lime.fill.Fill=function(){goog.base(this)};goog.inherits(lime.fill.Fill,goog.events.EventTarget);lime.fill.Fill.prototype.initForSprite=goog.nullFunction;lime.fill.parse=function(t){if(t[0]instanceof lime.fill.Fill)return t[0];goog.isArray(t)||(t=goog.array.toArray(arguments));return t.length>2?new lime.fill.Color(t):!goog.isString(t[0])||"rgb("!=t[0].substring(0,4)&&"rgba("!=t[0].substring(0,5)&&"#"!=t[0].substring(0,1)?new lime.fill.Image(t[0]):new lime.fill.Color(t[0])};lime.fill.Fill.prototype.setDOMStyle=goog.nullFunction;lime.fill.Fill.prototype.setCanvasStyle=goog.nullFunction;goog.provide("lime.fill.Color");goog.require("goog.array");goog.require("goog.color");goog.require("goog.color.alpha");goog.require("lime.fill.Fill");lime.fill.Color=function(t){lime.fill.Fill.call(this);this.a=1;this.setColor(t)};goog.inherits(lime.fill.Color,lime.fill.Fill);lime.fill.Color.prototype.id="color";lime.fill.Color.prototype.getRgba=function(){var t=null;if(goog.isNumber(this.r)&&goog.isNumber(this.g)&&goog.isNumber(this.b))t=[this.r,this.g,this.b,this.a];else if(goog.isString(this.str)){var e=goog.color.parse(this.str);"named"!=e.type&&(t=goog.color.hexToRgb(e.hex));t.push(1)}return t};lime.fill.Color.prototype.addBrightness=function(t){return this.modifyColor(2,t)};lime.fill.Color.prototype.modifyColor=function(t,e){var o=e||.1,i=this.getRgba();if(!i)return this;i.pop();var n=goog.color.rgbArrayToHsl(i);n[t]+=o;n[t]>1&&(n[t]=1);i=goog.color.hslArrayToRgb(n);i.push(this.a);return this.setColor(i)};lime.fill.Color.prototype.addSaturation=function(t){return this.modifyColor(1,t)};lime.fill.Color.prototype.setColor=function(t){var e=t;if(goog.isString(t)){this.str=t;return this}arguments.length>2&&(e=arguments);if(e.length>=3){this.r=e[0];this.g=e[1];this.b=e[2]}4==e.length&&(this.a=e[3]);this.str=1==this.a?"rgb("+this.r+","+this.g+","+this.b+")":"rgba("+this.r+","+this.g+","+this.b+","+this.a+")";return this};lime.fill.Color.prototype.setDOMStyle=function(t){t.style.background=this.str};lime.fill.Color.prototype.setCanvasStyle=function(t){t.fillStyle=this.str};lime.fill.Color.prototype.clone=function(){var t=new lime.fill.Color("");t.r=this.r;t.g=this.g;t.b=this.b;t.a=this.a;t.str=this.str;return t};lime.fill.Color.prototype.equals=function(t){return t&&t instanceof lime.fill.Color&&(this.str===t.str||void 0!==t.r&&t.r===this.r&&t.g===this.g&&t.b===this.b&&r.a===this.a||goog.array.equals(this.getRgba(),t.getRgba()))};goog.provide("lime.fill.Image");goog.require("lime.fill.Fill");goog.require("lime.userAgent");lime.fill.Image=function(t){lime.fill.Fill.call(this);t&&goog.isFunction(t.data)&&(t=t.data());if(goog.isString(t)){this.url_=t;this.url_.length>50&&(this.url_=this.url_.substr(-50));if(lime.fill.Image.loadedImages_[this.url_])this.image_=lime.fill.Image.loadedImages_[this.url_];else{this.image_=new Image;this.image_.src=t}}else{this.url_=t.src;this.url_.length>50&&(this.url_=this.url_.substr(-50));this.image_=lime.fill.Image.loadedImages_[this.url_]?lime.fill.Image.loadedImages_[this.url_]:t}this.isLoaded()||this.addLoadHandler_();lime.fill.Image.loadedImages_[this.url_]=this.image_};goog.inherits(lime.fill.Image,lime.fill.Fill);lime.fill.Image.loadedImages_={};lime.fill.Image.prototype.id="image";lime.fill.Image.prototype.initForSprite=function(t){var e=t.getSize(),o=this;e.width||e.height||(this.isLoaded()?t.setSize(this.image_.width,this.image_.height):goog.events.listen(this,goog.events.EventType.LOAD,function(){var t=this.getSize();t.width||t.height||this.setSize(o.image_.width,o.image_.height)},!1,t));this.isLoaded()?t.setImgSize&&t.setImgSize(this.image_.width,this.image_.height):goog.events.listen(this,goog.events.EventType.LOAD,function(){t.setImgSize&&t.setImgSize(this.image_.width,this.image_.height);t.setDirty(lime.Dirty.CONTENT);window.current_scene&&current_scene.isPaused_&&lime.updateDirtyObjects()},!1,this)};lime.fill.Image.prototype.addLoadHandler_=function(){goog.events.listen(this.image_,goog.events.EventType.LOAD,this.imageLoadedHandler_,!1,this)};lime.fill.Image.prototype.imageLoadedHandler_=function(t){this.dispatchEvent(t)};lime.fill.Image.prototype.getImageElement=function(){return this.image_};lime.fill.Image.prototype.isLoaded=function(){return!!(this.image_&&this.image_.width&&this.image_.height)};lime.fill.Image.prototype.setSize=function(t,e){if(goog.isNumber(t)){t=new goog.math.Size(arguments[0],arguments[1]);e=arguments[2]||!1}this.size_=t;this.size_perc_=e;return this};lime.fill.Image.prototype.setOffset=function(t,e){if(goog.isNumber(t)){t=new goog.math.Coordinate(arguments[0],arguments[1]);e=arguments[2]||!1}this.offset_=t;this.offset_perc_=e;return this};lime.fill.Image.prototype.getPixelSizeAndOffset=function(t){var e=t.getSize().clone();if(this.size_)if(this.size_perc_){e.width*=this.size_.width;e.height*=this.size_.height}else e=this.size_;var o=new goog.math.Coordinate(0,0);if(this.offset_)if(this.offset_perc_){o.x=e.width*this.offset_.x;o.y=e.height*this.offset_.y}else o=this.offset_;return[e,o]};lime.fill.Image.prototype.setDOMBackgroundProp_=function(t,e){var o=this.getPixelSizeAndOffset(e),i=o[0],n=o[1];t.style[lime.style.getCSSproperty("BackgroundSize")]=i.width+"px "+i.height+"px";var r=e.stroke_?e.stroke_.width_:0;t.style.backgroundPosition=n.x-r+"px "+(n.y-r)+"px";var s=null==e.repeat&&null==e.repeat_x&&null==e.repeat_y?"repeat":e.repeat?"repeat":e.repeat_x?"repeat-x":e.repeat_y?"repeat-y":"no-repeat";t.style.backgroundRepeat=s;this.qualityRenderer&&(t.style.imageRendering="optimizeQuality")};lime.fill.Image.prototype.IS_IOS_CHROME=lime.userAgent.IOS&&(lime.userAgent.CHROME||/CriOS/.test(goog.global.navigator.userAgent));lime.fill.Image.prototype.setDOMStyle=function(t,e){if(this.isLoaded()){var o="url("+this.image_.src+")",i=t.style.background;i&&-1!==i.indexOf(this.image_.src)||(t.style.background=o);this.setDOMBackgroundProp_(t,e)}};lime.fill.Image.prototype.setCanvasStyle=function(t,e){var o=e.getSize(),i=e.getFrame();if(o.width&&o.height)try{var n=this.getImageElement();if(!n.width||!n.height)return;var r=null==e.repeat&&null==e.repeat_x&&null==e.repeat_y?"repeat":e.repeat?"repeat":e.repeat_x?"repeat-x":e.repeat_y?"repeat-y":"no-repeat",s=this.getPixelSizeAndOffset(e),a=s[0],l=s[1],g=t.createPattern(n,r),m=a.width/n.width,c=a.height/n.height;t.save();var u=0,h=0,p=1,_=1;if(e.mirror){if(-1==e.mirror.horizontal){u=o.width-2*l.x;p=-1}if(-1==e.mirror.vertical){h=o.height-2*l.y;_=-1}}t.translate(i.left+l.x+u,i.top+l.y+h);t.scale(m*p,c*_);t.fillStyle=g;if("circle"===e.id)t.fill();else{var d=e.isBG?scene.getSize():o;t.fillRect(-l.x/m,-l.y/c,d.width/m,d.height/c)}t.restore()}catch(y){}};goog.provide("lime.fill.Stroke");goog.require("lime.fill.Fill");lime.fill.Stroke=function(t){lime.fill.Fill.call(this);var e=goog.isArray(t)?t:goog.array.toArray(arguments);this.width_=e[0]||1;e.shift();this.setColor.apply(this,e)};goog.inherits(lime.fill.Stroke,lime.fill.Fill);lime.fill.Stroke.prototype.id="stroke";lime.fill.Stroke.prototype.setDOMStyle=function(t){t.style.border=this.width_+"px solid "+this.color_.str};lime.fill.Stroke.prototype.setCanvasStyle=function(t){t.strokeStyle=this.color_.str;t.lineWidth=this.width_};lime.fill.Stroke.prototype.getWidth=function(){return this.width_};lime.fill.Stroke.prototype.setWidth=function(t){this.width_=t;return this};lime.fill.Stroke.prototype.getColor=function(){return this.color_};lime.fill.Stroke.prototype.setColor=function(){var t=goog.array.toArray(arguments);if(t[0]instanceof lime.fill.Color)this.color_=t[0];else{this.color_=new lime.fill.Color("#000");t.length&&this.color_.setColor.apply(this.color_,t)}return this};lime.fill.Stroke.prototype.clone=function(){var t=new lime.fill.Stroke;t.width_=this.width_;t.color_=this.color_;return t};goog.provide("lime.Renderer.CANVAS.SPRITE");goog.provide("lime.Renderer.DOM.SPRITE");goog.provide("lime.Sprite");goog.require("goog.events");goog.require("goog.events.EventTarget");goog.require("goog.math.Size");goog.require("lime");goog.require("lime.Node");goog.require("lime.fill.Color");goog.require("lime.fill.Stroke");goog.require("lime.fill.Fill");goog.require("lime.fill.Image");lime.Sprite=function(){lime.Node.call(this);this.fill_=null;this.stroke_=null};goog.inherits(lime.Sprite,lime.Node);lime.Sprite.prototype.id="sprite";lime.Sprite.prototype.supportedRenderers=[lime.Renderer.DOM.makeSubRenderer(lime.Renderer.DOM.SPRITE),lime.Renderer.CANVAS.makeSubRenderer(lime.Renderer.CANVAS.SPRITE)];lime.Sprite.prototype.getFill=function(){return this.fill_};lime.Sprite.prototype.setFill=function(){this.fill_=lime.fill.parse(goog.array.toArray(arguments));this.fill_.initForSprite(this);this.setDirty(lime.Dirty.CONTENT);return this};lime.Sprite.prototype.getStroke=function(){return this.stroke_};lime.Sprite.prototype.setStroke=function(t){!t||t instanceof lime.fill.Stroke||(t=new lime.fill.Stroke(goog.array.toArray(arguments)));this.stroke_=t;this.setDirty(lime.Dirty.CONTENT);return this};lime.Sprite.prototype.getCanvasContextName_=function(){var t=0;return function(){goog.isDef(this.canvasContextName_)||(this.canvasContextName_="limedc"+t++);return this.canvasContextName_}}();lime.Renderer.DOM.SPRITE.draw=function(t){goog.isNull(this.fill_)||this.fill_.setDOMStyle(t,this);if(goog.isNull(this.stroke_)){if(this.hadStroke_){goog.style.setStyle(t,"border-width",0);this.hadStroke_=!1}}else{this.stroke_.setDOMStyle(t,this);this.hadStroke_=!0}};lime.Renderer.CANVAS.SPRITE.draw=function(t){var e=this.getSize(),o=this.fill_,i=this.stroke_;if(o||i){var n=this.getFrame();if(o){o.setCanvasStyle(t,this);"image"!=o.id&&"frame"!=o.id&&t.fillRect(n.left,n.top,e.width,e.height)}if(i){i.setCanvasStyle(t,this);if("sprite"==this.id||"label"==this.id){var r=i.width_/2;t.strokeRect(n.left+r,n.top+r,e.width-2*r,e.height-2*r)}}}};goog.provide("lime.Renderer.CANVAS.SPRITE");goog.provide("lime.Renderer.DOM.SPRITE");goog.provide("lime.Sprite");goog.require("goog.events");goog.require("goog.events.EventTarget");goog.require("goog.math.Size");goog.require("lime");goog.require("lime.Node");goog.require("lime.fill.Color");goog.require("lime.fill.Stroke");goog.require("lime.fill.Fill");goog.require("lime.fill.Image");lime.Sprite=function(){lime.Node.call(this);this.fill_=null;this.stroke_=null};goog.inherits(lime.Sprite,lime.Node);lime.Sprite.prototype.id="sprite";lime.Sprite.prototype.supportedRenderers=[lime.Renderer.DOM.makeSubRenderer(lime.Renderer.DOM.SPRITE),lime.Renderer.CANVAS.makeSubRenderer(lime.Renderer.CANVAS.SPRITE)];lime.Sprite.prototype.getFill=function(){return this.fill_};lime.Sprite.prototype.setFill=function(){this.fill_=lime.fill.parse(goog.array.toArray(arguments));this.fill_.initForSprite(this);this.setDirty(lime.Dirty.CONTENT);return this};lime.Sprite.prototype.getStroke=function(){return this.stroke_};lime.Sprite.prototype.setStroke=function(t){!t||t instanceof lime.fill.Stroke||(t=new lime.fill.Stroke(goog.array.toArray(arguments)));this.stroke_=t;this.setDirty(lime.Dirty.CONTENT);return this};lime.Sprite.prototype.getCanvasContextName_=function(){var t=0;return function(){goog.isDef(this.canvasContextName_)||(this.canvasContextName_="limedc"+t++);return this.canvasContextName_}}();lime.Renderer.DOM.SPRITE.draw=function(t){goog.isNull(this.fill_)||this.fill_.setDOMStyle(t,this);if(goog.isNull(this.stroke_)){if(this.hadStroke_){goog.style.setStyle(t,"border-width",0);this.hadStroke_=!1}}else{this.stroke_.setDOMStyle(t,this);this.hadStroke_=!0}};lime.Renderer.CANVAS.SPRITE.draw=function(t){var e=this.getSize(),o=this.fill_,i=this.stroke_;if(o||i){var n=this.getFrame();if(o){o.setCanvasStyle(t,this);"image"!=o.id&&"frame"!=o.id&&t.fillRect(n.left,n.top,e.width,e.height)}if(i){i.setCanvasStyle(t,this);if("sprite"==this.id||"label"==this.id){var r=i.width_/2;t.strokeRect(n.left+r,n.top+r,e.width-2*r,e.height-2*r)}}}};goog.provide("lime.Renderer.CANVAS.SPRITE");goog.provide("lime.Renderer.DOM.SPRITE");goog.provide("lime.Sprite");goog.require("goog.events");goog.require("goog.events.EventTarget");goog.require("goog.math.Size");goog.require("lime");goog.require("lime.Node");goog.require("lime.fill.Color");goog.require("lime.fill.Stroke");goog.require("lime.fill.Fill");goog.require("lime.fill.Image");lime.Sprite=function(){lime.Node.call(this);this.fill_=null;this.stroke_=null};goog.inherits(lime.Sprite,lime.Node);lime.Sprite.prototype.id="sprite";lime.Sprite.prototype.supportedRenderers=[lime.Renderer.DOM.makeSubRenderer(lime.Renderer.DOM.SPRITE),lime.Renderer.CANVAS.makeSubRenderer(lime.Renderer.CANVAS.SPRITE)];lime.Sprite.prototype.getFill=function(){return this.fill_};lime.Sprite.prototype.setFill=function(){this.fill_=lime.fill.parse(goog.array.toArray(arguments));this.fill_.initForSprite(this);this.setDirty(lime.Dirty.CONTENT);return this};lime.Sprite.prototype.getStroke=function(){return this.stroke_};lime.Sprite.prototype.setStroke=function(t){!t||t instanceof lime.fill.Stroke||(t=new lime.fill.Stroke(goog.array.toArray(arguments)));this.stroke_=t;this.setDirty(lime.Dirty.CONTENT);return this};lime.Sprite.prototype.getCanvasContextName_=function(){var t=0;return function(){goog.isDef(this.canvasContextName_)||(this.canvasContextName_="limedc"+t++);return this.canvasContextName_}}();lime.Renderer.DOM.SPRITE.draw=function(t){goog.isNull(this.fill_)||this.fill_.setDOMStyle(t,this);if(goog.isNull(this.stroke_)){if(this.hadStroke_){goog.style.setStyle(t,"border-width",0);this.hadStroke_=!1}}else{this.stroke_.setDOMStyle(t,this);this.hadStroke_=!0}};lime.Renderer.CANVAS.SPRITE.draw=function(t){var e=this.getSize(),o=this.fill_,i=this.stroke_;if(o||i){var n=this.getFrame();if(o){o.setCanvasStyle(t,this);"image"!=o.id&&"frame"!=o.id&&t.fillRect(n.left,n.top,e.width,e.height)}if(i){i.setCanvasStyle(t,this);if("sprite"==this.id||"label"==this.id){var r=i.width_/2;t.strokeRect(n.left+r,n.top+r,e.width-2*r,e.height-2*r)}}}};goog.provide("lime.Circle");goog.provide("lime.Renderer.CANVAS.CIRCLE");goog.provide("lime.Renderer.DOM.CIRCLE");goog.require("lime.Renderer.CANVAS.SPRITE");goog.require("lime.Renderer.DOM.SPRITE");goog.require("lime.Sprite");goog.require("lime.style");lime.Circle=function(){lime.Sprite.call(this)};goog.inherits(lime.Circle,lime.Sprite);lime.Circle.prototype.id="circle";lime.Circle.prototype.supportedRenderers=[lime.Renderer.DOM.SPRITE.makeSubRenderer(lime.Renderer.DOM.CIRCLE),lime.Renderer.CANVAS.SPRITE.makeSubRenderer(lime.Renderer.CANVAS.CIRCLE)];lime.Circle.prototype.hitTest=function(t){var e=this.screenToLocal(t.screenPosition),o=this.size_,i=this.anchorPoint_,n=.5*o.width,r=.5*o.height,s=e.x-o.width*(.5-i.x),a=e.y-o.height*(.5-i.y);if(1>s*s/(n*n)+a*a/(r*r)){t.position=e;return!0}return!1};lime.Renderer.DOM.CIRCLE.draw=function(t){var e=this.getSize();lime.Renderer.DOM.SPRITE.draw.call(this,t);lime.style.setBorderRadius(t,.5*e.width,.5*e.height)};lime.Circle.prototype.makeCanvasPath_=function(t,e,o){var i=this.getAnchorPoint();t.save();t.scale(e,o);t.translate(1-2*i.x,1-2*i.y);t.beginPath();t.arc(0,0,1,0,2*Math.PI,!1);t.closePath();t.restore()};lime.Renderer.CANVAS.CIRCLE.draw=function(t){var e=this.getFill(),o=this.getStroke(),i=this.getFrame(),n=.5*(i.right-i.left),r=.5*(i.bottom-i.top);if(null!==e){this.makeCanvasPath_(t,n,r);e.setCanvasStyle(t,this);e instanceof lime.fill.Image||t.fill()}if(null!==o){this.makeCanvasPath_(t,n-o.width_/2,r-o.width_/2);o.setCanvasStyle(t,this);t.stroke()}};goog.provide("lime.Layer");goog.require("lime");goog.require("lime.Node");lime.Layer=function(){lime.Node.call(this);this.domClassName=goog.getCssName("lime-layer")};goog.inherits(lime.Layer,lime.Node);lime.Layer.prototype.hitTest=function(t){if(this.hidden_)return!1;for(var e,o=0;e=this.children_[o];o++)if(e.hitTest(t)){t.position=this.screenToLocal(t.screenPosition);return!0}return!1};goog.provide("goog.fx.easing");goog.fx.easing.easeIn=function(t){return t*t*t};goog.fx.easing.easeOut=function(t){return 1-Math.pow(1-t,3)};goog.fx.easing.inAndOut=function(t){return 3*t*t-2*t*t*t};goog.provide("lime.scheduleManager");goog.require("goog.array");goog.require("goog.userAgent");goog.require("lime");lime.scheduleManager=new function(){this.taskStack_=[];this.active_=!1;this.started_=!1;this.intervalID_=0;this.displayRate_=1e3/30;this.lastRunTime_=0};lime.scheduleManager.Callback=function(t,e,o){this.f=t;this.ctx=e;this.paused=!1;this.delta=o};lime.scheduleManager.Task=function(t,e){this.maxdelta=t;this.limit=goog.isDef(e)?e:-1;this.functionStack_=[]};lime.scheduleManager.Task.prototype.step_=function(t){if(this.functionStack_.length)for(var e,o=this.functionStack_.length;--o>=0;){e=this.functionStack_[o];if(e&&!e.paused&&goog.isFunction(e.f))if(e.delta>t)e.delta-=t;else{var i=this.maxdelta+t-e.delta;e.delta=this.maxdelta-(t-e.delta);e.delta<0&&(e.delta=0);e.f.call(e.ctx,i);if(-1!==this.limit){this.limit--;0==this.limit&&lime.scheduleManager.unschedule(e.f,e.ctx)}}}};lime.scheduleManager.taskStack_.push(new lime.scheduleManager.Task(0));!function(){for(var t=["webkit","moz"],e=0;e<t.length&&!goog.global.requestAnimationFrame;++e){goog.global.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"];goog.global.cancelAnimationFrame=goog.global[t[e]+"CancelAnimationFrame"]||goog.global[t[e]+"CancelRequestAnimationFrame"]}}();lime.scheduleManager.USE_ANIMATION_FRAME=!!goog.global.requestAnimationFrame;lime.scheduleManager.getDisplayRate=function(){return this.displayRate_};lime.scheduleManager.setDisplayRate=function(t){this.displayRate_=t;if(this.active_){lime.scheduleManager.disable_();lime.scheduleManager.activate_()}};lime.scheduleManager.schedule=function(t,e,o){var i=goog.isDef(o)?o:this.taskStack_[0];goog.array.insert(i.functionStack_,new this.Callback(t,e,i.maxdelta));goog.array.insert(this.taskStack_,i);this.active_||lime.scheduleManager.activate_()};lime.scheduleManager.unschedule=function(t,e){for(var o=this.taskStack_.length;--o>=0;){for(var i,n=this.taskStack_[o],r=n.functionStack_,s=r.length;--s>=0;){i=r[s];i.f==t&&i.ctx==e&&goog.array.remove(r,i)}0==r.length&&0!=o&&goog.array.remove(this.taskStack_,n)}1==this.taskStack_.length&&0==this.taskStack_[0].functionStack_.length&&lime.scheduleManager.disable_()};lime.scheduleManager.activate_=function(){if(!this.active_){this.started_?this.activate__():setTimeout(goog.bind(this.activate__,this),0);this.started_=!0;this.active_=!0}};lime.scheduleManager.activate__=function(){this.lastRunTime_=this.now();if(lime.scheduleManager.USE_ANIMATION_FRAME&&goog.global.requestAnimationFrame)if(goog.global.mozRequestAnimationFrame&&goog.userAgent.VERSION<11){goog.global.mozRequestAnimationFrame();this.beforePaintHandlerBinded_=goog.bind(lime.scheduleManager.beforePaintHandler_,this);goog.global.addEventListener("MozBeforePaint",this.beforePaintHandlerBinded_,!1)}else{this.animationFrameHandlerBinded_=goog.bind(lime.scheduleManager.animationFrameHandler_,this);goog.global.requestAnimationFrame(this.animationFrameHandlerBinded_)}else this.intervalID_=setInterval(goog.bind(lime.scheduleManager.stepTimer_,this),lime.scheduleManager.getDisplayRate())};!function(){var t=goog.global.performance,e=t&&(t.now||t.webkitNow);lime.scheduleManager.now=function(){return e?e.call(t):goog.now()}}();lime.scheduleManager.disable_=function(){if(this.active_){lime.scheduleManager.USE_ANIMATION_FRAME&&goog.global.requestAnimationFrame?goog.global.mozRequestAnimationFrame&&goog.userAgent.VERSION<11?goog.global.removeEventListener("MozBeforePaint",this.beforePaintHandlerBinded_,!1):goog.global.cancelAnimationFrame(this.animationFrameHandlerBinded_):clearInterval(this.intervalID_);this.active_=!1}};var frameTime=31.25;lime.scheduleManager.setFrameTime=function(t){frameTime=t};lime.scheduleManager.getFrameTime=function(){return frameTime};lime.scheduleManager.animationFrameHandler_=function(){time=this.now();var t=time-this.lastRunTime_;0>t&&(t=1);if(t>=frameTime){lime.scheduleManager.dispatch_(frameTime);this.lastRunTime_+=t-t%frameTime}goog.global.requestAnimationFrame(this.animationFrameHandlerBinded_)};lime.scheduleManager.beforePaintHandler_=function(t){var e=t.timeStamp-this.lastRunTime_;if(e>=frameTime){lime.scheduleManager.dispatch_(frameTime);this.lastRunTime_+=frameTime}goog.global.mozRequestAnimationFrame()};lime.scheduleManager.stepTimer_=function(){var t=this.now(),e=t-this.lastRunTime_;0>e&&(e=1);if(e>=frameTime){lime.scheduleManager.dispatch_(frameTime);this.lastRunTime_+=frameTime}};lime.scheduleManager.dispatch_=function(t){for(var e=this.taskStack_.slice(),o=e.length;--o>=0;)e[o].step_(t);if(1==lime.transformSet_&&/Firefox\/18./.test(goog.userAgent.getUserAgentString())&&!lime.FF4_USE_HW_ACCELERATION){if(lime.scheduleManager.odd_){document.body.style.MozTransform="";lime.scheduleManager.odd_=0}else{document.body.style.MozTransform="scale(1,1)";lime.scheduleManager.odd_=1}lime.transformSet_=0}};lime.scheduleManager.changeDirectorActivity=function(t,e){for(var o,i,n,r,s,a=this.taskStack_.length;--a>=0;){o=this.taskStack_[a];s=o.functionStack_.length;for(;--s>=0;){n=o.functionStack_[s];i=n.ctx;if(goog.isFunction(i.getDirector)){r=i.getDirector();r==t&&(n.paused=!!e)}}}};lime.scheduleManager.callAfter=function(t,e,o){lime.scheduleManager.scheduleWithDelay(t,e,o,1)};lime.scheduleManager.scheduleWithDelay=function(t,e,o,i){var n=new lime.scheduleManager.Task(o,i);lime.scheduleManager.schedule(t,e,n)};goog.provide("lime.animation.Animation");goog.provide("lime.animation.Easing");goog.provide("lime.animation.actionManager");goog.provide("lime.animation.Event");goog.require("goog.array");goog.require("goog.events.EventTarget");goog.require("goog.fx.easing");goog.require("lime.scheduleManager");lime.animation.Animation=function(){goog.events.EventTarget.call(this);this.targets=[];this.initTargets_=[];this.targetProp_={};this.duration_=1;this.ease=lime.animation.Easing.EASEINOUT;this.status_=0};goog.inherits(lime.animation.Animation,goog.events.EventTarget);lime.animation.Animation.prototype.scope="";lime.animation.EasingFunction;lime.animation.Event={START:"start",STOP:"stop"};lime.animation.Animation.prototype.getDuration=function(){return this.duration_};lime.animation.Animation.prototype.setDuration=function(t){this.duration_=t;return this};lime.animation.Animation.prototype.setEasing=function(t){this.ease=t;return this};lime.animation.Animation.prototype.getEasing=function(){return this.ease};lime.animation.Animation.prototype.addTarget=function(t){goog.array.insert(this.targets,t);return this};lime.animation.Animation.prototype.removeTarget=function(t){goog.array.remove(this.targets,t);goog.array.remove(this.initTargets_,t);return this};lime.animation.Animation.prototype.play=function(){this.playTime_=0;this.status_=1;this.firstFrame_=1;lime.scheduleManager.schedule(this.step_,this);this.dispatchEvent({type:lime.animation.Event.START})};lime.animation.Animation.prototype.setStatus=function(t){this.status_=t};lime.animation.Animation.prototype.stop=function(){if(0!=this.status_){var t=this.initTargets_;if(this.useTransitions()&&this.clearTransition)for(var e=t.length;--e>=0;)this.clearTransition(t[e]);this.initTargets_=[];this.targetProp_={};this.status_=0;lime.scheduleManager.unschedule(this.step_,this);this.dispatchEvent({type:lime.animation.Event.STOP})}};lime.animation.Animation.prototype.makeTargetProp=function(){return{}};lime.animation.Animation.prototype.getTargetProp=function(t){var e=goog.getUid(t);if(!goog.isDef(this.targetProp_[e])){this.initTarget(t);this.targetProp_[e]=this.makeTargetProp(t)}return this.targetProp_[e]};lime.animation.Animation.prototype.initTarget=function(t){lime.animation.actionManager.register(this,t);this.status_=1;goog.array.insert(this.initTargets_,t);this.speed_&&!this.speedCalcDone_&&this.calcDurationFromSpeed_&&this.calcDurationFromSpeed_()};lime.animation.Animation.prototype.getDirector=function(){return this.targets[0]?this.targets[0].getDirector():null};lime.animation.Animation.prototype.step_=function(t){this.speed_&&!this.speedCalcDone_&&this.calcDurationFromSpeed_&&this.calcDurationFromSpeed_();if(this.firstFrame_){delete this.firstFrame_;t=1}this.playTime_+=t;this.dt_=t;var e=this.playTime_/(1e3*this.duration_);(isNaN(e)||e>=1)&&(e=1);e=this.updateAll(e,this.targets);1==e&&this.stop()};lime.animation.Animation.prototype.updateAll=function(t,e){t=this.getEasing()[0](t);isNaN(t)&&(t=1);for(var o=e.length;--o>=0;)this.update(t,e[o]);return t};lime.animation.Animation.prototype.useTransitions=function(){return lime.userAgent.IOS&&this.duration_>0&&lime.style.isTransitionsSupported&&this.optimizations_};lime.animation.Animation.prototype.enableOptimizations=function(t){var e=goog.isDef(t)?t:!0;this.optimizations_=e;return this};lime.animation.Animation.prototype.update=goog.abstractMethod;lime.animation.Animation.prototype.cloneParam=function(t){return this.setDuration(t.getDuration()).enableOptimizations(t.optimizations_)};lime.animation.Animation.prototype.reverse=function(){throw"Reverseform not supported for this animation"};lime.animation.actionManager=new function(){this.actions={}};lime.animation.actionManager.register=function(t,e){if(t.scope.length){var o=goog.getUid(e);goog.isDef(this.actions[o])||(this.actions[o]={});goog.isDef(this.actions[o][t.scope])&&this.actions[o][t.scope].stop();this.actions[o][t.scope]=t}};lime.animation.actionManager.stopAll=function(t){var e=goog.getUid(t);if(goog.isDef(this.actions[e])){for(var o in this.actions[e]){this.actions[e][o].stop();delete this.actions[e][o]
}delete this.actions[e]}};!function(){function t(t){return((l*t+g)*t+m)*t}function e(t){return((c*t+u)*t+h)*t}function o(t){return(3*l*t+2*g)*t+m}function i(t){return 1/(200*t)}function n(t,o){return e(s(t,o))}function r(t){return t>=0?t:0-t}function s(e,i){var n,s,a,l,g,m;for(a=e,m=0;8>m;m++){l=t(a)-e;if(r(l)<i)return a;g=o(a);if(r(g)<1e-6)break;a-=l/g}n=0;s=1;a=e;if(n>a)return n;if(a>s)return s;for(;s>n;){l=t(a);if(r(l-e)<i)return a;e>l?n=a:s=a;a=.5*(s-n)+n}return a}function a(t,e,o,r,s,a){m=3*e;g=3*(r-e)-m;l=1-m-g;h=3*o;u=3*(s-o)-h;c=1-h-u;return n(t,i(a))}var l=0,g=0,m=0,c=0,u=0,h=0;lime.animation.getEasingFunction=function(t,e,o,i){return[function(n){return a(n,t,e,o,i,100)},t,e,o,i]}}();lime.animation.Easing={EASE:lime.animation.getEasingFunction(.25,.1,.25,1),LINEAR:[function(t){return t},0,0,1,1],EASEIN:lime.animation.getEasingFunction(.42,0,1,1),EASEOUT:lime.animation.getEasingFunction(0,0,.58,1),EASEINOUT:lime.animation.getEasingFunction(.42,0,.58,1)};goog.provide("lime.animation.MoveTo");goog.require("goog.math.Coordinate");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.MoveTo=function(t){lime.animation.Animation.call(this);this.position_=2==arguments.length?new goog.math.Coordinate(arguments[0],arguments[1]):t};goog.inherits(lime.animation.MoveTo,lime.animation.Animation);lime.animation.MoveTo.prototype.scope="move";lime.animation.MoveTo.prototype.setSpeed=function(t){this.speed_=t;delete this.speedCalcDone_;return this};lime.animation.MoveTo.prototype.makeTargetProp=function(t){if(window.isLime)var e=t.getPosition();else var e=t.getPosition().clone();var o=new goog.math.Coordinate(this.position_.x-e.x,this.position_.y-e.y);if(this.useTransitions()){t.addTransition(lime.Transition.POSITION,this.position_,this.duration_,this.getEasing());t.setDirty(lime.Dirty.POSITION)}return{startpos:e,delta:o}};lime.animation.MoveTo.prototype.calcDurationFromSpeed_=function(){if(this.speed_&&this.targets.length){var t=this.targets[0].getPosition(),e=new goog.math.Coordinate(this.position_.x-t.x,this.position_.y-t.y);this.setDuration(this.speed_*goog.math.Coordinate.distance(e,new goog.math.Coordinate(0,0))/100);this.speedCalcDone_=1}};lime.animation.MoveTo.prototype.update=function(t,e){if(0!=this.status_){var o=this.getTargetProp(e),i=e.qyobj||e;i.setPosition(o.startpos.x+o.delta.x*t,o.startpos.y+o.delta.y*t,!0)}};lime.animation.MoveTo.prototype.clearTransition=function(t){if(this.useTransitions()){t.clearTransition(lime.Transition.POSITION);t.setDirty(lime.Dirty.POSITION)}};goog.provide("lime.animation.Delay");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.Delay=function(){lime.animation.Animation.call(this)};goog.inherits(lime.animation.Delay,lime.animation.Animation);lime.animation.Delay.prototype.update=goog.nullFunction;lime.animation.Delay.prototype.reverse=function(){return(new lime.animation.Delay).setDuration(this.getDuration())};goog.provide("lime.animation.Sequence");goog.require("goog.math.Coordinate");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.Sequence=function(t){lime.animation.Animation.call(this);var e=goog.array.toArray(arguments);goog.isArray(t)&&(e=t);if(e.length>2){var o=e.shift();this.actions=[o,new lime.animation.Sequence(e)]}else this.actions=e;this.setDuration(this.actions[0].duration_+this.actions[1].duration_)};goog.inherits(lime.animation.Sequence,lime.animation.Animation);lime.animation.Sequence.prototype.initTarget=function(t){lime.animation.Animation.prototype.initTarget.call(this,t);this.setDuration(this.actions[0].duration_+this.actions[1].duration_);this.split_=this.actions[0].duration_/this.duration_;this.last_=-1};lime.animation.Sequence.prototype.stop=function(){this.last_&&-1!=this.last_&&this.actions[this.last_].stop(this.targets);lime.animation.Animation.prototype.stop.apply(this,arguments)};lime.animation.Sequence.prototype.updateAll=function(t,e){if(0==this.status_)return t;for(var o=e.length;--o>=0;)this.getTargetProp(e[o]);var i=0,n=0;if(t>=this.split_){i=1;n=1==this.split_?1:(t-this.split_)/(1-this.split_)}else{i=0;n=0!=this.split_?t/this.split_:1}if(-1==this.last_&&1==i){this.actions[0].status_=1;this.actions[0].updateAll(1,e);this.actions[0].stop()}if(this.last_!=i){if(-1!=this.last_&&this.actions[this.last_]){this.actions[this.last_].updateAll(1,e);this.actions[this.last_].stop()}this.actions[i].setStatus(1)}this.actions[i].updateAll(n,e);this.last_=i;return t};lime.animation.Sequence.prototype.reverse=function(){return new lime.animation.Sequence(this.actions[1].reverse(),this.actions[0].reverse())};goog.provide("lime.animation.Spawn");goog.require("lime.animation.Animation");goog.require("lime.animation.Delay");goog.require("lime.animation.Sequence");lime.animation.Spawn=function(t){lime.animation.Animation.call(this);var e=goog.array.toArray(arguments);goog.isArray(t)&&(e=t);if(e.length>2){this.one=e.shift();this.two=new lime.animation.Spawn(e)}else{this.one=e[0];this.two=e[1]}var o=this.one.duration_,i=this.two.duration_;this.setDuration(Math.max(o,i));var n=new lime.animation.Delay;o>i?this.two=new lime.animation.Sequence(this.two,n.setDuration(o-i)):i>o&&(this.one=new lime.animation.Sequence(this.one,n.setDuration(i-o)))};goog.inherits(lime.animation.Spawn,lime.animation.Animation);lime.animation.Spawn.prototype.initTarget=function(t){lime.animation.Animation.prototype.initTarget.call(this,t);this.one.status_=1;this.two.status_=1};lime.animation.Spawn.prototype.updateAll=function(t,e){if(0==this.status_)return void 0;for(var o=e.length;--o>=0;)this.getTargetProp(e[o]);this.one.updateAll(t,e);this.two.updateAll(t,e);return t};lime.animation.Spawn.prototype.setStatus=function(t){this.status_=t;this.one.setStatus(t);this.two.setStatus(t)};lime.animation.Spawn.prototype.stop=function(){lime.animation.Animation.prototype.stop.apply(this,arguments);this.one&&this.one.stop();this.two&&this.two.stop()};lime.animation.Spawn.prototype.reverse=function(){return new lime.animation.Spawn(this.one.reverse(),this.two.reverse())};goog.provide("lime.animation.Loop");goog.require("goog.math.Coordinate");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.Loop=function(t){lime.animation.Animation.call(this);this.action_=t;goog.events.listen(t,lime.animation.Event.STOP,this.handleActionEnd_,!1,this);this.setLimit(0);this.timesRun_=0;this.setDuration(t.duration_)};goog.inherits(lime.animation.Loop,lime.animation.Animation);lime.animation.Loop.prototype.initTarget=function(t){lime.animation.Animation.prototype.initTarget.call(this,t);this.setDuration(this.action_.duration_)};lime.animation.Loop.prototype.getLimit=function(){return this.limit_};lime.animation.Loop.prototype.setLimit=function(t){this.limit_=t;this.timesRun_=0;return this};lime.animation.Loop.prototype.play=function(){this.action_.play();this.status_=1;this.dispatchEvent({type:lime.animation.Event.START})};lime.animation.Loop.prototype.stop=function(){if(1==this.status_){this.status_=0;this.action_.stop();this.dispatchEvent({type:lime.animation.Event.STOP})}};lime.animation.Loop.prototype.handleActionEnd_=function(){this.timesRun_++;1==this.status_&&(!this.limit_||this.timesRun_<this.limit_)?this.action_.play():this.stop()};lime.animation.Loop.prototype.addTarget=function(t){this.action_.addTarget(t);return this};lime.animation.Loop.prototype.removeTarget=function(t){this.action_.removeTarget(t);return this};goog.provide("lime.animation.MoveBy");goog.require("goog.math.Coordinate");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.MoveBy=function(t){lime.animation.Animation.call(this);this.delta_=2==arguments.length?new goog.math.Coordinate(arguments[0],arguments[1]):t};goog.inherits(lime.animation.MoveBy,lime.animation.Animation);lime.animation.MoveBy.prototype.scope="move";lime.animation.MoveBy.prototype.setSpeed=function(t){this.speed_=t;this.calcDurationFromSpeed_();return this};lime.animation.MoveBy.prototype.makeTargetProp=function(t){if(this.useTransitions()){t.addTransition(lime.Transition.POSITION,goog.math.Coordinate.sum(t.getPosition(),this.delta_),this.duration_,this.getEasing());t.setDirty(lime.Dirty.POSITION)}return{startpos:t.getPosition()}};lime.animation.MoveBy.prototype.calcDurationFromSpeed_=function(){if(this.speed_){this.setDuration(this.speed_*goog.math.Coordinate.distance(this.delta_,new goog.math.Coordinate(0,0))/100);this.speedCalcDone_=1}};lime.animation.MoveBy.prototype.update=function(t,e){if(0!=this.status_){var o=this.getTargetProp(e),i=e.qyobj||e;i.setPosition(o.startpos.x+this.delta_.x*t,o.startpos.y+this.delta_.y*t,!0)}};lime.animation.MoveBy.prototype.clearTransition=function(t){if(this.useTransitions()){t.clearTransition(lime.Transition.POSITION);t.setDirty(lime.Dirty.POSITION)}};lime.animation.MoveBy.prototype.reverse=function(){var t=this.delta_.clone();t.x*=-1;t.y*=-1;return new lime.animation.MoveBy(t).cloneParam(this)};goog.provide("lime.animation.RotateTo");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.RotateTo=function(t){lime.animation.Animation.call(this);this.angle_=t};goog.inherits(lime.animation.RotateTo,lime.animation.Animation);lime.animation.RotateTo.prototype.scope="rotate";lime.animation.RotateTo.prototype.makeTargetProp=function(t){var e=t.getRotation();if(this.useTransitions()){t.addTransition(lime.Transition.ROTATION,this.angle_,this.duration_,this.getEasing());t.setDirty(lime.Dirty.POSITION)}return{startRot:e,delta:this.angle_-e}};lime.animation.RotateTo.prototype.update=function(t,e){if(0!=this.status_){var o=this.getTargetProp(e),i=e.qyobj||e;i.setRotation(o.startRot+o.delta*t)}};lime.animation.RotateTo.prototype.clearTransition=function(t){if(this.useTransitions()){t.clearTransition(lime.Transition.ROTATION);t.setDirty(lime.Dirty.POSITION)}};goog.provide("lime.animation.ColorTo");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.ColorTo=function(){lime.animation.Animation.call(this);this.rgb_=null;this.target_=lime.animation.ColorTo.Target.FILL;var t=lime.fill.parse(goog.array.toArray(arguments));t instanceof lime.fill.Color&&(this.rgba_=t.getRgba())};goog.inherits(lime.animation.ColorTo,lime.animation.Animation);lime.animation.ColorTo.prototype.scope="color";lime.animation.ColorTo.Target={FILL:"fill",STROKE:"stroke",FONT:"font"};lime.animation.ColorTo.prototype.setTargetComponent=function(t){this.target_=t;return this};lime.animation.ColorTo.prototype.getTargetComponent=function(){return this.target_};lime.animation.ColorTo.prototype.makeTargetProp=function(t){var e,o;switch(this.target_){case lime.animation.ColorTo.Target.FILL:e=t.getFill(),o=e instanceof lime.fill.Color?e.getRgba():[255,255,255,0];break;case lime.animation.ColorTo.Target.STROKE:e=t.getStroke().getColor();o=e instanceof lime.fill.Color?e.getRgba():[255,255,255,0];break;case lime.animation.ColorTo.Target.FONT:o=goog.color.hexToRgb(t.getFontColor())}return{start:o,delta:[this.rgba_[0]-o[0],this.rgba_[1]-o[1],this.rgba_[2]-o[2],this.rgba_[3]-o[3]]}};lime.animation.ColorTo.prototype.update=function(t,e){if(0!=this.status_){var o,i=this.getTargetProp(e),n=Math.round(i.start[0]+i.delta[0]*t),r=Math.round(i.start[1]+i.delta[1]*t),s=Math.round(i.start[2]+i.delta[2]*t);if("start"in i)switch(this.target_){case lime.animation.ColorTo.Target.FILL:o=i.start[3]+i.delta[3]*t;e.setFill(n,r,s,o);break;case lime.animation.ColorTo.Target.STROKE:o=i.start[3]+i.delta[3]*t;e.setStroke(e.getStroke().setColor(n,r,s,o));break;case lime.animation.ColorTo.Target.FONT:e.setFontColor(goog.color.rgbToHex(n,r,s))}}};goog.provide("lime.animation.FadeTo");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.FadeTo=function(t){lime.animation.Animation.call(this);this.opacity_=t};goog.inherits(lime.animation.FadeTo,lime.animation.Animation);lime.animation.FadeTo.prototype.scope="fade";lime.animation.FadeTo.prototype.makeTargetProp=function(t){var e=t.getOpacity();if(this.useTransitions()){t.addTransition(lime.Transition.OPACITY,this.opacity_,this.duration_,this.getEasing());t.setDirty(lime.Dirty.ALPHA)}return{startOpacity:e,delta:this.opacity_-e}};lime.animation.FadeTo.prototype.update=function(t,e){if(0!=this.status_){var o=this.getTargetProp(e);e.setOpacity(o.startOpacity+o.delta*t)}};lime.animation.FadeTo.prototype.clearTransition=function(t){if(this.useTransitions()){t.clearTransition(lime.Transition.OPACITY);t.setDirty(lime.Dirty.ALPHA)}};goog.provide("lime.transitions.Transition");lime.transitions.Transition=function(t,e){goog.events.EventTarget.call(this);this.duration_=1;this.outgoing_=t;this.incoming_=e;this.finished_=!1};goog.inherits(lime.transitions.Transition,goog.events.EventTarget);lime.transitions.Transition.prototype.getDuration=function(){return this.duration_};lime.transitions.Transition.prototype.setDuration=function(t){this.duration_=t;return this};lime.transitions.Transition.prototype.setFinishCallback=function(){goog.DEBUG&&console&&console.warn&&console.warn("Transition.prototype.setFinishCallback() is deprecated. Use event listeners.");return this};lime.transitions.Transition.prototype.start=function(){this.incoming_.setPosition(new goog.math.Coordinate(0,0));this.incoming_.setHidden(!1);this.finish()};lime.transitions.Transition.prototype.finish=function(){this.dispatchEvent(new goog.events.Event("end"));this.finished_=!0};goog.provide("lime.transitions.Dissolve");goog.require("lime.animation.FadeTo");goog.require("lime.transitions.Transition");lime.transitions.Dissolve=function(t,e){lime.transitions.Transition.call(this,t,e)};goog.inherits(lime.transitions.Dissolve,lime.transitions.Transition);lime.transitions.Dissolve.prototype.start=function(){this.incoming_.setOpacity(0);this.incoming_.setHidden(!1);var t=new lime.animation.FadeTo(0).setDuration(this.getDuration()).enableOptimizations();goog.events.listen(t,lime.animation.Event.STOP,function(){this.outgoing_&&this.outgoing_.setOpacity(1)},!1,this);this.outgoing_&&this.outgoing_.runAction(t);var e=new lime.animation.FadeTo(1).setDuration(this.getDuration());this.incoming_.runAction(e);goog.events.listen(e,lime.animation.Event.STOP,this.finish,!1,this)};goog.provide("lime.animation.ScaleTo");goog.require("goog.math.Vec2");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.ScaleTo=function(t){lime.animation.Animation.call(this);this.scale_=1==arguments.length&&goog.isNumber(t)?new goog.math.Vec2(t,t):2==arguments.length?new goog.math.Vec2(arguments[0],arguments[1]):t};goog.inherits(lime.animation.ScaleTo,lime.animation.Animation);lime.animation.ScaleTo.prototype.scope="scale";lime.animation.ScaleTo.prototype.makeTargetProp=function(t){var e=t.getScale(),o=new goog.math.Vec2(this.scale_.x-e.x,this.scale_.y-e.y);null==window.isLime||window.isLime||(e=e.clone());if(this.useTransitions()){t.addTransition(lime.Transition.SCALE,new goog.math.Vec2(e.x+o.x,e.y+o.y),this.duration_,this.getEasing());t.setDirty(lime.Dirty.SCALE)}return{startScale:e,delta:o}};lime.animation.ScaleTo.prototype.update=function(t,e){if(0!=this.status_){var o=this.getTargetProp(e),i=e.qyobj||e;i.setScale(o.startScale.x+o.delta.x*t,o.startScale.y+o.delta.y*t)}};lime.animation.ScaleTo.prototype.clearTransition=function(t){if(this.useTransitions()){t.clearTransition(lime.Transition.SCALE);t.setDirty(lime.Dirty.SCALE)}};goog.provide("lime.animation.KeyframeAnimation");goog.require("goog.events");goog.require("lime.Sprite");goog.require("lime.animation.Animation");lime.animation.KeyframeAnimation=function(){lime.animation.Animation.call(this);this.frames_=[];this.numFramesLoaded_=0;this.usesBackgroundCanvas_=!1;this.currentFrame_=-1;this.delay=1/15;this.looping=!0};goog.inherits(lime.animation.KeyframeAnimation,lime.animation.Animation);lime.animation.KeyframeAnimation.prototype.scope="keyframe";lime.animation.KeyframeAnimation.prototype.getDelay=function(){return this.delay};lime.animation.KeyframeAnimation.prototype.setDelay=function(t){this.delay=t;return this};lime.animation.KeyframeAnimation.prototype.setFrames=function(t){this.frames_=[];this.numFramesLoaded_=0;this.currentFrame_=-1;for(var e=0;e<t.length;e++)this.addFrame(lime.fill.parse([t[e]]));return this};lime.animation.KeyframeAnimation.prototype.setLooping=function(t){this.looping=t;return this};lime.animation.KeyframeAnimation.prototype.addFrame=function(t){this.framesLoaded_=!1;var e=lime.fill.parse(goog.array.toArray(arguments));"image"!=e.id||e.isLoaded()?"frame"!=e.id||t.isProcessed()?this.numFramesLoaded_++:goog.events.listen(e,"processed",this.frameLoadedHandler_,!1,this):goog.events.listen(e,goog.events.EventType.LOAD,this.frameLoadedHandler_,!1,this);this.frames_.push(e);return this};lime.animation.KeyframeAnimation.prototype.frameLoadedHandler_=function(){this.numFramesLoaded_++};lime.animation.KeyframeAnimation.prototype.play=function(){this.lastChangeTime_=0;lime.animation.Animation.prototype.play.call(this)};lime.animation.KeyframeAnimation.prototype.updateAll=function(t,e){for(var o=this.dt_,i=Math.round(1e3*this.delay),n=null,r=e.length,s=this.looping,a=!1;--r>=0;)this.getTargetProp(e[r]);this.lastChangeTime_+=o;var l=this.currentFrame_+1;if(this.lastChangeTime_>i){if(l<this.frames_.length)a=!0;else if(s){a=!0;l=0}if(a){n=this.frames_[l];r=e.length;if(r>0)for(;--r>=0;)this.targets[r].setFill(n);this.currentFrame_=l;this.lastChangeTime_%=i}}return s?0:l/this.frames_.length};goog.provide("lime.Renderer.CANVAS.ROUNDEDRECT");goog.provide("lime.Renderer.DOM.ROUNDEDRECT");goog.provide("lime.RoundedRect");goog.require("lime.Renderer.CANVAS.SPRITE");goog.require("lime.Renderer.DOM.SPRITE");goog.require("lime.Sprite");goog.require("lime.style");lime.RoundedRect=function(){lime.Sprite.call(this);this.setRadius(5)};goog.inherits(lime.RoundedRect,lime.Sprite);lime.RoundedRect.prototype.id="roundedrect";lime.RoundedRect.prototype.supportedRenderers=[lime.Renderer.DOM.SPRITE.makeSubRenderer(lime.Renderer.DOM.ROUNDEDRECT),lime.Renderer.CANVAS.SPRITE.makeSubRenderer(lime.Renderer.CANVAS.ROUNDEDRECT)];lime.RoundedRect.prototype.getRadius=function(){return this.radius_};lime.RoundedRect.prototype.getUnitPercentage=function(){return this.unitPercentage_};lime.RoundedRect.prototype.setRadius=function(t,e){this.unitPercentage_=e||!1;this.radius_=t;return this};lime.Renderer.DOM.ROUNDEDRECT.draw=function(t){lime.Renderer.DOM.SPRITE.draw.call(this,t);lime.style.setBorderRadius(t,[this.radius_,this.radius_])};lime.RoundedRect.prototype.makeCanvasPath_=function(t,e,o,i,n,r){t.save();t.beginPath();if(i==n&&2*r==i)t.arc(e+r,o+r,r,0,2*Math.PI);else{t.moveTo(e+r,o);t.lineTo(e+i-r,o);t.quadraticCurveTo(e+i,o,e+i,o+r);t.lineTo(e+i,o+n-r);t.quadraticCurveTo(e+i,o+n,e+i-r,o+n);t.lineTo(e+r,o+n);t.quadraticCurveTo(e,o+n,e,o+n-r);t.lineTo(e,o+r);t.quadraticCurveTo(e,o,e+r,o)}t.closePath();t.restore()};lime.Renderer.CANVAS.ROUNDEDRECT.draw=function(t){var e=this.getRadius();if(e){var o=this.getFill(),i=this.getStroke(),n=this.getFrame(),r=n.left,s=n.top,a=n.right-n.left,l=n.bottom-n.top;e=Math.min(a/2,l/2,e);if(null!==o){this.makeCanvasPath_(t,r,s,a,l,e);o.setCanvasStyle(t,this);o instanceof lime.fill.Image||t.fill()}if(null!==i){this.makeCanvasPath_(t,r+i.width_/2,s+i.width_/2,a-i.width_,l-i.width_,e-i.width_/2);i.setCanvasStyle(t,this);t.stroke()}}else lime.Renderer.CANVAS.SPRITE.draw.call(this,t)};goog.provide("goog.cssom");goog.provide("goog.cssom.CssRuleType");goog.require("goog.array");goog.require("goog.dom");goog.cssom.CssRuleType={STYLE:1,IMPORT:3,MEDIA:4,FONT_FACE:5,PAGE:6,NAMESPACE:7};goog.cssom.getAllCssText=function(t){var e=t||document.styleSheets;return goog.cssom.getAllCss_(e,!0)};goog.cssom.getAllCssStyleRules=function(t){var e=t||document.styleSheets;return goog.cssom.getAllCss_(e,!1)};goog.cssom.getCssRulesFromStyleSheet=function(t){var e=null;try{e=t.rules||t.cssRules}catch(o){if(15==o.code){o.styleSheet=t;throw o}}return e};goog.cssom.getAllCssStyleSheets=function(t,e){var o=[],i=t||document.styleSheets,n=goog.isDef(e)?e:!1;if(i.imports&&i.imports.length)for(var r=0,s=i.imports.length;s>r;r++)goog.array.extend(o,goog.cssom.getAllCssStyleSheets(i.imports[r]));else if(i.length)for(var r=0,s=i.length;s>r;r++)goog.array.extend(o,goog.cssom.getAllCssStyleSheets(i[r]));else{var a=goog.cssom.getCssRulesFromStyleSheet(i);if(a&&a.length)for(var l,r=0,s=a.length;s>r;r++){l=a[r];l.styleSheet&&goog.array.extend(o,goog.cssom.getAllCssStyleSheets(l.styleSheet))}}!(i.type||i.rules||i.cssRules)||i.disabled&&!n||o.push(i);return o};goog.cssom.getCssTextFromCssRule=function(t){var e="";if(t.cssText)e=t.cssText;else if(t.style&&t.style.cssText&&t.selectorText){var o=t.style.cssText.replace(/\s*-closure-parent-stylesheet:\s*\[object\];?\s*/gi,"").replace(/\s*-closure-rule-index:\s*[\d]+;?\s*/gi,""),i=t.selectorText+" { "+o+" }";e=i}return e};goog.cssom.getCssRuleIndexInParentStyleSheet=function(t,e){if(t.style&&t.style["-closure-rule-index"])return t.style["-closure-rule-index"];var o=e||goog.cssom.getParentStyleSheet(t);if(!o)throw Error("Cannot find a parentStyleSheet.");var i=goog.cssom.getCssRulesFromStyleSheet(o);if(i&&i.length)for(var n,r=0,s=i.length;s>r;r++){n=i[r];if(n==t)return r}return-1};goog.cssom.getParentStyleSheet=function(t){return t.parentStyleSheet||t.style&&t.style["-closure-parent-stylesheet"]};goog.cssom.replaceCssRule=function(t,e,o,i){var n=o||goog.cssom.getParentStyleSheet(t);if(!n)throw Error("Cannot proceed without the parentStyleSheet.");var r=i>=0?i:goog.cssom.getCssRuleIndexInParentStyleSheet(t,n);if(!(r>=0))throw Error("Cannot proceed without the index of the cssRule.");goog.cssom.removeCssRule(n,r);goog.cssom.addCssRule(n,e,r)};goog.cssom.addCssRule=function(t,e,o){var i=o;if(0>i||void 0==i){var n=t.cssRules||t.rules;i=n.length}if(t.insertRule)t.insertRule(e,i);else{var r=/^([^\{]+)\{([^\{]+)\}/.exec(e);if(3!=r.length)throw Error("Your CSSRule appears to be ill-formatted.");var s=r[1],a=r[2];t.addRule(s,a,i)}};goog.cssom.removeCssRule=function(t,e){t.deleteRule?t.deleteRule(e):t.removeRule(e)};goog.cssom.addCssText=function(t,e){var o=e?e.getDocument():goog.dom.getDocument(),i=o.createElement("style");i.type="text/css";var n=o.getElementsByTagName("head")[0];n.appendChild(i);if(i.styleSheet)i.styleSheet.cssText=t;else{var r=o.createTextNode(t);i.appendChild(r)}return i};goog.cssom.getFileNameFromStyleSheet=function(t){var e=t.href;if(!e)return null;var o=/([^\/\?]+)[^\/]*$/.exec(e),i=o[1];return i};goog.cssom.getAllCss_=function(t,e){for(var o=[],i=goog.cssom.getAllCssStyleSheets(t),n=0;t=i[n];n++){var r=goog.cssom.getCssRulesFromStyleSheet(t);if(r&&r.length){if(!e)var s=0;for(var a,l=0,g=r.length;g>l;l++){a=r[l];if(e&&!a.href){var m=goog.cssom.getCssTextFromCssRule(a);o.push(m)}else if(!a.href){if(a.style){a.parentStyleSheet||(a.style["-closure-parent-stylesheet"]=t);a.style["-closure-rule-index"]=s}o.push(a)}e||s++}}}return e?o.join(" "):o};goog.provide("lime.fill.Frame");goog.require("lime.fill.Fill");goog.require("lime.fill.Image");goog.require("goog.math.Rect");goog.require("goog.style");goog.require("goog.cssom");goog.require("goog.dom.classes");goog.require("goog.dom");goog.require("goog.math.Vec2");goog.require("goog.math.Size");lime.fill.Frame=function(t,e,o,i,n){lime.fill.Image.call(this,t);if(goog.isNumber(e)){e=new goog.math.Rect(arguments[1],arguments[2],arguments[3],arguments[4]);o=new goog.math.Vec2(0,0);i=new goog.math.Size(e.width,e.height);n=!1}this.rect_=e;this.coffset_=o;this.csize_=i;this.rotated_=n;var r=this.rect_,s=[this.url_,r.width,r.height,r.left,r.top,this.coffset_.x,this.coffset_.y].join("_");if(goog.isDef(this.dataCache_[s])){this.data_=this.dataCache_[s];this.data_.processed||goog.events.listen(this.data_.initializer,"processed",function(){this.dispatchEvent(new goog.events.Event("processed"))},!1,this)}else{this.data_={};this.data_.processed=!1;this.data_.initializer=this;this.data_.classname=this.getNextCssClass_();this.dataCache_[s]=this.data_;this.ctx=this.USE_CSS_CANVAS?document.getCSSCanvasContext("2d",this.data_.classname,this.csize_.width,this.csize_.height):this.makeCanvas();this.isLoaded()?this.makeFrameData_():goog.events.listen(this,goog.events.EventType.LOAD,this.makeFrameData_,!1,this)}};goog.inherits(lime.fill.Frame,lime.fill.Image);lime.fill.Frame.prototype.id="frame";lime.fill.Frame.prototype.dataCache_={};lime.fill.Frame.prototype.USE_CSS_CANVAS=goog.isFunction(document.getCSSCanvasContext);lime.fill.Frame.prototype.initForSprite=function(t){var e=t.getSize();0==e.width&&0==e.height&&t.setSize(this.csize_.width,this.csize_.height);lime.fill.Image.prototype.initForSprite.call(this,t);this.isProcessed()||goog.events.listen(this,"processed",function(){t.setDirty(lime.Dirty.CONTENT)},!1,this)};lime.fill.Frame.prototype.isProcessed=function(){return this.data_&&this.data_.processed};!function(){var t,e="cvsbg_"+Math.round(1e3*Math.random())+"_",o=0;lime.fill.Frame.prototype.getNextCssClass_=function(){o++;return e+o};lime.fill.Frame.prototype.makeFrameData_=function(){this.writeToCanvas(this.ctx);if(!this.USE_CSS_CANVAS){var e=this.ctx.canvas.toDataURL("image/png"),o="."+this.data_.classname+"{background-image:url("+e+") !important}";if(t)goog.cssom.addCssRule(t,o);else{goog.style.installStyles(o);t=document.styleSheets[document.styleSheets.length-1]}this.data_.img=goog.dom.createDom("img");this.data_.img.src=e}this.data_.processed=!0;this.dispatchEvent(new goog.events.Event("processed"))}}();lime.fill.Frame.prototype.getImageElement=function(){this.frameImgCache_||(this.frameImgCache_=this.data_.initializer&&this.data_.initializer.frameImgCache_?this.data_.initializer.frameImgCache_:this.ctx.canvas);return this.frameImgCache_};lime.fill.Frame.prototype.makeCanvas=function(){var t=goog.dom.createDom("canvas");t.width=this.csize_.width;t.height=this.csize_.height;return t.getContext("2d")};lime.fill.Frame.prototype.writeToCanvas=function(t){var e,o,i=this.rect_,n=i.width,r=i.height,s=i.left,a=i.top;if(0>s){n+=s;s=0}if(0>a){r+=a;a=0}n+s>this.image_.width&&(n=this.image_.width-s);r+a>this.image_.height&&(r=this.image_.height-a);if(this.rotated_){t.rotate(.5*-Math.PI);t.translate(-this.csize_.height,0);e=this.csize_.height-this.coffset_.y-n;o=this.coffset_.x}else{e=this.coffset_.x;o=this.coffset_.y}t.drawImage(this.image_,s,a,n,r,e,o,n,r)};lime.fill.Frame.prototype.setDOMStyle=function(t,e){if(this.USE_CSS_CANVAS)t.style.background="-webkit-canvas("+this.data_.classname+")";else if(this.data_.classname!=e.cvs_background_class_){goog.dom.classes.add(t,this.data_.classname);t.style.background="";e.cvs_background_class_&&goog.dom.classes.remove(t,e.cvs_background_class_);e.cvs_background_class_=this.data_.classname}this.setDOMBackgroundProp_(t,e)};goog.provide("goog.dom.ViewportSizeMonitor");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.math.Size");goog.dom.ViewportSizeMonitor=function(t){goog.events.EventTarget.call(this);this.window_=t||window;this.listenerKey_=goog.events.listen(this.window_,goog.events.EventType.RESIZE,this.handleResize_,!1,this);this.size_=goog.dom.getViewportSize(this.window_)};goog.inherits(goog.dom.ViewportSizeMonitor,goog.events.EventTarget);goog.dom.ViewportSizeMonitor.getInstanceForWindow=function(t){var e=t||window,o=goog.getUid(e);return goog.dom.ViewportSizeMonitor.windowInstanceMap_[o]=goog.dom.ViewportSizeMonitor.windowInstanceMap_[o]||new goog.dom.ViewportSizeMonitor(e)};goog.dom.ViewportSizeMonitor.removeInstanceForWindow=function(t){var e=goog.getUid(t||window);goog.dispose(goog.dom.ViewportSizeMonitor.windowInstanceMap_[e]);delete goog.dom.ViewportSizeMonitor.windowInstanceMap_[e]};goog.dom.ViewportSizeMonitor.windowInstanceMap_={};goog.dom.ViewportSizeMonitor.prototype.listenerKey_=null;goog.dom.ViewportSizeMonitor.prototype.window_=null;goog.dom.ViewportSizeMonitor.prototype.size_=null;goog.dom.ViewportSizeMonitor.prototype.getSize=function(){return this.size_?this.size_.clone():null};goog.dom.ViewportSizeMonitor.prototype.disposeInternal=function(){goog.dom.ViewportSizeMonitor.superClass_.disposeInternal.call(this);if(this.listenerKey_){goog.events.unlistenByKey(this.listenerKey_);this.listenerKey_=null}this.window_=null;this.size_=null};goog.dom.ViewportSizeMonitor.prototype.handleResize_=function(){var t=goog.dom.getViewportSize(this.window_);if(!goog.math.Size.equals(t,this.size_)){this.size_=t;this.dispatchEvent(goog.events.EventType.RESIZE)}};goog.provide("lime.CoverNode");goog.require("goog.dom");goog.require("goog.dom.classes");goog.require("goog.math.Box");goog.require("goog.style");goog.require("lime.Node");lime.CoverNode=function(){lime.Node.call(this);var t=this.baseElement;this.baseElement=document.createElement("canvas");goog.dom.replaceNode(this.baseElement,t);this.context=this.baseElement.getContext("2d");goog.dom.classes.add(this.baseElement,goog.getCssName("lime-cover"))};goog.inherits(lime.CoverNode,lime.Node);lime.CoverNode.prototype.update=function(){if(this.director){var t=goog.style.getSize(this.director.baseElement.parentNode),e=this.baseElement.style,o=this.director.getScale();e.width=t.width+"px";e.height=t.height+"px";this.baseElement.width=t.width/o.x;this.baseElement.height=t.height/o.y;this.updateRect_?this.setNeedsRedrawInRect(this.updateRect_):this.setNeedsRedraw()}};lime.CoverNode.prototype.setNeedsRedraw=function(){var t=new goog.math.Box(0,this.baseElement.width/this.getQuality(),this.baseElement.height/this.getQuality(),0);this.setNeedsRedrawInRect(this.director.getBounds(t))};lime.CoverNode.prototype.setNeedsRedrawInRect=function(t){var e=this.director,o=e.getScale(),i=e.getPosition();this.context.save();this.context.translate(i.x/o.x,i.y/o.y);this.drawInRect(t);this.context.restore()};lime.CoverNode.prototype.drawInRect=goog.abstractMethod;goog.provide("lime.events.Drag");goog.require("goog.events.EventTarget");goog.require("lime.animation.MoveTo");lime.events.Drag=function(t,e,o,i){goog.base(this);this.target=i||t.targetObject;this.dropTargets_=[];this.dropIndex_=-1;this.x=0;this.y=0;if(!e){var n=this.target.localToScreen(new goog.math.Coordinate(0,0));this.x=t.screenPosition.x-n.x;this.y=t.screenPosition.y-n.y}t.swallow(["touchmove","mousemove"],goog.bind(this.moveHandler_,this));t.swallow(["touchend","touchcancel","mouseup"],goog.bind(this.releaseHandler_,this));this.setBounds(o||null);this.dispatchEvent(new goog.events.Event(lime.events.Drag.Event.START))};goog.inherits(lime.events.Drag,goog.events.EventTarget);lime.events.Drag.Event={START:"start",END:"end",MOVE:"move",CHANGE:"change",DROP:"drop",CANCEL:"cancel"};lime.events.Drag.prototype.disposeInternal=function(){goog.base(this,"disposeInternal");this.event_=null;this.target=null;this.dropTargets_=null};lime.events.Drag.prototype.getBounds=function(){return this.bounds_};lime.events.Drag.prototype.setBounds=function(t){this.bounds_=t};lime.events.Drag.prototype.moveHandler_=function(t){var e=t.screenPosition.clone();e.x-=this.x;e.y-=this.y;e=this.target.getParent().screenToLocal(e);var o=this.getBounds();if(goog.isDefAndNotNull(o)){e.x<o.left?e.x=o.left:e.x>o.right&&(e.x=o.right);e.y<o.top?e.y=o.top:e.y>o.bottom&&(e.y=o.bottom)}this.target.setPosition(e);this.dispatchEvent(new goog.events.Event(lime.events.Drag.Event.MOVE));for(var i=-1,n=goog.math.Rect.createFromBox(this.target.getFrame()),r=[],s=0;s<this.dropTargets_.length;s++){var a=this.dropTargets_[s];if(!goog.isFunction(a.confirmTargetActive)||a.confirmTargetActive(this.target)){var l=a.getFrame(),g=a.localToNode(new goog.math.Coordinate(l.left,l.top),this.target),m=a.localToNode(new goog.math.Coordinate(l.right,l.bottom),this.target),c=goog.math.Rect.createFromBox(new goog.math.Box(Math.min(g.y,m.y),Math.max(g.x,m.x),Math.max(g.y,m.y),Math.min(m.x,g.x))),u=goog.math.Rect.intersection(n,c);u&&r.push([u.width*u.height/(c.width*c.height),s])}}if(r.length){r=r.sort(function(t,e){return e[0]-t[0]
});i=r[0][1]}if(i!=this.dropIndex_){-1!=this.dropIndex_&&goog.isFunction(this.dropTargets_[this.dropIndex_].hideDropHighlight)&&this.dropTargets_[this.dropIndex_].hideDropHighlight();this.dropIndex_=i;-1!=this.dropIndex_&&goog.isFunction(this.dropTargets_[this.dropIndex_].showDropHighlight)&&this.dropTargets_[this.dropIndex_].showDropHighlight();var h=new goog.events.Event(lime.events.Drag.Event.CHANGE);h.activeDropTarget=-1!=this.dropIndex_?this.dropTargets_[this.dropIndex_]:null;this.dispatchEvent(h)}};lime.events.Drag.prototype.releaseHandler_=function(){if(-1!=this.dropIndex_){var t=new goog.events.Event(lime.events.Drag.Event.DROP);t.activeDropTarget=this.dropTargets_[this.dropIndex_];goog.isFunction(t.activeDropTarget.showDropHighlight)&&t.activeDropTarget.hideDropHighlight();this.dispatchEvent(t);if(!t.propagationStopped_){var e=t.activeDropTarget.getParent().localToNode(t.activeDropTarget.getPosition(),this.target.getParent()),o=new lime.animation.MoveTo(e).setDuration(.5).enableOptimizations();this.target.runAction(o);goog.isFunction(t.moveEndedCallback)&&goog.events.listen(o,lime.animation.Event.STOP,t.moveEndedCallback,!1,this.target)}}else this.dispatchEvent(new goog.events.Event(lime.events.Drag.Event.CANCEL));this.dispatchEvent(new goog.events.Event(lime.events.Drag.Event.END));lime.scheduleManager.callAfter(this.dispose,this,100)};lime.events.Drag.prototype.addDropTarget=function(t){this.dropTargets_.push(t)};goog.provide("lime.events.Event");goog.require("lime.events.Drag");lime.events.Event=function(t){this.dispatcher_=t;this.identifier=0};lime.events.Event.prototype.swallow=function(t,e,o){t=goog.isArray(t)?t:[t];for(var i=0;i<t.length;i++)this.dispatcher_.swallow(this,t[i],e);o&&this.event.stopPropagation()};lime.events.Event.prototype.release=function(t){var e=goog.isDef(t),o=goog.isArray(t)?t:[t],i=this.dispatcher_.swallows[this.identifier];if(i){var n=this,r=goog.array.filter(i,function(t){if(!goog.isDef(n.targetObject)||t[0]==n.targetObject&&(!e||goog.array.contains(o,t[1]))){goog.events.unlisten(t[0],t[1],t[2]);return!1}return!0});r.length?this.dispatcher_.swallows[this.identifier]=r:delete this.dispatcher_.swallows[this.identifier]}};lime.events.Event.prototype.startDrag=function(t,e,o){return new lime.events.Drag(this,t,e,o)};lime.events.Event.prototype.clone=function(){var t=new lime.events.Event(this.dispatcher_);goog.object.extend(t,this);return t};goog.provide("lime.events.EventDispatcher");goog.require("lime.events.Event");lime.events.EventDispatcher=function(t){this.director=t;this.handlers={};this.swallows={}};lime.events.EventDispatcher.prototype.register=function(t,e){if(goog.isDef(this.handlers[e])){if(!goog.array.contains(this.handlers[e],t)){this.handlers[e].push(t);this.handlers[e].sorted=!1}}else{this.handlers[e]=[t];this.handlers[e].sorted=!0;goog.events.listen("touch"==e.substring(0,5)&&t!=this.director?document:"key"==e.substring(0,3)?window:this.director.domElement.parentNode,e,this,!1,this)}};lime.events.EventDispatcher.prototype.release=function(t,e){if(goog.isDef(this.handlers[e])){goog.array.remove(this.handlers[e],t);if(!this.handlers[e].length){goog.events.unlisten(this.director.domElement.parentNode,e,this,!1,this);delete this.handlers[e]}}};lime.events.EventDispatcher.prototype.updateDispatchOrder=function(t){for(var e in this.handlers){var o=this.handlers[e];goog.array.contains(o,t)&&(o.sorted=!1)}};lime.events.EventDispatcher.prototype.swallow=function(t,e,o){var i=t.identifier;goog.isDef(this.swallows[i])||(this.swallows[i]=[]);this.swallows[i].push([t.targetObject,e,o]);goog.events.listen(t.targetObject,e,goog.nullFunction)};lime.events.EventDispatcher.prototype.handleEvent=function(t){this.shouldPreventDefault(t.type)&&(t.preventDefault?t.preventDefault():t.returnValue=!1);if(goog.isDef(this.handlers[t.type])){if(!this.handlers[t.type].sorted){this.handlers[t.type].sort(lime.Node.compareNode);this.handlers[t.type].sorted=!0}for(var e=this.handlers[t.type].slice(),o=!1,i=0,n=0;!n;){var r=new lime.events.Event(this);r.type=t.type;r.event=t;if("touch"==t.type.substring(0,5)){var s=t.getBrowserEvent().changedTouches[i];r.screenPosition=new goog.math.Coordinate(s.pageX,s.pageY);r.identifier=s.identifier;i++;i>=t.getBrowserEvent().changedTouches.length&&(n=1)}else{r.screenPosition=new goog.math.Coordinate(t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.clientY+document.body.scrollTop+document.documentElement.scrollTop);n=1}if(goog.isDef(this.swallows[r.identifier])){for(var a=this.swallows[r.identifier],l=0;l<a.length;l++)if(a[l][1]==t.type||goog.isArray(a[l][1])&&goog.array.contains(a[l][1],t.type)){var g=a[l][0];r.targetObject=g;r.position=g.screenToLocal(r.screenPosition);a[l][2].call(g,r);o=!0}if("touchend"==t.type||"touchcancel"==t.type||"mouseup"==t.type||"keyup"==t.type){delete r.targetObject;r.release()}}else for(var m="key"==t.type.substring(0,3),l=0;l<e.length;l++){var g=e[l];if((this.director.getCurrentScene()==g.getScene()||g==this.director)&&!g.getHidden()&&g.inTree_){r.targetObject=g;if(m||g.hitTest(r)){r.targetObject=g;var c=0,u=0;if(g.offset){c=g.offset.x;u=g.offset.y}window.mouseX=r.position.x-c;window.mouseY=r.position.y-u;if(window.current_scene){if(current_scene.viewOffset){window.mouseX-=current_scene.viewOffset.x;window.mouseY-=current_scene.viewOffset.y}current_scene.wOffset&&(window.mouseX-=current_scene.wOffset)}g.dispatchEvent(r);o=!0;if(r.event.propagationStopped_)break}}}}}};lime.events.EventDispatcher.prototype.shouldPreventDefault=function(t){return goog.string.startsWith(t,"key")?!1:!0};goog.provide("lime.Label");goog.provide("lime.Renderer.CANVAS.LABEL");goog.provide("lime.Renderer.DOM.LABEL");goog.require("lime.Renderer.CANVAS.SPRITE");goog.require("lime.Renderer.DOM.SPRITE");goog.require("lime.Sprite");goog.require("goog.style");lime.Label=function(t){lime.Sprite.call(this);this.setMultiline(!1);this.setText(t);this.setFontFamily(lime.Label.defaultFont);this.setFontSize(14);this.setFontColor("#000");this.setAlign("center");this.setFontWeight("400");this.setPadding(0);this.setLineHeight(1.15);this.setShadow(null);this.setFill(255,255,255,0);this.setStyle("normal")};goog.inherits(lime.Label,lime.Sprite);lime.Label.prototype.id="label";lime.Label.defaultFont="Arial";lime.Label.prototype.supportedRenderers=[lime.Renderer.DOM.SPRITE.makeSubRenderer(lime.Renderer.DOM.LABEL),lime.Renderer.CANVAS.SPRITE.makeSubRenderer(lime.Renderer.CANVAS.LABEL)];!function(){var t;lime.Label.prototype.measureText=function(){if(!goog.isDef(t)){var e=document.createElement("canvas");t=e.getContext("2d")}var o=this.getLineHeight()*this.getFontSize();this.getMultiline()&&(o*=goog.string.trim(this.text_).split("\n").length);t.font=this.getStyle()+" "+this.getFontWeight()+" "+this.getFontSize()+"px "+this.getFontFamily();var i=t.measureText(this.text_),n=goog.userAgent.WEBKIT?i.width:i.width+1;lime.userAgent.IOS5&&(n+=1);var r=this.stroke_?this.stroke_.width_:0;return new goog.math.Size(this.padding_[1]+this.padding_[3]+n+2*r,this.padding_[0]+this.padding_[2]+o+2*r)}}();lime.Label.prototype.getSize=function(){var t=lime.Node.prototype.getSize.call(this);return t&&(t.width||t.height)?t:this.measureText()};lime.Label.prototype.getText=function(){return this.text_};lime.Label.prototype.setText=function(t){this.text_=t+"";this.setDirty(lime.Dirty.CONTENT);delete this.words_;return this};lime.Label.prototype.setStyle=function(t){this.style_=t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getStyle=function(){return this.style_};lime.Label.prototype.getFontFamily=function(){return this.fontFamily_};lime.Label.prototype.setFontWeight=function(t){this.fontWeight_=t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getFontWeight=function(){return this.fontWeight_};lime.Label.prototype.setFontFamily=function(t){this.fontFamily_=t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getFontSize=function(){return this.fontSize_};lime.Label.prototype.setFontSize=function(t){this.fontSize_=t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getFontColor=function(){return this.fontColor_};lime.Label.prototype.setFontColor=function(t){this.fontColor_=t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getPadding=function(){return this.padding_};lime.Label.prototype.setPadding=function(t,e,o,i){var n=[t,t,t,t];goog.isDef(e)&&(n[1]=n[3]=e);goog.isDef(o)&&(n[2]=o);goog.isDef(i)&&(n[3]=i);this.padding_=n;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.setLineHeight=function(t,e){this.lineHeightAbsolute_=e||!1;this.lineHeight_=t;return this};lime.Label.prototype.getLineHeight=function(){var t=Math.abs(this.getShadowOffset().y)+2*this.shadowBlur_;return this.lineHeightAbsolute_?(this.lineHeight_+t)/this.getFontSize():this.lineHeight_+t/this.getFontSize()};lime.Label.prototype.getAlign=function(){return this.align_};lime.Label.prototype.setAlign=function(t){this.align_=t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getMultiline=function(){return this.multiline_};lime.Label.prototype.setMultiline=function(t){this.multiline_=t;this.setDirty(lime.Dirty.CONTENT);return this};lime.Label.prototype.setShadow=function(t,e,o,i){if(1==arguments.length&&goog.isNull(t)){this.setShadowColor("#ccc");this.setShadowBlur(0);this.setShadowOffset(0,0)}else if(2==arguments.length){this.setShadowColor(t);this.setShadowBlur(e);this.setShadowOffset(new goog.math.Vec2(0,0))}else if(3==arguments.length){this.setShadowColor(t);this.setShadowBlur(e);this.setShadowOffset(o)}else{this.setShadowColor(t);this.setShadowBlur(e);this.setShadowOffset(o,i)}this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.hasShadow_=function(){return this.shadowBlur_||this.shadowOffset_.x||this.shadowOffset_.y};lime.Label.prototype.getShadowColor=function(){return this.shadowColor_};lime.Label.prototype.getShadowOffset=function(){return this.shadowOffset_};lime.Label.prototype.setShadowColor=function(t){this.shadowColor_=t;return this};lime.Label.prototype.setShadowBlur=function(t){this.shadowBlur_=t;return this};lime.Label.prototype.setShadowOffset=function(t){this.shadowOffset_=2==arguments.length?new goog.math.Vec2(arguments[0],arguments[1]):t;this.setDirty(lime.Dirty.FONT);return this};lime.Label.prototype.getShadowBlur=function(){return this.shadowBlur_};lime.Label.prototype.calcWordsArray=function(){var t=[],e=this.text_.length,o=goog.userAgent.GECKO?/[\s\.]+/g:/[\s-\.]+/g,i=this.text_.match(o),n=0;if(i)for(var r=0;r<i.length;r++){var s=i[r],a=this.text_.indexOf(s,n),l=a+s.length;t.push(this.text_.substring(n,l));n=l}n!=e&&t.push(this.text_.substring(n,e));return t};lime.Label.prototype.wrapText=function(t,e){for(var o,i=[],n="",r=this.words_,s=0;s<r.length;s++){var a=0;if(this.multiline_){var l=r[s].match(/\n/g);l&&(a=l.length)}if(""==n)n=r[s];else{o=t.measureText(goog.string.trim(n+r[s]));if(o.width>e){i.push(goog.string.trim(n));n=r[s]}else n+=r[s]}for(var g=0;a>g;g++){i.push(goog.string.trim(n));n=""}}i.push(n);return i};lime.Label.prototype.update=function(){this.getDirty()&lime.Dirty.CONTENT&&delete this.lastDrawnWidth_;lime.Node.prototype.update.apply(this,arguments)};lime.Renderer.DOM.LABEL.draw=function(t){lime.Renderer.DOM.SPRITE.draw.call(this,t);var e=t.style;this.dirty_&lime.Dirty.CONTENT&&(this.getMultiline()?t.innerHTML=goog.string.htmlEscape(this.text_).replace(/\n/g,"<br/>"):goog.dom.setTextContent(t,this.text_));if(this.dirty_&lime.Dirty.FONT){e.lineHeight=this.getLineHeight();e.padding=goog.array.map(this.padding_,function(t){return t},this).join("px ")+"px";e.color=this.getFontColor();e.fontFamily=this.getFontFamily();e.fontSize=this.getFontSize()+"px";e.fontWeight=this.getFontWeight();e.textAlign=this.getAlign();e["font-style"]=this.getStyle();e.textShadow=this.hasShadow_()?this.getShadowColor()+" "+this.getShadowOffset().x+"px "+this.getShadowOffset().y+"px "+this.getShadowBlur()+"px":""}};lime.Renderer.CANVAS.LABEL.draw=function(t){lime.Renderer.CANVAS.SPRITE.draw.call(this,t);var e=this.getFrame(),o=-e.left-this.padding_[3]+e.right-this.padding_[1]+Math.abs(this.getShadowOffset().x)+Math.abs(2*this.getShadowBlur()),i=0;if(!this.words_){this.words_=this.calcWordsArray();i=1}var n=this.stroke_?this.stroke_.width_:0;t.save();var r=this.getAlign();"left"==r?t.translate(e.left+this.padding_[3]+n,e.top+this.padding_[0]+n):"right"==r?t.translate(e.right-this.padding_[1]-n,e.top+this.padding_[0]+n):"center"==r&&t.translate(.5*(e.left+this.padding_[3]+e.right-this.padding_[1]),e.top+this.padding_[0]+n);var s=this.getLineHeight();t.fillStyle=this.getFontColor();t.font=this.getStyle()+" "+this.getFontWeight()+" "+this.getFontSize()+"px/"+s+" "+this.getFontFamily();t.textAlign=r;t.textBaseline="top";if(this.hasShadow_()){t.shadowColor=this.getShadowColor();t.shadowOffsetX=this.getShadowOffset().x;t.shadowOffsetY=this.getShadowOffset().y;t.shadowBlur=this.getShadowBlur()}if(i||o!=this.lastDrawnWidth_){this.lines_=this.wrapText(t,o-2*n);this.lastDrawnWidth_=o}if(this.lines_){var a=s*this.getFontSize(),l=(goog.isDef(this.getShadowBlur())?Math.abs(this.getShadowBlur()):0)+(goog.isDef(this.getShadowOffset())?Math.abs(this.getShadowOffset().y)/2:0),g=0;a=goog.userAgent.WEBKIT?Math.floor(a):Math.round(a);for(var m=0;m<this.lines_.length;m++)t.fillText(this.lines_[m],g,a*m+l-.5)}t.restore()};lime.Label.installFont=function(t,e,o){var i=o||"truetype";goog.style.installStyles('@font-face{font-family: "'+t+'";src: url('+e+') format("'+i+'");})')};goog.provide("lime.Scene");goog.require("lime");goog.require("lime.Node");lime.Scene=function(){lime.Node.call(this);this.setAnchorPoint(0,0);this.domClassName=goog.getCssName("lime-scene");this.createDomElement()};goog.inherits(lime.Scene,lime.Node);lime.Scene.prototype.getScene=function(){return this};lime.Scene.prototype.measureContents=function(){return this.getFrame()};goog.provide("lime.helper.PauseScene");goog.require("lime.Label");goog.require("lime.Scene");goog.require("lime.Sprite");lime.helper.PauseScene=function(){lime.Scene.call(this);this.domElement.style.cssText="background:rgba(255,255,255,.6)";var t=this.continueLabel=(new lime.Label).setText("Click To Continue").setPosition(100,100).setFontSize(32);this.appendChild(t);if(window.current_scene){var e=current_scene.getSize();t.setPosition(e.width/2,e.height/2);goog.events.listen(t,["mousedown","touchstart"],function(t){(t.event||t).stopPropagation();current_scene.resume()})}};goog.inherits(lime.helper.PauseScene,lime.Scene);lime.helper.PauseScene.prototype.destroy=function(){};goog.provide("lime.Director");goog.require("lime.CoverNode");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.ViewportSizeMonitor");goog.require("goog.dom.classes");goog.require("goog.events");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.math.Vec2");goog.require("goog.style");goog.require("lime");goog.require("lime.Node");goog.require("lime.events.EventDispatcher");goog.require("lime.helper.PauseScene");goog.require("lime.scheduleManager");goog.require("lime.transitions.Transition");lime.Director=function(t){lime.Node.call(this);this.inTree_=!0;this.setAnchorPoint(0,0);this.sceneStack_=[];this.coverStack_=[];this.domClassName=goog.getCssName("lime-director");this.createDomElement();t.appendChild(this.domElement);if(goog.userAgent.WEBKIT&&goog.userAgent.MOBILE){this.coverElementBelow=document.createElement("div");goog.dom.classes.add(this.coverElementBelow,goog.getCssName("lime-cover-below"));goog.dom.insertSiblingBefore(this.coverElementBelow,this.domElement);this.coverElementAbove=document.createElement("div");goog.dom.classes.add(this.coverElementAbove,goog.getCssName("lime-cover-above"));goog.dom.insertSiblingAfter(this.coverElementAbove,this.domElement)}"absolute"!=t.style.position&&(t.style.position="relative");t.style.overflow="hidden";if(t==document.body){goog.style.installStyles("html,body{margin:0;padding:0;height:100%;}");var e=document.createElement("meta");e.name="viewport";var o="initial-scale=1.0,minimum-scale=1,maximum-scale=1.0,user-scalable=no";/android/i.test(navigator.userAgent)&&(o+=",target-densityDpi=device-dpi");e.content=o;document.getElementsByTagName("head").item(0).appendChild(e);if(goog.userAgent.MOBILE&&!goog.global.navigator.standalone){var i=this;setTimeout(function(){window.scrollTo(0,0);i.invalidateSize_()},100)}}var n,r=goog.style.getSize(t);this.setSize(new goog.math.Size(n=arguments[1]||r.width||lime.Director.DEFAULT_WIDTH,arguments[2]||r.height*n/r.width||lime.Director.DEFAULT_HEIGHT));this.setDisplayFPS(goog.DEBUG);this.setPaused(!1);var s=new goog.dom.ViewportSizeMonitor;goog.events.listen(s,goog.events.EventType.RESIZE,this.invalidateSize_,!1,this);goog.events.listen(goog.global,"orientationchange",this.invalidateSize_,!1,this);lime.scheduleManager.schedule(this.step_,this);if(window.isLime){this.eventDispatcher=new lime.events.EventDispatcher(this);goog.events.listen(this,["touchmove","touchstart"],function(t){t.event.preventDefault()},!1,this);goog.events.listen(this,["mouseup","touchend","mouseout","touchcancel"],function(){},!1)}this.invalidateSize_();goog.DEBUG&&goog.events.listen(goog.global,"keyup",this.keyUpHandler_,!1,this)};goog.inherits(lime.Director,lime.Node);lime.Director.FPS_INTERVAL=100;lime.Director.DEFAULT_WIDTH=400;lime.Director.DEFAULT_HEIGHT=400;lime.Director.prototype.isPaused=function(){return this.isPaused_};lime.Director.prototype.setPaused=function(t){if(this.isPaused_!=t){this.isPaused_=t;lime.scheduleManager.changeDirectorActivity(this,t);if(this.isPaused_){var e=this.pauseClassFactory||lime.helper.PauseScene;this.pauseScene=new e;this.pushScene(this.pauseScene)}else if(this.pauseScene){this.popScene();delete this.pauseScene}}return this};lime.Director.prototype.isDisplayFPS=function(){return this.displayFPS_};lime.Director.prototype.setDisplayFPS=function(t){if(this.displayFPS_&&!t)goog.dom.removeNode(this.fpsElement_);else if(!this.displayFPS_&&t){this.frames_=0;this.accumDt_=0;this.fpsElement_=goog.dom.createDom("div");goog.dom.classes.add(this.fpsElement_,goog.getCssName("lime-fps"));this.domElement.parentNode.appendChild(this.fpsElement_)}this.displayFPS_=t;return this};lime.Director.prototype.getCurrentScene=function(){return this.sceneStack_.length?this.sceneStack_[this.sceneStack_.length-1]:null};lime.Director.prototype.getDirector=function(){return this};lime.Director.prototype.getScene=function(){return null};lime.Director.prototype.step_=function(t){if(this.isDisplayFPS()){this.frames_++;this.accumDt_+=t;if(this.accumDt_>lime.Director.FPS_INTERVAL){this.fps=1e3*this.frames_/this.accumDt_;goog.dom.setTextContent(this.fpsElement_,this.fps.toFixed(2));this.frames_=0;this.accumDt_=0}}if(qyengine.gRenderer){qyengine.gRenderer.render(qyengine.gStage);var e=countTotal(qyengine.gStage);if(e>totalSprites){console.log(e);totalSprites=e}}lime.updateDirtyObjects()};var totalSprites=0;lime.Director.prototype.replaceScene=function(t,e,o){t.setSize(this.getSize().clone());var i=e||lime.transitions.Transition,n=null;this.sceneStack_.length&&(n=this.sceneStack_[this.sceneStack_.length-1]);for(var r=[],s=this.sceneStack_.length;--s>=0;){this.sceneStack_[s].wasRemovedFromTree();r.push(this.sceneStack_[s].domElement);this.sceneStack_[s].parent_=null}this.sceneStack_.length=0;this.sceneStack_.push(t);t.domElement.style.display="none";this.domElement.appendChild(t.domElement);t.parent_=this;t.wasAddedToTree();var a=new i(n,t);goog.events.listenOnce(a,"end",function(){for(var t=r.length;--t>=0;)goog.dom.removeNode(r[t]);r.length=0},!1,this);goog.isDef(o)&&a.setDuration(o);a.start();return a};lime.Director.prototype.updateLayout=function(){this.dirty_&=~lime.Dirty.LAYOUT};lime.Director.prototype.pushScene=function(t,e,o){var i,n;t.setSize(this.getSize().clone());if(goog.isDef(e)&&this.sceneStack_.length){n=this.sceneStack_[this.sceneStack_.length-1];i=new e(n,t);goog.isDef(o)&&i.setDuration(o);t.domElement.style.display="none"}this.sceneStack_.push(t);this.domElement.appendChild(t.domElement);t.parent_=this;t.wasAddedToTree();if(i){i.start();return i}};lime.Director.prototype.popScene=function(t,e){var o,i=this.getCurrentScene();if(!goog.isNull(i)){var n=function(){i.wasRemovedFromTree();i.parent_=null;goog.dom.removeNode(i.domElement);this.sceneStack_.pop();i=null};if(goog.isDef(t)&&this.sceneStack_.length>1){o=new t(i,this.sceneStack_[this.sceneStack_.length-2]);goog.isDef(e)&&o.setDuration(e);goog.events.listenOnce(o,"end",n,!1,this)}else n.call(this);if(o){o.start();return o}}};lime.Director.prototype.addCover=function(t,e){goog.userAgent.WEBKIT&&goog.userAgent.MOBILE?e?this.coverElementAbove.appendChild(t.domElement):this.coverElementBelow.appendChild(t.domElement):e?goog.dom.insertSiblingAfter(t.domElement,this.domElement):goog.dom.insertSiblingBefore(t.domElement,this.domElement);t.director=this;this.coverStack_.push(t)};lime.Director.prototype.removeCover=function(t){goog.array.remove(this.coverStack_,t);goog.dom.removeNode(t.domElement)};lime.Director.prototype.getBounds=function(t){var e=this.getPosition(),o=this.getScale();return new goog.math.Box(t.top-e.y/o.y,t.right-e.x/o.x,t.bottom-e.y/o.y,t.left-e.x/o.x)};lime.Director.prototype.screenToLocal=function(t){var e=t.clone();e.x-=this.domOffset.x+this.position_.x;e.y-=this.domOffset.y+this.position_.y;e.x/=this.scale_.x;e.y/=this.scale_.y;return e};lime.Director.prototype.localToScreen=function(t){var e=t.clone();e.x*=this.scale_.x;e.y*=this.scale_.y;e.x+=this.domOffset.x+this.position_.x;e.y+=this.domOffset.y+this.position_.y;return e};lime.Director.prototype.update=function(){lime.Node.prototype.update.call(this);for(var t=this.coverStack_.length;--t>=0;)this.coverStack_[t].update()};lime.Director.prototype.invalidateSize_=function(){var t=goog.style.getSize(this.domElement.parentNode);if(this.domElement.parentNode==document.body){window.scrollTo(0,0);goog.isNumber(window.innerHeight)&&(t.height=window.innerHeight)}var e=this.getSize(),o=t.width/e.width,i=t.height/e.height,n=window.current_scene&&"qyDefaultLoadingScene"===current_scene.classId||current_game.isFullScreen||"full_screen"===current_game.screenSize,r=n?"max":"min",s=Math[r](o,i);if("scale_integer"===current_game.screenSize)if(s>=1)s=Math.floor(s);else for(var a=0;a&&s>1/a||1/(a+1)>s;){a++;(1/a>=s&&s>=1/(a+1)||a>10)&&(s=1/(a+1))}else"not_scale"===current_game.screenSize&&(s=1);var l=(t.height-e.height*s)/2,g=(t.width-e.width*s)/2;this.setPosition(g,l);this.setScale(s);this.updateDomOffset_();if(goog.userAgent.MOBILE&&this.domElement.parentNode==document.body){this.overflowStyle_&&goog.style.uninstallStyles(this.overflowStyle_);this.overflowStyle_=goog.style.installStyles("html{height:"+(t.height+120)+"px;overflow:hidden;}")}window.current_scene&&current_scene.isPaused_&&lime.updateDirtyObjects()};lime.Director.prototype.makeMobileWebAppCapable=function(){var t=!1;goog.isDef(localStorage)&&(t=localStorage.getItem("_lime_visited"));var e=function(t,e){var o=document.createElement("meta");o.name=t;o.content=e;document.getElementsByTagName("head").item(0).appendChild(o)};e("mobile-web-app-capable","yes");var o=/(ipod|iphone|ipad)/i.test(navigator.userAgent);if(o){e("apple-mobile-web-app-capable","yes");e("apple-mobile-web-app-status-bar-style","black");if(!window.navigator.standalone&&COMPILED&&!t&&this.domElement.parentNode==document.body){alert("Please install this page as a web app by clicking Share + Add to home screen.");goog.isDef(localStorage)&&localStorage.setItem("_lime_visited",!0)}}};lime.Director.prototype.updateDomOffset_=function(){this.domOffset=goog.style.getPageOffset(this.domElement.parentNode)};lime.Director.prototype.keyUpHandler_=function(t){if(t.altKey&&"d"==String.fromCharCode(t.keyCode).toLowerCase()){if(this.debugModeOn_){goog.style.uninstallStyles(this.debugModeOn_);this.debugModeOn_=null}else this.debugModeOn_=goog.style.installStyles(".lime-scene div,.lime-scene img,.lime-scene canvas{border: 1px solid #c00;}");t.stopPropagation();t.preventDefault()}};lime.Director.prototype.hitTest=function(t){t&&t.screenPosition&&(t.position=this.screenToLocal(t.screenPosition));return!0};goog.provide("lime.audio.Audio");goog.require("goog.events");goog.require("goog.events.EventTarget");goog.require("lime.userAgent");lime.audio.Audio=function(t){if("YFactory"in window)return YFactory.getYAudioInstance(t);goog.events.EventTarget.call(this);t&&goog.isFunction(t.data)&&(t=t.data());this.loaded_=!1;this.playing_=!1;goog.userAgent.GECKO&&/\.mp3$/.test(t)&&(t=t.replace(/\.mp3$/,".ogg"));if(lime.audio.AudioContext){this.volume_=1;this.prepareContext_();this.loadBuffer(t,goog.bind(this.bufferLoadedHandler_,this))}else{this.baseElement=document.createElement("audio");this.baseElement.preload=!0;this.baseElement.loop=!1;this.baseElement.src=t;this.baseElement.load();this.baseElement.addEventListener("ended",goog.bind(this.onEnded_,this));this.loadInterval=setInterval(goog.bind(this.loadHandler_,this),10);this.loaded_=!1}};goog.inherits(lime.audio.Audio,goog.events.EventTarget);lime.audio.AudioContext=goog.global.AudioContext||goog.global.webkitAudioContext;lime.audio._buffers={};lime.audio.supportsMultiChannel=lime.audio.AudioContext||!(lime.userAgent.IOS||lime.userAgent.WINPHONE);lime.audio.Audio.prototype.prepareContext_=function(){if(!lime.audio.context){var t=lime.audio.context=new lime.audio.AudioContext,e=lime.audio.masterGain=t.createGain();e.connect(t.destination)}};lime.audio.Audio.prototype.loadBuffer=function(t,e){var o=lime.audio._buffers;if(o[t]&&o[t].buffer)e(o[t].buffer,t);else if(o[t])o[t].push(e);else{o[t]=[e];var i=new XMLHttpRequest;i.open("GET",t,!0);i.responseType="arraybuffer";i.onload=function(){lime.audio.context.decodeAudioData(i.response,function(e){if(!e)return console.error("Error decoding file:",t);var i=o[t];o[t]={buffer:e};for(var n=0;n<i.length;n++)i[n](e,t)},function(t){console.error("Error decoding file",t)})};i.onerror=function(){console.error("XHR error loading file:",t)};i.send()}};lime.audio.Audio.prototype.bufferLoadedHandler_=function(t){this.buffer=t;this.loaded_=!0;var e=new goog.events.Event("loaded");e.event=null;this.dispatchEvent(e);this.autoplay_&&this.play.apply(this,this.autoplay_)};lime.audio.Audio.prototype.onEnded_=function(t){this.playing_=!1;var e=new goog.events.Event("ended");e.event=t;this.dispatchEvent(e);this.playPosition_=0;var o=lime.audio.AudioContext?this.playTime_+this.buffer.duration-this.playPositionCache-.05:0;if(this.next_)for(var i=0;i<this.next_.length;i++)this.next_[i][0].play(this.next_[i][1],o);else e.returnValue_!==!1&&this.loop_&&this.play(this.loop_,o)};lime.audio.Audio.prototype.loadHandler_=function(){if(this.baseElement.readyState>2){this.bufferLoadedHandler_();clearTimeout(this.loadInterval)}this.baseElement.error&&clearTimeout(this.loadInterval);if(lime.userAgent.IOS&&0==this.baseElement.readyState){this.bufferLoadedHandler_();clearTimeout(this.loadInterval)}};lime.audio.Audio.prototype.isLoaded=function(){return this.loaded_};lime.audio.Audio.prototype.isPlaying=function(){return this.playing_};lime.audio.Audio.prototype.play=function(t){this.isLoaded()||(this.autoplay_=goog.array.toArray(arguments));if(this.isLoaded()&&!this.isPlaying()&&!lime.audio.getMute()){if(lime.audio.AudioContext){this.source&&this.source.playbackState==this.source.FINISHED_STATE&&(this.playPosition_=0);this.source=lime.audio.context.createBufferSource();this.source.buffer=this.buffer;this.gain=lime.audio.context.createGain();this.gain.connect(lime.audio.masterGain);this.gain.gain.value=this.volume_;this.source.connect(this.gain);this.playTime_=lime.audio.context.currentTime;var e=arguments[1]||0;this.playPosition_>0?this.source.start(e,this.playPosition_,this.buffer.duration-this.playPosition_):this.source.start(e);this.playPositionCache=this.playPosition_;this.endTimeout_=setTimeout(goog.bind(this.onEnded_,this),1e3*(this.buffer.duration-(this.playPosition_||0))-150)}else this.baseElement.play();this.playing_=!0;this.loop_=!!t;-1==lime.audio._playQueue.indexOf(this)&&lime.audio._playQueue.push(this)}};lime.audio.Audio.prototype.stop=function(){this.isLoaded()||(this.autoplay_=null);if(this.isPlaying()){if(lime.audio.AudioContext){clearTimeout(this.endTimeout_);this.playPosition_=lime.audio.context.currentTime-this.playTime_+(this.playPosition_||0);this.playPosition_>this.buffer.duration&&(this.playPosition_=0);this.source.stop(0);this.gain.disconnect(lime.audio.masterGain);this.source=null}else this.baseElement.pause();this.playing_=!1}};lime.audio._isMute=!1;lime.audio._playQueue=[];lime.audio.getMute=function(){return lime.audio._isMute};lime.audio.setMute=function(t){if(t&&!lime.audio._isMute){for(var e=0;e<lime.audio._playQueue.length;e++)lime.audio._playQueue[e].stop();lime.audio._playQueue=[]}lime.audio._isMute=t};lime.audio.Audio.prototype.setVolume=function(t){if(lime.audio.AudioContext){this.volume_=t;this.gain&&(this.gain.gain.value=t)}else this.baseElement.volume=t};lime.audio.Audio.prototype.getVolume=function(){return lime.audio.AudioContext?this.volume_:this.baseElement.volume};goog.provide("lime.ui.Container");goog.require("lime.Layer");lime.ui.Container=function(){goog.base(this);this.GAP=10;this.toAdd_=[];this.toRemove_=[];this.setDirection(lime.ui.Container.Direction.HORIZONTAL)};goog.inherits(lime.ui.Container,lime.Layer);lime.ui.Container.Direction={HORIZONTAL:0,VERTICAL:1};lime.ui.Container.prototype.getDirection=function(){return this.direction_};lime.ui.Container.prototype.setDirection=function(t){this.direction_=t;return this};lime.ui.Container.prototype.updateChildrenPositions=function(){for(var t=this.children_.length,e=new goog.math.Coordinate(0,0),o=0;t>o;o++){var i=this.children_[o],n=i.getPosition();goog.math.Coordinate.equals(e,n)||i.setPosition(e.clone());this.getDirection()==lime.ui.Container.Direction.HORIZONTAL?e.x+=i.getSize().width+this.GAP:e.y+=i.getSize().height+this.GAP}return this};lime.ui.Container.prototype.update=function(t){t||this.updateChildrenPositions();lime.Node.prototype.update.apply(this,arguments)};goog.provide("lime.ui.Scroller");goog.require("lime.Layer");goog.require("lime.Sprite");goog.require("lime.animation.MoveTo");lime.ui.Scroller=function(){goog.base(this);this.setSize(100,100);this.clipper=(new lime.Sprite).setFill("#c00").setSize(100,100).setAutoResize(lime.AutoResize.ALL);this.appendChild(this.clipper);this.setMask(this.clipper);this.moving_=new lime.Layer;lime.Node.prototype.appendChild.call(this,this.moving_);goog.events.listen(this,["mousedown","touchstart"],this.downHandler_,!1,this);this.setDirection(lime.ui.Scroller.Direction.HORIZONTAL)};goog.inherits(lime.ui.Scroller,lime.Sprite);lime.ui.Scroller.OFFSET=250;lime.ui.Scroller.OFFSET_LAG=.4;lime.ui.Scroller.FRICTION=.95;lime.ui.Scroller.Direction={HORIZONTAL:0,VERTICAL:1};lime.ui.Scroller.prototype.dispose=function(){if(this.event){this.event.disposeInternal();this.event=null}if(this.clipper){goog.events.removeAll(this.clipper);this.clipper.maskTarget_=null;this.clipper.targetNode=null;this.clipper=null}if(this.moving_){goog.events.removeAll(this.moving_);this.moving_.removeAllChildren();this.moving_=null}this.mask_=null;this.activeMask_=null;goog.base(this,"dispose")};lime.ui.Scroller.prototype.getDirection=function(){return this.direction_};lime.ui.Scroller.prototype.setDirection=function(t){this.direction_=t;return this};lime.ui.Scroller.prototype.setAnchorPoint=function(){this.clipper&&this.clipper.setAnchorPoint.apply(this.clipper,arguments);return lime.Node.prototype.setAnchorPoint.apply(this,arguments)};lime.ui.Scroller.prototype.appendChild=function(){return this.moving_?this.moving_.appendChild.apply(this.moving_,arguments):lime.Node.prototype.appendChild.apply(this,arguments)};lime.ui.Scroller.prototype.removeChild=function(){return this.moving_?this.moving_.removeChild.apply(this.moving_,arguments):lime.Node.prototype.removeChild.apply(this,arguments)
};lime.ui.Scroller.prototype.measureLimits=function(){var t=this.moving_.measureContents();if(this.getDirection()==lime.ui.Scroller.Direction.HORIZONTAL){this.downy=this.moving_.getPosition().y;var e=this.getSize().width;this.LOW=-t.left;this.HIGH=Math.min(e-t.right,-t.left);var o=t.right-t.left-e}else{this.downx=this.moving_.getPosition().x;e=this.getSize().height;this.LOW=-t.top;this.HIGH=Math.min(e-t.bottom,-t.top);o=t.bottom-t.top-e}if(o>0){this.LOW-=o;this.HIGH+=o}};lime.ui.Scroller.prototype.scrollTo=function(t,e){var o=this.moving_.getPosition().clone(),i=e||0;this.measureLimits();0>t&&(t=0);if(this.getDirection()==lime.ui.Scroller.Direction.HORIZONTAL){o.x=this.HIGH-t;o.x<this.LOW&&(o.x=this.LOW)}else{o.y=this.HIGH-t;o.y<this.LOW&&(o.y=this.LOW)}i?this.moving_.runAction(new lime.animation.MoveTo(o.x,o.y).setDuration(i).enableOptimizations().setEasing(lime.animation.getEasingFunction(.19,.6,.35,.97))):this.moving_.setPosition(o)};lime.ui.Scroller.prototype.downHandler_=function(t){if(!this.ismove){t.position=this.localToNode(t.position,this.moving_);this.downx=t.position.x;this.downy=t.position.y;this.v=0;this.ismove=1;this.oldvalue=this.posvalue=this.getDirection()==lime.ui.Scroller.Direction.HORIZONTAL?this.moving_.getPosition().x:this.moving_.getPosition().y;this.measureLimits();lime.animation.actionManager.stopAll(this.moving_);lime.scheduleManager.schedule(this.captureVelocity_,this);t.swallow(["touchmove","mousemove"],this.moveHandler_);t.swallow(["touchend","mouseup","touchcancel"],this.upHandler_);this.event=t.clone()}};lime.ui.Scroller.prototype.captureVelocity_=function(){if(this.ismove){this.v=1.05*(this.posvalue-this.oldvalue);this.oldvalue=this.posvalue}this.v*=lime.ui.Scroller.FRICTION};lime.ui.Scroller.prototype.cancelEvents=function(){this.event&&this.event.release();this.ismove=0};lime.ui.Scroller.prototype.moveHandler_=function(t){var e,o=t.position.clone(),i=this.getDirection();if(i==lime.ui.Scroller.Direction.HORIZONTAL){o.x-=this.downx;o.y=this.downy;e=o.x}else{o.x=this.downx;o.y-=this.downy;e=o.y}if(e<this.LOW){var n=this.LOW-e;n>lime.ui.Scroller.OFFSET&&(n=lime.ui.Scroller.OFFSET);e=this.LOW-n*lime.ui.Scroller.OFFSET_LAG;if(i==lime.ui.Scroller.Direction.HORIZONTAL){if(!this.reachedRight){this.dispatchEvent("reachRight");this.reachedRight=!0}}else if(!this.reachedBottom){this.dispatchEvent("reachBottom");this.reachedBottom=!0}}else if(e>this.HIGH){n=e-this.HIGH;n>lime.ui.Scroller.OFFSET&&(n=lime.ui.Scroller.OFFSET);e=this.HIGH+n*lime.ui.Scroller.OFFSET_LAG;if(i==lime.ui.Scroller.Direction.HORIZONTAL){if(!this.reachedLeft){this.dispatchEvent("reachLeft");this.reachedLeft=!0}}else if(!this.reachedTop){this.dispatchEvent("reachTop");this.reachedTop=!0}}else{this.reachedTop=!1;this.reachedBottom=!1;this.reachedLeft=!1;this.reachedRight=!1}this.posvalue=e;i==lime.ui.Scroller.Direction.HORIZONTAL?o.x=e:o.y=e;this.moving_.setPosition(o)};lime.ui.Scroller.prototype.upHandler_=function(t){var e,o=t.position.clone(),i=this.getDirection();if(i==lime.ui.Scroller.Direction.HORIZONTAL){o.x-=this.downx;o.y=this.downy;e=o.x}else{o.x=this.downx;o.y-=this.downy;e=o.y}lime.scheduleManager.unschedule(this.captureVelocity_,this);var n=Math.log(.5/Math.abs(this.v))/Math.log(lime.ui.Scroller.FRICTION),r=n/30,s=Math.abs(this.v)*(Math.pow(lime.ui.Scroller.FRICTION,n)-1)/(lime.ui.Scroller.FRICTION-1)*(this.v>0?1:-1);e+=s;this.ismove=0;if(0!=this.v){var a=s;if(e<this.LOW){a=this.LOW-(e-s);e=this.LOW}if(e>this.HIGH){a=this.HIGH-(e-s);e=this.HIGH}r*=a/s}if(this.oldvalue<this.LOW){e=this.LOW;r=.3}if(this.oldvalue>this.HIGH){e=this.HIGH;r=.3}i==lime.ui.Scroller.Direction.HORIZONTAL?o.x=e:o.y=e;Math.abs(r)<10&&this.moving_.runAction(new lime.animation.MoveTo(o.x,o.y).setDuration(r).enableOptimizations().setEasing(lime.animation.getEasingFunction(.19,.6,.35,.97)))};var qyboot_config='{"mt":"F8HGUe","pt":"dep","modrelease":["modjsall.js"],"modrelmt":["F8HGUe"]}';
!function(){function o(o,t){null==o&&(o={});if(!t)return o;var e=typeof t;if("object"!=e)return o;for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);return o}var t={debug:window.g_qyboot_debug,version:"v1.3",qyboot_config:qyboot_config,mergeObj:o};window.qyboot=o(window.qyboot,t)}();!function(){function matchVersion(){var o=qyboot.getLSItem("QYSYSVER");if(o!=qyboot.version){qyboot.clearLS();qyboot.setLSItem("QYSYSVER",qyboot.version)}}function applyUpdates(){for(var o,t,e=window.localStorage.length,n=0;e>n;n++){o=window.localStorage.key(n);var r=/QYFU\/(.+)/.exec(o);if(r){t=qyboot.getLSItem(o);window.localStorage.removeItem(o);qyboot.setLSItem(r[1],t)}}}function loadBoot(o,t){if(qyboot.isqyc(o)){console.log(t+" enc");qyboot.qyload(o)}else{if(qyboot.isxor(o)){o=qyboot.dexor(o);console.log(t+" x")}else console.log(t+" notenc");qyboot.debug?qyboot.evalClean(o+"\n//@ sourceURL="+t,t):qyboot.evalClean_wrap(o,t)}}function outdateMsg(o){return o+" is using old format.please deploy it force update"}function preloadBoot(o,t){var e=JSON.parse(qyboot.qyboot_config),n=qyboot.getFromLS(qyboot.PROJ(o));qyboot.preloadProjByConfig(o,e,n,t)}function using_boot(o,t){preloadBoot(o,function(e){for(var n=e.config,r=qyboot.getReleaseFiles(n,o),a=r.length,s=0;a>s;s++){var i=r[s],d=o+"/"+i,l=getFromLS(d,!0);if(null==l){l=qyboot.getRemoteFile(d);loadBoot(l,d)}else try{loadBoot(l,d)}catch(u){l=qyboot.getRemoteFile(d);loadBoot(l,d)}}if(window.miniqyboot){qyboot.baseLoaded=!0;qyboot.preloaded=!0;qyboot.tryRunReadyFuns()}else t()})}function bootLoadedCallback(){var o=SelfModName(),t=qyboot.getPrefix()+o;qyboot.is_webapp=window.g_qyboot_path?!1:""!=o&&!/^qiyun\/website\//.test(o);var e,n=defaultProjs;if(qyboot.is_webapp||window.forbidPreload){var r=qyboot.analyzePath(t);if("proj"==r.type)n=n.concat([r.path]);else if(/\/(main|login)$/.test(o)){e=r.path;n=n.concat([o])}else n=n.concat([[r.path]])}else n=n.concat(staticToLoad);var a=window.g_projsToPreload?window.g_projsToPreload.concat(n):n;qyboot.preload(a,function(){console.log("after preload");if(qyboot.is_webapp){o.match(/\/qybase$/)||qyboot.initShowMessage();"http"==qyboot.getProto()&&qyboot.tryCreateGuest();using_webapp(o);o.match(/\/qybase$/)&&qyboot.initShowMessage();qyboot.initUpdateReminder()}e&&qyboot.preload([[e]],function(){})});qyboot.ready(qyboot.removeLoadingImg)}qyboot.evalClean=function(code,file){file||(file="");try{return eval(code)}catch(e){throw e}};qyboot.evalClean_wrap=function(o,t){t||(t="");try{new Function(o)();return}catch(e){throw e}};var FSPrefix="QYFI",FSContent="QYFC",posRegex=/^(debug|beta|public)\/(.*)/;qyboot.mapPath=function(o,t){if(!t){t=o;o="deployed"}var e=posRegex.exec(t);if(e){o=e[1];t=e[2]}return{PositionType:o,Path:t}};qyboot.getLocalStoragePath=function(o,t,e){if(!t){t=o;o="deployed"}return[e?FSContent:FSPrefix,o,t].join("/")};var getLsPath=qyboot.getLsPath=function(o){var t=qyboot.mapPath(o),e=qyboot.getLocalStoragePath(t.PositionType,t.Path,!0);return e};qyboot.showQuota=function(o){var t=0==o?navigator.webkitTemporaryStorage:navigator.webkitPersistentStorage;t&&t.queryUsageAndQuota?t.queryUsageAndQuota(function(o,t){console.log("Used quota: "+o+", remaining quota: "+t)},function(o){console.log("Error",o)}):console.log("not webkit based platform")};var askingForQuota=!1,cxo=function(o){if(void 0===o)return void 0;if(null===o)return null;for(var t=o.length,e="",n=0;t>n;n++)e+=String.fromCharCode(155^o.charCodeAt(n));return e};qyboot.getLSItem=function(o){return cxo(window.localStorage.getItem(o))};qyboot.setLSItem=function(o,t){t=cxo(t);try{window.localStorage.setItem(o,t);return!0}catch(e){qyboot.gcLS();try{window.localStorage.setItem(o,t);if(askingForQuota||!navigator.webkitPersistentStorage)return!1;askingForQuota=!0;navigator.webkitPersistentStorage.requestQuota(4294967296,function(o){console.log("persistent quota is set to "+o)});return!1}catch(e){return!1}}};var saveToLS=qyboot.saveToLS=function(o,t){var e=getLsPath(o),n="string"==typeof t?t:JSON.stringify(t);qyboot.setLSItem(e,n)},getFromLS=qyboot.getFromLS=function(o,t){var e=getLsPath(o),n=qyboot.getLSItem(e);if(t){/.css$/.test(o)&&(n=cxo(n));return n}if(!n)return void 0;try{return JSON.parse(n)}catch(r){window.localStorage.removeItem(o);return void 0}},removeFromLS=qyboot.removeFromLS=function(o){var t=getLsPath(o);window.localStorage.removeItem(t)};qyboot.clearLS=function(){for(var o=window.localStorage.length,t=[],e=0;o>e;e++){var n=window.localStorage.key(e);/^QYF/.test(n)&&t.push(n)}o=t.length;for(e=0;o>e;e++)window.localStorage.removeItem(t[e]);console.log("clearLS done");return o};qyboot.gcLS=function(){for(var o=window.localStorage.length,t=/(^QYFC\/(debug|beta|public|deployed)\/)|(^QYFI\/)/,e=[],n=0;o>n;n++){var r=window.localStorage.key(n);t.test(r)&&e.push(r)}o=e.length;for(n=0;o>n;n++)window.localStorage.removeItem(e[n]);console.log("gcLS done");return o};matchVersion();applyUpdates();qyboot.randUrl=function(o){return o+"?rand="+Math.floor(1e4*Math.random())};qyboot.getPathUrl=function(o){var t=/^debug\//.test(o)?"/"+o:qyboot.getBaseURIHttp()+o;return t};qyboot.getRemoteFile=function(o){var t=new XMLHttpRequest;t.open("GET",qyboot.randUrl(qyboot.getBaseURI()+o),!1);t.send(null);if(4==t.readyState&&200==t.status)return t.responseText;console.log("getting "+o+" failed.");return null};qyboot.getRemoteFile_async=function(o,t){var e=new XMLHttpRequest;e.open("GET",qyboot.randUrl(qyboot.getBaseURI()+o),!0);e.onreadystatechange=function(){if(4==e.readyState){e.onreadystatechange=function(){};200==e.status?t(o,e.responseText):t(o,null)}};e.send(null)};qyboot.isqyc=function(o){return 4==o.charCodeAt(0)&&1==o.charCodeAt(1)};qyboot.isxor=function(o){return 8==o.charCodeAt(0)&&16==o.charCodeAt(1)};qyboot.dexor=function(o){for(var t="",e=o.length,n=4;e>n;n++)t+=String.fromCharCode(185^o.charCodeAt(n));return t};qyboot.PROJ=function(o){return o+"/proj.config"};qyboot.getReleaseFiles=function(o,t){if(!o)throw t+" config is null";if(!o.mt)throw outdateMsg(t);return o.modrelease||o.webapprelease?o.modrelease?o.webapprelease?o.modrelease.concat(o.webapprelease):o.modrelease:o.webapprelease:[]};qyboot.getReleaseMts=function(o){return o.modrelmt||o.webapprelmt?o.modrelmt?o.webapprelmt?o.modrelmt.concat(o.webapprelmt):o.modrelmt:o.webapprelmt:[]};qyboot.makeMap=function(o,t){var e={};if(!o)return e;for(var n=qyboot.getReleaseFiles(o,t),r=qyboot.getReleaseMts(o,t),a=n.length,s=0;a>s;s++)e[n[s]]=r[s];return e};var baseURI,baseURIHttp,baseURIHttps,domainApp,hostName,hostPort,debugMode,proto,prefix,cookiesuffix,hostAddress,httpsHostAddress,httpHostAddress,uriRegex=/((http[s]?):\/\/([^/:]+)(:([0-9]+))?\/)((debug|beta|public)\/)?/i;qyboot.getHostName=function(){return hostName||(qyboot.getBaseURI(),hostName)};qyboot.getHostAddress=function(){return hostAddress||(qyboot.getBaseURI(),hostAddress)};qyboot.getHttpsHostAddress=function(){return httpsHostAddress||(qyboot.getBaseURI(),httpsHostAddress)};qyboot.getBaseURIHttp=function(){return baseURIHttp||(qyboot.getBaseURI(),baseURIHttp)};qyboot.getBaseURIHttps=function(){return baseURIHttps||(qyboot.getBaseURI(),baseURIHttps)};qyboot.getHttpHostAddress=function(){return httpHostAddress||(qyboot.getBaseURI(),httpHostAddress)};qyboot.getCookieSuffix=function(){return cookiesuffix||(qyboot.getBaseURI(),cookiesuffix)};qyboot.getProto=function(){return proto||(qyboot.getBaseURI(),proto)};qyboot.getDebugMode=function(){return debugMode||(qyboot.getBaseURI(),debugMode)};qyboot.getPrefix=function(){return prefix||(qyboot.getBaseURI(),prefix)};qyboot.getBaseURI=function(){if(baseURI)return baseURI;var o=window.g_qyboot_path||window.qyProjUrl||decodeURI(window.location.href),t=o.indexOf("?");t>=0&&(o=o.substr(0,t));var e=uriRegex.exec(o);if(!e)return o;baseURI=e[1];proto=e[2];cookiesuffix="http"==proto?"h":"";hostName=e[3];hostPort=e[5];hostAddress=hostName+(hostPort?":"+hostPort:"");httpsHostAddress="https"==proto?hostAddress:hostName+(hostPort?":4443":"");httpHostAddress="http"==proto?hostAddress:hostName+(hostPort?":8080":"");baseURIHttps="https"==proto?baseURI:"https://"+httpsHostAddress+"/";baseURIHttp="http"==proto?baseURI:"http://"+httpHostAddress+"/";prefix=e[6]||"";debugMode="debug/"==prefix?"debug/":"";var n=o.length;if(baseURI.length>=n)domainApp="";else{var r=o.substring(e[0].length),a=r.split("/"),s=a[a.length-1];(""==s||s.indexOf(".")>=0)&&a.pop();domainApp=a.join("/")}return baseURI};qyboot.getDomainApp=function(){return domainApp||(qyboot.getBaseURI(),domainApp)};qyboot.initToLoad=function(o){for(var t={items:{}},e=0,n=0;n<o.length;n++)if(!t.items[o[n]]){t.items[o[n]]={status:"toload"};e++}t.total=t.remaining=e;return t};var preloadFiles=function(o,t){function e(o,e){if(null==e)n.items[o].status="failed";else{n.items[o].status="loaded";n.items[o].content=e}0==--n.remaining&&t(n)}if(o&&0!=o.length){var n=qyboot.initToLoad(o);for(var r in n.items)qyboot.getRemoteFile_async(r,function(o,t){e(o,t)})}else t({items:{}})},bootProj=(qyboot.debug?"debug/":"")+"qiyun/qyboot";qyboot.preloadProjByConfig=function(o,t,e,n){if(e&&e.mt==t.mt)n({proj:o,config:t,status:"exist"});else{var r=qyboot.makeMap(e,o),a=qyboot.makeMap(t,o),s=[];for(var i in a)r[i]!=a[i]&&s.push(o+"/"+i);preloadFiles(s,function(e){for(var r in e.items){var a=e.items[r];"loaded"==a.status&&qyboot.saveToLS(r,a.content)}qyboot.saveToLS(qyboot.PROJ(o),t);n({proj:o,config:t,status:"updated"})})}};!function(){function o(){e=!0;r()}var t=[],e=!1;qyboot.preloaded=window.QYCOMPILED?!0:!1;var n=!1,r=qyboot.tryRunReadyFuns=function(){if(e&&qyboot.preloaded)for(var o=t.shift();o;){o();o=t.shift()}};qyboot.ready=function(r){if(e&&qyboot.preloaded)r();else{t.push(r);if("complete"!==document.readyState){if(!n){window.addEventListener?window.addEventListener("load",o,!1):window.attachEvent&&window.attachEvent("onload",o);n=!0}}else o()}}}();var defaultProjs=["qiyun/qybase","qiyun/qyutil_sln/qyShowMessage","qiyun/qyutil_sln/qyShowMessage_css"],staticToLoad=["qiyun/qylogin_sln","qiyun/main","qiyun/qyMessenger_sln",["qiyun/qyutil_sln",["qyDragModule","qyUpdateReminder","qyTabs","qyTabs_css","qyButton","qyButton_css"]]];window.QYCOMPILED?window.miniqyboot&&(qyboot.baseLoaded=!0):using_boot(bootProj,bootLoadedCallback)}();!function(){qyboot.set_export_desc=function(e,o){o||(o=qyboot);for(var t in e)e.hasOwnProperty(t)&&(o[t]=e[t].value);o.exports_desc=qyboot.mergeObj(o.exports_desc,e)}}();!function(){var e=[];qyboot.pushShowMsgFun=function(o){e.push(o)};qyboot.popShowMsgFun=function(){var o=e.length;o>1&&e.pop()};var o;qyboot.initShowMessage=function(){if(!o&&using){var e=using("qiyun/qyutil_sln/qyShowMessage");if(e&&e.qyShowMessage){o=new e.qyShowMessage({});qyboot.showMsgObj=o;if(window.g_qy_DESKTOP){var t=window.g_qy_DESKTOP.getSize();o.setPosition({x:t.x/2,y:t.y/2})}qyboot.pushShowMsgFun(o.showMessage.closure(o))}}};window.defaultShowMessage=function(e,t,r,n){return o&&o.showMessage(e,t,r,n)};window.showMessage=function(o,t,r,n){return e.length>0&&e[e.length-1](o,t,r,n)};window.clearMessage=function(){o&&o.clearMessage()};window.showQyLogin=function(){qyboot.CurrentUser=null;if(!qyboot.UserPanel){var e=using("qiyun/qylogin_sln/qylogin");qyboot.UserPanel=new e.QYUserPanel({})}}}();!function(){function e(e){return e+"/load.manifest"}function o(e){var o=e.path,t=e.updateFiles;if(t)for(var r=t.length,n=0;r>n;n++)qyboot.saveToLS(o+"/"+t[n].filename,t[n].content);qyboot.saveToLS(o+"/"+e.type+".config",e.newConfig)}function t(e,o){for(var t=0;t<u.length;t++)u[t](e,o);l.push({projPath:e,updateFiles:o})}function r(){if(s)return s;if(!window.Worker){console.log("worker is not supported");return null}console.log("worker is supported");var r=qyboot.debug?"debug/":"",n=qyboot.getBaseURI()+r+"qiyun/qyboot/worker/qyupdate.js";s=new window.Worker(qyboot.randUrl(n));s.addEventListener("message",function(r){var n=r.data;if("updateReady"==n.cmd){for(var s=n.updateFiles?n.updateFiles.length:0,a=new Array(s),i=0;s>i;i++)a[i]=n.updateFiles[i].filename;t(n.path,a);o(n)}else if("loadMnftReady"==n.cmd){var u=e(n.path);qyboot.setLSItem(qyboot.getLsPath(u),n.mnft)}else console.log("from worker:"+JSON.stringify(n))},!1);return s}function n(e,o,t,n){var s=r();if(!s)return!1;s.postMessage({cmd:"update",path:e,type:o,baseURIHttp:qyboot.getBaseURIHttp(),usedProjs:n,oldConfig:t||qyboot.getFromLS(e+"/"+o+".config")});return!0}var s,a,i=function(e,o){var t=o?o.length:0;t>0?console.log(e+" updated(files:"+t+"). Will take effect after restart."):console.log(e+" config updated. ")},u=[i],l=[];qyboot.initUpdateReminder=function(){if(!a){a=using("qiyun/qyutil_sln/qyUpdateReminder");qyboot.addUpdateReminder(a.updateReminder)}};qyboot.addUpdateReminder=function(e){if("function"==typeof e){u.push(e);for(var o=0;o<l.length;o++)e(l[o].projPath,l[o].updateFiles)}};qyboot.bgUpdateProj=function(e,o){return n(e,"proj",o)};qyboot.bgUpdateSln=function(e,o,t){return n(e,"sln",o,t)};qyboot.loadManifest=function(o){var t=e(o),n=qyboot.getLSItem(qyboot.getLsPath(t)),s=qyboot.getRemoteFile(t);if(n!=s){var a=r();if(!a)return!1;a.postMessage({cmd:"loadMnft",path:o,oldMnft:n,newMnft:s,baseURIHttp:qyboot.getBaseURIHttp()})}return!0}}();!function(){function e(e,o,t){t?qyboot.preloadProjByConfig(e,t,null,o):qyboot.getRemoteFile_async(qyboot.PROJ(e),function(t,r){if(null!=r){var n=JSON.parse(r);qyboot.preloadProjByConfig(e,n,null,o)}else o({proj:e,status:"failed"})})}function o(){qyboot.preloaded=!0;l();qyboot.tryRunReadyFuns()}function t(t){if(!c[t.path]){c[t.path]=t;d++;if(t.config)r(t.config);else{p++;e(t.path,function(e){t.status=e.status;t.config=e.config;t.config&&r(t.config);0==--p&&o()})}}}function r(e){if(e&&e.deps)for(var o=0;o<e.deps.length;o++)u(e.deps[o])}function n(e){p++;qyboot.getRemoteFile_async(qyboot.SLN(e.path),function(t,n){if(null==n)"failed"==e.status;else{qyboot.saveToLS(t,n);var s=JSON.parse(n);e.config=s;e.status="loaded";r(s)}a(e);0==--p&&o()})}function s(e){var o=[];if("sln_all"==e.type){if(!e.config)return[];for(var t=0;t<e.config.projs.length;t++){var r=e.path+"/"+e.config.projs[t].path;e.projsLoaded[r]||qyboot.getFromLS(qyboot.PROJ(r))||o.push(r)}}else{for(t=0;t<e.projsToLoad.length;t++){r=e.projsToLoad[t];e.projsLoaded[r]||o.push(r)}e.projsToLoad=[]}return o}function a(t){for(var n=s(t),a=0;a<n.length;a++){var i=n[a],u=qyboot.getProjConfigFromSlnConfig(t.config,i);u&&r(u);p++;e(i,function(e){t.projsLoaded[e.proj]=e;0==--p&&o()},u)}}function i(e){if(c[e.path]){var o=c[e.path];if("toload"==o.status)"sln_all"==e.type?o.type="sln_all":e.projsToLoad.length>0&&(o.projsToLoad=o.projsToLoad.concat(e.projsToLoad));else{if("sln_all"==o.type)return;if("sln_all"==e.type){o.type="sln_all";a(o)}else if(e.projsToLoad.length>0){o.projsToLoad=o.projsToLoad.concat(e.projsToLoad);a(o)}}}else{c[e.path]=e;if(e.config){r(e.config);a(e)}else n(e)}}function u(e){var o=qyboot.analyzePath(e);if(o)if(qyboot.is_webapp)switch(o.type){case"proj":t(o);return;case"sln_proj":case"sln_all":i(o);return}else{if(o.config)return;switch(o.type){case"proj":qyboot.bgUpdateProj(o.path);return;case"sln_proj":case"sln_all":qyboot.bgUpdateSln(o.path,null,"sln_all"==o.type?"all":o.projsToLoad);return}}}var l,c={},d=0,p=0;qyboot.analyzePath=function(e){if(e instanceof Array){var o=e[0],t=qyboot.getFromLS(qyboot.SLN(o));if(!e[1])return{type:"sln_all",path:o,config:t,status:t?"exist":"toload",projsLoaded:{}};for(var r=e[1],n={type:"sln_proj",path:o,config:t,status:t?"exist":"toload",projsLoaded:{},projsToLoad:[]},s=0;s<r.length;s++){var a=o+"/"+r[s];qyboot.getFromLS(qyboot.PROJ(a))||n.projsToLoad.push(a)}return n}if(!e||e.split("/").length<2)return null;var i=qyboot.dirname(e),u=qyboot.dirname(i);if(u&&"debug"!=u&&"beta"!=u&&"public"!=u){t=qyboot.getFromLS(qyboot.SLN(i));var l=qyboot.getFromLS(qyboot.PROJ(e));return{type:"sln_proj",path:i,config:t,status:t?"exist":"toload",projsLoaded:{},projsToLoad:l?[]:[e]}}if(/_sln$/.test(e)){t=qyboot.getFromLS(qyboot.SLN(e));return{type:"sln_all",path:e,config:t,status:t?"exist":"toload",projsLoaded:{}}}return{type:"proj",path:e,config:qyboot.getFromLS(qyboot.PROJ(e)),status:t?"exist":"toload"}};qyboot.preload=function(e,t){l=t;for(var r=0;r<e.length;r++)u(e[r]);0==p&&o()}}();!function(){function e(e){if(e.origin==m){var o=e.data.msg,t=e.data.data,r=b[o];if(r)for(var n=0;n<r.length;n++)r[n](t)}}function o(){var e="";for(var o in q){var t=q[o];t&&t.msg&&(e+=t.msg+"\n")}return e}var t=qyboot.setCookie=function(e,o,t){var r="";if(t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);r="; expires="+n.toGMTString()}document.cookie=e+"="+escape(o)+r+";path=/"},r=function(e,o,t){var r=new Date;r.setTime(r.getTime()+1e3*t);var n="; expires="+r.toGMTString();document.cookie=e+"="+escape(o)+n+";path=/"},n=qyboot.eraseCookie=function(e){t(e,"",-1)},s=(qyboot.getCookie=function(e){var o=s();return e in o?o[e]:null},qyboot.getCookies=function(){var e,o,t,r=document.cookie.split(";"),n=r.length,s={};for(e=0;n>e;e++){o=r[e].substr(0,r[e].indexOf("="));t=r[e].substr(r[e].indexOf("=")+1);o=o.replace(/^\s+|\s+$/g,"");s[o]=unescape(t)}return s}),a="qyrememberaccount",i="qyuseremail",u="qyusertype",l="qyd"+qyboot.getCookieSuffix(),c="qyu"+qyboot.getCookieSuffix(),d="qys"+qyboot.getCookieSuffix(),p="qycv";qyboot.setCaptcha=function(e){r(p,e,60)};qyboot.saveEmail=function(e){if(e){qyboot.setLSItem(i,e);return qyremote.saveEmail(e)}window.localStorage.removeItem(i)};qyboot.resetEmail=function(e){var o=qyremote.saveEmail(e);if(o.success){qyboot.setLSItem(i,e);qyboot.CurrentUser&&(qyboot.CurrentUser.email=e)}else console.log(o.result);return o};qyboot.getEmail=function(){return qyboot.getLSItem(i)};qyboot.removeEmail=function(){window.localStorage.removeItem(i)};qyboot.saveType=function(e){qyboot.setLSItem(u,e)};qyboot.getType=function(){return qyboot.getLSItem(u)};qyboot.removeType=function(){window.localStorage.removeItem(u)};qyboot.rememberAccount=function(e){e?qyboot.setLSItem(a,"rem"):window.localStorage.removeItem(a)};var y=qyboot.eraseSessionId=function(){n(d)};qyboot.eraseUserId=function(){n(l);n(c);y()};qyboot.getWeiXinUser=function(){if(qyboot.weixinUser)return qyboot.weixinUser;var e=/code=([0-9a-zA-Z]+)/.exec(window.location.href);if(e){var o=qyremote.getWeiXinUserInfo(e[1]);if(o.success)try{var t=JSON.parse(o.result);qyboot.weixinUser={nickname:t.nickname,headimgurl:t.headimgurl};qyboot._completeWeixinUser=t;return qyboot.weixinUser}catch(r){}}};Object.defineProperties(window,{weixin_nickname:{get:function(){var e=qyboot.getWeiXinUser();return e&&e.nickname}},weixin_headimgurl:{get:function(){var e=qyboot.getWeiXinUser();return e&&e.headimgurl}}});qyboot.getCurrentUser=function(e){if(qyboot.CurrentUser){if(!e)return qyboot.CurrentUser;if(qyboot.CurrentUser.verified)return qyboot.CurrentUser}var o=s(),t={logindomain:o[l],userid:o[c],sessionid:o[d],email:qyboot.getEmail(),type:qyboot.getType(),rememberAccount:qyboot.getLSItem(a)?!0:!1,verified:!1};if(e&&t.logindomain&&t.userid){var r=qyremote.verifySession();if(r.success&&0!=r.result){t.verified=!0;t.type=r.result;qyboot.saveType(t.type);"qiyun"==t.logindomain&&qyboot.addTrustedDomain(t.userid)}else{y();t.verified=!1}}qyboot.CurrentUser=t;return t};var f=navigator.userAgent;qyboot.is_opera=/opera/i.test(f);qyboot.is_webkit=!qyboot.is_opera&&/webkit/i.test(f);qyboot.is_mobile=qyboot.is_webkit&&/mobile/i.test(f);qyboot.is_ios=qyboot.is_webkit&&qyboot.is_mobile&&/(ipod|iphone|ipad)/i.test(f);qyboot.is_ie=/msie/i.test(f)&&!qyboot.is_opera&&!/mac_powerpc/i.test(f);qyboot.is_ie5=qyboot.is_ie&&/msie 5\.[^5]/i.test(f);qyboot.is_ie6=qyboot.is_ie&&/msie 6/i.test(f);qyboot.is_ie7=qyboot.is_ie&&/msie 7/i.test(f);qyboot.is_ie8=qyboot.is_ie&&/msie 8/i.test(f);qyboot.ie_box_model=qyboot.is_ie&&document.compatMode&&"BackCompat"==document.compatMode;qyboot.is_mac_ie=/msie.*mac/i.test(f);qyboot.is_khtml=/Konqueror|Safari|KHTML/i.test(f);qyboot.is_safari=/Safari/i.test(f);qyboot.is_safari3=qyboot.is_safari&&/Version\/3/i.test(f);qyboot.is_konqueror=qyboot.is_khtml&&!qyboot.is_safari3;qyboot.is_gecko=/gecko/i.test(f)&&!qyboot.is_khtml&&!qyboot.is_opera&&!qyboot.is_ie;qyboot.is_chrome=/Chrome/i.test(f);qyboot.is_w3=!qyboot.is_ie,qyboot.is_macintosh=/Macintosh/i.test(f);var g={},m=qyboot.getBaseURI().replace(/\/$/,"");qyboot.postMessage=function(e,o,t){var r=g[e];r&&r.postMessage&&r.postMessage({msg:o,data:t},m)};var b={};qyboot.addMsgHandler=function(e,o){b[e]?b[e].push(o):b[e]=[o]};qyboot.removeMsgHandler=function(e,o){if(o){if(b[e]){var t=b[e],r=t.indexOf(o);r>=0&&t.splice(r,1)}}else e?delete b[e]:b={}};window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e);var q={};qyboot.cancelConfirmLeave=function(e){null!=e||(e="default");delete q[e]};qyboot.confirmLeave=function(e,o){if(null==o){o=e;e="default"}q[e]&&q[e].msg?q[e].msg+="\n"+o:q[e]={msg:o}};window.onbeforeunload=function(e){e||(e=window.event);var t=o();if(""==t)return null;e.cancelBubble=!0;e.returnValue=t;if(e.stopPropagation){e.stopPropagation();e.preventDefault()}return t};var h=!0;qyboot.confirm_logout=function(e){h=e};window.onunload=function(){return}}();!function(){function e(e,o){return{synctime:o||qyboot.getCurrentUTCTime(),modified:!1,patches:null,encrypted:!e}}function o(e){return{content:e,synctime:qyboot.getCurrentUTCTime(),modified:!1}}qyboot.getCurrentUTCTime=function(){var e=new Date,o=e.getUTCFullYear(),t=e.getUTCMonth()+1,r=e.getUTCDate(),n=e.getUTCHours(),s=e.getUTCMinutes(),a=e.getUTCSeconds();return[o,t,r,n,s,a]};var t=qyboot.getTimeTuple=function(e){return"string"==typeof e?e:qyboot.Bert.tuple(qyboot.Bert.tuple(e[0],e[1],e[2]),qyboot.Bert.tuple(e[3],e[4],e[5]))},r=qyboot.getItem=function(e,o,t){var r=qyboot.getLocalStoragePath(e,o,t),n=qyboot.getLSItem(r);if(!n)return n;if(t)return n;try{return JSON.parse(n)}catch(s){window.localStorage.removeItem(r);return void 0}},n=qyboot.setItem=function(e,o,t,r,n){var s=qyboot.getLocalStoragePath(o,t,r),a=r?e:JSON.stringify(e);qyboot.setLSItem(s,a);return!0};qyboot.removeItem=function(e,o,t){var r=qyboot.getLocalStoragePath(e,o,t);window.localStorage.removeItem(r);return!0};qyboot.clearModule=function(e){for(var o=new RegExp("/(dev|deployed|debug|trash|beta)/"+e,"i"),t=window.localStorage.length,r=new Array,n=0;t>n;n++){var s=window.localStorage.key(n);o.test(s)&&r.push(s)}var a=r.length;for(n=0;a>n;n++){s=r[n];window.localStorage.removeItem(s)}return a};qyboot.saveFileItem=function(o,t,r,s){n(r,o,t,!0,s);var a=qyremote.uploadFile(o,t,r);if(a.success){var i=a.result,u=e(s,i);n(u,o,t);return i}throw"upload file to "+o+" "+t+"failed"};var s=qyboot.getFileItem=function(o,t,s,a){var i=qyboot.mapPath(o,t);o=i.PositionType;t=i.Path;var u=r(o,t,s);if(void 0!=u)return u;var l,c;if("deployed"==o)l=qyboot.getRemoteFile(t);else if("dev"==o){var d=qyremote.downloadFileWithMT(o,t);if(!d.success)throw"downloading file failed:"+d.result;c=d.result.substring(0,6);l=d.result.substring(6)}else l=qyboot.getRemoteFile(o+"/"+t);u=e(a,c);n(u,o,t);n(l,o,t,!0,a);return s?l:u},a=qyboot.updateFolderItem=function(e,t){var r=qyboot.mapPath(e,t);e=r.PositionType;t=r.Path;var s=qyremote.expandFolder(e,t);if(s.success){var a=o(s.result);n(a,e,t);return a}throw"expanding folder failed with "+s.result};qyboot.getFolderItem=function(e,o){var t=qyboot.mapPath(e,o);e=t.PositionType;o=t.Path;var n=r(e,o);return n?n:a(e,o)};qyboot.updateFileItem=function(o,a,i,u){var l=qyboot.mapPath(o,a);o=l.PositionType;a=l.Path;var c=r(o,a,i),d=r(o,a);if(!c||!d){qyboot.removeItem(o,a,i);c=s(o,a,i,u);return{updated:!0,item:c}}if(!window.navigator.onLine)return{updated:!1,item:c};var p=d.synctime,y=qyremote.downloadIfOldWithMT(o,a,t(p));if(y.success){if("//%%not_modified%%"==y.result)return{updated:!1,item:c};var f=y.result.substring(0,6),g=y.result.substring(6);c=e(u,f);n(c,o,a);n(g,o,a,!0,u);return{updated:!0,item:i?g:c}}console.info("update file item failed with "+y.result);console.info("using local version");return{updated:!1,item:c}}}();!function(){var e="QYLOCALE",o=qyboot.getDefaultLocaleName=function(){var o=window.localStorage.getItem(e);if(o)return o;var t=navigator.language&&r(navigator.language);return t||"en-US"},t={English:"en-US","en-US":"en-US",en_US:"en-US","英文":"en-US",Chinese:"zh-CN","zh-CN":"zh-CN",zh_CN:"zh-CN","中文":"zh-CN"},r=qyboot.mapLocaleName=function(e){return t[e]},n=o();qyboot.switchLocale=function(o){var t=r(o);if(n==t)return!1;n=t;window.localStorage.setItem(e,t);return!0};qyboot.clearDefaultLocaleName=function(){var o=window.localStorage.getItem(e);window.localStorage.removeItem(e);return o};var s=qyboot.getCurrentLocaleName=function(){return n};qyboot.qyLocale=function(){var e={};this.addLocale=function(o,t){o in e?e[o]=qyboot.mergeObj(e[o],t):e[o]=t};this.get=function(o){var t=e[s()];if(!t)return o;var r=t[o];if(!r)return o;if("function"==typeof r&&arguments.length>1){var n=Array.prototype.slice.call(arguments,1);return r.apply(this,n)}return r}};window.DEFINE_LOCALE=function(e,o){var t=qyboot.getCurrentNameSpace();t.Locale||(t.Locale=new qyboot.qyLocale);t.Locale.addLocale(r(e),o)};qyboot.addBootLocale=function(e,o){qyboot.Locale||(qyboot.Locale=new qyboot.qyLocale);qyboot.Locale.addLocale(r(e),o)};qyboot.getSystemTime=function(e){var o=new Date;if(!e){var t=qyremote.getSystemTime();t.success&&t.result&&o.setTime(1e9*t.result[0]+1e3*t.result[1]+t.result[2]/1e3)}return o}}();!function(){function e(e){var o,t=new XMLHttpRequest;o=e&&e.url?e.url:qyboot.getBaseURI()+"qyrpc";e&&e.extend&&(o+="/"+e.extend);e&&e.query&&(o+=(e.isJson?"/?json=":"/?args=")+e.query);var r=e&&e.action||"POST",n=e&&e.async||!1;t.open(r,o,n);return t}function o(e){return escape(e).replace(/\+/g,"%2B").replace(/%20/g,"+").replace(/\*/g,"%2A").replace(/\//g,"%2F").replace(/@/g,"%40")}function t(t,r,n,s,u){defaultShowMessage(qyboot.Locale.get("loading..."),"Busy");n||(n=[]);var l=o(a(r,n,t.domainApp,s)),c=e({query:l,isJson:s});c.setRequestHeader("Content-Type","text/plain;charset=UTF-8");t.overrideMimeType&&c.overrideMimeType(t.overrideMimeType);c.send(u);clearMessage();if(4==c.readyState){var d,p=200==c.status;if(p&&t.return_plain)d=c.responseText;else{var y=i(c.responseText,s);d=y?y.result:null}var f={status:c.status,readyState:c.readyState,success:p,result:d};p||"please login first"!=d||showQyLogin();return f}return{success:!1,result:"readyState is not success",readyState:c.readyState,state:c.status}}function r(t,r,n,s,u,l){defaultShowMessage(qyboot.Locale.get("loading..."),"Busy");s||(s=[]);var c=o(a(n,s,r.domainApp,u)),d=e({query:c,async:!0,isJson:u});d.setRequestHeader("Content-Type","text/plain;charset=UTF-8");r.overrideMimeType&&d.overrideMimeType(r.overrideMimeType);d.onreadystatechange=function(){if(4==d.readyState){clearMessage();d.onreadystatechange=function(){};var e=200==d.status,o=e&&r.return_plain?d.responseText:i(d.responseText,u).result,n={status:d.status,readyState:d.readyState,success:e,result:o};e||"please login first"!=o||showQyLogin();t(n)}};d.send(l)}function n(e,o,r){var n;if(o.with_content){n=function(){var n=arguments.length,s=arguments[n-1];"string"==typeof s||s instanceof File||(s=r?l+JSON.stringify(s):qyboot.Bert.encode(s));var a=Array.prototype.slice.call(arguments,0,n-1);return t(o,e,a,r,s)};return n}n=function(){var n=Array.prototype.slice.call(arguments,0);return t(o,e,n,r)};return n}function s(e,o,t){var n;if(o.with_content){n=function(){if("function"==typeof arguments[0]){var n=arguments[0],s=arguments.length,a=arguments[s-1];"string"==typeof a||a instanceof File||(a=t?l+JSON.stringify(a):qyboot.Bert.encode(a));var i=Array.prototype.slice.call(arguments,1,s-1);r(n,o,e,i,t,a)}else{s=arguments.length;n=arguments[s-1];if("function"!=typeof n)throw"the last argument should be a function";a=arguments[s-2];"string"==typeof a||a instanceof File||(a=t?l+JSON.stringify(a):qyboot.Bert.encode(a));i=Array.prototype.slice.call(arguments,0,s-2);r(n,o,e,i,t,a)}};return n}n=function(){if("function"==typeof arguments[0]){var n=arguments[0],s=Array.prototype.slice.call(arguments,1);r(n,o,e,s,t)}else{var a=arguments.length;n=arguments[a-1];if("function"!=typeof n)throw"the last argument should be a function";s=Array.prototype.slice.call(arguments,0,a-1);r(n,o,e,s,t)}};return n}var a=qyboot.g_encode=function(e,o,t,r){var n={m:e,a:o},s=t?t:"qiyun/main";"qiyun/main"!=s&&(n.da=s);var a=r?JSON.stringify(n):qyboot.Bert.encode(n);return a},i=qyboot.g_decode=function(e,o){var t;if(!o){t=qyboot.Bert.decode(e);t.result=qyboot.Bert.g_decode(t.result);return t}try{t=JSON.parse(e);return t}catch(r){console.log("decode failed "+r);return null}},u={downloadFile:{params:"(PositionType,Path)",return_plain:!0,returns:"ok"},downloadBin:{remote:"downloadFile",params:"(PositionType,Path)",return_plain:!0,overrideMimeType:"text/plain; charset=x-user-defined",returns:"ok"},downloadFileWithMT:{params:"(PositionType,Path)",return_plain:!0,returns:"ok"},downloadIfOld:{params:"(PositionType,Path,DateTimeTuple)",return_plain:!0,returns:'if success, means downloads a new file. with result="//%%not_modified%%" means not changed'},downloadIfOldWithMT:{params:"(PositionType,Path,DateTimeTuple)",return_plain:!0,returns:'if success, means downloads a new file. with result="//%%not_modified%%" means not changed'},getConfig:{params:"(PositionType,projPath,numstr)",return_plain:!0},getUserConfig:{},updateUserConfig:{},pushProj:{},getFolderMTs:{},getFolderHashes:{},addProjToProjsJs:{},getSystemTime:{},createQRImg:{},getWeiXinSignature:{},getWeiXinUserInfo:{},pullProj:{},reportIssue:{},reportIssueWithImg:{with_content:!0},updateIssue:{},saveAppUserData:{with_content:!0},getAppUserData:{return_plain:!0},syncFolder:{},syncUser:{params:"()"},syncDeploy:{params:"(path)"},uploadFile:{params:"(PositionType,Path,Content)",with_content:!0,returns:"mt"},downloadImg:{},copyFile:{params:"(SourcePos,SourcePath,TargetPos,TargetPath)",returns:"ok"},applyTheme:{params:"(ProjPath,ThemeFile)",returns:"ok"},copyFolder:{params:"(SourcePos,SourcePath,TargetPos,TargetPath)",returns:"ok"},moveFile:{params:"(SourcePos,SourcePath,TargetPos,TargetPath)",returns:"ok"},makeFolder:{params:"(PositionType,Path)",returns:"ok"},expandFolder:{params:"(PositionType,Path)",returns:"{files:[list of filenames],folders:[list of folders]"},remove:{help:"delete either file or folder. if PositionType is dev, it will be \n                 moved to trash. Other types will be removed directly.",params:"(PositionType,Path)",returns:"ok"},rename:{help:"rename either file or folder.",params:"(PositionType,SourcePath,NewName)",returns:"ok"},clearAllTrash:{params:"()",returns:"ok"},getDuration:{},createSln:{params:"(Path)",returns:"ok"},forkSln:{help:"fork solution",params:"(SourcePath,Targetpath)",returns:"Msg"},syncSln:{help:"if sourcepath has new projects, fork them into the targetpath",params:"(SourcePath,Targetpath)",returns:"ok"},getSlnDetails:{help:"get project details in solution",params:"(SlnPath)",returns:"[{proj,result}...]"},getProjDetails:{help:"get project details",params:"(ProjPath)",returns:"[{proj,result}...]"},listSlnDiff:{help:"get project details in both sourcepath and targetpath",params:"(SourcePath,Targetpath)",returns:"[[{proj,result}..],[{proj,result}]]"},listProjDiff:{help:"get project details in both sourcepath and targetpath",params:"(SourcePath,Targetpath)",returns:"[[{proj,result}..],[{proj,result}]]"},pushSln:{help:"push sln",params:"(SourceSlnPath,TargetSlnPath)",returns:"[Msgs]"},pushProj:{help:"push proj",params:"(SourceProjPath,TargetProjPath)",returns:"Msg"},deploySln:{help:"OptionObj can be\nTargetPath:Path to hold the deploy, default is SourcePath\nPositionType:'deployed or debug', default is 'deployed'\nUglify:'none,uglify or uglify_compress' default is none for debug, uglify_compress for deployed\nForceUpdate:'true or false' default is false.",params:"(SourcePath,OptionObj)",returns:"ok"},getProjTemplates:{params:"()",returns:"[proj template names]"},createProj:{params:"(ProjType,Path)",returns:"ok"},createProjsJs:{params:"()",returns:"ok"},createSite:{params:"(Path,SiteHtml,InitVC)",returns:"ok"},createProjWithSln:{params:"(SlnPath,ProjType,ProjName)",returns:"ok"},initVersionControl:{params:"(Path)",returns:"Msg"},deployProj:{params:"(SourcePath,OptionObj)",returns:"ok"},compileRpc:{params:"(SourcePath)",returns:"ok"},createRpcFile:{params:"(user/proj/rpc/file.extension)",returns:"timestamp"},packForDeploy:{params:"(proj path)",returns:"path to download"},packProj:{},packSln:{},createPack:{},uploadProj:{with_content:!0},uploadSln:{with_content:!0},compileDps:{params:"(SourcePath)",returns:"ok"},syncRedirectProj:{params:"(ProjPath1,ProjPath2,OptionObj)",returns:"ok"},forkProj:{params:"(ForkedPath,ForkToPath)",returns:"Msg"},createRedirectProj:{params:"(ForkedPath,ForkToPath)",returns:"Msg"},addProjToWeb:{help:"add proj to projs.config and to hgweb",params:"(Path)",returns:"ok"},removeProjFromWeb:{help:"remove proj from projs.config and from hgweb",params:"(Path)",returns:"ok"},updateProj:{help:"update project to revision. if no RevisionInt update to latest revision",params:"(Path,RevisionInt)",returns:"Msg"},getProjStatus:{help:"get project status on server. if no change msg is empty",params:"(Path)",returns:"Msg"},getProjDiff:{help:"get project diff",params:"(Path,[Rev1,Rev2])",returns:"Msg"},getProjRevision:{help:"get project revision on server.",params:"(Path)",returns:"Revison"},getProjLog:{help:'Revision is either "tip" or a number. returns at most 20 changesets from Revision',params:"(path,Revision)",return_plain:!0,returns:"log"},revertFiles:{help:"revert changes on server.",params:"(Path[,Files])",returns:"Msg"},commitProj:{help:"commit changes on server.",params:"(Path,CommitMsg[,ModifiedFiles,ToAddFiles,ToRemoveFiles])",returns:"Msg"},getAccessableProjs:{params:"(AccessedUserId)"},getHgPassword:{help:"get hg password in email",params:"()",returns:"Msg"},resetHgPassword:{help:"reset and get hg password in email",params:"()",returns:"Msg"},getUserDBs:{params:"(PositionType,UserId)"},isDBCreated:{params:"(PositionType,Path)"},initDB:{params:"(PositionType,Path,InitSqlScript)",with_content:!0},initMainDB:{help:"init userid/main db for user management. It will create user table with userid, password and dasessionid",params:"()"},pauseDB:{params:"(PositionType,Path)"},copyDB:{params:"(SrcPositionType,SrcPath,DestPositionType,DestPath)"},resumeDB:{params:"(PositionType,Path)"},dropDB:{params:"(PositionType,Path)"},attachDB:{params:"(SrcPos,SrcPath,DestPos,DestPath,DBName)"},detachDB:{params:"(Pos,Path,DBName)"},getSchema:{params:"(PositionType,Path)"},execSql:{params:"(PositionType,Path,SqlScript)",with_content:!0},getTotalCount:{},verifySession:{params:"()",help:"verify whether the session is valid"},createCaptcha:{params:"()"},verifyCaptcha:{params:"()"},getDownloadCount:{},getSessionId:{},verifySessionId:{},login:{params:"(domain,userid,password)",returns:"object of user information",help:"if success, a seesion id is set through cookie."},createGuest:{params:"()",returns:"object of user information"},logout:{params:"()",returns:"true/false"},checkDomainExists:{params:"domainname",returns:"true/false"},checkUserNameAvailable:{params:"(userid)",returns:"true/false"},checkEmailAddressAvailable:{params:"(emailaddress)",returns:"true/false"},checkEmailAddressActivated:{params:"(emailaddress)",returns:"true/false"},registerUser:{params:"([email,]userid,password)",returns:"true/false",need_captcha:!0},createUser:{params:"([Userid,password,email)",returns:"ok"},getAllUsers:{returns:"[user1,user2...]"},changePassword:{params:"(oldPassword,newPassowrd)",returns:"ok"},activateUser:{params:"(email)",returns:"ok"},resetPassword:{params:"(userid)",returns:"ok",need_captcha:!0},saveEmail:{params:"emailAddress",returns:"ok"},getModConnectedUsers:{}},l=String.fromCharCode(11)+String.fromCharCode(20)+String.fromCharCode(4)+String.fromCharCode(1);qyboot.set_rpc_commands=function(e,o){if(!o){o=e;e=qyboot}"remote"in e||(e.remote={});"remote_async"in e||(e.remote_async={});"json_remote"in e||(e.json_remote={});"json_remote_async"in e||(e.json_remote_async={});for(var t in o){var r=o[t],a=r.remote||t;/^postContent_/.test(a)&&(r.with_content=!0);e.json_remote[t]=n(a,r,!0);e.json_remote_async[t]=s(a,r,!0);e.remote[t]=e.json_remote[t];e.remote_async[t]=e.json_remote_async[t]}e.rpc_commands_desc=qyboot.mergeObj(e.rpc_commands_desc,o)};qyboot.set_rpc_commands(qyboot,u)}();!function(){function e(e,o){var t=qyboot.SLN(e),r=qyboot.getLatestConfigFile(t);if(!r||!r.content)return qyboot.updateProj(o);try{var n=JSON.parse(r.content);qyboot.g_Updated[e]=n;qyboot.saveToLS(t,r.content);var s=qyboot.getProjConfigFromSlnConfig(n,o);return qyboot.updateProjByConfig(null,s,o)}catch(a){return qyboot.updateProj(o)}}function o(e,o,t){e=/^\//.test(e)?e.substr(1):qyboot.getNameToUse(e);if(!window.QYCOMPILED&&!qyboot.isTrustedDomain(e)){var r=qyboot.getDomain(e);if(!qyboot.isTrustedDomain(r)){if(!confirm(qyboot.Locale.get("confirm_using_code")(e)))throw qyboot.Locale.get("stop using code from ")+e;confirm(qyboot.Locale.get("confirm_adding_trusted_user")(r))?qyboot.addTrustedDomain(r):qyboot.addTrustedDomain(e)}}console.info("using "+(t?"webapp ":"")+e);var n=qyboot.getModule(e);if(n)return o?o(n.modexports):n.modexports;var s=null,a=null;s=qyboot.qyUpdateProj(e);if(!s){console.info("no "+e);return null}if(o)qyboot.addOneModule(e,s,a,!0,o,t);else try{var i=qyboot.addOneModule(e,s,a,!0,o,t);return i}catch(u){var l=e+"/proj.config";qyboot.removeItem("deployed",l,!0);throw u}}qyboot.filename=function(e){return e.substring(e.lastIndexOf("/")+1)};qyboot.dirname=function(e){return e.substring(0,e.lastIndexOf("/"))};qyboot.getProjConfigFromSlnConfig=function(e,o){if(!e||!e.projs)return null;for(var t=e.projs,r=t.length,n=qyboot.filename(o),s=0;r>s;s++)if(t[s].path==n)return t[s];return null};qyboot.SLN=function(e){return e+"/sln.config"};qyboot.getLatestConfigFile=function(e,o){if(!o){var t=qyboot.getRemoteFile(e);return t?{updated:!0,content:t}:!1}var r=qyboot.mapPath(e),n=qyremote.downloadIfOld(r.PositionType,r.Path,o);if(n.success)return"//%%not_modified%%"==n.result?{updated:!1}:{updated:!0,content:n.result};console.log("download "+e+" failed.");return!1};qyboot.g_Updated={};var t=(qyboot.updateProj=function(e){if(qyboot.g_Updated[e])return qyboot.g_Updated[e];var o=qyboot.PROJ(e),r=qyboot.getFromLS(o);if(r&&!window.navigator.onLine){qyboot.g_Updated[e]=r;return r}if(r&&"127.0.0.1"!=qyboot.getHostName()){var n=qyboot.mapPath(e);if("qiyun/qyboot"!=n.Path&&"debug"!=n.PositionType&&"beta"!=n.PositionType){qyboot.bgUpdateProj(e);qyboot.g_Updated[e]=r;return r}}var s=r&&r.mt,a=qyboot.getLatestConfigFile(o,s);if(!a||!a.updated){qyboot.g_Updated[e]=r;return r}var i=a.content;if(!i){qyboot.g_Updated[e]=r;return r}var u=JSON.parse(i);return t(r,u,e)},qyboot.updateProjByConfig=function(e,o,t){qyboot.g_Updated[t]=o;if(e&&e.mt==o.mt)return e;for(var r=qyboot.makeMap(e,t),n=qyboot.makeMap(o,t),s=qyboot.getReleaseFiles(o,t),a=s.length,i=qyboot.getReleaseMts(o,t),u=0;a>u;u++){var l=s[u],c=i[u];if(r[l]!=c){var d=t+"/"+l,p=qyboot.getRemoteFile(d);null!=p&&qyboot.saveToLS(d,p)}}if(e){s=qyboot.getReleaseFiles(e,t),a=s.length;i=qyboot.getReleaseMts(e,t);for(u=0;a>u;u++){l=s[u];c=i[u];if(!n[l]){d=t+"/"+l;qyboot.removeFromLS(d)}}}qyboot.saveToLS(qyboot.PROJ(t),o);return o});qyboot.qyUpdateSlnProjs=function(e){for(var o=qyboot.dirname(e),t=qyboot.getSlnUsedProjs(o),r=0;r<t.length;r++){var n=t[r];qyboot.updateProj(n)}qyboot.g_Updated[o]=!0;return qyboot.updateProj(e)};qyboot.qyUpdateProj=function(o){if("127.0.0.1"==qyboot.getHostName())return qyboot.updateProj(o);var t=qyboot.mapPath(o);if("debug"==t.PositionType||"beta"==t.PositionType||"qiyun/qyboot"==t.Path)return qyboot.updateProj(o);if(o in qyboot.g_Updated)return qyboot.g_Updated[o];var r=qyboot.dirname(o),n=qyboot.dirname(r);if(!n||"debug"==n||"beta"==n||"public"==n)return qyboot.updateProj(o);if(r in qyboot.g_Updated)return qyboot.updateProj(o);var s=qyboot.getFromLS(qyboot.SLN(r));if(!s)return e(r,o);qyboot.g_Updated[r]=s;var a=qyboot.getSlnUsedProjs(r),i=a.length;qyboot.bgUpdateSln(r,s,a);for(var u=0;i>u;u++){var l=a[u];qyboot.g_Updated[l]=qyboot.getFromLS(qyboot.PROJ(l))}return o in qyboot.g_Updated?qyboot.g_Updated[o]:qyboot.updateProj(o);var t};qyboot.getSlnUsedProjs=function(e){for(var o,t=qyboot.getLsPath(e),r=new RegExp("^"+t+"/([^/]+)/proj.config$"),n=window.localStorage.length,s=[],a=0;n>a;a++){o=window.localStorage.key(a);var i=r.exec(o);i&&i[1]&&s.push(e+"/"+i[1])}return s};var r={qiyun:!0};qyboot.addTrustedDomain=function(e){r[e]=!0};qyboot.isTrustedDomain=function(e){if(e in r)return!0;var o=qyboot.getCurrentUser();return"qiyun"==o.logindomain?o.userid==e:!1};qyboot.getNameToUse=function(e){var o=qyboot.mapPath(e);if("deployed"==o.PositionType){var t=qyboot.getPrefix();qyboot.getDomainApp()==e&&(e=t+e)}return e};window.using=o}();!function(){qyboot.fc="return qyboot.qyapply(arguments.callee,arguments,this)"}();!function(){function e(e,o){qyboot.setWebapp(e);var t=using(e,o,!0);return t}function o(e){var o=[],t=0,r=e.length;for(t=0;r>t;t++)e[t]&&o.push(e[t]);return o}function t(e,t){for(var r=o(e.split("/")),n=o(t.split("/"));n.length>0&&".."==n[0];){n.shift();r.pop()}var s=r.concat(n).join("/");return s}function r(e,o){return n("../"+e,o)}function n(e,o){var t=qyboot.getCurrentNSName();return s(t,e,o)}function s(e,o,r){var n=t(e,o);return using(n,r)}function a(e){var o=qyboot.getCurrentNSName();if(!o)return null;var t=o.replace(/_css$/,"");return using(t,e)}function i(e){var o=qyboot.getCurrentNSName();if(!o)return null;var t=o+"_css";return using(t,e)}function u(e){var o=qyboot.getCurrentNSName();if(!o)return null;var t=o.split("/");t.pop();t.push(t[t.length-1].replace(/_sln(.)*/,"_sln")+"_css");var r=t.join("/");return using(r,e)}function l(e,o,t){return using("public/"+e,o,t)}function c(e,o,t){return using("debug/"+e,o,t)}function d(e){return p("../"+e)}function p(e){var o=qyboot.getCurrentNSName(),r=t(o,e);return y(r)}function y(e){e=/^\//.test(e)?e.substr(1):qyboot.getNameToUse(e);console.info("using_rpc "+e);var o=P(e);if(o)return o.modexports;var t=e+"/@rpc";o=P(t);if(o)return o.modexports;var r=qyboot.getRemoteFile(e+"/proj.config");
if(null==r)throw e+"not found";for(var n=JSON.parse(r).modrelease,s="",a=0;a<n.length;a++){var i=n[a];if(/^rpc\//.test(i)){var u=qyboot.getRemoteFile(e+"/"+i);u&&(s+="\n"+u)}}var l=s;qyboot.pushNSName(t);qyboot.pushJsName(_);try{q(t,_,l)}catch(c){console.error("using_rpc "+e+" with error:"+c)}qyboot.popJsName();qyboot.popNSName();return w[t].modexports}function f(e,o){if(o){var t=0,r=o.length;for(t=0;r>t;t++)s(e,"../"+o[t])}}function g(){var e,o=[],t=arguments.length;for(e=0;t>e;e++)arguments[e]&&(o=o.concat(arguments[e]));return o}function m(e,o,t){var r=o.length,n=0;qyboot.pushNSName(e);for(var s=0;r>s;s++){var a=o[s],i=e+"/"+a;!function(s){qyboot.getRemoteFile_async(i,function(i,u){try{var l=i,c=fileItem();setItem(c,"deployed",l);setItem(u,"deployed",l,!0,c.encrypted);if(n==s){for(;r>n&&c;){h(e,a);a=o[++n];c=getItem("deployed",e+"/"+a)}if(n==r){var d=using(e);t(d);qyboot.popNSName()}}}catch(p){qyboot.removeItem("deployed",e+"/proj.config",!0);throw p}})}(s)}}function b(e){var o=document.createElement("script");o.type="text/javascript";o.src=e;"undefined"!=typeof o&&document.getElementsByTagName("head")[0].appendChild(o)}function q(e,o,t){if(t){var r=e+"/"+o;try{if(qyboot.isqyc(t)){S(o+" enc");qyboot.qyload(t)}else{qyboot.isxor(t)&&(t=qyboot.dexor(t));if(/^debug\//.test(e)){S(o+" dbg");qyboot.evalClean(t+"\n//@ sourceURL="+r,r)}else{S(o);qyboot.evalClean_wrap(t,r)}}}catch(n){throw n}S(o+" done")}}function h(e,o,t){if(!o){o=e;e=qyboot.getCurrentNSName()}var r=P(e);if(!r){r=using(e);if(!r)return null}if(o in r.jsfileObjs)return r.jsfileObjs[o].exports;qyboot.pushJsName(o);if(t){r.jsfileObjs[o]={exports:{}};var n=qyboot.getBaseURI()+e+"/";b(n+o)}else{var s=e+"/"+o,a=qyboot.mapPath(s),i=qyboot.getFileItem(a.PositionType,a.Path,!0);r.jsfileObjs[o]={exports:{}};try{q(e,o,i)}catch(u){qyboot.removeFromLS(s);i=qyboot.getFileItem(a.PositionType,a.Path,!0);console.log("reload "+s);try{q(e,o,i)}catch(u){console.error(s+" with error:"+u);showMessage(s+" error:"+u)}}}qyboot.popJsName();return r.jsfileObjs[o].exports}function v(){var e=qyboot.getDomainApp();if("http"==qyboot.getProto())return e;""==e?e="qiyun/main":e.indexOf("/")<0&&(e+="/main");return e}var w=qyboot.g_Modules={},P=(qyboot.g_CssFiles={},qyboot.getModule=function(e){return e in w?w[e]:null});qyboot.getDomain=function(e){var o=qyboot.mapPath(e),t=o.Path.split("/")[0];return t};qyboot.setWebapp=function(e){var o=qyboot.getDomain(e);qyboot.addTrustedDomain(o);var t=/^(debug|beta)\//.exec(qyboot.getPrefix());window.document.title=(t?t[0]:"")+qyboot.filename(e)};qyboot.namespace_relative_using=s;window.using_root_slncss=function(e,o){var t=qyboot.getCurrentNSName();if(!t)return null;var r=qyboot.mapPath(t),n=r.Path.split("/");n.pop();"deployed"==r.PositionType?n[0]=o:n[0]=r.PositionType+"/"+e;var s=n.pop();n.push(s.replace(/_sln(.)*/,"_sln")+"_css");var a=n.join("/");return using(a)};window.using_qy_slncss=function(){return using_root_slncss("shbzhumg_qiyun/qycss","qiyun/qycss")};window.using_root_projcss=function(e,o){var t=qyboot.getCurrentNSName();if(!t)return null;var r=qyboot.mapPath(t),n=r.Path.split("/");"deployed"==r.PositionType?n[0]=o:n[0]=r.PositionType+"/"+e;var s=n.pop();n.push(s.replace(/(_dev)?$/,"_css"));var a=n.join("/");return using(a)};window.using_qy_projcss=function(){return using_root_projcss("shbzhumg_qiyun/qycss","qiyun/qycss")};var _="proj.rpc.client.js",S=qyboot.qydebug=qyboot.debug?function(e){console.log(e)}:function(){},j=qyboot.createDeployList=function(e,o){for(var t=["cssfiles","locales","rpcclient","jsfiles"],r=[],n=t.length,s=0;n>s;s++)r=g(r,e[o+t[s]]);return r};qyboot.addOneModule=function(e,o,t,r,n,s){f(e,o.modinsidedeps);var a=/^debug\//.test(e),i=!a&&o.moddeploy?o.moddeploy:j(o,"mod"),u=!a&&o.webappdeploy?o.webappdeploy:j(o,"webapp"),l=o.modrelease,c=o.webapprelease;l||(l=i);c||(c=u);if(s){f(e,o.webappinsidedeps);l=l.concat(c)}if(r||!n){qyboot.pushNSName(e,s);var d,p,y=l.length;for(p=0;y>p;p++){d=l[p];d.filename&&(d=d.filename);/.css$/.test(d)?qyboot.addCssFile(e,d,t,r):/.js$/.test(d)&&h(e,d,t,r)}qyboot.popNSName();return w[e].modexports}m(e,o.modjsfiles,n)};var T=qyboot.exports_desc={require:{value:h,params:"(modName,jsfile)",returns:"exportObj",help:"get exports from jsfile."},using:{value:using,params:"(modName)",returns:"modexportObj",help:"load module and all depending modules"},getModules:{value:function(){return w},params:"()",returns:"[modobjs]",help:"get all loaded modules"}};qyboot.set_export_desc(T);window.using=using;window.using_public=l;window.using_debug=c;window.using_webapp=e;window.using_rpc=y;window.inside_using=r;window.inside_using_css=i;window.inside_using_code=a;window.inside_using_slncss=u;window.inside_using_rpc=d;window.relative_using=n;window.relative_using_rpc=p;window.qyjsonremote=qyboot.json_remote;window.qyjsonremote_async=qyboot.json_remote_async;window.qybertremote=qyboot.remote;window.qybertremote_async=qyboot.remote_async;window.qyremote=qyjsonremote;window.qyremote_async=qyjsonremote_async;window.qyremote.rpc_commands_desc=qyboot.rpc_commands_desc;window.SelfModName=v}();!function(){function e(){var e=t.length;return e>0?t[e-1]:null}var o,t=[];qyboot.pushNameSpace=function(e){if(e instanceof Object){var r=t.push(e);o=e;return r}};qyboot.popNameSpace=function(){var r=t.pop();o=e();return r};qyboot.getCurrentNameSpace=function(){return o};qyboot.getCurrentModName=function(){return o?o.modName:null};var r=[],n=[];qyboot.addModObjToGlobal=function(e){var o={modName:e,modexports:s(e),jsfileObjs:{},cssfiles:{}};qyboot.g_Modules[e]=o;return o};qyboot.pushNSName=function(e,o){r.push(e);var t=qyboot.addModObjToGlobal(e);o&&(window.SelfMod=t.modexports)};qyboot.getCurrentNSName=function(){return 0==r.length?qyboot.getPrefix()+SelfModName():r[r.length-1]};qyboot.popNSName=function(){r.pop()};qyboot.pushJsName=function(e){n.push(e)};qyboot.getCurrentJsName=function(){return 0==n.legth?null:n[n.length-1]};qyboot.popJsName=function(){n.pop()};var s=function(e){var o={modName:e,Locale:new qyboot.qyLocale,inside_using:function(o,t){return qyboot.namespace_relative_using(e,"../"+o,t)},relative_using:function(o,t){return qyboot.namespace_relative_using(e,o,t)},confirmLeave:function(o){return o?qyboot.confirmLeave(e,o):qyboot.cancelConfirmLeave(e)},addRemoteFun:function(e){var o={};o[e]={};qyboot.set_rpc_commands(this,o)}};o.ws_onReply=function(e){o.ws_Result=e};o.ws_onError=function(e){console.log("websocket error:"+JSON.stringify(e));o.ws_Result=e};return o}}();!function(){function e(){var e="http"==qyboot.getProto()?"ws":"wss";this.beforeOpenMsg=[];this.wsAddress=e+"://"+qyboot.getHostAddress()+"/qyws/qiyun/main";var t=window.WebSocket||window.MozWebSocket;if(t){this.websocket=new t(this.wsAddress);this.websocket.onopen=this.onopen.bind(this);this.websocket.onclose=this.onclose.bind(this);this.websocket.onmessage=this.onmessage.bind(this);this.websocket.onerror=this.onerror.bind(this);this.connectedUsers={};var r=this;this.addEventListener("connected",function(e){e=o(e);e==r.userName||r.connectedUsers[e]?r.connectedUsers[e]++:r.connectedUsers[e]=1});this.addEventListener("closed",function(e){e=o(e);e!=r.userName&&r.connectedUsers[e]&&(--r.connectedUsers[e]||delete r.connectedUsers[e])})}else console.log("websocket is not supported in this browser.")}function o(e){e&&e.replace&&(e=e.replace(/^qiyun\//,""));return e}window.QyWebSocket=e;e.prototype.getConnectedUsers=function(e){e&&this.syncConnectedUsers();var o=[];for(var t in this.connectedUsers)this.connectedUsers[t]&&o.push(t);return o};e.prototype.syncConnectedUsers=function(){var e=qyremote.getModConnectedUsers(this.domainApp);if(e.success){this.connectedUsers={};for(var t=e.result,r=0;r<t.length;r++){var n=o(t[r]);n!=this.userName&&(this.connectedUsers[n]?this.connectedUsers[n]++:this.connectedUsers[n]=1)}}};e.prototype.connect=function(e){this.userName=qyboot.getCurrentUser().userid;this.domainApp=e||qyboot.getDomainApp();this.syncConnectedUsers();this.send_Internal("connect");this.dispatchEvent("connect")};e.prototype.sendMsg=function(e,o,t){o?o instanceof Array||(o=[o]):o=[];for(var r=0;r<o.length;r++)o[r]=JSON.stringify(o[r]);t||(t="*ALL*");o.unshift(e,t);this.send_Internal("send",o)};e.prototype.send_Internal=function(e,o){if(this.websocket){o?o instanceof Array||(o=[o]):o=[];o.unshift(this.domainApp||qyboot.getDomainApp());var t={method:e,args:o},r=JSON.stringify(t);1==this.websocket.readyState?this.websocket.send(r):this.beforeOpenMsg.push(r)}};e.prototype.close=function(){this.websocket&&this.websocket.close()};e.prototype.onopen=function(){console.log("websocket opened");this.dispatchEvent("open");if(this.websocket){for(var e=0;e<this.beforeOpenMsg.length;e++)this.websocket.send(this.beforeOpenMsg[e]);this.beforeOpenMsg=[]}};e.prototype.onmessage=function(e){if(e.data){for(var o=JSON.parse(e.data),t=o.args||o.a,r=0;r<t.length;r++)try{t[r]=JSON.parse(t[r])}catch(n){console.log(t[r])}this.from=o.from;this.dispatchEvent(o.method||o.m,o.args||o.a)}};e.prototype.onclose=function(){this.dispatchEvent("close");this.websocket=null;console.log("websocket closed")};e.prototype.onerror=function(e){console.log("websocket error:",e)};e.prototype.addEventListener=function(e,o){this.eventHandlers||(this.eventHandlers={});this.eventHandlers[e]||(this.eventHandlers[e]=[]);var t=this.eventHandlers[e];t.indexOf(o)<0&&t.push(o)};e.prototype.dispatchEvent=function(e,o){if(this.eventHandlers&&this.eventHandlers[e])for(var t=this.eventHandlers[e],r=0;r<t.length;r++)t[r].apply(this,o)}}();!function(){if("undefined"!=typeof process){window.location.href.search("/debug/")<0&&require("nw.gui").Window.get().maximize();var e=require("fs"),o=require("path"),t=require("qyutil"),r=o.join(process.cwd(),"log"),n=o.join(r,"client_log.txt");t.ensureDir(r);console.log=function(){e.appendFileSync(n,t.getLogLine(arguments)+"\n")};console.info=console.log;console.error=console.log}}();!function(){qyboot.addCssFile=function(e,o){var t=e+"/"+o;if(!(t in qyboot.g_CssFiles)){qyboot.debug&&qyboot.qydebug(o);var r=qyboot.mapPath(t),n=qyboot.getFileItem(r.PositionType,r.Path,!0);qyboot.addCssFileContent(e+"/"+o,n);qyboot.g_CssFiles[t]=e;qyboot.qydebug(o+" done")}};qyboot.addCssFileContent=function(e,o){if(!o)return null;var t=qyboot.getBaseURI()+e;t=t.substring(0,t.lastIndexOf("/")+1);var r=o.replace(/url\("([^/])/g,'url("'+t+"$1");r=r.replace(/url\('([^/])/g,"url('"+t+"$1");r=r.replace(/url\(([^'"/][^'")]+)\)/g,"url('"+t+"$1')");r="/*"+e+"*/\n"+r;var n=document.createElement("style");n.type="text/css";if(n.styleSheet)n.styleSheet.cssText=r;else{var s=document.createTextNode(r);n.appendChild(s)}var a=document.getElementsByTagName("head")[0];a.appendChild(n);return n};qyboot.applyCss=function(e,o){qyboot.addCssFileContent(e,o)}}();!function(){function e(e){return e.match(/\/qybase$/)?!0:!1}qyboot.isqybase=function(o){return o&&o.modName?e(o.modName):!1};qyboot.forbidLoadDefaultBase=function(){qyboot.baseLoaded=!0};window.DEFINE_NAMESPACE=function(){var o,t,r,n=!1;switch(arguments.length){case 1:r=arguments[0];break;case 2:o=arguments[0];r=arguments[1];n=!0;break;case 3:o=arguments[0];t=arguments[1];r=arguments[2];n=!0;break;default:return null}if(n)qyboot.pushNSName(o);else{var s=qyboot.getCurrentNSName();s&&(o=s)}if(!t){var a=qyboot.getCurrentJsName();a&&(t=a)}if(!qyboot.baseLoaded){e(o)||using("qiyun/qybase");qyboot.baseLoaded=!0}var i=qyboot.getModule(o)||qyboot.addModObjToGlobal(o),u=i.modexports;i.jsfileObjs[t]={exports:u};qyboot.pushNameSpace(u);r(u);n&&qyboot.popNSName();return qyboot.popNameSpace()}}();!function(){function e(e){var o=qyboot.getCurrentUser();return o&&o.userid?o.userid+"/"+e.replace(/\//,"_")+".config":null}qyboot.getServerFilePath=function(e){return qyboot.getBaseURI()+"file/"+qyboot.getPrefix()+SelfModName()+"/"+e};qyboot.getUserProjs=function(e){if(!e){var o=qyboot.getCurrentUser();if(!o||!o.userid)return null;e=o.userid}var t=qyboot.updateFileItem("dev",e+"/projs.js",!0);return t&&t.item?JSON.parse(t.item):null};qyboot.getUserProjsByType=function(e,o){var t=[],r=qyboot.getUserProjs(e);if(!r||!r.projs)return t;for(var n in r.projs){var s=r.projs[n];if(s.type==o){var a=s;a.path=n;t.push(a)}}return t};qyboot.getUserSites=function(e){return qyboot.getUserProjsByType(e,"site")};qyboot.getUserFormApps=function(e){return qyboot.getUserProjsByType(e,"form")};qyboot.getUserDataBeans=function(e){return qyboot.getUserProjsByType(e,"databean")};qyboot.getUserFreeForms=function(e){return qyboot.getUserProjsByType(e,"freeform")};qyboot.getPreference=function(o){var t=e(o);if(!t)return null;try{var r=qyboot.getFileItem("dev",t,!0);return r?JSON.parse(r):{}}catch(n){return{}}};qyboot.savePreference=function(o,t){var r=e(o);if(!r)return null;var n=JSON.stringify(t);return qyboot.saveFileItem("dev",r,n,!0)}}();!function(){function e(){console.log("websocket opened");for(var e=0;e<l.length;e++)i.send(l[e]);l=[]}function o(){for(var e in u){var o=u[e];o.onWsClose&&o.onWsClose()}u={};i=null;console.log("websocket closed")}function t(e){if(e.data){var o=JSON.parse(e.data);if(o.domainApp&&o.method){var t=u[o.domainApp];t&&t[o.method]&&t[o.method].apply(t,o.args)}}}function r(){console.log("websocket closed")}function n(){if(i)return i;if(!c){console.log("websocket is not supported in this browser.");return null}var n="http"==qyboot.getProto()?"ws":"wss",s=n+"://"+qyboot.getHostAddress()+"/qyws/qiyun/main";i=new c(s);i.onopen=e;i.onclose=o;i.onmessage=t;i.onerror=r;return i}function s(e,o){var t=qyboot.getCurrentNSName();return function(){if(!u[e]&&"ws_Connect"!=o)throw"need to call ws_Connect first.";var r=Array.prototype.slice.call(arguments,0),n={method:o,args:r,domainApp:e||"qiyun/main"},s=JSON.stringify(n);qyboot.sendToWs(s);var a=qyboot.getModule(t);a&&a.modexports&&(a.modexports.ws_Result=void 0);"ws_Connect"==o?a&&a.modexports&&(u[e]=a.modexports):"ws_Disconnect"==o&&delete u[e]}}function a(e){e&&(e.parentNode?e.parentNode.removeChild(e):e.style&&(e.style.disply="none"))}var i,u={},l=[],c=window.WebSocket||window.MozWebSocket;qyboot.closeWebSocket=function(){i&&i.close()};qyboot.sendToWs=function(e){(i||n())&&(1==i.readyState?i.send(e):l.push(e))};qyboot.set_ws_remote_commands=function(e,o){if(!o){o=e;e=qyboot}for(var t in o){var r=o[t],n=r.domainApp||"qiyun/main";e[t]=s(n,t)}e.ws_remote_commands_desc=qyboot.mergeObj(e.ws_remote_commands_desc,o)};qyboot.tryCreateGuest=function(){if("https"!=qyboot.getProto()){var e=qyboot.getCurrentUser();if(e.userid&&"qiyun"==e.logindomain)/^Guest_/.test(e.userid)&&qyremote.login("qiyun",e.userid,e.userid);else{qyremote.createGuest();qyboot.rememberAccount(!0)}}};qyboot.removeLoadingImg=function(){var e="QYIDE_Desktop_loading";a(document.getElementById(e));for(var o=document.getElementsByClassName?document.getElementsByClassName(e):[],t=0;t<o.length;t++)a(o[t])};var d={};d.addDependency=function(e,o,t){return goog?goog.addDependency(d.getDepPath(e),o,t):null};d.getDepPath=function(e){return"../../../../"+qyboot.getDebugMode()+qyboot.getDomainApp()+"/"+e};window.qycloud=d}();!function(){qyboot.addBootLocale("en_US",{confirm_logout:function(o){return"You still log in to "+o+". Do you like to logout now?"},confirm_using_code:function(o){return"Using code from "+o+". Are you sure to continue?\nWarning: using code from untrusted user will be dangerous. "},confirm_adding_trusted_user:function(o){return"Add "+o+" to trusted users?"}});qyboot.addBootLocale("zh_CN",{"loading...":"加载中...",confirm_logout:function(o){return"你仍登录在 "+o+"。现在退出？"},confirm_using_code:function(o){return"将使用 "+o+" 的代码。 确认继续?\n警告：使用不被信任的用户代码将会带来危害。"},"stop using code from ":"停止使用",confirm_adding_trusted_user:function(o){return"把 "+o+" 加为受信任用户？"}})}();function genDataforms(e){e=JSON.parse(JSON.stringify(e||{}));for(var n in e)e[n]=genDataform(e[n]);return e}function genDataform(e){if(e instanceof Array){var n={};e.forEach(function(e,t){n[t+1]=e});return n}return e&&e.data}window.qyengine||(window.qyengine={});qyengine.initUtil=function(){!function(){qyengine.merge=function(e,n){var t=null!=e?goog.cloneObject(e):{};if(!n||"object"!=typeof n)return t;for(var r in n)n.hasOwnProperty(r)&&(void 0==t[r]?t[r]=n[r]:t[r]instanceof Array?goog.array.extend(t[r],n[r]):"object"==typeof t[r]&&"object"==typeof n[r]?qyengine.addToObj(t[r],n[r]):t[r]=n[r]);return t};qyengine.addToObj=function(e,n){if(!e||"object"!=typeof e)return n;if(!n||"object"!=typeof n)return e;for(var t in n)n.hasOwnProperty(t)&&(void 0==e[t]||"object"!=typeof e[t]||"object"!=typeof n[t]?e[t]=n[t]:qyengine.addToObj(e[t],n[t]));return e};qyengine.toUpperFirst=function(e){return e&&e[0].toUpperCase()+e.substr(1)};qyengine.toLowerFirst=function(e){return e&&e[0].toLowerCase()+e.substr(1)};qyengine.installFonts=function(e){e||(e=current_game.customFonts);for(var n in e)lime.Label.installFont(n,e[n])};qyengine.makeLabel=function(){var e;e=window.isLime?(new lime.Label).setAnchorPoint(0,0).setFontSize(36).setFontColor("#000").setAlign("center"):new PIXI.Text("");return e};window.getText=function(e,n){if(current_game.texts&&e in current_game.texts){var t=current_game.texts[e],r=qyboot.getDefaultLocaleName();if("string"==typeof t.text)e=t.text;else if(null!=t.text[r])e=t.text[r];else for(var o in t.text){e=t.text[o];break}if(n){var i=t.font instanceof Object?t.font:current_game.fonts[t.font]||{};return{text:e,font:i,size:t.size}}return e}return n?e.font?e:{text:e,font:{}}:null!=e.text?e.text:e};window.current_game||(window.current_game={});window.gmx_||(window.gmx_={});window.current_game.vars_||(window.current_game.vars_={});window.current_game.score||(window.current_game.score=0);window.current_game.lives||(window.current_game.lives=3);window.current_game.health||(window.current_game.health=100);window.current_game.money||(window.current_game.health=0);window.current_game.experience||(window.current_game.experience=0);window.current_game.level||(window.current_game.level=0);window.mouseX=0;window.mouseY=0;window.browser={}}();!function(){qyengine.genProps=function(){var e={};goog.array.forEach(qyengine.resTypes,function(n){var t="Qy"+qyengine.toUpperFirst(n),r=new window[t];e[t]=window[t].qyProps||{};for(var o in r){var i=/^get(.+)/.exec(o);if(i&&"set"+i[1]in r)try{var a=r[o]();e[t][i[1]]={"default":a,help:""}}catch(s){console.log(o,s)}}});return qyremote.uploadFile("deployed",SelfModName()+"/props.js",JSON.stringify(e))}}();!function(){qyengine.isApk=!!window.cordova;qyengine.isApk&&qyboot.ready(function(){document.addEventListener("deviceready",function(){setTimeout(function(){navigator.splashscreen&&navigator.splashscreen.hide()},1e3)},!1)})}();!function(){function e(e,n){var t=new Image;t.onload=function(){lime.fill.Image.loadedImages_[e]=t;n(e,t)};t.onerror=function(){n(e,null)};t.src=e}function n(e,n){function t(){qyengine.audioUnlocked||qyengine.unlockAudio_||(qyengine.unlockAudio_=r);n(e)}if(qyengine.soundExist(e))n(e);else{var r=qyengine.getSound(e,{autoplay:!1,onload:t,onloaderror:function(){console.log("load error ",e);n(e)}});qyengine.isApk&&t()}}function t(e,n){var t=new XMLHttpRequest;t.open("GET",e,!0);t.onreadystatechange=function(){if(4==t.readyState){t.onreadystatechange=function(){};200==t.status?n(e,t.responseText):n(e,null)}};t.send(null)}qyengine.audioUnlocked=!lime.userAgent.IOS;qyengine.unlockAudio_;var r=!0;qyengine.preloadFileList=function(o,i,a){function s(e,n){++u;a&&(f[e]=n);i&&i(Math.round(1e4*u/d)/100);u>=d&&a&&a(f)}var g=o[0],c=o[1];g&&c||i&&i(100);var u=0,d=g.length+c.length,f={};0==d&&i&&i(100);for(var l=0;l<g.length;l++){var m=g[l];r&&/.(png|jpeg|jpg|gif)$/.test(m)?e(m,s):t(m,s)}for(l=0;l<c.length;l++)n(c[l],s)};qyengine.loading_scene="qyDefaultLoadingScene";qyengine.pause_scene="qyDefaultPauseScene"}();!function(){var e={click:"/public/qiyun/preload/sounds/click.ogg",loadingText:"/public/qiyun/preload/images/loaddingText.png",loadingLogo:"/public/qiyun/preload/images/loadingLogo.png"};if(window.qyProjUrl)for(var n in e)e[n]="assets"+e[n];qyengine.initLoadingScene=function(){gmx_.bg_loading=function(e){this.init_(e,"bg_loading")};qyengine.define_type("bg_loading",QyBackground,{fill:"#243145",size:{width:8,height:8},imgSize:{width:8,height:8},anchorPoint:{x:0,y:0}});gmx_.snd_preload=function(e){this.init_(e,"snd_preload")};qyengine.define_type("snd_preload",QySound,{urls:[e.click,".mp3"],preload:!0,volume:0,background:!1});gmx_.sprites_loaddingText=function(e){this.init_(e,"sprites_loaddingText")};qyengine.define_type("sprites_loaddingText",QySprite,{fill:e.loadingText,anchorPoint:{x:.5,y:.5},size:{width:180,height:82},imgSize:{width:180,height:82}});gmx_.sprites_loadingLogo=function(e){this.init_(e,"sprites_loadingLogo")};qyengine.define_type("sprites_loadingLogo",QySprite,{fill:e.loadingLogo,anchorPoint:{x:.5,y:.5},size:{width:180,height:150},imgSize:{width:180,height:150}});gmx_.spr_white=function(e){this.init_(e,"spr_white")};qyengine.define_type("spr_white",QySprite,{size:{width:150,height:140},imgSize:{width:150,height:140},anchorPoint:{x:.5,y:1},fill:"#ffffff"});gmx_.objects_loaddingText=function(e){this.init_(e,"objects_loaddingText")};qyengine.define_type("objects_loaddingText",QyObject,{sprite:"sprites_loaddingText"},{create:function(){qyengine.play_sound(snd_preload,{})}});gmx_.objects_loadingLogo=function(e){this.init_(e,"objects_loadingLogo")};qyengine.define_type("objects_loadingLogo",QyObject,{sprite:"sprites_loadingLogo"});gmx_.obj_spr_white=function(e){this.init_(e,"obj_spr_white")};qyengine.define_type("obj_spr_white",QyObject,{sprite:"spr_white",parent:"no-parent"},{loading:function(e){this.progress=e.progress;this.scaleY=this.progress/100}});gmx_.qyDefaultLoadingScene=function(e){this.init_(e,"qyDefaultLoadingScene")};qyengine.define_type("qyDefaultLoadingScene",QyScene,{size:{width:1600,height:900},background:"bg_loading",layers:[{id:"default",objects:[{type:"objects_loaddingText",id:"objects_loaddingText",position:{x:800,y:609}},{type:"obj_spr_white",id:"obj_spr_white",scale:{x:1,y:0},position:{x:800,y:510}},{type:"objects_loadingLogo",id:"objects_loadingLogo_1",position:{x:800,y:441}}]}]});current_game.sceneRes=qyengine.addToObj(current_game.sceneRes,{qyDefaultLoadingScene:{files:[e.loadingText,e.loadingLogo],sounds:["snd_preload"],usedScenes:[]}});qyengine.installFonts()}}();!function(){function e(){return qyboot.getPrefix()+SelfModName()}function n(){if(l)return l;var n=qyboot.getCurrentUser(),t=n&&n.userid;t||(t="Guest_tmp");l="QYAPP/"+e()+"/"+t;return l}function t(e){var n={};for(var t in e)current_game.extend[t].serverVariable&&(n[t]=e[t]);for(var t in n)delete e[t];return[e,n]}function r(n){var r=t(n),o=r[0],i=r[1];Object.keys(o).length>0&&qyremote.saveAppUserData(e(),JSON.stringify(o));Object.keys(i).length>0&&qyremote.saveAppUserData(e(),!0,JSON.stringify(i))}function o(){var e=n();if(e&&current_game.extend){var t=current_game.extend,o={},i=!1;for(var a in t)if(t[a].autosave){o[a]=f(a);i=!0}if(i){qyboot.saveToLS(e,o);try{r(o)}catch(s){console.log(s)}}}return!0}function i(){if(current_game.extend){var e=current_game.extend,n=!1;for(var t in e)if(e[t].autosave){n=!0;break}if(n){var r=a();if(r)for(var t in e)e[t].autosave&&null!=r[t]&&d(t,r[t])}}return!0}function a(n){var t;if(n&&current_game.extend[n]){t=current_game.extend[n].serverVariable?qyremote.getAppUserData(e(),!0):qyremote.getAppUserData(e());if(t.success){var r=JSON.parse(t.result);return r[n]}return void 0}var t=qyremote.getAppUserData(e(),!0);if(t.success){var r=JSON.parse(t.result);t=qyremote.getAppUserData(e());if(t.success){var o=JSON.parse(t.result);for(var i in r)o[i]=r[i]}return o}return void 0}function s(e,t){t||(t="both");var r,o=n();if("local"==t){r=qyboot.getFromLS(o)||{};return r[e]}try{return a(e)}catch(i){console.log(i)}}function g(e,t,o){var i=n(),a=qyboot.getFromLS(i)||{};a[e]=t;o||(o="both");("local"==o||"both"==o)&&qyboot.saveToLS(i,a);if("remote"==o||"both"==o){var s={};s[e]=t;try{r(s)}catch(g){console.log(g)}}return!0}function c(e,n){var t=f(e);return g(e,t,n)}function u(e,n){var t=s(e,n);null!=t&&d(e,t)}function d(e,n){switch(e){case"score":case"lives":case"health":current_game[e]=n;return;default:current_game.vars_||(current_game.vars_={});current_game.vars_[e]=n;return}}function f(e){switch(e){case"score":case"lives":case"health":return current_game[e];default:return current_game.vars_&&current_game.vars_[e]}}var l;qyengine.storeAppUserData=o;window.onunload=function(){o()};qyengine.loadAppUserData=i;qyengine.saveGameVar=c;qyengine.loadGameVar=u}();qyengine.supported_devices={}};window.year=function(e){return qyboot.getSystemTime("local"===e).getFullYear()};window.month=function(e){return qyboot.getSystemTime("local"===e).getMonth()+1};window.day=function(e){return qyboot.getSystemTime("local"===e).getDate()};window.hours=function(e){return qyboot.getSystemTime("local"===e).getHours()};window.minutes=function(e){return qyboot.getSystemTime("local"===e).getMinutes()};window.seconds=function(e){return qyboot.getSystemTime("local"===e).getSeconds()};window.milliseconds=function(e){return qyboot.getSystemTime("local"===e).getMilliseconds()};window.time=function(e){return qyboot.getSystemTime("local"===e).getTime()};window.setCursor=function(e){document.body.style.cursor="default";var n=game.director&&game.director.domElement||document.body;n&&(n.style.cursor=e)};qyengine.initBrowserVars=function(){localStorage.removeItem("QYFC/deployed/qiyun/signin/userpane.js");var e="gm_browserVariables",n={};n.vars_=n;var t=window.current_game.browserVariable;qyengine.initVars(n,t);delete n.vars_;t=localStorage.getItem(e);if(t)try{t=JSON.parse(t)}catch(r){t={}}for(var o in t)n[o]=t[o];localStorage.setItem(e,JSON.stringify(n));window.browser||(window.browser={});window.browser.vars_=window.browser;window.browser.classId="browser";window.browser.setVar=function(n,t,r){if(void 0!==this[n])r?this[n]+=t:this[n]=t;else{Object.defineProperty(window.browser,n,{get:function(){var t=localStorage.getItem(e);t&&(t=JSON.parse(t));return t&&t[n]},set:function(t){var r=localStorage.getItem(e);r&&(r=JSON.parse(r));r||(r={});r[n]=t;localStorage.setItem(e,JSON.stringify(r))}});this[n]=t}var o=this.classId+"_"+n;qyengine.updateDraw(o,this[n])};for(var i in n)window.browser.setVar(i,n[i]);current_game.extend&&qyengine.initVars(current_game,current_game.extend)};qyengine.initDataforms=function(){current_game.dataforms||qyengine.getDataforms()};qyengine.getDataforms=function(){Object.defineProperty(current_game,"dataforms",{get:function(){if(current_game.__dataforms)return current_game.__dataforms;var e=SelfModName(),n=qyremote.getAppUserData(e,!0);if(n&&n.success){try{n=JSON.parse(n.result)}catch(t){}if(n){qyengine.dataforms=n.__dataforms||{};n=genDataforms(qyengine.dataforms);current_game.__dataforms=n||""}}return current_game.__dataforms}})};qyengine.updateDataforms=function(e,n,t){game.dataforms;var r=qyengine.dataforms;if(r){var o=r[e];if(o){o.data[t[n]]=t;var i={__dataforms:{}};i.__dataforms[e]={data:{}};i.__dataforms[e].data[t[n]]=t;qyengine.uploadDataform(i);current_game.dataforms&&current_game.dataforms[e]&&(current_game.dataforms[e][t[n]]=t);current_game.__dataforms&&current_game.__dataforms[e]&&(current_game.__dataforms[e][t[n]]=t)}}};qyengine.deleteFromDataform=function(e,n,t){game.dataforms;var r=qyengine.dataforms;if(r){var o=r[e];if(o){delete o.data[t[n]];var i={__dataforms:{}};i.__dataforms[e]={data:{}};i.__dataforms[e].data[t[n]]=null;qyengine.uploadDataform(i);current_game.dataforms&&current_game.dataforms[e]&&delete current_game.dataforms[e][t[n]];current_game.__dataforms&&current_game.__dataforms[e]&&delete current_game.__dataforms[e][t[n]]}}};qyengine.uploadDataform=function(e){var n=SelfModName();qyremote_async.saveAppUserData(n,!0,JSON.stringify(e),function(){})};qyengine.isInTags=function(e,n){for(var t=game.tags&&game.tags[e]&&game.tags[e].objects||[],r=0,o=t.length;o>r;r++)if(n instanceof qyengine.guardType(t[r]))return!0;return!1};window.dataformData=function(e,n,t){var r=game.dataforms&&game.dataforms[e]||{};return r[n]&&r[n][t]};window.dataformDataLength=function(e){var n=game.dataforms&&game.dataforms[e]||{};return Object.keys(n).length};window.instanceLength=function(e){var n=qyengine.getInstancesByType(e)||[];return n.length};window.distance=function(){return qyengine.calDistance.apply(this,arguments)};window.angle=function(e,n,t,r){return qyengine.calAngle(e-t,n-r)};
qyengine.initBaseClass=function(){!function(e){function t(t){if(e)lime.RoundedRect.call(this);else{var i=t.fill||"#ffffff",n=t.size.width,r=t.size.height,o=qyengine.getTextureFromFill(i,n,r);PIXI.Sprite.call(this,o,n,r);delete t.fill}this.qyobj=t&&t.qyobj;this.fromJson(t)}function i(e){var t={fill:e.fontColor,font:e.fontStyle+" "+e.fontSize+"pt "+e.fontFamily,align:e.align,wordWrap:!0};return t}function n(t,i,n){return e?goog.events.listen(t,i,n):t.listen(i,n)}function r(i){i||(i={});i.anchorPoint||(i.anchorPoint={x:0,y:0});if(e)t.call(this,i);else{var n=i.fill,r=i.size.width,o=i.size.height,s=qyengine.getTextureFromFill(n,r,o);PIXI.TilingSprite.call(this,s,r,o);this.minTimeDelta=null!=i.minTimeDelta?i.minTimeDelta:.1;this.setSpeed(i.background_speed||0)}}function o(t){e?lime.Layer.call(this):PIXI.DisplayObjectContainer.call(this);t||(t={});t.hiddenAtStart&&this.hide();t.ignore25d&&(this.ignore25d=!0);t.sticky&&(this.sticky=!0);t.id&&(window[t.id]=this)}function s(e){o.call(this,qyengine.addToObj({sticky:!0},e));this.varLabels={};current_game.drawScore&&this.drawVariable("score","score:"+current_game.score,0,0);current_game.drawLives&&this.drawVariable("lives","lives:"+current_game.lives,200,0);current_game.drawHealth&&this.drawVariable("health","health:"+current_game.health,400,0)}function a(e){if(e.urls&&!(e.urls.length<2))for(var t=e.urls[0],i=1;i<e.urls.length;i++){var n=e.urls[i];"."==n[0]&&(e.urls[i]=t.replace(/\.[^./]+$/,n))}}function h(){var e=window.location.pathname,t=e.substring(0,e.lastIndexOf("/"))+"/";console.log(t);return t}function c(e){QyEventTarget.call(this);e||(e={});if(e.background){this.is_background=!0;null==e.loop&&(e.loop=!0)}this.loop=e.loop;for(var t=0;t<Ae.length;t++){var i="sound"+Ae[t];if(e[i]){n(this,Ae[t],e[i]);delete e[i]}}a(e);try{if(qyengine.isApk){this.initCordovaAudio(e);this.setVolume(e.volume)}else this.initHowl(e)}catch(r){console.log(r)}}function l(e){QyEventTarget.call(this);this.setStepProps(e);this.scheduled_=null;this.speedRatio=e&&e.speed||1}function d(e){for(var t=e.length,i=new Array(t),n=0;t>n;n++){var r=e[n],o=n==e.length-1?e[0]:e[n+1],s=$(r,o);s.pointIdx=n;var a=r.speed&&r.speed/100||1;s.xRatio*=a;s.yRatio*=a;i[n]=s}return i}function u(e,t){if(0>t){e.x=e.dir.startX+e.relatedTo.x;e.y=e.dir.startY+e.relatedTo.y;e.xRatio=-e.dir.xRatio;e.yRatio=-e.dir.yRatio}else{e.x=e.dir.x+e.relatedTo.x;e.y=e.dir.y+e.relatedTo.y;e.xRatio=e.dir.xRatio;e.yRatio=e.dir.yRatio}return e}function p(e){QyEventTarget.call(this);this.at_end="stop";this.speed=100;e||(e={});this.setupOpt(e);var t;window.current_scene&&current_scene.classId&&(t=e[current_scene.classId]);if(!t)for(var i in e)if(e[i].points){t=e[i];break}t&&this.setupOpt(t)}function y(e){this.type=e.type;this.keyframeOpt=e;this.changeFrame(e)}function g(){}function f(e){QyEventTarget.call(this);e||(e={});this.initVars(e);e.sceneId?this.scene=window[e.sceneId]:this.scene=window.current_scene;this.scene.instances.push(this);e.physics&&(this.physics=e.physics);this.mirror={horizontal:1,vertical:1};e.mirror&&this.setMirror(e.mirror.horizontal,e.mirror.vertical);e.sprite&&"no-sprite"!==e.sprite?this.changeSprite(e.sprite,e):e.position&&(this.selfPos={x:e.position.x,y:e.position.y});e.gesture&&this.setupHammer();e.layer&&(this.layerName=e.layer);null!=e.speed&&this.setSpeed(e.speed);e.timeline&&this.setTimeline(e.timeline);e.hiddenAtStart&&this.hide();this.checkOutofscene(this.getPosition(),!0);if(this.isRankEntrance){this.selfListen("create",qyengine.rankList_showoff);this.spriteListen("mousedown",function(){qyengine.displayRanklist()})}this.zIndex=e.zIndex||0}function m(e,t,i){return t>=e.lx&&i>=e.ly&&t<=e.rx&&i<=e.ry}function v(e,t){return e.lx<t.rx&&t.lx<e.rx&&e.ly<t.ry&&t.ly<e.ry}function w(e){if("string"!=typeof e)return e;var t=gmx_[e];t||console.log("type "+e+" is not defined.");return t}function _(e){var t=window[e];t||console.log("id "+JSON.stringify(e)+" is not defined.");return t}function S(e,t,i){null!=this.vars_[e]&&i?this.vars_[e]+=t:this.vars_[e]=t;var n=this.classId+"_"+e;qyengine.updateDraw(n,this.vars_[e])}function b(e){null!=this.vars_[e]?this.vars_[e]=!this.vars_[e]:this.vars_[e]=!0;var t=this.classId+"_"+e;qyengine.updateDraw(t,this.vars_[e])}function x(e,t){Pe.x=e;Pe.y=-t;return goog.math.Coordinate.azimuth(Pe)}function k(e){Object.defineProperties(e.prototype,{timeline:{configurable:!0,get:function(){return this.getTimeline()},set:function(e){this.setTimeline&&this.setTimeline(e);return this}}});e.prototype.getTimeline=function(){return this.timeline_};e.prototype.setTimeline=function(e,t){this.timeline_&&this.timeline_.stop();e.classId&&(e=e.classId);var i=w(e);if(i){this.timeline_=new i(t);this.timeline_.target=this;t&&t.start&&this.timeline_.start()}return this};e.prototype.startTimeline=function(){this.timeline_&&this.timeline_.start();return this};e.prototype.stopTimeline=function(){this.timeline_&&this.timeline_.stop();return this};e.prototype.setTimelinePosition=function(e,t){this.timeline_&&this.timeline_.setPosition(e,t);return this};e.prototype.setTimelineSpeed=function(e,t){this.timeline_&&this.timeline_.setSpeed(e,t)}}function A(){var e=Ce;Ce=!1;var t,i;for(i=0;i<Oe.length;i++){t=Oe[i];t.destroyBuffered=!1;t.destroy(!0)}Oe.length=0;for(i=0;i<ze.length;i++){t=ze[i];t.rebuildBuffered=!1;t.setupBody(!0)}ze.length=0;Ce=e}function I(){var e=Ce;Ce=!1;if(qe){qyengine.switchScene(qe);qe=null}if(null!=Ee){current_scene.setPaused(Ee,Be);Ee=null;Be=null}Ce=e}function P(e,t){var i=t.type||t;qyengine.EventsOnQyObj.indexOf(i)>=0?e.dispatchEvent(t):e.currentSprite&&e.currentSprite.dispatchEvent(t)}function q(e){for(var t=0;t<Te.length;t++){var i=Te[t];if(e[i]){e.type=qyengine.toUpperFirst(i);e.val=e[i];return e}}}function E(e){var t;e instanceof Array?e.length>0&&(t=e[0]):t="object"==typeof e?e:_(e);return t&&!t.destroyed_?t:null}function B(e){if(0!=Me.length){if(!e){e=Ve;e.global.x=mouseX;e.global.y=mouseY}var t=e.global;Ne.x=t.x-current_scene.viewOffset.x;Ne.y=t.y-current_scene.viewOffset.y;for(var i=0;i<Me.length;i++){var n=Me[i],r=n.currentSprite,o=r&&r.parent;if(o){e.getLocalPosition(o,je);je.x=Ne.x;je.y=Ne.y;var s=n.getPosition(),a=n.followingMouse,h=s.x,c=s.y,l=n.followMouse.deltaX,d=n.followMouse.deltaY;if("both"==a){h=je.x+l;c=je.y+d}else"x"==a?h=je.x+l:c=je.y+d;n.setPosition(h,c,!0)}}}}function C(e){var t=e.position||e.global;Ne.x=t.x-current_scene.viewOffset.x;Ne.y=t.y-current_scene.viewOffset.y;for(var i=0;i<Me.length;i++){var n=Me[i],r=n.currentSprite,o=r&&(r.parent_||r.parent);if(o){je.x=Ne.x;je.y=Ne.y;o.screenToLocal(je);var s=n.getPosition(),a=n.followingMouse,h=s.x,c=s.y,l=n.followMouse.deltaX,d=n.followMouse.deltaY;if("both"==a){h=je.x+l;c=je.y+d}else"x"==a?h=je.x+l:c=je.y+d;n.setPosition(h,c,!0)}}}function O(e,t,i){var n=0==e?!0:e>0?i>=t:t>=i;return n}function z(e,t){if(null==e){e=-1e3;t=-1e3}else if(null!=e.x){t=e.y;e=e.x}if(isNaN(e)){console.log("NaN encountered");e=-1e3}if(isNaN(t)){console.log("NaN encountered");t=-1e3}Pe.x=e;Pe.y=t;return Pe}function D(e){var t=[];e.forEach(function(e){t.push(R(e))});return t}function R(e){if(e.type&&void 0!==e.keyCode)return{type:e.type,data:e.keyCode+""};if("swipe"===e.type&&e.gesture&&e.gesture.direction)return{type:e.type,data:e.gesture.direction};if("string"==typeof e){if(e.indexOf(":")<0)return e;var t=e.split(":");return{type:t[0],data:t[1]}}return e.type||e}function T(){return"qyNoNameScn_"+Ue++}function L(t){e?lime.Scene.call(this):PIXI.DisplayObjectContainer.call(this);t||(t={});this.is25D=!!t.is25D;this.full_size=t.size;this.scene_pos={x:0,y:0};this.viewOffset={x:0,y:0};t.isPauseScene||this.isPauseScene?this.isPauseScene=!0:window.scene=window.current_scene=this;this.setId(t.id);this.isPaused_=!1;this.instances=[];this.instancesWithBody=[];this.initVars(t);this.persistent=!!t.persistent;t.prev_scene&&(this.prev_scene=t.prev_scene);t.next_scene&&(this.next_scene=t.next_scene);this.setBackground(t);this.physics=t.physics;this.setupWorld(t.size,t.physics&&t.physics.gravity);t.speed&&this.setSpeed(t.speed);t.collisionShape&&this.setupBlockArea(t.collisionShape);this.objects_=[];this.setLayers(t);this.stickyLayer=new s;this.appendChild(this.stickyLayer);t.isPauseScene||t.view&&this.setView(t.view);t.gesture&&this.setupHammer()}function M(e,t){var i=0!=(e.maskBits&t.categoryBits)&&0!=(e.categoryBits&t.maskBits);return i}function F(e,t,i){if(e.getPosition){var n=e.getPosition();n.x+=t;n.y+=i;e.setPosition(n)}return e}function N(e,t,i,n,r){return e.x>=t&&e.x<=t+n&&e.y>=i&&e.y<=i+r?!0:!1}function j(){var e=w(current_game.pause_scene),t=new e({isPauseScene:!0});current_game.director.pushScene(t)}function V(){var e=current_game.director.getCurrentScene();e.destroy();current_game.director.popScene();var t=current_scene.gravity;qyengine.setGravity(t.x,t.y)}function G(){L.call(this);if(e){this.domElement.style.cssText="background:rgba(255,255,255,.6)";var t=this.continueLabel=(new lime.Label).setText("Click To Continue").setPosition(100,100).setFontSize(32)}else{var t=this.continueLabel=new PIXI.Text("Click To Continue");t.setPosition(100,100);t.setStyle({dropShadow:!0,fill:"yellow",font:"bold 32px Arial"})}this.appendChild(t);if(window.current_scene){var i=current_scene.getSize();t.setPosition(i.width/2,i.height/2);window.isLime?n(t,["mousedown","touchstart"],function(e){(e.event||e).stopPropagation();current_scene.resume()}):t.mousedown=t.touchstart=function(e){e.originalEvent.stopPropagation();current_scene.resume()}}}function J(e){var t={};return function(i){return t.toString.call(i)==="[object "+e+"]"}}function H(e){if(!Xe(e)&&!Ke(e))return e;var t=Ke(e)?[]:{};for(var i in e)e.hasOwnProperty(i)&&(t[i]=Ke(e[i])||Xe(e[i])?arguments.callee(e[i]):e[i]);return t}function U(e){var t={type:"",fill:""};switch(e.type){case"font":t.type="TEXT";break;case"picture":t.type="FILL";""!==e["background-image"]?t.fill=e["background-image"]:"transparent"!==e["background-color"]&&""!==e["background-color"]?t.fill=e["background-color"]:t.fill="#";break;default:console.log("function getSpriteInfor arguments type invalid ")}return t}function W(e,i,n){function r(e,t){var i=new K;void 0!==t&&i.setText(t);void 0!==e.color&&i.setFontColor(e.color);void 0!==e["font-size"]&&i.setFontSize(e["font-size"]);void 0!==e.position&&i.setPosition(e.position.x,e.position.y,!0);void 0!==e.size&&i.setSize(e.size.width,e.size.height);return i.currentSprite}function o(e,i){var n=e.size?H(e.size):{width:0,height:0},r={width:e["border-width"]||0,color:e["border-color"]||"#ff0000"},o=new t({fill:i,size:n,radius:e["border-radius"]||0,stroke:r});o.setAnchorPoint(0,0);void 0!==e.position&&o.setPosition(e.position.x,e.position.y);void 0!==e.opacity&&o.setOpacity(e.opacity);void 0!==e.scale&&o.setScale(e.scale.x,e.scale.y);return o}if("object"!=typeof i)return null;var s=U(i),a=null;switch(e){case"TEXT":a=r(i,n);break;case"FILL":a=o(i,n||s.fill);break;default:console.log("function spriteFactory_RL argument type invaild")}return a}function Q(e){o.call(this,e);current_scene.ranklist_=this;this.scene=current_scene;current_scene.user=null;this.initRanklistConfigInfor(e||(e={}));this.ranklist_dialog=null;this.nickname_dialog=null;this.login_dialog=null;current_scene.appendChild(this)}function X(e){e||(e={});f.call(this,e);this.currentSprite=new lime.ui.Scroller;this.currentSprite.setAnchorPoint({x:0,y:0});this.currentSprite.qyobj=this;e.position&&this.currentSprite.setPosition(e.position.x,e.position.y);this.setupContent(e)}function K(e){e||(e={});e.anchorPoint={x:0,y:0};f.call(this,e);this.currentSprite=new t(e);this.currentSprite.qyobj=this;e.position&&this.currentSprite.setPosition(e.position.x,e.position.y);e.size&&this.currentSprite.setSize(e.size.width,e.size.height);var i=e.position;e.position=null;window.isLime?this.currentSprite.setText(e):this.origSize=e.size;e.position=i;e.hiddenAtStart&&this.hide()}function Y(t){f.call(this);var i=this.currentSprite=(new lime.input).setAnchorPoint(0,0).setValue(t.defaultText||"").setPlaceHolder(t.emptyText||"").setType(t.isPassword?"password":"text").setLengthLimit(void 0===t.lengthLimit?null:t.lengthLimit).setRotation(t.rotation||0);i.qyobj=this;var n=t.inputStyle||{};n.backgroundColor&&i.setBackgroundColor(n.backgroundColor);i.setStroke(n.borderWidth||0,n.borderColor||"#000");i.setRadius(n.borderRadius||0);var r=t.position;r&&i.setPosition(r.x,r.y);var o=t.size;o&&i.setSize(o.width,o.height);var s=t.textStyle;if(e)for(var a in s){var h="set"+qyengine.toUpperFirst(a);"function"==typeof i[h]?i[h](s[a]):"fontStyle"===a?i.setStyle(s[a]):console.log(a+" when setting label font is ignored")}t.hiddenAtStart&&this.hide()}function Z(e){return e?0>e?-1:1:0}function $(e,t,i){if(null==i){i=t.y;t=t.x}var n=t-e.x,r=i-e.y,o=Z(n),s=Z(r),a={startX:e.x,startY:e.y,x:t,y:i,xRatio:o,yRatio:s};if(0==n||0==r)return a;var h=Math.pow(n/r,2),c=1/(1+h),l=1-c;a.xRatio*=Math.sqrt(l);a.yRatio*=Math.sqrt(c);return a}function ee(e,t,i){t||(t=i&&i.layer?_(i.layer):e.layerName?_(e.layerName):current_scene.defaultLayer);e.layer=t;var n=e.currentSprite;if(n){var r;if(e.scene.is25D&&!t.ignore25d){var o=e.getBoundingBox();r=ie(t,o.ry,0,t.getNumberOfChildren()-1)}else r=te(t,e.zIndex,0,t.getNumberOfChildren()-1);t.appendChild(n,r);n.keyframe&&!n.keyframe.started&&n.keyframe.start()}}function te(e,t,i,n){if(0>n)return 0;var r=e.children_||e.children;if(i>=n)return!r[n].qyobj||r[n].qyobj.zIndex>t?n:n+1;var o=Math.floor((i+n)/2),s=r[o],a=s.qyobj;if(!a){e.setChildIndex(s,r.length);return te(e,t,i,n-1)}var h=a.zIndex;return h>t?te(e,t,i,o-1):te(e,t,o+1,n)}function ie(e,t,i,n){if(i>=n)return i;var r=e.children_||e.children,o=Math.floor((i+n)/2),s=r[o],a=s.qyobj;if(!a){e.setChildIndex(s,r.length);return ie(e,t,i,n-1)}var h=a.getBoundingBox().ry;return h==t?o:h>t?ie(e,t,i,o-1):ie(e,t,o+1,n)}function ne(e){Object.defineProperties(e.prototype,{x:{configurable:!0,get:function(){return this.getPosition().x},set:function(e){var t=this.getPosition();this.setPosition(e,t.y);return this}},y:{configurable:!0,get:function(){return this.getPosition().y},set:function(e){var t=this.getPosition();this.setPosition(t.x,e);return this}},scaleX:{configurable:!0,get:function(){return this.getScale().x},set:function(e){var t=this.getScale();this.setScale(e,t.y);return this}},scaleY:{configurable:!0,get:function(){return this.getScale().y},set:function(e){var t=this.getScale();this.setScale(t.x,e);return this}},width:{configurable:!0,get:function(){return this.getSize().width},set:function(e){var t=this.getSize();this.setSize(e,t.height);return this}},height:{configurable:!0,get:function(){return this.getSize().height},set:function(e){var t=this.getSize();this.setSize(t.width,e);return this}}})}function re(){b2ContactListener.call(this);this.beginContacts=[];this.endContacts=[]}function oe(e){if(e){var t=e.GetBody();return t&&t.qyobj}return null}function se(e,t,i,n,r,o){n||(n="allFixs");r||(r="allFixs");for(var s=0;s<e.length;s++){var a=e[s];if(a.obj1==t&&a.obj2==i&&a.fixName1==n&&a.fixName2==r)return;if(a.obj2==t&&a.obj1==i&&a.fixName2==n&&a.fixName1==r)return}e.push({obj1:t,obj2:i,fixName1:n,fixName2:r,isSensor:o});("allFixs"!=n||"allFixs"!=r)&&se(e,t,i,"allFixs","allFixs",o)}function ae(e){return e&&!e.destroyBuffered&&!e.rebuildBuffered&&!e.destroyed_}function he(e,t,i,n,r){e.other_=t;e.dispatchEvent({type:i,myName:n,withName:r});t.other_=e;t.dispatchEvent({type:i,myName:r,withName:n})}function ce(e,t,i,n){for(var r=0;r<Ze.length;r++){var o=Ze[r];if(o.obj1==e&&o.obj2==t&&(o.myNames==i||goog.array.equals(o.myNames,i))&&(o.withNames==n||goog.array.equals(o.withNames,n)))return!0}return!1}function le(){if(e){if("canvas"==current_game.renderer)return lime.Renderer.CANVAS;current_game.renderer="dom";return lime.Renderer.DOM}return qyengine.gRenderer}function de(e){e/=1e3;e>3&&(e=3);$e+=e;if($e>=.03125){$e-=.03125;current_game.world.Step(.03125,current_game.velocityIterations,current_game.positionIterations);current_game.world.ClearForces()}current_scene.step_(e);current_game.world.DrawDebugData&&current_game.world.DrawDebugData();current_game.contactListener.handleContacts();A();I()}function ue(e){if(current_game.sceneRes){var t=current_game.sceneRes[e],i=t&&t.usedScenes;if(i)for(var n=0;n<i.length;n++)we(i[n])}}function pe(t,i){var n=window.current_scene,r=w(t);if(!r)return n;ue(t);n&&n.destroy();var o=le();n=new r(i).setRenderer(o);var s=n.view;s?current_game.director.setSize(n.view.width,n.view.height):current_game.director.setSize(n.full_size.width,n.full_size.height);if(e)current_game.director.replaceScene(n);else{qyengine.gStage.children.length>0&&qyengine.gStage.removeChildren();qyengine.gStage.addChild(n);qyengine.gStage.interactionManager.rebuildInteractiveGraph()}current_game.director.invalidateSize_();n.dispatchCreateEvent("create");if(!et){lime.scheduleManager.schedule(de,qyengine);et=!0}Ce=!0;current_game.debugDraw&&(/\/previewGame$/.test(qyboot.getDomainApp())||"debug/"==qyboot.getPrefix())&&current_game.enableDebugDraw();return n}function ye(){var e=new goog.events.KeyHandler(document.body);qyengine.keyDispatcher=new QyEventTarget;qyengine.docKh=qyengine.keyDispatcher;n(e,"keydown",function(e){if(!nt[e.keyCode]){nt[e.keyCode]=!0;qyengine.keyDispatcher.dispatchEvent(e)}});n(e,"keyup",function(e){if(nt[e.keyCode]){nt[e.keyCode]=!1;qyengine.keyDispatcher.dispatchEvent(e)}})}function ge(){qyengine.audioUnlocked=!0;rt=document.body.addEventListener("touchstart",fe)}function fe(){qyengine.unlockAudio_.play();goog.events.unlistenByKey(rt)}function me(e){for(var t=[],i=0;i<e.length;i++)if(!qyengine.preloadedFiles[e[i]]){qyengine.preloadedFiles[e[i]]=!0;t.push(e[i])}return t}function ve(e){for(var t=[],i=0;i<e.length;i++)if(!qyengine.preloadedSounds[e[i]]){qyengine.preloadedSounds[e[i]]=!0;t.push(e[i])}return t}function we(e,t,i){if(ke)t&&t();else{var n=qyengine.preloadedScenes[e];if(null==n){qyengine.preloadedScenes[e]=t?[t]:[];i||(i=window.gamejson);var r=current_game.sceneRes[e],o=me(r.files),s=ve(r.sounds),a={type:"loading",progress:0};qyengine.preloadFileList([o,s],function(t){a.progress=t;var i=qyengine.preloadedScenes[e],n=i.length,r=n>0;if(t>=100){r&&qyengine.loadingAgent.dispatchEvent(a);qyengine.preloadedScenes[e]=!0;for(var o=0;n>o;o++)i[o]&&i[o]()}else r&&qyengine.loadingAgent.dispatchEvent(a)})}else n===!0?t&&t():t&&n.push(t)}}function _e(e,t){if(e&&t&&0!=e.length)for(var i=0;i<e.length;i++)t(e[i])}function Se(e,t){for(var i in t){var n=goog.bind(t[i],e);_e(i.split(","),function(t){switch(t){case"loading":case"loaded":e.objListen(qyengine.loadingAgent,t,n);break;case"keydown":case"keyup":n.target=e;e.objListen(qyengine.keyDispatcher,t,n);break;case"acceleration":e.objListen(qyengine.accelerationDispatcher,t,n);qyengine.watchAcceleration();break;case"mouseleave":e.spriteListen("mouseout",n);break;default:goog.array.contains(qyengine.EventsOnQyObj,t)?e.selfListen(t,n):e.spriteListen(t,n)}})}}function be(e,t){var i=qyengine.guardType(t);if(i){var n=i.baseType,r=i.evHandlers,o=i.defaultOpt;n&&n.call(this,qyengine.merge(o,e));r&&Se(this,r)}}!function(){function e(e,i,n){var r=parseInt(e);if(!t){t=new PIXI.Graphics;t.boundsPadding=0}t.beginFill(r);t.drawRect(0,0,i,n);t.endFill();var o=t.generateTexture();t.clear();return o}var t;qyengine.getTextureFromFill=function(t,i,n){if("string"!=typeof t||/^rgb/.test(t)){console.log(t+" is not supported in webgl mode at present");t="#ffffff"}var r;r=/^#/.test(t)?e("0x"+t.substr(1),i,n):PIXI.Texture.fromImage(t);return r}}();if(e)goog.inherits(t,lime.RoundedRect);else{goog.inherits(t,PIXI.Sprite);t.prototype.runAction=lime.Node.prototype.runAction;PIXI.Text.prototype.runAction=lime.Node.prototype.runAction}window.QySprite=t;ne(t);t.prototype.isBG=!1;t.prototype.getOffset=function(){return this.offset};t.prototype.setOffset=function(e,t){var i=this.keyframe?this.imgSize:this.getSize();if(!this.keyframe&&(this.repeat||this.repeat_x||this.repeat_y)){e%=i.width;t%=i.height}if(e!=this.offset.x||t!=this.offset.y){this.offset.x=e;this.offset.y=t;if(this.tilePosition){this.tilePosition.x=e;this.tilePosition.y=t}if(this.fill_&&this.fill_.setOffset){this.fill_.setOffset(e,t);this.setDirty(lime.Dirty.POSITION)}}return this};qyengine.getDirector=function(){return current_game.director};t.prototype.getDirector=qyengine.getDirector;t.prototype.setImgSize=function(e,t){this.imgSize={width:e,height:t};var i=this.getSize();if(!this.keyframe){!this.repeat_x&&(e=i.width);!this.repeat_y&&(t=i.height)}this.fill_&&this.fill_.setSize&&this.fill_.setSize(e,t)};t.Props={size:{"default":{x:0,y:0},help:""}};t.prototype.setRenderer=function(e){var t=e;!this.mirror||1==this.mirror.horizontal&&1==this.mirror.vertical||(t=lime.Renderer.CANVAS.getType());t&&lime.Node.prototype.setRenderer.call(this,t)};t.prototype.setMirror=function(e,t){var i=!1;if(null!=e&&this.mirror.horizontal!=e){this.mirror.horizontal=e;i=!0}if(null!=t&&this.mirror.vertical!=t){this.mirror.vertical=t;i=!0}(1!=this.mirror.horizontal||1!=this.mirror.vertical)&&this.setRenderer();i&&this.setDirty(lime.Dirty.CONTENT)};t.prototype.fromJson=function(t){t||(t={});this.repeat_x=t.repeat||t.repeat_x;this.repeat_y=t.repeat||t.repeat_y;this.repeat=this.repeat_x&&this.repeat_y;delete this.pixiFrames;this.mirror={horizontal:1,vertical:1};t.mirror&&this.setMirror(t.mirror.horizontal,t.mirror.vertical);this.minTimeDelta=null!=t.minTimeDelta?t.minTimeDelta:.1;delete this.imgSize;t.size&&this.setSize(t.size.width,t.size.height);t.anchorPoint&&this.setAnchorPoint(t.anchorPoint.x,t.anchorPoint.y);if(t.position){var i=z(t.position);this.setPosition(i.x,i.y)}t.scale&&this.setScale(t.scale.x,t.scale.y);t.rotation&&this.setRotation(t.rotation);null!=t.opacity&&this.setOpacity(t.opacity);t.stroke&&t.stroke.width&&this.setStroke(t.stroke.width,t.stroke.color);this.setRadius(t.radius>0?t.radius:0);if(this.keyframe){this.keyframe.stop();this.keyframe=null}this.offset={x:0,y:0};this.fill_=null;t.fill&&this.setFill(t.fill);t.imgSize&&this.setImgSize(t.imgSize.width,t.imgSize.height);if(t.keyframe){this.setKeyFrame(t.keyframe);this.keyframe&&"multiImages"==this.keyframe.type&&e&&this.setRenderer(lime.Renderer.CANVAS)}this.setText(t.text);this.collisionData=t.collisionData;this.setSpeed(t.background_speed||0);this.accSeconds=0;return this};t.prototype.setSize=function(t,i){if(e){lime.Sprite.prototype.setSize.call(this,t,i);if(this.repeat||this.repeat_x||this.repeat_y){if(this.imgSize&&this.fill_&&this.fill_.setOffset){var n=this.getAnchorPoint();this.fill_.setOffset(n.x*(t-this.imgSize.width),n.y*(i-this.imgSize.height))}}else this.fill_&&this.fill_.setSize&&this.fill_.setSize(t,i)}else PIXI.TilingSprite.prototype.setSize.call(this,t,i);return this};t.prototype.makeTextLabel=function(t){if(!this.txtLabel_){this.txtLabel_=qyengine.makeLabel();this.appendChild(this.txtLabel_)}var n=this.txtLabel_;if(!t||"object"!=typeof t)return n;var r=t.size||this.getSize(),o=t.position||{x:0,y:0},s="object"==typeof t.font?t.font:current_game.fonts[t.font]||{};if(e)for(var a in s){var h="set"+qyengine.toUpperFirst(a);"function"==typeof n[h]?n[h](s[a]):console.log(a+" when setting label font is ignored")}else n.setStyle(i(s));n.setSize(r);e?n.setPosition(o):n.setPosition(o.x+this.width/2,o.y+this.height/2);return n};t.prototype.setText=function(e){if(void 0!==e){var t=goog.cloneObject(e.font);if(current_game.texts[e.text]){var i;i=JSON.parse(JSON.stringify(current_game.texts[e.text]));i.content=i.text;delete i.text;qyengine.addToObj(i,e);e=i}else current_game.texts[e]&&(e=current_game.texts[e]);t&&(e.font=t);var n,r=this.makeTextLabel(e);e.content&&(e.text=e.content);if("object"==typeof e){if("string"==typeof e.text)n=e.text;else{var o=qyboot.getDefaultLocaleName();if(e.text&&e.text[o])n=e.text[o];else for(var s in e.text){n=e[s];break}}null!=n||(n=e[o])}else n=e;null!=n||(n="");r.setText(n);r.setMultiline&&r.setMultiline(!0);return this}this.txtLabel_&&this.txtLabel_.setText("")};t.prototype.getText=function(){return this.txtLabel_&&this.txtLabel_.getText()};t.prototype.addText=function(e){var t=this.getText();t&&(e=t+e);return this.setText(e)};t.prototype.setFontColor=function(t){if(this.txtLabel_&&this.txtLabel_.setFontColor){this.txtLabel_.setFontColor(t);e||(this.txtLabel_.dirty=!0)}};t.prototype.setFontSize=function(t){if(this.txtLabel_&&this.txtLabel_.setFontSize){this.txtLabel_.setFontSize(t);e||(this.txtLabel_.dirty=!0)}};t.prototype.setKeyFrame=function(t){this.keyframe&&this.keyframe.stop();this.keyframe=new y(t);var i=this.qyobj||this;n(this.keyframe,"timelinestop",function(){i.dispatchEvent("keyframeend")});n(this.keyframe,"timelinestart",function(){i.dispatchEvent("keyframestart")});this.keyframe.setSprite(this);var r=this.getSize();this.setOffset(-r.width*this.keyframe.xStart,-r.height*this.keyframe.yStart);if(!e){this.texture.setFrame({x:r.width*this.keyframe.xStart,y:r.height*this.keyframe.yStart,width:r.width,height:r.height});this.onTextureUpdate();this.keyframe.start()}return this};t.prototype.changeAnimation=function(e){if(this.curAnimationName!=e){this.curAnimationName=e;if(this.keyframe){this.keyframe.stop();this.keyframe.changeFrame(e);this.keyframe.setSprite(this)}}return this};t.prototype.toJson=function(){};t.prototype.setSpeed=function(e,t){if(null==e)return this;("number"==typeof t||"number"==typeof e)&&(e={x:e,y:t||0});this.speed_=e};Object.defineProperties(t.prototype,{speed:{configurable:!0,get:function(){return this.speed_||{x:0,y:0}},set:function(e){this.setSpeed&&this.setSpeed(e);return this}}});t.prototype.moveBySpeed=function(e){if(this.speed_&&(0!=this.speed_.x||0!=this.speed_.y)){this.accSeconds+=e;if(this.accSeconds>this.minTimeDelta){this.moveBy(this.speed_.x*this.accSeconds,this.speed_.y*this.accSeconds);this.accSeconds=0}}};t.prototype.moveTo=function(e,t){this.setOffset(e,t);return this};t.prototype.moveBy=function(e,t){null!=e||(e=0);null!=t||(t=0);if(0==e&&0==t)return this;this.setOffset(this.offset.x+e,this.offset.y+t);return this};t.prototype.setFrameSpeed=function(e,t){this.keyframe&&this.keyframe.setSpeed(e,t)};t.prototype.shieldEvent=function(e){this.shieldedEvent||(this.shieldedEvent=[]);this.shieldedEvent.indexOf(e)<0&&this.shieldedEvent.push(e)};t.prototype.cancelShieldEvent=function(e){this.shieldedEvent||(this.shieldedEvent=[]);var t=this.shieldedEvent.indexOf(e);t>-1&&this.shieldedEvent.splice(t,1)};t.prototype.isShieldEvent=function(e){return this.shieldedEvent&&this.shieldedEvent.indexOf(e)>-1};if(e)goog.inherits(r,t);else{goog.inherits(r,PIXI.TilingSprite);r.prototype.moveBySpeed=function(e){this.tilePosition.x=(this.tilePosition.x+e*this.speed_.x)%this.width;this.tilePosition.y=(this.tilePosition.y+e*this.speed_.y)%this.height};r.prototype.setSpeed=t.prototype.setSpeed;r.prototype.moveBy=function(e,t){this.tilePosition.x+=e;this.tilePosition.y+=t}}window.QyBackground=r;r.prototype.isBG=!0;e?goog.inherits(o,lime.Layer):goog.inherits(o,PIXI.DisplayObjectContainer);window.QyLayer=o;ne(o);o.prototype.toObj=function(){};e||(o.prototype.getNumberOfChildren=function(){return this.children.length});o.prototype.show=function(){this.isHidden_=!1;this.setHidden(!1);var e=this.children_||this.children;goog.array.forEach(e,function(e){e.qyobj&&e.qyobj.show()})};o.prototype.hide=function(){this.isHidden_=!0;this.setHidden(!0);var e=this.children_||this.children;goog.array.forEach(e,function(e){e.qyobj&&e.qyobj.hide()})};o.prototype.toggleHidden=function(){this.isHidden_?this.show():this.hide()};goog.inherits(s,o);window.QyStickyLayer=s;lime.Label.prototype.getFontStyle=lime.Label.prototype.getStyle;lime.Label.prototype.setFontStyle=lime.Label.prototype.setStyle;s.prototype.drawVariable=function(t,n,r,o,s,a){var h=this.varLabels[t];if(!h){h=qyengine.makeLabel();this.varLabels[t]=h;this.appendChild(h)}if(e)for(var c in s){var l="set"+qyengine.toUpperFirst(c);"function"==typeof h[l]?h[l](s[c]):console.log(c+" is ignored")}else h.setStyle(i(s));a&&a.size&&h.setSize(a.size);h.setText(n);null!=r&&h.setPosition(r,o);return this};s.prototype.updateHealthImage=function(e,t,i,n){if(this.healthSprite){var r;if(null==e||null==t){r=this.healthSprite.getPosition();null==e&&(e=r.x);null==t&&(t=r.y)}if(i||n){r||(r=this.healthSprite.getPosition());i&&(e+=r.x);n&&(t+=r.y)}this.healthSprite.setPosition(e,t);var o=Math.max(Math.min(current_game.health,1),0),s=this.healthSprite.constructor.defaultOpt.size;this.healthSprite.setSize(s.width*o,s.height*o)}};s.prototype.drawLifeImage=function(t,i,n,r,o){if(!this.lifeImgContainer){e?this.lifeImgContainer=new lime.ui.Container:this.lifeImgContainer=new PIXI.DisplayObjectContainer;this.appendChild(this.lifeImgContainer)}if(n){n.classId&&(n=n.classId);if(this.lifeImgContainer.spriteName!=n){this.lifeImgContainer.removeAllChildren();this.lifeImgContainer.spriteName=n}}else{if(!this.lifeImgContainer.spriteName)return;n=this.lifeImgContainer.spriteName}var s;if(null==t||null==i){s=this.lifeImgContainer.getPosition();null==t&&(t=s.x);null==i&&(i=s.y)}if(r||o){s||(s=this.lifeImgContainer.getPosition());r&&(t+=s.x);o&&(i+=s.y)}this.lifeImgContainer.setPosition(t,i);var a=this.lifeImgContainer.children_||this.lifeImgContainer.children,h=a.length,c=current_game.lives;c>=0||(c=0);if(h>c)for(var l=h-1;l>=c;l--)this.lifeImgContainer.removeChildAt(l);else if(c>h){var d=w(n);if(d)for(l=0;c-h>l;l++){var u=new d;this.lifeImgContainer.appendChild(u)}}};var xe=/^file:/.test(window.document.location.protocol),ke=!qyengine.isApk&&xe;e?window.QyEventTarget=goog.events.EventTarget:window.QyEventTarget=PIXI.EventTarget;var Ae=["end","load","loaderror","pause","play"];goog.inherits(c,QyEventTarget);window.QySound=c;if(qyengine.isApk){c.prototype.play=function(){if(this.cordovaAudio){this.shouldStop=!this.loop;this.cordovaAudio.play()}};c.prototype.pause=function(){this.cordovaAudio&&this.cordovaAudio.pause()};c.prototype.stop=function(){if(this.cordovaAudio){this.shouldStop=!0;this.cordovaAudio.stop()}};c.prototype.mute=function(){if(!this._muted){this._muted=!0;this.oldVolume_=this.volume_;this.setVolume(0)}};c.prototype.unmute=function(){if(this._muted){this._muted=!1;null!=this.oldVolume_&&this.setVolume(this.oldVolume_)}};c.prototype.unload=function(){this.cordovaAudio&&this.cordovaAudio.release()};c.prototype.setVolume=function(e){e>=0&&1>=e||(e=1);this.volume_=e;this.cordovaAudio&&this.cordovaAudio.setVolume(e)};c.prototype.getVolume=function(){return this.volume_};c.prototype.getActiveNode=function(){return this._activeNode}}else{goog.object.extend(c,Howler);c.prototype.getActiveNode=function(){this.howl||this.initHowl();return this.howl&&this.howl._activeNode()};c.prototype.setVolume=function(e){this.howl&&this.howl.volume(e)};c.prototype.getVolume=function(){this.howl&&this.howl.volume()};!function(){function e(e){c.prototype[e]=function(){this.howl&&this.howl[e]()}}var t=["play","pause","stop","mute","unmute","unload"];goog.array.forEach(t,e)}()}c.prototype.initCordovaAudio=function(e){var t=h()+e.urls[0],i=this;this.cordovaAudio=new Media(t,void 0,function(e){console.log(t+":Audio Error: "+JSON.stringify(e))},function(e){switch(e){case Media.MEDIA_NONE:break;case Media.MEDIA_STARTING:i._activeNode=i;break;case Media.MEDIA_RUNNING:i.onplay();break;case Media.MEDIA_PAUSED:i.onpause();break;case Media.MEDIA_STOPPED:if(i.shouldStop){i._activeNode=null;i.onend()}else i.cordovaAudio.play()}})};c.prototype.initHowl=function(e){this.howl=new Howl(qyengine.addToObj({onend:goog.bind(this.onend,this),onload:goog.bind(this.onload,this),onloaderror:goog.bind(this.onloaderror,this),onpause:goog.bind(this.onpause,this),onplay:goog.bind(this.onplay,this)},e))};c.prototype.onend=function(){this.dispatchEvent("soundend")};c.prototype.onload=function(){this.dispatchEvent("soundload")};c.prototype.onloaderror=function(){this.dispatchEvent("soundloaderror")};c.prototype.onpause=function(){this.dispatchEvent("soundpause")};c.prototype.onplay=function(){this.dispatchEvent("soundplay")};goog.inherits(l,QyEventTarget);window.QyTimeline=l;l.prototype.getDirector=qyengine.getDirector;l.prototype.setPosition=function(e,t){t&&(e+=this.stepProps.startPosition);
this.stepProps.startPosition=e;return this};l.prototype.setSpeed=function(e,t){e=null!=e?e/100:1;t&&(e*=this.speedRatio);this.speedRatio=e;return this};l.prototype.setStepProps=function(e){e||(e={});this.stepProps={loop:null!=e.loop?e.loop:!1,delay:e.delay||0,startPosition:e.startPosition||0};return this};l.prototype.stop=function(){if(this.scheduled_){lime.scheduleManager.unschedule(this.scheduled_,this);this.scheduled_=null;if(this.started){this.started=!1;this.dispatchEvent("timelinestop");if(!(this instanceof y)){var e=this.startedOpt&&this.startedOpt.target||this.target;e&&e.dispatchEvent("timelinestop")}}}return this};l.prototype.start=function(e){if(!this.stepDefs_)return this;this.stop();var t=qyengine.merge(this.stepProps,e);if(t.startPosition>=this.stepMax_){if(!t.loop)return this;t.offset=t.startPosition%this.stepMax_}else t.offset=t.startPosition;for(var i=this.stepDefs_,n=i.length,r=0;n>r&&!(i[r][0]>=t.offset);r++);t.startIdx=r;this.startedOpt=t;var o=this.startedOpt.delay;if(o){lime.scheduleManager.callAfter(this.startImm_,this,o);this.scheduled_=this.startImm_}else this.startImm_();return this};l.prototype.startImm_=function(){this.stop();this.dispatchEvent("timelinestart");if(!(this instanceof y)){var e=this.startedOpt&&this.startedOpt.target||this.target;e&&e.dispatchEvent("timelinestart")}this.started=!0;lime.scheduleManager.scheduleWithDelay(this.step_,this,0,-1);this.scheduled_=this.step_;window.current_scene&&current_scene.isPaused_&&current_game.director&&lime.scheduleManager.changeDirectorActivity(current_game.director,!0);return this};l.prototype.step_=function(e){e/=10;for(var t=this.startedOpt.target||this.target,i=this.startedOpt.loop,n=this.startedOpt.offset,r=e*this.speedRatio,o=n+r,s={type:"timeline"},a=this.stepDefs_,h=a.length;;){for(var c=this.startedOpt.startIdx;h>c;c++){var l=a[c],d=l[0],u=l[1],p=l[2];if(!(o>d)){this.startedOpt.offset=o;this.startedOpt.startIdx=c;current_scene.isPaused_&&lime.updateDirtyObjects();return}s.step=d;p&&(s.extraArg=p);u.call(t,s)}if(!(i===!0||i>1)){this.stop();current_scene.isPaused_&&lime.updateDirtyObjects();return}i!==!0&&this.startedOpt.loop--;n=0;this.startedOpt.startIdx=0;o-=this.stepMax_}};goog.inherits(p,QyEventTarget);window.QyPath=p;p.prototype.setSpeed=function(e){this.speed=e;if(this.target){var t=this.target.moveTarget_;if(t){u(t,e);e=Math.abs(e);this.target.setSpeed(e*t.xRatio,e*t.yRatio)}}return this};p.prototype.setPosition=function(e,t){t&&(e+=this.position);this.setupOpt({reversed:!1,position:e,speed:Math.abs(this.speed)});if(this.target&&this.target.moveTarget_){var i=this.getPoints()[this.position],n=this.getDirs()[this.position],r=this.target.moveTarget_,o=r.relatedTo;this.target&&this.target.setPosition(i.x+o.x,i.y+o.y,!0);this.moveOneStep(n,r);return this}};p.prototype.setupOpt=function(e){e||(e={});null!=e.closed&&(this.closed=e.closed);null!=e.at_end&&(this.at_end=e.at_end);null!=e.relative&&(this.relative=e.relative);null!=e.reversed&&(this.reversed=e.reversed);null!=e.speed&&(this.speed=e.speed);null!=e.points&&this.setPoints(e.points);if(null!=e.position&&this.points&&this.points.length>0){var t=this.points.length,i=e.position;this.position=0>i?t-1+i%t:i%t}else null==this.point&&(this.position=0)};p.prototype.setPoints=function(e){if(this.closed){this.points=new Array(e.length+1);for(var t=0;t<e.length;t++)this.points[t]=e[t];this.points[e.length]=e[0]}else this.points=e;delete this.revPoints;delete this.Dirs;delete this.revDirs};p.prototype.getPoints=function(){if(this.reversed){if(this.revPoints)return this.revPoints;for(var e=this.points.length,t=e-1,i=new Array(e),n=0;e>n;n++)i[n]=this.points[t-n];this.constructor.prototype.revPoints=i;return i}return this.points};p.prototype.getDirs=function(){if(!this.points||0==this.points.length)return[];if(this.reversed){if(this.revDirs)return this.revDirs;var e=d(this.getPoints());this.constructor.prototype.revDirs=e;return e}if(this.Dirs)return this.Dirs;var t=d(this.points);this.constructor.prototype.Dirs=t;return t};p.prototype.moveOneStep=function(e,t){t||(t={relatedTo:{x:0,y:0}});t.dir=e;this.target.moveTarget_=t;this.setSpeed(this.speed)};p.prototype.start=function(e){if(!this.target||this.started)return this;e&&this.setupOpt(e);var t=this.getDirs();if(0!=t.length)if(1!=t.length){var i=this.getPoints()[this.position],n=t[this.position],r={relatedTo:{x:0,y:0}},o=this.target.getPosition();this.targetStartPos={x:o.x,y:o.y};if(this.relative){var s=o.x-i.x,a=o.y-i.y;r.relatedTo.x=s;r.relatedTo.y=a}else{this.target.setPosition(i.x,i.y,!0);this.targetStartPos.x=i.x;this.targetStartPos.y=i.y;this.relative=!0}this.moveOneStep(n,r);this.started=!0;this.target.dispatchEvent("pathstart")}else this.relative||this.target.setPosition(t[0].x,t[0].y)};p.prototype.stop=function(){if(this.target&&this.started){delete this.target.moveTarget_;this.target.setSpeed(0);this.started=!1;return this}};p.prototype.reachPoint=function(e){var t=e.dir,i=this.points.length,n=0;this.speed<=0&&t.pointIdx<=0?n=1:this.speed>=0&&t.pointIdx>=i-2&&(n=2);if(n){this.position=0;this.target.dispatchEvent("pathend");switch(this.at_end){case"stop":this.stop();return;case"revert":if(1==n)this.setSpeed(-this.speed);else if(2==n){this.reversed=!this.reversed;this.stop();this.start()}return;case"recurse":this.target.setPosition(this.targetStartPos.x,this.targetStartPos.y,!0);case"continue":if(1==n)this.setSpeed(-this.speed);else if(2==n){this.stop();this.start()}return}}this.target.dispatchEvent({type:"pathpoint",pointIdx:t.pointIdx});var r=this.getDirs();t=r[(i+t.pointIdx+Z(this.speed))%i];this.moveOneStep(t,e)};goog.inherits(y,l);window.QyKeyframe=y;y.prototype.changeFrame=function(e){this.loop=null!=e.loop?e.loop:!0;this.startPosition=null!=e.startPosition?e.startPosition:0;if("multiImages"==this.type){this.setupMultiImages(e.frames);this.xStart=0;this.yStart=0}else if("largeImage"==this.type&&void 0!==e.total){this.setupLargeImage(e);this.xStart=0;this.yStart=0}else{if("string"==typeof e)e=this.frames&&this.frames[e];else if(e.frames){this.frames=e.frames;e=e.frames[e.defaultFrame]}this.delay=null!=e.delay?60*e.delay:200;this.xNum=e.xNum||1;this.xStart=null!=e.xStart?e.xStart:0;this.xEnd=null!=e.xEnd?e.xEnd:this.xNum-1;this.yStart=null!=e.yStart?e.yStart:0;this.yEnd=e.yEnd?e.yEnd:this.yStart;this.xLen=this.xEnd-this.xStart+1;this.yLen=this.yEnd-this.yStart+1,this.setupStepDefs()}this.target=this;l.call(this,{delay:0,loop:this.loop,startPosition:this.startPosition});e.sprite&&this.setSprite(e.sprite)};y.prototype.showOneMultiImgsFrame=function(t){var i=t.extraArg[0],n=this.frames[i];if(e){this.sprite.setFill(n.url);this.sprite.setSize(n.size.width,n.size.height)}else this.sprite.setTexture(PIXI.Texture.fromImage(n.url));return this};y.prototype.showOneLargeImgFrame=function(t){var i=t.extraArg[0],n=t.extraArg[1],r=this.frame,o=this.size,s=r.hFrameOffset+i,a=r.vFrameOffset+n,h=r.hPixelOffset+o.width*s+i*r.hSplit,c=r.vPixelOffset+o.height*a+n*r.vSplit;e?this.sprite.setOffset(-h,-c):this.setPixiFrame(h,c,o.width,o.height);return this};y.prototype.setupMultiImages=function(e){this.frames=e;var t=e.length,i=0;this.stepDefs_=new Array(t+1);for(var n=0;t>n;n++){this.stepDefs_[n]=[i,this.showOneMultiImgsFrame,[n]];i+=60*e[n].delay}this.stepDefs_[t]=[i,g];this.stepMax_=i+1;return this};y.prototype.setupLargeImage=function(e){this.frame=e;var t=e.total,i=60*e.delay,n=e.xNum;this.stepDefs_=new Array(t+1);for(var r=0;t>r;r++)this.stepDefs_[r]=[r*i,this.showOneLargeImgFrame,[r%n,Math.floor(r/n)]];this.stepDefs_[t]=[t*i,g];this.stepMax_=t*i+1;return this};y.prototype.setupStepDefs=function(){var e=this.xStart,t=this.xLen,i=this.yStart,n=this.yLen,r=this.delay,o=t*n,s=0;this.stepDefs_=new Array(o+1);for(var a=0;n>a;a++)for(var h=0;t>h;h++){s=a*t+h;this.stepDefs_[s]=[s*r,this.showFrame,[e+h,i+a]]}this.stepDefs_[o]=[o*r,g];this.stepMax_=o*r+1;return this};y.prototype.showFrame=function(t){var i=t.extraArg,n=i[0],r=i[1],o=this.size;e?this.sprite.setOffset(-n*o.width,-r*o.height):this.setPixiFrame(n*o.width,r*o.height,o.width,o.height);return this};y.prototype.setPixiFrame=function(e,t,i,n){var r=this.sprite,o=e+":"+t;r.pixiFrames||(r.pixiFrames={});if(!r.pixiFrames[o]){var s={x:e,y:t,width:i,height:n};r.pixiFrames[o]=new PIXI.Texture(r.texture.baseTexture,s);r.setSize(s.width,s.height)}r.setTexture(r.pixiFrames[o])};y.prototype.setSprite=function(t){this.sprite=t;this.size=t.getSize();e&&t.inTree_&&this.start();return this};var Ie=!1;y.prototype.getDirector=function(){return current_scene.isPaused_&&Ie?null:qyengine.getDirector()};y.prototype.setSpeed=function(e,t){var i;if("multiImages"===this.type){var n;if(t){e+=100;n=JSON.parse(JSON.stringify(this.frames||[]))}else{n=this.keyframeOpt&&this.keyframeOpt.frames;n=JSON.parse(JSON.stringify(n||[]))}n&&n.length&&n.forEach(function(t){t.delay/=e/100});i={loop:this.loop,frames:n,startPosition:this.startPosition}}else if("largeImage"===this.type){var r;if(t){e+=100;r=JSON.parse(JSON.stringify(this.frame||{}))}else{r=this.keyframeOpt;r=JSON.parse(JSON.stringify(r||{}))}r.delay/=e/100;i=r}else{i=this;if(t){e+=100;this.delay=this.delay/60/e*100}else this.delay=this.keyframeOpt&&this.keyframeOpt.delay/60/e*100}this.stop();this.changeFrame(i);this.start()};goog.inherits(f,QyEventTarget);window.QyObject=f;ne(f);Object.defineProperties(f.prototype,{text:{configurable:!0,get:function(){return this.getText()},set:function(e){this.setText(e)}},rotation:{configurable:!0,get:function(){return this.getRotation()},set:function(e){this.setRotation(e)}},rotationSpeed:{configurable:!0,get:function(){return this.getRotationSpeed()},set:function(e){this.setRotationSpeed(e)}},fixedRotation:{configurable:!0,get:function(){return this.isFixedRotation()},set:function(e){this.setFixedRotation(e)}},speed:{configurable:!0,get:function(){return this.getSpeed()||{x:0,y:0,angle:0}},set:function(e,t){this.setSpeed&&this.setSpeed(e,t);return this}},friction:{configurable:!0,get:function(){return this.getFriction()},set:function(e){this.setFriction(e);return this}},gravityScale:{configurable:!0,get:function(){return this.getGravityScale()},set:function(e){this.setGravityScale(e);return this}},restitution:{configurable:!0,get:function(){return this.getRestitution()},set:function(e){this.setRestitution(e);return this}},"是感应器":{configurable:!0,get:function(){return this.getIsSensor()},set:function(e){this.setIsSensor(e);return this}},isSensor:{configurable:!0,get:function(){return this.getIsSensor()},set:function(e){this.setIsSensor(e);return this}},awake:{configurable:!0,get:function(){return this.isAwake()},set:function(e){this.setAwake(e);return this}}});var Pe=new b2Vec2(0,0);f.prototype.setMirror=function(e,t){var i;if(null!=e&&this.mirror.horizontal!=e){i=!0;this.mirror.horizontal=e}if(null!=t&&this.mirror.vertical!=t){i=!0;this.mirror.vertical=t}if(i&&this.currentSprite&&this.currentSprite.setMirror){this.currentSprite.setMirror(this.mirror.horizontal,this.mirror.vertical);this.b2dBody&&this.setupBody(!0)}};f.prototype.getBoundingBox=function(){this.boundingBox_||(this.boundingBox_={lx:0,rx:0,ly:0,ry:0});if(this.currentSprite){var e=this.getPosition(),t=this.getAnchorPoint(),i=this.getSize(),n=this.getScale();this.boundingBox_.lx=e.x-t.x*i.width*n.x;this.boundingBox_.rx=e.x+(1-t.x)*i.width*n.x;this.boundingBox_.ly=e.y-t.y*i.height*n.y;this.boundingBox_.ry=e.y+(1-t.y)*i.height*n.y}return this.boundingBox_};qyengine.queryPoint=function(e,t){for(var i=[],n=current_scene.instances.length,r=0;n>r;r++){var o=current_scene.instances[r],s=o.getBoundingBox();m(s,e,t)&&i.push(o)}return i};qyengine.checkIfEmpty=function(e,t,i){var n=qyengine.queryPoint(e,t);if(!i)return 0==n.length;for(var r=0;r<n.length;r++){var o=n[r];if("solid"==o.getType()&&!o.destroyBuffered&&!o.destroyed_)return!1}return!0};f.prototype.toObj=function(){var e={type:this.classId,position:{x:this.x,y:this.y},scale:{x:this.scaleX,y:this.scaleY},id:this.id};this.currentSprite&&(e.sprite=this.currentSprite.classId);return e};f.prototype.mirrorH=function(){this.setMirror(-1,void 0)};f.prototype.mirrorV=function(){this.setMirror(void 0,-1)};f.prototype.checkIfEmpty=function(e,t,i){return qyengine.checkIfEmpty(e,t,i)};f.prototype.checkIfCollide=function(e,t,i){return!qyengine.checkIfEmpty(e,t,i)};qyengine.guardType=w;qyengine.guardId=_;f.prototype.checkTypeAt=function(e,t,i){var n=w(i);if(!n)return!1;for(var r=qyengine.queryPoint(e,t),o=0;o<r.length;o++){var s=r[o];if(s instanceof n&&!s.destroyBuffered&&!s.destroyed_)return!0}return!1};qyengine.getInstancesByType=function(e){function t(e,t){for(var i=0,n=e.length;n>i;i++)if(t instanceof e[i])return!0}e instanceof Array||(e=[e]);var i=[],n=[];e.forEach(function(e){var t=qyengine.guardType(e);t&&i.indexOf(t)<0&&i.push(t)});if(!i||!i.length)return n;for(var r=0;r<current_scene.instances.length;r++){var o=current_scene.instances[r];o.destroyBuffered||o.destroyed_||!t(i,o)||n.push(o)}return n};qyengine.getInstanceCount=function(e){var t=w(e);if(!t)return 0;for(var i=0,n=0;n<current_scene.instances.length;n++){var r=current_scene.instances[n];r instanceof t&&!r.destroyBuffered&&!r.destroyed_&&i++}return i};f.prototype.setViewCenter=function(e){current_scene.viewFollowObj(this,!0,e)};qyengine.initVars=function(e,t){e.vars_||(e.vars_={});for(var i in t){var n=t[i];null!=n.value&&(n=n.value);n.length>1&&"{"==n[0]&&"}"==n[n.length-1]&&(n="(function(){return "+n+";})();");e.vars_[i]=qyboot.evalClean.call(e,n)}};f.prototype.initVars=function(e){this.vars_={};this.constructor.prototype.setVar=S;this.constructor.prototype.toggleVar=b;e.extend&&qyengine.initVars(this,e.extend)};f.prototype.setFollowView=function(){if(!this.id){this.id="followingObj";window[this.id]=this}current_scene.setFollowView(this)};f.prototype.setOpacity=function(e){this.currentSprite&&this.currentSprite.setOpacity&&this.currentSprite.setOpacity(Math.round(1e3*e)/1e3)};f.prototype.getOpacity=function(){return this.currentSprite&&this.currentSprite.getOpacity&&this.currentSprite.getOpacity()};f.prototype.setMask=function(e){if(e!==this){var t;t="string"==typeof e?window[e]&&window[e].currentSprite:e&&e.currentSprite;if(t){this.mask=t;var i=this.currentSprite;i&&i.setMask&&i.setMask(t)}}};f.prototype.cancelMask=function(){this.currentSprite&&this.currentSprite.setMask&&this.currentSprite.setMask(null);this.mask&&this.mask.setDirty(-1);this.mask=null};f.prototype.makeDraggable=function(e){function t(t){r.initMouseJoint(e);t.swallow(["mouseup","touchend"],function(){r.releaseMouseJoint()});t.swallow(["mousemove","touchmove"],function(e){var t=this.localToParent(e.position);r.dragToPos(t.x,t.y)})}var i=this.currentSprite;if(!i||this.dragListeners&&this.dragListeners.length>0)return this;var r=this;this.dragListeners||(this.dragListeners=[]);this.dragListeners.push(n(i,"mousedown",t));this.dragListeners.push(n(i,"touchstart",t));return this};f.prototype.releaseDraggable=function(){this.releaseMouseJoint();if(this.dragListeners){goog.array.forEach(this.dragListeners,function(e){goog.events.unlistenByKey(e)});this.dragListeners.length=0}};f.prototype.dragToObj=function(e,t){var i=E(e);if(i&&i.getPosition){var n=i.getPosition();this.dragToPos(n.x,n.y,t)}};f.prototype.dragToPos=function(e,t,i){var n=this.initMouseJoint(i);Pe.x=e*Je;Pe.y=t*Je;n.SetTarget(Pe)};f.prototype.initMouseJoint=function(e){if(this.mouseJoint_){e&&this.mouseJoint_.SetMaxForce(e);return this.mouseJoint_}this.b2dBody||this.setupBody();var t=this.b2dBody;if(!t)return null;var i=new b2MouseJointDef;i.bodyA=current_game.world.GetGroundBody();i.bodyB=t;var n=this.getPosition();i.target.Set(n.x*Je,n.y*Je);i.maxForce=(e||500)*t.m_mass;this.mouseJoint_=current_game.world.CreateJoint(i);return this.mouseJoint_};f.prototype.releaseMouseJoint=function(){if(this.mouseJoint_){current_game.world.DestroyJoint(this.mouseJoint_);this.mouseJoint_=null}};qyengine.calAngle=x;f.prototype.faceToward=function(e){if(this.currentSprite){var t;switch(e.toward){case"object":var i=E(e.objId);i&&(t=i.getPosition());break;case"coordinate":var n=e.relative_x,r=e.relative_y,o=e.x+(n?this.x:0),s=e.y+(r?this.y:0);t={x:o,y:s};break;case"mouse":t={x:mouseX,y:mouseY}}if(t){var a,h=this.getPosition(),c=e.delta||0,l=e.min_rotation||0,d=e.max_rotation?e.max_rotation:360,u=(x(t.x-h.x,t.y-h.y)+c)%360;a=0>l&&0>d?u>=l+360&&d+360>=u:0>l?u>=l+360||d>=u:u>=l&&d>=u;a&&this.setRotation(u)}}if(e.always){this.faceTowardAlways=e;if(current_game.mvListened)current_game.mvListenedCount++;else{current_game.mvListened=current_game.director.listen("mousemove",function(){});current_game.mvListenedCount=1}}else{this.faceTowardAlways=null;current_game.mvListenedCount--;if(0==current_game.mvListenedCount){current_game.director.unlistenByKey(current_game.mvListened);current_game.mvListened=null}}};f.prototype.faceForward=function(e,t){var i=this.animSpeed||this.getSpeed();if(i){e||(e=0);var n=x(i.x,i.y);this.setRotation(n+e)}if(t){this.faceForwardAlways||(this.faceForwardAlways={});this.faceForwardAlways.delta=e}else this.faceForwardAlways=null;return this};f.prototype.getGravityScale=function(){return this.b2dBody&&this.b2dBody.GetGravityScale()||0};f.prototype.setGravityScale=function(e){this.b2dBody||this.setupBody();var t=this.b2dBody;if(!t)return this;t.SetGravityScale(e);t.SetAwake(!0);return this};f.prototype.setSpriteSpeed=function(e,t){this.currentSprite&&this.currentSprite.setSpeed&&this.currentSprite.setSpeed(e,t)};f.prototype.getRestitution=function(){return this.b2dBody&&this.b2dBody.GetFixtureList().GetRestitution()||0};f.prototype.setRestitution=function(e){this.b2dBody&&this.b2dBody.GetFixtureList().SetRestitution(e)};f.prototype.getFriction=function(){return this.b2dBody&&this.b2dBody.GetFixtureList().GetFriction()||0};f.prototype.setFriction=function(e){this.b2dBody&&this.b2dBody.GetFixtureList().SetFriction(e)};f.prototype.isFixedRotation=function(){return this.b2dBody&&this.b2dBody.IsFixedRotation()};f.prototype.setFixedRotation=function(e){this.b2dBody||this.setupBody();var t=this.b2dBody;if(!t)return this;if(null==e||e===!1)t.SetFixedRotation(!1);else{e!==!0&&this.setRotation(e);t.m_angularVelocity=0;t.SetFixedRotation(!0)}t.SetAwake(!0);return this};f.prototype.addJoint=function(e,t){var i=e.m_bodyA.qyobj,n=e.m_bodyB.qyobj;t||(t=i.jointCount_++ +":"+n.jointCount_++);i.releaseJointById(t);n.releaseJointById(t);i.joints_[t]=e;n.joints_[t]=e;return e};f.prototype.releaseJointById=function(e){var t=this.joints_[e];if(!t)return this;var i=t.m_bodyA.qyobj,n=t.m_bodyB.qyobj;delete i.joints_[e];delete n.joints_[e];current_game.world.DestroyJoint(t);return this};f.prototype.releaseJoints=function(e){if(e)return this.releaseJointById(e);for(e in this.joints_)this.releaseJointById(e);return this};f.prototype.beforeCreateJoint=function(e){if(!e)return!1;this.b2dBody||this.setupBody();var t=[];if(!this.b2dBody)return t;var i;i="string"==typeof e?qyengine.getInstancesByType(e):[e];for(var n=0;n<i.length;n++){e=i[n];e.b2dBody||e.setupBody();e.b2dBody&&t.push(e.b2dBody)}return t};f.prototype.createDistanceJoint=function(e,t){var i=this.beforeCreateJoint(e),n=i.length;if(0>=n)return null;for(var r=this.b2dBody,o=0;n>o;o++){var s=i[o],a=new b2DistanceJointDef;a.Initialize(r,s,r.GetWorldCenter(),s.GetWorldCenter());this.addJoint(current_game.world.CreateJoint(a),t)}};f.prototype.createRopeJoint=function(e,t){var i=this.beforeCreateJoint(e),n=i.length;if(0>=n)return null;for(var r=this.b2dBody,o=0;n>o;o++){var s=i[o],a=new b2RopeJointDef;a.Initialize(r,s,r.GetWorldCenter(),s.GetWorldCenter());this.addJoint(current_game.world.CreateJoint(a),t)}};f.prototype.createRevoluteJoint=function(e,t){var i=this.beforeCreateJoint(e),n=i.length;if(0>=n)return null;for(var r=this.b2dBody,o=0;n>o;o++){var s=i[o],a=new b2RevoluteJointDef;a.Initialize(r,s,r.GetWorldCenter());this.addJoint(current_game.world.CreateJoint(a),t)}};f.prototype.createWeldJoint=function(e,t){var i=this.beforeCreateJoint(e),n=i.length;if(0>=n)return null;for(var r=this.b2dBody,o=0;n>o;o++){var s=i[o],a=new b2WeldJointDef;a.Initialize(r,s,s.GetWorldCenter());this.addJoint(current_game.world.CreateJoint(a),t)}};f.prototype.createPrismaticJoint=function(e,t){var i=this.beforeCreateJoint(e),n=i.length;if(0>=n)return null;for(var r=this.b2dBody,o=new b2Vec2(0,1),s=0;n>s;s++){var a=i[s],h=new b2PrismaticJointDef;h.Initialize(r,a,a.GetWorldCenter(),o);h.lowerTranslation=-5;h.upperTranslation=2.5;h.enableLimit=!0;this.addJoint(current_game.world.CreateJoint(h),t)}};f.prototype.applyForce=function(e,t,i){if(!e&&!t)return this;this.b2dBody||this.setupBody();var n=this.b2dBody,r=n.GetMass(),o=n.GetWorldCenter();Pe.x=r*e/Je;Pe.y=r*t/Je;n.SetBullet(!0);i?this.b2dBody.ApplyImpulse(Pe,o):this.b2dBody.ApplyForce(Pe,o);return this};f.prototype.applyTorque=function(e){if(!e)return this;e/=Je;this.b2dBody||this.setupBody();var t=this.b2dBody,i=t.GetMass();this.b2dBody.ApplyTorque(i*e);return this};f.prototype.setupHammer=function(){if(this.hammer||!this.currentSprite)return this;this.hammer=Hammer(this.currentSprite);var e=this;for(var t in Hammer.gestures)this.hammer.on(Hammer.gestures[t].name,function(t){e.isShieldEvent&&e.isShieldEvent(t)||e.dispatchEvent(t)});return this};f.prototype.setActive=function(e){this.b2dBody&&this.b2dBody.SetActive(e)};f.prototype.setHidden=function(e){this.currentSprite&&this.currentSprite.setHidden(e);this.setActive(!e);this.isHidden_=e;return this};f.prototype.toggleHidden=function(){this.setHidden(!this.isHidden_)};f.prototype.show=function(){this.setHidden(!1);return this};f.prototype.hide=function(){this.setHidden(!0);return this};f.prototype.getText=function(){return this.currentSprite&&this.currentSprite.getText&&this.currentSprite.getText()};f.prototype.setText=function(e){this.currentSprite&&this.currentSprite.setText&&this.currentSprite.setText(e)};f.prototype.addText=function(e){this.currentSprite&&this.currentSprite.addText&&this.currentSprite.addText(e)};f.prototype.setFontColor=function(e){this.currentSprite&&this.currentSprite.setFontColor&&this.currentSprite.setFontColor(e)};f.prototype.setFontSize=function(e){this.currentSprite&&this.currentSprite.setFontSize&&this.currentSprite.setFontSize(e)};f.prototype.setType=function(e){var t=b2Body.b2_dynamicBody;if(this.b2dBody){switch(e){case"solid":t=b2Body.b2_staticBody;break;case"kinematic":t=b2Body.b2_kinematicBody}this.b2dBody.GetType()!=t&&this.b2dBody.SetType(t)}return this};f.prototype.getType=function(){var e;if(this.b2dBody)switch(this.b2dBody.GetType()){case b2Body.b2_staticBody:e="solid";break;case b2Body.b2_kinematicBody:e="kinematic";break;default:e="dynamic"}return e};f.prototype.setRandomPath=function(e){var t=e.paths;if(!t||0==t.length)return this;var i=random(t.length-1);return this.setPath(t[i],e)};f.prototype.setPath=function(e,t){e.classId&&(e=e.classId);var i=w(e);if(i){this.path_=new i(t);this.path_.target=this;this.path_.start()}return this};f.prototype.setPathSpeed=function(e,t){if(this.path_){t&&(e+=this.path_.speed);this.path_.setSpeed(e)}return this};f.prototype.setPathPosition=function(e,t){this.path_&&this.path_.setPosition(e,t)};f.prototype.endPath=function(){if(this.path_){this.path_.stop();this.setSpeed(0)}};k(f);var qe,Ee,Be,Ce=!1,Oe=[],ze=[];f.prototype.objListen=function(e,t,i){this.eventHandlerKeys||(this.eventHandlerKeys=[]);if(window.isLime)this.eventHandlerKeys.push(n(e,t,i));else{n(e,t,i);this.eventHandlerKeys.push([e,t,i])}};f.prototype.selfListen=function(e,t){this.objListen(this,e,t)};f.prototype.selfUnlisten=function(){if(this.eventHandlerKeys){goog.array.forEach(this.eventHandlerKeys,function(e){window.isLime?goog.events.unlistenByKey(e):e[0].unlisten(e[1],e[2])});this.eventHandlerKeys.length=0}};f.prototype.spriteListen=function(t,i){if(this.currentSprite){this.currentSprite.interactive=!0;this.currentSprite.listen(t,i);e||(this.currentSprite[t]=i);this.spriteHandlers||(this.spriteHandlers=[]);this.spriteHandlers.push([t,i])}return this};f.prototype.dispatchMessage=function(e){if(this==current_scene)for(var t=0;t<current_scene.instances.length;t++)P(current_scene.instances[t],e);P(this,e)};f.prototype.spriteUnlisten=function(){var e=this.currentSprite;if(e){e.keyframe&&e.keyframe.stop();if(this.spriteHandlers){goog.array.forEach(this.spriteHandlers,function(t){e.unlisten(t[0],t[1])});this.spriteHandlers.length=0}var t=e.parent_||e.parent;t&&t.removeChild(e);delete this.currentSprite}this.releaseDraggable&&this.releaseDraggable()};f.prototype.destroyBody=function(){this.releaseJoints();this.releaseMouseJoint();if(this.b2dBody){current_game.world.DestroyBody(this.b2dBody);goog.array.remove(this.scene.instancesWithBody,this);delete this.b2dBody}};f.prototype.maintainId=function(){var e=this.id;if(e){if(window[e]==this){var t=window[e].classId;t?window[e]={classId:t,destroyed_:!0}:delete window[e]}delete this.id}};f.prototype.destroyIsolate=function(){this.selfUnlisten();this.spriteUnlisten();this.cancelAllAlarms();this.stopTimeline();delete this.timeline_};f.prototype.destroy=function(e){if(Ce){if(!this.destroyBuffered){e||this.dispatchEvent("destroy");Oe.push(this);this.destroyBuffered=!0}}else if(!this.destroyed_){this.destroyed_=!0;e||this.dispatchEvent("destroy");this.destroyIsolate();this.stopAnimation();this.unfollowMouse();this.destroyBody();this.maintainId();goog.array.remove(this.scene.instances,this)}};f.prototype.changeInstance=function(e,t){return instance_change(this,e,t)};f.prototype.moveBy=function(e,t,i){var n=this.getPosition();return this.moveTo(n.x+e,n.y+t,i)};f.prototype.moveTo=function(e,t,i){i||(i=300);var r=this.getPosition(),o=$(r,e,t);if(0==o.xRatio&&0==o.yRatio){this.dispatchEvent("moveend");this.movestarted=!1;return this}if(this.b2dBody){this.moveTarget_=o;this.setSpeed({x:o.xRatio*i,y:o.yRatio*i});this.animSpeed=null}else if(this.currentSprite){var s=new lime.animation.MoveTo(e,t);i&&s.setSpeed(100/i);this.animSpeed={x:o.xRatio*i,y:o.yRatio*i,angle:qyengine.calAngle(o.xRatio,o.yRatio)};var a=this;n(s,"stop",function(){a.dispatchEvent("moveend");a.animSpeed=null;a.movestarted=!1;current_scene.is25D&&a.checkZAxis()});this.currentSprite.runAction(s)}this.dispatchEvent("movestart");this.movestarted=!0;return this};var De=qyengine.R2A=180/Math.PI,Re=qyengine.A2R=Math.PI/180;f.prototype.stopAnimation=function(){this.animation&&this.animation.stop();if(this.animListenerKeys){for(var e=0;e<this.animListenerKeys.length;e++)goog.events.unlistenByKey(this.animListenerKeys[e]);this.animListenerKeys.length=0}return this};f.prototype.runAnimation=function(e){if(this.currentSprite){var t=this.createAnimation(e);if(t){this.stopAnimation();this.animation=t;this.animListenerKeys||(this.animListenerKeys=[]);var i=this;this.animListenerKeys.push(n(t,"start",function(){i.dispatchEvent("animationstart")}));this.animListenerKeys.push(n(t,"stop",function(){i.dispatchEvent("animationend")}));this.currentSprite.runAction(t)}}return this};f.prototype.createAnimation=function(e){if("string"==typeof e){var t=current_game.animations[e];if(!t)return null;var i=this.createFrames(t.frames);return new lime.animation.Loop(i).setLimit(t.loop)}if(e instanceof Array){var n=this,r=goog.array.map(e,function(e){return n.createAnimation(e)});return 1==r.length?r[0]:new lime.animation.Sequence(r)}e=q(e);var t=new lime.animation[e.type](e.val);e.duration&&t.setDuration(e.duration);return t};f.prototype.createOneFrame=function(e){for(var t=[],i=e.anim,n=e.duration,r=this.getPosition(),o=0;o<i.length;o++){var s=i[o],a=s[0],h=s[1];if("oldFormatMove"==a){a="moveTo";h={x:h.x+r.x,y:h.y+r.y}}var c=new(lime.animation[a[0].toUpperCase()+a.slice(1)])(h).setDuration(n);t.push(c)}return 1==t.length?t[0]:new lime.animation.Spawn(t)};f.prototype.createFrames=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];t.push(this.createOneFrame(n))}return 1==t.length?t[0]:new lime.animation.Sequence(t)};var Te=["scaleTo","scaleBy","moveTo","moveBy","rotateTo","rotateBy","colorTo","fadeTo","delay"],Le={density:1};f.prototype.genPolygonShape=function(e,t,i,n){var r,o,s,a,h;if(e.points&&(a=e.points.length)>2){for(var c=new Array(a),l=0;a>l;l++){o=e.points[l].x*i;s=e.points[l].y*n;h=l;if(-1==this.mirror.horizontal&&-1==this.mirror.vertical){o=-o;s=-s}else if(-1==this.mirror.horizontal){h=a-l-1;o=-o}else if(-1==this.mirror.vertical){h=a-l-1;s=-s}c[h]={x:o+t.x,y:s+t.y}}try{r=qyengine.separateShape(c)}catch(d){console.log(d);r=b2PolygonShape.AsArray(c)}}return r};f.prototype.genCircleShape=function(e,t,i,n,r,o){var s=new b2CircleShape,a=e.center&&e.center.x&&e.center.x*r||0,h=e.center&&e.center.y&&e.center.y*o||0,c=-1==this.mirror.horizontal?-a:a,l=-1==this.mirror.vertical?-h:h,d=new b2Vec2(c+t.x,l+t.y),u=e.radius&&e.radius*Math.min(r,o)||Math.min(i*r,n*o);s.SetLocalPosition(d);s.SetRadius(u);return s};f.prototype.genShape=function(e,t,i,n,r,o){var s;if(e instanceof Array){for(var a=[],h=0;h<e.length;h++){s=this.genShape(e[h],t,i,n,r,o);s&&goog.array.extend(a,s)}return a}if(e)switch(e.type){case"polygon":s=this.genPolygonShape(e,t,r,o);break;case"circle":s=this.genCircleShape(e,t,i,n,r,o)}s||(s=b2PolygonShape.AsOrientedBox(i*r,n*o,t));var c=e&&e.name;if(s instanceof Array)for(var h=0;h<s.length;h++)s[h].fixName=c;else s.fixName=c;return s};f.prototype.calShape=function(){var e=this.getAnchorPoint(),t=this.currentSprite.constructor.defaultOpt.size,i=this.getSize(),n=this.getScale(),r=i.width/t.width*n.x*Je,o=i.height/t.height*n.y*Je,i=t,s=i.width/2,a=i.height/2,h=(.5-e.x)*i.width,c=(.5-e.y)*i.height,l={x:h*r,y:c*o};return this.genShape(this.physics.collisionData,l,s,a,r,o)};f.prototype.calFixtureDef=function(){if(this.fixtureDef)return this.fixtureDef;var e=new b2FixtureDef,t=this.physics;goog.object.extend(e,t);e.filter.categoryBits=t.categoryBits;e.filter.maskBits=t.maskBits;t.solid&&(e.density||(e.density=1));this.fixtureDef=e;this.isSensor_=e.isSensor;return e};f.prototype.controlRotation=function(e,t){if(null==e&&null==t)return this;this.b2dBody||this.setupBody();var i=this.b2dBody;if(!i)return this;e||(e=0);i.m_angularVelocity=-e*Re;t?this.setRotateOnly():this.removeRotateOnly();this.setAwake(!0);return this};f.prototype.setRotateOnly=function(){if(this.pinJoint)return this;this.b2dBody||this.setupBody();var e=this.b2dBody;if(!e)return this;var t=current_game.world.GetGroundBody(),i=new b2RevoluteJointDef;i.Initialize(e,t,e.GetWorldCenter());this.pinJoint=current_game.world.CreateJoint(i);return this};f.prototype.removeRotateOnly=function(){if(!this.pinJoint)return this;current_game.world.DestroyJoint(this.pinJoint);this.pinJoint=null;return this};f.prototype.setRotationSpeed=function(e){this.b2dBody||this.setupBody();var t=this.b2dBody;if(!t)return this;t.m_angularVelocity=-e*Re;return this};f.prototype.getRotationSpeed=function(){this.b2dBody||this.setupBody();var e=this.b2dBody;return e?-e.m_angularVelocity*De:0};f.prototype.applyForceWithAngle=function(e,t,i,n){var r=(n?t+180:t)*Re;return this.applyForce(e*Math.cos(r),-e*Math.sin(r),i)};f.prototype.applyForceTowardPos=function(e,t,i,n,r){if(null==e||null==t)return this;null!=i||(i=200);var o=this.getPosition(),s=e-o.x,a=t-o.y,h=x(s,a);return this.applyForceWithAngle(i,h,n,r)};f.prototype.applyForceTowardTap=function(e,t,i){return this.applyForceTowardPos(window.mouseX,window.mouseY,e,t,i)};f.prototype.applyForceTowardObject=function(e,t,i,n){var r=E(e),o=r&&r.getPosition();return o?this.applyForceTowardPos(o.x,o.y,t,i,n):void 0};f.prototype.setSpeedWithAngle=function(e,t){var i=t*Re;return this.setSpeed(e*Math.cos(i),-e*Math.sin(i))};f.prototype.setSpeedTowardPos=function(e,t,i){if(null==e||null==t)return this;null!=i||(i=200);var n=this.getPosition(),r=e-n.x,o=t-n.y,s=x(r,o);return this.setSpeedWithAngle(i,s)};f.prototype.setSpeedTowardObject=function(e,t){var i=E(e),n=i&&i.getPosition();return n?this.setSpeedTowardPos(n.x,n.y,t):void 0};f.prototype.setSpeedTowardTap=function(e){return this.setSpeedTowardPos(window.mouseX,window.mouseY,e)};f.prototype.calBody=function(){if(this.b2dBody)return this.b2dBody;var e=this.getPosition(),t=this.getRotation(),i=-t*Re,n=this.physics,r=new b2BodyDef;
goog.object.extend(r,n);r.position.x=e.x*Je;r.position.y=e.y*Je;r.angle=i;n.solid||(r.type=b2Body.b2_dynamicBody);this.b2dBody=current_game.world.CreateBody(r);this.bodyDef=r;this.oldRotr_=i;this.oldRota_=t;this.oldPos_=e;if(n){this.controlRotation(n.rotateSpeed,n.rotateOnly);this.setFixedRotation(n.fixedRotation);this.isBullet_=!!n.bullet}this.b2dBody.qyobj=this;this.joints_={};this.jointCount_=0;return this.b2dBody};f.prototype.destroyFixtures=function(){var e=this.b2dBody;if(e)for(var t=e.GetFixtureList();t;){e.DestroyFixture(t);t=e.GetFixtureList()}};f.prototype.getIsSensor=function(){return this.isSensor_};f.prototype.setIsSensor=function(e){if(this.b2dBody){for(var t=this.b2dBody.GetFixtureList();t;){t.SetSensor(e);t=t.m_next}this.isSensor_=e;this.fixtureDef&&(this.fixtureDef.isSensor=e)}};f.prototype.setupBody=function(e){if(this.destroyed_||this.destroyBuffered)return this;this.physics||(this.physics=Le);if(this.b2dBody&&!e)return this;var t=this.currentSprite;if(!t)return this;t.physics&&t.physics.collisionData&&(this.physics.collisionData=t.physics.collisionData);if(e&&this.b2dBody){this.destroyFixtures();this.b2dBody.fixtureDef=null;this.setAwake(!0)}var i,n=this.calShape(),r=this.calFixtureDef(),o=this.calBody();if(n instanceof Array)for(var s=0;s<n.length;s++){r.shape=n[s];i=o.CreateFixture(r);i.fixName=n[s].fixName}else{r.shape=n;i=o.CreateFixture(r);i.fixName=n.fixName}current_scene.instancesWithBody.push(this);return this};var Me=[],Fe=[],Ne=new goog.math.Coordinate,je=new goog.math.Coordinate;if(!e)var Ve=new PIXI.InteractionData;f.prototype.followMouse=function(t,i,n,r,o,s){this.followMouse.deltaX=i;this.followMouse.deltaY=n;if(!this.followingMouse){Me.push(this);if(e&&0==Fe.length)if(Hammer.HAS_TOUCHEVENTS){Fe[0]=current_game.director.listen("touchstart",C);Fe[1]=current_game.director.listen("touchmove",C)}else Fe[0]=current_game.director.listen("mousemove",C);t&&hide_cursor()}this.followingMouse=r;this.followingMouseWay=o;this.followingMouseSpeed=s;e||B();return this};f.prototype.unfollowMouse=function(){if(this.followingMouse){delete this.followingMouse;goog.array.remove(Me,this);if(Me.length<=0){restore_cursor();goog.array.forEach(Fe,function(e){current_game.director.unlistenByKey(e)});Fe.length=0}this.releaseMouseJoint();this.setSpeed(0,0)}this.followingOpt=null;return this};f.prototype.step_=function(e){this.currentSprite&&this.currentSprite.moveBySpeed&&this.currentSprite.moveBySpeed(e);this.b2dBody?this.updateByBody():this.moveBySpeed(e);this.faceForwardAlways&&this.faceForward(this.faceForwardAlways.delta,!0);this.faceTowardAlways&&this.faceToward(this.faceTowardAlways);var t=this.followingOpt;if(t){var i=E(t.objId);if(i&&i.getPosition){var n=i.getPosition(),r=this.getPosition(),o=r.x,s=r.y,a=t.followType;if("both"==a){o=n.x+t.x;s=n.y+t.y}else"x"==a?o=n.x+t.x:s=n.y+t.y;this.setPosition(o,s,!0)}}if(this.followingMouse){var h=this.getPosition();qyengine.calDistance(h.x,h.y,window.mouseX||0,window.mouseY||0)<10&&this.setSpeed(0,0)}};f.prototype.cancelAlarm=function(e){if(this.scheduledAlarms){var t=this.scheduledAlarms[e];if(t){lime.scheduleManager.unschedule(t,this);this.scheduledAlarms[e]=null}}};f.prototype.cancelAllAlarms=function(){if(this.scheduledAlarms)for(var e in this.scheduledAlarms)this.cancelAlarm(e)};f.prototype.setAlarm=function(e,t){this.scheduledAlarms||(this.scheduledAlarms={});this.cancelAlarm(e);var i=this,n=function(){i.scheduledAlarms[e]=null;var t={type:"alarm",alarmIdx:e};if(i==current_scene)for(var n=0;n<current_scene.instances.length;n++)current_scene.instances[n].dispatchEvent(t);i.dispatchEvent(t)};this.scheduledAlarms[e]=n;lime.scheduleManager.callAfter(n,this,t)};f.prototype.moveBySpeed=function(e){if(!this.selfSpeed){this.checkOutofscene();return this}var t,i=this.selfSpeed.x*e,n=this.selfSpeed.y*e,r=this.getPosition(),o={x:r.x+i,y:r.y+n},s=this.moveTarget_;if(s&&O(s.xRatio,s.x,o.x)&&O(s.yRatio,s.y,o.y)){o.x=s.x;o.y=s.y;this.setPosition(o.x,o.y,!0);if(s.relatedTo&&this.path_)this.path_.reachPoint(s);else{delete this.moveTarget_;t=!0}}else this.setPosition(o.x,o.y,!0);if(t){Ge=!0;this.dispatchEvent("moveend");Ge=!1;this.moveendSpSet?this.moveendSpSet=!1:this.setSpeed(0)}return this};f.prototype.releaseBody=function(){var e=this.b2dBody;if(e){e.qyobj=null;current_game.world.DestroyBody(e);this.b2dBody=null}};f.prototype.updatePosByBody=function(){var e=this.b2dBody.GetPosition(),t=new goog.math.Coordinate(e.x/Je,e.y/Je);if(this.oldPos_.x!=t.x||this.oldPos_.y!=t.y){var i,n=this.moveTarget_,r=this.currentSprite;if(n&&O(n.xRatio,n.x,t.x)&&O(n.yRatio,n.y,t.y)){var o;if(t.x!=n.x){t.x=n.x;o=!0}if(t.y!=n.y){t.y=n.y;o=!0}o&&this.setPosition(t.x,t.y,!0);if(n.relatedTo&&this.path_)this.path_.reachPoint(n);else{delete this.moveTarget_;i=!0}}this.oldPos_.x=t.x;this.oldPos_.y=t.y;r.setPosition(t);if(i){Ge=!0;this.dispatchEvent("moveend");Ge=!1;this.moveendSpSet?this.moveendSpSet=!1:this.setSpeed(0)}this.checkOutofscene(t)}else this.checkOutofscene(t)};var Ge=!1;f.prototype.updateRotByBody=function(){var e=this.currentSprite;if(e){var t=this.b2dBody.GetAngle(),i=Math.abs(t);1e-6>=i&&(t=0);if(this.oldRotr_!=t){var n=-t*De;e.setRotation(n);this.oldRotr_=t;this.oldRota_=n}}};f.prototype.updateByBody=function(){this.updatePosByBody();this.updateRotByBody()};f.prototype.checkOutofscene=function(e,t){e||(e=this.getPosition());if(e){var i="",n=e.x,r=e.y;0>n?i="left":n>this.scene.full_size.width?i="right":0>r?i="top":r>this.scene.full_size.height&&(i="bottom");if(this.isBullet_&&i)this.destroy();else{if(!t)if(i&&!this.outofscene)this.dispatchEvent({type:"outofscene",outType:i});else if(!i&&this.outofscene){var o="left",s={left:n/this.scene.full_size.width,top:r/this.scene.full_size.height,right:(this.scene.full_size.width-n)/this.scene.full_size.width,bottom:(this.scene.full_size.height-r)/this.scene.full_size.height};for(var a in s)s[a]<s[o]&&(o=a);this.dispatchEvent({type:"inscene",inType:o})}this.outofscene=i;this.checkOutofview(e,t)}}};f.prototype.checkOutofview=function(e,t){var i="",n=this.scene.getSize(),r=this.scene.viewOffset,o=e.x+r.x,s=e.y+r.y;0>o?i="left":o>n.width?i="right":0>s?i="top":s>n.height&&(i="bottom");if(this.isBullet_&&i)this.destroy();else{if(!t)if(i&&!this.outofview)this.isBullet_?this.destroy():this.dispatchEvent({type:"outofview",outType:i});else if(!i&&this.outofview){var a="left",h={left:o/n.width,top:s/n.height,right:(n.width-o)/n.width,bottom:(n.height-s)/n.height};for(var c in h)h[c]<h[a]&&(a=c);this.dispatchEvent({type:"inview",inType:a})}this.outofview=i}};var Je=.1;qyengine.setGScale=function(e){Je=e||.1;return Je};qyengine.getGScale=function(){return Je};f.prototype.setSpeed=function(e,t){if(null==e)return this;Ge&&(this.moveendSpSet=!0);("number"==typeof t||"number"==typeof e)&&(e=new b2Vec2(e,t||0));if(this.b2dBody){e.x*=Je;e.y*=Je;this.setAwake(!0);this.b2dBody.SetLinearVelocity(e);this.speedOpt=e}else{this.selfSpeed=e;this.selfSpeed.angle=qyengine.calAngle(e.x,e.y);this.selfPos||(this.selfPos={x:0,y:0})}if(this.movestarted&&0==e.x&&0==e.y){this.movestarted=!1;current_scene.is25D&&this.checkZAxis()}return this};f.prototype.getSpeed=function(){if(!this.b2dBody)return this.selfSpeed||this.animSpeed;var e=this.b2dBody.GetLinearVelocity();this.speedOpt||(this.speedOpt={});this.speedOpt.x=e.x/Je;this.speedOpt.y=e.y/Je;this.speedOpt.angle=qyengine.calAngle(e.x,e.y);return this.speedOpt};f.prototype.changeSprite=function(e,t){e.classId&&(e=e.classId);if(this.spriteName==e)return this;this.spriteName=e;var i=w(e);if(!i)return this;if(this.insideChangeSprite)return this;this.insideChangeSprite=!0;if(this.currentSprite)this.currentSprite.fromJson(qyengine.merge(i.defaultOpt,t));else{t||(t={});t.qyobj=this;this.currentSprite=new i(t);t.qyobj=null}this.currentSprite.setMirror(this.mirror.horizontal,this.mirror.vertical);this.setMask(this.mask);if(this.physics){var n=this.currentSprite.collisionData;if(n){this.physics.collisionData=n;this.setupBody(!0)}else this.setupBody()}this.insideChangeSprite=!1;return this};f.prototype.changeAnimation=function(e){this.currentSprite&&this.currentSprite.changeAnimation(e);return this};f.prototype.getSize=function(){return this.currentSprite?this.currentSprite.getSize():{width:0,height:0}};f.prototype.setSize=function(e,t){var i=this.currentSprite;if(i){var n=i.getSize();if(e!=n.x||t!=n.y){i.setSize(e,t);e>0&&t>0&&this.rebuildBody()}}return this};f.prototype.getRotation=function(){var e=this.currentSprite;return e&&e.getRotation()};f.prototype.setRotation=function(e){if(null==e||e==this.oldRota_)return this;var t=this.currentSprite;if(t){var i=this.b2dBody;i?i.SetAngle(-e*Re):t.setRotation(e)}return this};f.prototype.rotateTo=function(e){return this.setRotation(e%360)};f.prototype.rotateBy=function(e){var t=this.getRotation();return this.rotateTo(t+e)};f.prototype.getAnchorPoint=function(){var e=this.currentSprite;return e&&e.getAnchorPoint()};f.prototype.setAnchorPoint=function(e,t){var i=this.currentSprite;return i&&i.setAnchorPoint(e,t)};f.prototype.isAwake=function(){return this.b2dBody&&this.b2dBody.IsAwake()};f.prototype.setAwake=function(e){this.b2dBody&&!this.b2dBody.IsAwake()&&this.b2dBody.SetAwake(e)};f.prototype.getPosition=function(){var e=this.currentSprite;if(e){var t=e.getPosition();if(this.scroller){t=t.clone();t.x+=this.scroller.x;t.y+=this.scroller.y}return t}return this.selfPos};f.prototype.setPosition=function(e,t,i){var n=z(e,t);e=n.x;t=n.y;var r=this.currentSprite;if(!r){this.selfPos||(this.selfPos={});this.selfPos.x=e;this.selfPos.y=t;this.checkOutofscene(this.selfPos);return this}var o=this.b2dBody;if(o)if(i){Pe.x=e*Je;Pe.y=t*Je;o.SetPosition(Pe);r.setPosition(e,t);this.setAwake(!0)}else this.moveTo(e,t,300);else{r.setPosition(e,t);Pe.x=e;Pe.y=t;this.checkOutofscene(Pe)}current_scene.is25D&&this.checkZAxis();return this};var He=[];f.prototype.checkZAxis=function(){var e=this.layer;if(e&&!e.ignore25d){var t=e.children_||e.children,i=this.getBoundingBox();He.length=0;for(var n=0;n<t.length;n++)if(!t[n].getHidden()){var r=t[n].qyobj;if(r!=this){var o=r.getBoundingBox();if(v(i,o)){o.curIdx_=n;He.push(o)}}else i.curIdx_=n}var s=i.curIdx_;for(n=0;n<He.length;n++){o=He[n];if(o.ry>i.ry){o.curIdx_<i.curIdx_&&(s=o.curIdx_);break}s<o.curIdx_&&(s=o.curIdx_)}s!=i.curIdx_&&e.setChildIndex(this.currentSprite,s)}};f.prototype.getScale=function(){var e=this.currentSprite;return e&&e.getScale()};f.prototype.rebuildBody=function(){if(this.b2dBody)if(Ce){if(!this.rebuildBuffered){ze.push(this);this.rebuildBuffered=!0}}else this.setupBody(!0)};f.prototype.setFollowObj=function(e,t,i,n){this.followingOpt={objId:e,x:t,y:i,followType:n}};f.prototype.setUnfollow=function(){this.unfollowMouse()};f.prototype.setScale=function(e,t){var i=this.currentSprite;if(i){var n=i.getScale();if(e!=n.x||t!=n.y){i.setScale(e,t);e>0&&t>0&&this.rebuildBody()}}return this};f.prototype.setFrameSpeed=function(e,t){this.currentSprite&&this.currentSprite.setFrameSpeed(e,t);return this};f.prototype.isDestroyed=function(){return this.destroyBuffered||this.destroyed_};qyengine.calDistance=function(e,t,i,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(t-n,2))};f.prototype.angleTo=function(e){if(!window[e])return 0;var t=window[e].x,i=window[e].y;if(void 0===t||void 0===i)return 0;var n=this.getPosition(),r=t-n.x,o=i-n.y;return qyengine.calAngle(r,o)};f.prototype.distanceTo=function(e){if(!window[e])return 0;var t=window[e].x,i=window[e].y;if(void 0===t||void 0===i)return 0;var n=this.getPosition();return qyengine.calDistance(t,i,n.x,n.y)};Object.defineProperties(f.prototype,{angleToMouse:{get:function(){var e=this.getPosition(),t=window.mouseX-e.x,i=window.mouseY-e.y;return qyengine.calAngle(t,i)}},distanceToMouse:{get:function(){var e=this.getPosition();return qyengine.calDistance(window.mouseX,window.mouseY,e.x,e.y)}}});f.prototype.shieldEvent=function(e,t){var i=this;e=D(e);e&&e.forEach&&e.forEach(function(e){var t="string"==typeof e?e:e.type;if(qyengine.EventsOnQyObj.indexOf(t)>-1||["keydown","keyup"].indexOf(t)>-1){i.shieldedEvent||(i.shieldedEvent={});"string"==typeof e?i.shieldedEvent[e]=[]:i.shieldedEvent[t]?i.shieldedEvent[t].indexOf(e.data)<0&&i.shieldedEvent[t].push(e.data):i.shieldedEvent[t]=[e.data]}else i.currentSprite&&i.currentSprite.shieldEvent(e)});t>0&&lime.scheduleManager.callAfter(function(){i.cancelShieldEvent(e)},this,t)};f.prototype.cancelShieldEvent=function(e){var t=this;e=D(e);e&&e.forEach&&e.forEach(function(e){var i=e.type||e;if(qyengine.EventsOnQyObj.indexOf(i)>-1||["keydown","keyup"].indexOf(i)>-1){t.shieldedEvent||(t.shieldedEvent={});if("string"==typeof e)delete t.shieldedEvent[e];else if(t.shieldedEvent[i]){var n=t.shieldedEvent[i].indexOf(e.data);n>-1&&t.shieldedEvent[i].splice(n,1)}}else t.currentSprite&&t.currentSprite.cancelShieldEvent(e)})};f.prototype.isShieldEvent=function(e){e=R(e);return this.shieldedEvent?"string"==typeof e?!!this.shieldedEvent[e]:this.shieldedEvent[e.type]&&this.shieldedEvent[e.type].indexOf(e.data)>-1:!1};var Ue=0;e?goog.inherits(L,lime.Scene):goog.inherits(L,PIXI.DisplayObjectContainer);window.QyScene=L;ne(L);k(L);var We=[];L.prototype.checkCollision=function(){for(var e=this.instances.length,t=0;e>t;t++)We.push(this.instances[t].getBoundingBox());for(var t=0;e-1>t;t++){var i=this.instances[t],n=i.physics;if(n)for(var r=t+1;e>r;r++){var o=this.instances[r],s=o.physics;if(s&&M(n,s)&&v(We[t],We[r])){var a=n.isSensor||s.isSensor?"enterobject":"collision";he(i,o,a,"allFixs","allFixs")}}}We.length=0};L.prototype.dispatchCreateEvent=function(){this.dispatchEvent("create");if(this.objects_){for(var e=0;e<this.objects_.length;e++)this.objects_[e].dispatchEvent("create");this.objects_=null}};L.prototype.setupBody=f.prototype.setupBody;L.prototype.calShape=f.prototype.calShape;L.prototype.genShape=f.prototype.genShape;L.prototype.calFixtureDef=f.prototype.calFixtureDef;L.prototype.calBody=f.prototype.calBody;L.prototype.controlRotation=f.prototype.controlRotation;L.prototype.setFixedRotation=f.prototype.setFixedRotation;L.prototype.genPolygonShape=f.prototype.genPolygonShape;L.prototype.genCircleShape=f.prototype.genCircleShape;L.prototype.destroyBody=f.prototype.destroyBody;L.prototype.releaseJoints=f.prototype.releaseJoints;L.prototype.releaseMouseJoint=f.prototype.releaseMouseJoint;L.prototype.mirror={horizontal:1,vertical:1};L.prototype.initVars=f.prototype.initVars;L.prototype.spriteListen=f.prototype.spriteListen;L.prototype.spriteUnlisten=f.prototype.spriteUnlisten;L.prototype.selfListen=f.prototype.selfListen;L.prototype.selfUnlisten=f.prototype.selfUnlisten;L.prototype.objListen=f.prototype.objListen;L.prototype.setAlarm=f.prototype.setAlarm;L.prototype.cancelAlarm=f.prototype.cancelAlarm;L.prototype.cancelAllAlarms=f.prototype.cancelAllAlarms;L.prototype.dispatchMessage=f.prototype.dispatchMessage;L.prototype.destroyIsolate=f.prototype.destroyIsolate;L.prototype.checkTypeAt=f.prototype.checkTypeAt;L.prototype.checkIfEmpty=f.prototype.checkIfEmpty;current_game.setVar=S;current_game.checkTypeAt=f.prototype.checkTypeAt;L.prototype.setupBlockArea=function(e){this.physics={solid:!0,restitution:0,linearDamping:1,friction:1,collisionData:e,categoryBits:1,maskBits:4294967295};this.scene=this;this.setupBody()};L.prototype.setOpacity=function(e){this.background&&this.background.setOpacity&&this.background.setOpacity(Math.round(1e3*e)/1e3)};L.prototype.show=function(){this.background&&this.background.show&&this.background.show()};L.prototype.hide=function(){this.background&&this.background.hide&&this.background.hide()};L.prototype.setId=function(e){e||(e=T());this.id=e;window[e]=this};L.prototype.setupHammer=function(){if(this.hammer||!this.background)return this;this.hammer=Hammer(this.background);var e=this;for(var t in Hammer.gestures)this.hammer.on(Hammer.gestures[t].name,function(t){e.dispatchEvent(t)});return this};L.prototype.drawLifeImage=function(e,t,i,n,r){this.stickyLayer.drawLifeImage(e,t,i,n,r)};L.prototype.destroy=function(){this.setPaused(!1);if(Ce){for(var e=0;e<this.instances.length;e++)this.instances[e].destroy();this.instances.length=0}else for(;this.instances.length>0;)this.instances[0].destroy();this.dispatchEvent("destroy");this.destroyIsolate();this.destroyBody()};L.prototype.setFollowView=function(e){this.view?this.followObj=e&&e.id||e:console.log("setting following obj but no view is set")};L.prototype.releaseFollowView=function(){this.followObj=null};L.prototype.setView=function(e){this.view=e;e.x||(e.x=0);e.y||(e.y=0);for(var t=0;t<this.layers.length;t++){var i=this.layers[t];i.sticky&&F(i,-e.x,-e.y)}e.width||(e.width=this.full_size.width);e.height||(e.height=this.full_size.height);this.setSize(e.width,e.height);this.maxViewOffSet={x:e.width-this.full_size.width,y:e.height-this.full_size.height};e.follows&&this.setFollowView(e.follows);(0!=e.x||0!=e.y)&&this.viewAt(e.x,e.y)};L.prototype.viewAt=function(e,t){this.moveViewBy(-(e+this.viewOffset.x),-(t+this.viewOffset.y))};L.prototype.moveBySpeed=function(e){this.background&&this.background.moveBySpeed(e);this.speed_&&this.moveViewBy(-this.speed_.x*e,-this.speed_.y*e)};L.prototype.shouldMoveBgWithScene=function(){return this.background&&this.view?this.background.speed&&this.background.speed.x&&this.background.speed.y?!1:!0:!1};L.prototype.moveViewBy=function(e,t){if(0==e&&0==t||!this.maxViewOffSet)return this;if(0==e&&0==t){if(this.moveTarget_){this.setSpeed(0);delete this.moveTarget_;this.dispatchEvent("moveend")}return this}var i=this.viewOffset,n=i.x+e,r=i.y+t;n>0&&(n=0);r>0&&(r=0);n<this.maxViewOffSet.x&&(n=this.maxViewOffSet.x);r<this.maxViewOffSet.y&&(r=this.maxViewOffSet.y);e=n-i.x;t=r-i.y;if(0==e&&0==t){if(this.moveTarget_){this.setSpeed(0);delete this.moveTarget_;this.dispatchEvent("moveend")}return this}this.shouldMoveBgWithScene()&&this.background.moveBy(e,t);for(var o=0;o<this.layers.length;o++){var s=this.layers[o];s.sticky||F(s,e,t)}i.x=n;i.y=r;this.scene_pos.x=-n;this.scene_pos.y=-r;return this};L.prototype.resetView=function(){this.moveViewBy(-this.viewOffset.x,-this.viewOffset.y)};L.prototype.setSpeed=t.prototype.setSpeed;Object.defineProperties(L.prototype,{paused:{configurable:!0,get:function(){return current_scene.isPaused_},set:function(e){current_scene.setPaused(e)}},mute:{configurable:!0,get:function(){return qyengine.isMuted()},set:function(e){e?qyengine.mute():qyengine.unmute()}},volume:{configurable:!0,get:function(){return qyengine.getVolume()},set:function(e){qyengine.setVolume(e)}},speed:{configurable:!0,get:function(){return this.speed_||{x:0,y:0}},set:function(e){this.setSpeed&&this.setSpeed(e);return this}}});L.prototype.moveTo=function(e,t,i){i||(i=300);var n=$(this.scene_pos,e,t);if(0==n.xRatio&&0==n.yRatio){this.dispatchEvent("moveend");return this}this.moveTarget_=n;this.setSpeed({x:n.xRatio*i,y:n.yRatio*i});this.dispatchEvent("movestart")};var Qe={};L.prototype.viewFollowObj=function(e,t,i){if(!this.view)return this;var n=e.getPosition(),r=this.view.follows||Qe;if(!t){var o=r.hbor>=0?r.hbor:this.view.width/2,s=r.vbor>=0?r.vbor:this.view.height/2;if(N(n,this.scene_pos.x+o,this.scene_pos.y+s,this.view.width-2*o,this.view.height-2*s))return this}var a={x:Math.round(n.x-this.view.width/2),y:Math.round(n.y-this.view.height/2)};a.x<0&&(a.x=0);a.y<0&&(a.y=0);a.x+this.view.width>this.full_size.width&&(a.x=this.full_size.width-this.view.width);a.y+this.view.height>this.full_size.height&&(a.y=this.full_size.height-this.view.height);if(a.x==this.scene_pos.x&&a.y==this.scene_pos.y)return this;null==i?i=r.speed&&r.speed>0?r.speed:r.hsp&&r.hsp>0?r.hsp:r.vsp&&r.vsp>0?r.vsp:null:0>=i&&(i=null);i?this.moveTo(a.x,a.y,i):this.viewAt(a.x,a.y);return this};L.prototype.checkMoveTarget=function(){var e=this.moveTarget_;if(e&&O(e.xRatio,e.x,this.scene_pos.x)&&O(e.yRatio,e.y,this.scene_pos.y)){delete this.moveTarget_;this.viewAt(e.x,e.y);this.setSpeed(0);this.dispatchEvent("moveend")}};L.prototype.stepFollow=function(){if(this.followObj&&window[this.followObj]){var e=window[this.followObj];e.getPosition?this.viewFollowObj(e):this.followObj=null}};L.prototype.step_=function(e){var t=this.domElement;if(t.getContext){var i=t.getContext("2d"),n="pixel"!==game.filter;i.mozImageSmoothingEnabled=n;i.imageSmoothingEnabled=n;i.webkitImageSmoothingEnabled=n;i.msImageSmoothingEnabled=n}for(var r=0;r<this.instances.length;r++){var o=this.instances[r];o.step_(e)}this.stepFollow();this.moveBySpeed(e);this.checkMoveTarget()};gmx_[qyengine.pause_scene]=G;L.prototype.setPaused=function(e,t){e=!!e;if(this.isPaused_!=e)if(Ce&&e){Ee=e;Be=t}else if(this.isPaused_!=e){this.isPaused_=e;Ie=t;lime.scheduleManager.changeDirectorActivity(current_game.director,e);if(e){j();lime.updateDirtyObjects()}else V()}};L.prototype.pause=function(e){this.setPaused(!0,e)};L.prototype.resume=function(){this.setPaused(!1)};L.prototype.restart=function(){qyengine.switchScene(this.classId)};L.prototype.endGame=function(){var e=current_game.end_scene&&"no-scene"!=current_game.end_scene?current_game.end_scene:current_game.start_scene;qyengine.switchScene(e)};L.prototype.restartGame=function(){qyengine.switchScene(current_game.start_scene)};L.prototype.setupWorld=function(e,t){var i=this.background;e?this.full_size=e:i?this.full_size=i.getSize():this.full_size=current_game.director&&current_game.director.getSize();this.setSize(this.full_size.width,this.full_size.height);this.createWorld(t);return this};L.prototype.createWorld=function(e){var t=e&&e.x||0,i=e&&null!=e.y?e.y:e||0;this.gravity={x:t,y:i};if(current_game.world)qyengine.setGravity(t,i);else{var n=new b2Vec2(t,i);current_game.world=new b2World(n,!0);current_game.contactListener=new re;current_game.world.SetContactListener(current_game.contactListener)}return current_game.world};qyengine.getGravityWithAngle=function(){var e=qyengine.getGravity();return{gravity:goog.math.Coordinate.magnitude(e),angle:goog.math.Coordinate.azimuth(e)}};qyengine.getGravity=function(){return current_game.world.GetGravity()};qyengine.setGravity=function(e,t){var i=qyengine.getGravity();i.x=e;i.y=t};qyengine.setGravityWithAngle=function(e,t,i,n){var r=qyengine.getGravityWithAngle();i&&(e+=r.gravity);n&&(t+=r.angle);var o=t*Re;qyengine.setGravity(e*Math.cos(o),e*Math.sin(o))};Object.defineProperties(current_game,{rankTotal:{configurable:!0,get:function(){var e=qyengine.getRankList();if(e){var t=e.remoteData||e.getDataFromRemote();return t.length}}},rankSelf:{configurable:!0,get:function(){var e=qyengine.getRankList();if(e){var t=e.remoteData||e.getDataFromRemote(),i=current_scene.user&&current_scene.user.userid;if(t&&i)for(var n=0;n<t.length;n++)if(t[n].userid==i)return n+1;return 1}}},gravityX:{configurable:!0,get:function(){return qyengine.getGravity().x},set:function(e){qyengine.setGravity(e,current_game.gravityY)}},gravityY:{configurable:!0,get:function(){return qyengine.getGravity().y},set:function(e){qyengine.setGravity(current_game.gravityX,e)}}});L.prototype.setBackground=function(e){this.currentSprite=this;var t=e.background;if(!t||"no-background"==t)return this;var i=w(t);if(i){e.repeat=!1;e.repeat_x=!1;e.repeat_y=!1;switch(e.background_repeat){case"repeat":case!0:e.repeat=!0;e.repeat_x=!0;e.repeat_y=!0;break;case"repeat-x":e.repeat_x=!0;break;case"repeat-y":e.repeat_y=!0}e.qyobj=this;var n=new i(e);e.qyobj=null;this.background=n.currentSprite||n;this.appendChild(this.background)}return this};L.prototype.setLayers=function(e){var t=e.layers;if(!t||0==t.length)return this;var i=t.length;this.layers=new Array(i);for(var n=0;i>n;n++){this.layers[n]=new o(t[n]);this.appendChild(this.layers[n])}e.defaultLayer&&(this.defaultLayer=window[e.defaultLayer]);this.defaultLayer||(this.defaultLayer=this);for(n=0;i>n;n++)this.setOneLayer(this.layers[n],t[n]);return this};ne(lime.Director);L.prototype.setOneLayer=function(e,t){if(t&&t.objects)for(var i=0;i<t.objects.length;i++){var n=t.objects[i];n.id||(n.id=n.type);n.sceneId=this.id;this.objects_.push(qyengine.createInstance(n,e,!0))}e.getHidden()&&e.hide();return this};goog.inherits(G,L);window.QyPauseScene=G;G.prototype.isPauseScene=!0;var Xe=J("Object"),Ke=Array.isArray||J("Array");goog.inherits(Q,o);Q.prototype.IMAGES={LOGIN_BG:{path:"/public/qiyun/ranklist/loginBg.png",size:{width:515,height:416}},LOGIN:{path:"/public/qiyun/ranklist/login.png",size:{width:183,height:62}},CLOSE:{path:"/public/qiyun/ranklist/close.png",size:{width:31,height:31}},PK:{path:"/public/qiyun/ranklist/PK.png",size:{width:514,height:316}},GO:{path:"/public/qiyun/ranklist/GO.png",size:{width:144,height:61}}};if(xe)for(var Ye in Q.prototype.IMAGES)Q.prototype.IMAGES[Ye].path="assets"+Q.prototype.IMAGES[Ye].path;Q.prototype.destroy=function(){};Q.prototype.displayRanklist=function(){var e=this;this.ranklist_dialog&&this.removeChild(this.ranklist_dialog);this.ranklist_dialog=new o;this.appendChild(this.ranklist_dialog);this.initCover(this.ranklist_dialog,function(){e.ranklist_dialog.setHidden(!0)});this.initWindow(this.window(),this.ranklist_dialog)};Q.prototype.displayLoginDialog=function(e,t){this.login_dialog&&this.removeChild(this.login_dialog);this.login_dialog=new o;this.appendChild(this.login_dialog);this.initCover(this.login_dialog);this.initLoginDialog(e,this.login_dialog,t)};Q.prototype.displayNicknameDialog=function(e,t){this.nickname_dialog&&this.removeChild(this.nickname_dialog);this.nickname_dialog=new o;this.appendChild(this.nickname_dialog);this.initCover(this.nickname_dialog);this.initNicknameDialog(e,this.nickname_dialog,t)};Q.prototype.initCover=function(e,i){var r=this,o=new t;o.setAnchorPoint(0,0);o.setFill("#000");o.setOpacity(.8);o.setSize(current_scene.width,current_scene.height);n(o,["mousedown","touchstart"],function(e){i&&i();r.stopPropagationFun(e)});e.appendChild(o);return o};Q.prototype.initLoginDialog=function(e,i,r){var o=this,s=1;if(current_scene.width<=this.IMAGES.LOGIN_BG.size.width||current_scene.height<=this.IMAGES.LOGIN_BG.size.height){var a=this.IMAGES.LOGIN_BG.size.width/current_scene.width,h=this.IMAGES.LOGIN_BG.size.height/current_scene.height;s=.9/(a>h?a:h)}var c=new t;c.setAnchorPoint(0,0);c.setFill(this.IMAGES.LOGIN_BG.path);c.setSize(this.IMAGES.LOGIN_BG.size.width,this.IMAGES.LOGIN_BG.size.height);var l=parseInt(current_scene.width-c.width*s)/2,d=parseInt(current_scene.height-c.height*s)/2;c.setPosition(l,d);c.setScale(s);n(c,["mousedown","touchstart"],function(e){o.stopPropagationFun(e)});i.appendChild(c);var u=new t;u.setAnchorPoint(0,0);u.setFill(this.IMAGES.CLOSE.path);u.setSize(this.IMAGES.CLOSE.size.width,this.IMAGES.CLOSE.size.height);u.setScale(1.5);u.setPosition(c.width-50,50);n(u,["mousedown","touchstart"],function(e){o.login_dialog.setHidden(!0);o.stopPropagationFun(e)});c.appendChild(u);var p={defaultText:e,isPassword:!1,inputStyle:{backgroundColor:"#E06858"},size:{width:240,height:24}},y=new Y(p);y.setFontColor("#ffffff");y.setFontSize(20);y.setPosition(165,160);c.appendChild(y.currentSprite);var g={isPassword:!0,inputStyle:{backgroundColor:"#E06858"},size:{width:240,height:24}},f=new Y(g);f.setFontColor("#ffffff");f.setFontSize(20);f.setPosition(165,215);c.appendChild(f.currentSprite);var m=new t;m.setAnchorPoint(0,0);m.setFill(this.IMAGES.LOGIN.path);m.setSize(this.IMAGES.LOGIN.size.width,this.IMAGES.LOGIN.size.height);var l=parseInt((c.width-m.width)/2),d=parseInt(c.height-m.height/2);m.setPosition(l,d);n(m,["mousedown","touchstart"],function(e){function t(e){if(!/^([a-zA-Z_0-9\u4E00-\u9FA5]+)$/.test(e)){y.currentSprite.setBackgroundColor("#ff0000");return!1}return!0}function i(e){if(/^$/.test(e)){f.currentSprite.setBackgroundColor("#ff0000");return!1}return!0}var n=y.getValue().trim(),s=f.getValue();t(n)&&i(s)&&o.tryToLogin(n,s,function(e){if(e){r&&r();o.login_dialog.hide()}else{y.currentSprite.setBackgroundColor("#ff0000");f.currentSprite.setBackgroundColor("#ff0000")}});o.stopPropagationFun(e)});c.appendChild(m)};Q.prototype.initNicknameDialog=function(e,i,r){var o=this,s=1;if(current_scene.width<=this.IMAGES.PK.size.width||current_scene.height<=this.IMAGES.PK.size.height){var a=this.IMAGES.PK.size.width/current_scene.width,h=this.IMAGES.PK.size.height/current_scene.height;s=.9/(a>h?a:h)}var c=new t;c.setAnchorPoint(0,0);c.setFill(this.IMAGES.PK.path);c.setSize(this.IMAGES.PK.size.width,this.IMAGES.PK.size.height);c.setScale(s);var l=parseInt(current_scene.width-c.width*s)/2,d=parseInt(current_scene.height-c.height*s)/2;c.setPosition(l,d);n(c,["mousedown","touchstart"],function(e){o.stopPropagationFun(e)});i.appendChild(c);var u=new t;u.setAnchorPoint(0,0);u.setFill(this.IMAGES.CLOSE.path);u.setSize(this.IMAGES.CLOSE.size.width,this.IMAGES.CLOSE.size.height);u.setScale(1.5);u.setPosition(c.width-40,40);n(u,["mousedown","touchstart"],function(e){o.nickname_dialog.setHidden(!0);o.stopPropagationFun(e)});c.appendChild(u);var p={defaultText:e,isPassword:!1,inputStyle:{backgroundColor:"#E06858"},size:{width:190,height:20}},y=new Y(p);y.setPosition(188,173);c.appendChild(y.currentSprite);var g=new t;g.setAnchorPoint(0,0);g.setFill(this.IMAGES.GO.path);g.setSize(this.IMAGES.GO.size.width,this.IMAGES.GO.size.height);var l=parseInt((c.width-g.width)/2),d=parseInt(c.height-g.height/2);g.setPosition(l,d);n(g,["mousedown","touchstart"],function(t){function i(e){if(!/^([a-zA-Z_0-9\u4E00-\u9FA5]+)$/.test(e)){y.currentSprite.setBackgroundColor("#ff0000");return!1}return!0}var n=y.getValue().trim();if(i(n)){var s=localStorage.getItem("nickname")||"";s&&(s=JSON.parse(s));s||(s={});s[e]=n;localStorage.setItem("nickname",JSON.stringify(s));r&&r();o.nickname_dialog.hide()}o.stopPropagationFun(t)});c.appendChild(g)};Q.prototype.initWindow=function(e,t){var i=this,r=W("FILL",e);n(r,["mousedown","touchstart"],function(e){i.stopPropagationFun(e)});if(r.getSize().width>current_scene.width||r.getSize().height>current_scene.height){var o=r.getSize().width/current_scene.width,s=r.getSize().height/current_scene.height,a=.9/(o>s?o:s);r.setScale(a,a)}var h=parseInt((current_scene.width-r.getSize().width*r.getScale().x)/2),c=parseInt((current_scene.height-r.getSize().height*r.getScale().y)/2);r.setPosition(h,c);t.appendChild(r);this.initButton(this.button(),r);this.initContentArea(this.contentArea(),r);return r};Q.prototype.initButton=function(e,t){var i=this,r=W("FILL",e);n(r,["mousedown","touchstart"],function(e){i.ranklist_dialog.setHidden(!0);i.stopPropagationFun(e)});t.appendChild(r);return r};Q.prototype.initContentArea=function(e,t){var i=W("FILL",e);t.appendChild(i);this.initScroller(this.contentArea(),i);return i};Q.prototype.initScroller=function(e,t){var i=this,n=new X;n.setPosition(0,0);n.setSize(e.size.width,e.size.height);n.checkZAxis=function(){};n.setDirection(this.getRecordsDisplayDirection()||"vertical");t.appendChild(n.currentSprite);var r=20;"horizontal"===i.getRecordsDisplayDirection()&&(r=5*i.getRowsOfRecord_horizontal());var o=0;i.initRecordContainers(i.recordContainer(),n.currentSprite,o,r);o+=r;var s="reachBottom";"vertical"!==i.getRecordsDisplayDirection()&&(s="reachRight");n.currentSprite.listen(s,function(e){i.initRecordContainers(i.recordContainer(),n.currentSprite,o,r);o+=r});return n};Q.prototype.initRecordContainers=function(e,t,i,n){for(var r=this,o=r.getLengthOfRecords(),s=r.getRecordsDisplayDirection(),a=this.getRowsOfRecord_horizontal(),h=i;o>h&&n>h-i;++h){var c=0,l=0;if("vertical"===s){c=h;l=0}else{c=h%a;l=Math.floor(h/a)}r.initRecord(c,l,e,t)}};Q.prototype.initRecord=function(e,t,i,n){var r=W("FILL",i),o=i.position.x+(r.getSize().width+i["margin-left"])*t,s=i.position.y+(r.getSize().height+i["margin-top"])*e;r.setPosition(o,s);n.appendChild(r);this.initFields(r,this.getRowsOfRecord_horizontal()*t+e)};Q.prototype.initFields=function(e,t){for(var i=this,n=this.fields(),r=0;r<n.length;++r){var o=n[r],s=!1;["rank","medal","photo","userName","score","time"].forEach(function(e){var t=new RegExp("^"+e+"$");t.test(o.name)&&!i["use"+o.name[0].toUpperCase()+o.name.substr(1)]()&&(s=!0)});if(!s)if("medal"===o.name){var a=["gold","silver","bronze"];if(void 0!==a[t]){var h=W("FILL",this.getMedal(a[t]));e.appendChild(h);
}}else{var c=this.getData(t,o.name),h=W(U(o.attr).type,o.attr,c);e.appendChild(h)}}};Q.prototype.tryToLogin=function(e,t,i){try{qyremote_async.login(e,t,function(t){if(t&&t.success){var n=current_scene.user;if(n){n.userid=e;n.verified=!0}i&&i(!0)}else i&&i(!1)})}catch(n){console.log(n)}};Q.prototype.initRanklistConfigInfor=function(e){e=this.formatRanklistConfigInfor(e);this.scoreSort(e.config.scoreSort);this.timeSort(e.config.timeSort);this.usePhoto("boolean"==typeof e.config.isUsePhoto?e.config.isUsePhoto:!0);this.useMedal("boolean"==typeof e.config.isUseMedal?e.config.isUseMedal:!0);this.useRank("boolean"==typeof e.config.isUseRank?e.config.isUseRank:!0);this.useTime("boolean"==typeof e.config.isUseTime?e.config.isUseTime:!0);this.useUserName("boolean"==typeof e.config.isUseUserName?e.config.isUseUserName:!0);this.useScore("boolean"==typeof e.config.isUseScore?e.config.isUseScore:!0);this.window(e.window||{});this.button(e.button||{});this.contentArea(e.contentArea||{});this.recordContainer(e.recordContainer||{});this.fields(e.fields||[])};Q.prototype.isConfigInforOfOldVersion=function(e){return void 0!==e.scroller?!0:!1};Q.prototype.formatRanklistConfigInfor=function(e){var t={};if(this.isConfigInforOfOldVersion(e)){t.config={scoreSort:e.scoreSort||"desc",timeSort:e.timeSort||"asc",isUsePhoto:!!e.photo,isUseMedal:!!e.medal,isUseRank:!0,isUseScore:!!e.score,isUseTime:!!e.time,isUseUserName:!!e.userid};t.window={type:"picture",opacity:1,"border-color":"transparent","border-width":0,"border-style":"solid","border-radius":0,"background-color":"transparent","background-image":H(e.background.path),size:H(e.background.size),"background-size":H(e.background.size),position:{x:0,y:40}};t.button={type:"picture",opacity:1,"border-color":"transparent","border-width":0,"border-style":"solid","border-radius":0,"background-color":"transparent","background-image":"",size:{width:0,height:0},position:{x:760,y:0},"background-size":{width:0,height:0}};t.contentArea={type:"picture",opacity:1,direction:"vertical","border-color":"transparent","border-width":0,"border-style":"solid","border-radius":0,"background-color":"transparent","background-image":"",size:H(e.scroller.size),position:H(e.scroller.position),"background-size":{width:0,height:0}};t.recordContainer={type:"picture",opacity:1,"margin-top":10,"margin-left":10,"border-color":"transparent","border-width":0,"border-style":"solid","border-radius":0,"background-color":"transparent","background-image":H(e.listBg.path),size:H(e.listBg.size),"background-size":H(e.listBg.size),position:{x:30,y:0}};t.fields=[{name:"medal",isCustomed:!1,dataType:"string",attr:{type:"medal",opacity:1,"border-color":"transparent","border-width":0,"border-style":"solid","border-radius":0,"background-color":"transparent",gold:{path:e.medal?H(e.medal[0].path):"","background-size":e.medal?H(e.medal[0].size):{width:0,height:0}},silver:{path:e.medal?H(e.medal[1].path):"","background-size":e.medal?H(e.medal[1].size):{width:0,height:0}},bronze:{path:e.medal?H(e.medal[2].path):"","background-size":e.medal?H(e.medal[2].size):{width:0,height:0}},size:e.medal?H(e.medal[2].size):{width:0,height:0},position:{x:10,y:12}}},{name:"rank",isCustomed:!1,dataType:"int",attr:{type:"font",color:"#000",content:"排名",border:"none","background-color":"transparent","font-size":30,size:{width:70,height:40},position:{x:120,y:30}}},{name:"photo",isCustomed:!1,dataType:"string",attr:{type:"picture",opacity:1,"border-color":"transparent","border-width":0,"border-style":"solid","border-radius":0,"background-color":"transparent","background-image":e.photo?H(e.photo.path):"",size:e.photo?H(e.photo.size):{width:0,height:0},position:{x:220,y:10},"background-size":e.photo?H(e.photo.size):{width:0,height:0}}},{name:"userName",isCustomed:!1,dataType:"string",attr:{type:"font",color:"#000",content:"用户名","background-color":"transparent","font-size":30,size:{width:100,height:40},position:{x:330,y:30}}},{name:"score",isCustomed:!1,dataType:"int",attr:{type:"font",color:"#000",content:"分数","background-color":"transparent","font-size":30,size:{width:70,height:40},position:{x:450,y:30}}},{name:"time",isCustomed:!1,dataType:"int",attr:{type:"font",color:"#000",content:"时间","background-color":"transparent","font-size":30,size:{width:70,height:40},position:{x:570,y:30}}}];for(var i=0,n=0;n<t.fields.length;++n){t.fields[n].attr.position.x=10+110*i;t.config["isUse"+t.fields[n].name[0].toUpperCase()+t.fields[n].name.substr(1)]&&i++}}else{t=e;t.config.isUseUserName=!0;t.config.isUseScore=!0}return t};Q.prototype.scoreSort=function(e){if(void 0===e)return this.sort_score||"desc";this.sort_score=e;return void 0};Q.prototype.timeSort=function(e){if(void 0===e)return this.sort_time||"desc";this.sort_time=e;return void 0};Q.prototype.usePhoto=function(e){if(void 0===e)return this.isUsePhoto;this.isUsePhoto=e;return void 0};Q.prototype.useMedal=function(e){if(void 0===e)return this.isUseMedal;this.isUseMedal=e;return void 0};Q.prototype.useRank=function(e){if(void 0===e)return this.isUseRank;this.isUseRank=e;return void 0};Q.prototype.useTime=function(e){if(void 0===e)return this.isUseTime;this.isUseTime=e;return void 0};Q.prototype.useUserName=function(e){if(void 0===e)return this.isUseUserName;this.isUseUserName=e;return void 0};Q.prototype.useScore=function(e){if(void 0===e)return this.isUseScore;this.isUseScore=e;return void 0};Q.prototype.window=function(e){if(void 0===e)return H(this.window_attr);this.window_attr=e;return void 0};Q.prototype.button=function(e){if(void 0===e)return H(this.button_attr);this.button_attr=e;return void 0};Q.prototype.contentArea=function(e){if(void 0===e)return H(this.contentArea_attr);this.contentArea_attr=e;return void 0};Q.prototype.recordContainer=function(e){if(void 0===e)return H(this.recordContainer_attr);this.recordContainer_attr=e;return void 0};Q.prototype.fields=function(e){if(void 0===e)return H(this.fields_attr);this.fields_attr=e;return void 0};Q.prototype.getMedal=function(e){for(var t={},i=0;i<this.fields().length;++i)if("medal"===this.fields()[i].name){var n=this.fields()[i];for(var r in n.attr)t[r]=n.attr[r];["gold","silver","bronze","size","position"].forEach(function(e){delete t[e]});t.size={width:n.attr.size.width,height:n.attr.size.height};t.position={x:n.attr.position.x,y:n.attr.position.y};t["background-image"]=n.attr[e].path;t["background-size"]={width:n.attr[e]["background-size"].width,height:n.attr[e]["background-size"].height};t.type="picture";break}return H(t)};Q.prototype.getCustomedFields=function(){for(var e=[],t=this.fields(),i=0;i<t.length;++i)t[i].isCustomed&&e.push(t[i]);return H(e)};Q.prototype.getRecordsDisplayDirection=function(){var e=this.contentArea();return e.direction||"vertical"};Q.prototype.getDataFromRemote=function(){var e=SelfModName();/previewGame$/.test(qyboot.getDomainApp)&&!/^debug\//.test(e)&&(e="debug/"+e);game.mod||(game.mod=using_rpc(e));if(!game.mod||!game.mod.remote||!game.mod.remote.getRankListData)return[];var t={score:this.scoreSort(),time:this.timeSort()},i=game.mod.remote.getRankListData(t);return i&&i.success?i.result:[]};Q.prototype.updateDataToRemote=function(e){var t=SelfModName();/previewGame$/.test(qyboot.getDomainApp)&&!/^debug\//.test(t)&&(t="debug/"+t);game.mod||(game.mod=using_rpc(t));if(!game.mod||!game.mod.remote||!game.mod.remote.updateRanklistData&&!game.mod.remote.addRankListData)return this.getRecords();var i=null;i=game.mod.remote.updateRanklistData?game.mod.remote.updateRanklistData(e):game.mod.remote.addRankListData(e.userid,e.nickname,e.score||0,e.time||0);return i&&i.success?this.getDataFromRemote():[]};Q.prototype.getRecords=function(){this.records||(this.records=this.getDataFromRemote());return H(this.records)};Q.prototype.setRecords=function(e){this.records=H(e)};Q.prototype.insertRankListData=function(e,t){if("object"==typeof e){var i=this,n=this.formatRecord(H(e));current_scene.user=qyboot.getCurrentUser(!0);if(current_scene.user.verified){n.userid=current_scene.user.userid;var r=localStorage.getItem("nickname");r=r?JSON.parse(r):{};n.nickname=r[current_scene.user.userid]||current_scene.user.userid;this.updateRecords(n);t&&this.displayRanklist()}else if("string"==typeof current_scene.user.userid&&""!==current_scene.user.userid)this.tryToLogin(current_scene.user.userid,current_scene.user.userid,function(n){n?i.insertRankListData(e,t):i.displayLoginDialog(current_scene.user.userid,function(){i.insertRankListData(e,t)})});else{var o=qyremote.createGuest();console.assert(!(!o||!o.success),"create guest error");o&&o.success&&i.displayNicknameDialog(qyboot.getCurrentUser(!0).userid,function(){i.insertRankListData(e,t)})}}};Q.prototype.updateRecords=function(e){var t=this.getRecords();"asc"===this.scoreSort()&&t.reverse();for(var i=!1,n=0;n<t.length;++n)if(t[n].userid===e.userid){i=t[n].score<e.score?!0:!1;break}i=i?!0:n===t.length?!0:!1;if(i){var r=this.updateDataToRemote(e);this.setRecords(r);return!0}return!1};Q.prototype.getLengthOfRecords=function(){var e=this.getRecords();return e.length};Q.prototype.getRowsOfRecord_horizontal=function(){var e=this.contentArea();if("vertical"===this.getRecordsDisplayDirection())return-1;var t=this.recordContainer();return Math.ceil(e.size.height/(t.size.height+t["margin-top"]))-1};Q.prototype.getData=function(e,t){for(var i={score:"score",time:"time",userName:"nickname"},n=this.getCustomedFields(),r=0;r<n.length;++r)i[n[r].name]=n[r].name;var o=this.getRecords(),s="";switch(t){case"rank":s=e+1;break;case"medal":[this.getMedal("gold")["background-image"],this.getMedal("silver")["background-image"],this.getMedal("bronze")["background-image"]];s=medals[e]||void 0;break;case"photo":s=null;break;case"time":s=o[e][i[t]];s=s?s:0;break;default:s=o[e][i[t]]}return s};Q.prototype.getRankingOfUser=function(e){var t=this.getRecords();t="desc"===this.scoreSort()?t:t.reverse();for(var i=-1,n=0;n<t.length;++n)if(e===t[n].userid){i=n+1;break}return i};Q.prototype.stopPropagationFun=function(e){e.event.stopPropagation()};Q.prototype.formatRecord=function(e){for(var t=this.getCustomedFields(),i=0,n=0;n<t.length;++n)if(t[n].isCustomed){i++;var r=e[t[n].name];delete e[t[n].name];e["field"+i]=r}return e};window.QyRanklist=Q;goog.inherits(X,f);window.QyScroller=X;lime.ui.Scroller.prototype.moveBySpeed=function(){};X.prototype.setupContent=function(e){this.autoClassify=e.autoClassify;this.cellWidth=e.cellWidth||100;this.cellHeight=e.cellHeight||100;this.margin=e.margin||0;this.cellBoundWidth=this.cellWidth+2*this.margin;this.cellBoundHeight=this.cellHeight+2*this.margin;this.setDirection(e.direction);this.contentArray=[];this.contentMap={};var t,i;if("vertical"===this.direction){t=e.height||100;this.columns=e.columns||1;i=this.cellBoundWidth*this.columns}else{i=e.width||100;this.rows=e.rows||1;t=this.cellBoundHeight*this.rows}this.currentSprite.setSize(i,t);for(var n in e.content){var r=n.split(","),o=parseInt(r[0]),s=parseInt(r[1]),a=e.content[n];"string"==typeof a?this.addOneInstance(a,o,s):this.addOneInstance(a.type,o,s,{id:a.id})}};X.prototype.addToLast=function(e,t){var i=0,n=0;if("vertical"===this.direction)for(;;){for(var n=0;n<this.columns;n++)if(!this.contentArray[i]||!this.contentArray[i][n])return this.addAt(e,i,n,t);i++}else for(;;){for(var i=0;i<this.rows;i++)if(!this.contentArray[i]||!this.contentArray[i][n])return this.addAt(e,i,n,t);n++}};X.prototype.addAt=function(e,t,i,n){n||(n={});n.allowMultiple||this.removeAt(void 0,t,i);void 0===n.px&&(n.px=this.cellWidth/2);void 0===n.py&&(n.py=this.cellHeight/2);var r=i*this.cellBoundWidth+this.margin,o=t*this.cellBoundHeight+this.margin,s=qyengine.guardType(e);if(s){var a=new s,h=a.getSize(),c=Math.min(this.cellWidth/h.width,this.cellHeight/h.height,1);a.setPosition(r+n.px,o+n.py,!0);a.setScale(c,c);n&&n.id&&(window[n.id]=a,a.id=n.id);var l=a.currentSprite;if(l){this.currentSprite.appendChild(l);a.scroller=this;a.scrollerX=i+1;a.scrollerY=t+1;l.keyframe&&!l.keyframe.started&&l.keyframe.start()}this.contentMap[e]||(this.contentMap[e]=[]);this.contentMap[e].push({object:a,number:1,position:[t,i]});this.contentArray[t]||(this.contentArray[t]=[]);this.contentArray[t][i]||(this.contentArray[t][i]={});this.contentArray[t][i][e]||(this.contentArray[t][i][e]=[]);this.contentArray[t][i][e].push(a);a.dispatchEvent("create");var d=this;a.listen("destroy",function(){d.onDestroyObject(a,e,t,i)})}};X.prototype.addOneInstance=function(e,t,i,n){if(this.autoClassify){var r=this.contentMap[e];if(r&&r.length){n&&n.id&&(window[n.id]=r[0].object,r[0].object.id=n.id);r[0].object.setText({text:++r[0].number+"",position:{x:0,y:-10}})}else this.addToLast(e,n)}else null==t||null==i?this.addToLast(e,n):this.addAt(e,t,i,n)};X.prototype.removeAt=function(e,t,i){this.removeContentArrayAt.apply(this,arguments);this.removeContentMapAt.apply(this,arguments)};X.prototype.removeOneType=function(e){for(var t=this.contentArray,i=0,n=t.length;n>i;i++)for(var r=0,o=t[i].length;o>r;r++)this.removeContentArrayAt(e,i,r);this.removeContentMapAt(e)};X.prototype.removeOneInstance=function(e,t,i){if(this.autoClassify){var n=this.contentMap[e];if(n&&n.length&&n[0].object){n[0].object.setText({text:--n[0].number+"",position:{x:0,y:-10}});if(n[0].number<=0){n[0].object.destroy(!0);delete this.contentMap[e];this.removeContentArrayAt(n[0].position[0],n[0].position[i])}}}else null!=t&&null!=i?this.removeAt(e,t,i):this.removeOneType(e)};X.prototype.removeById=function(e){var t=window[e]&&window[e].classId;if(t){var i=window[e].scrollerY-1,n=window[e].scrollerX-1;null!=i&&null!=n&&this.removeOneInstance(t,i,n)}};X.prototype.removeContentArrayAt=function(e,t,i){var n,r=this.contentArray;if(r[t]&&r[t][i]){n=r[t][i][e]||[];n&&n.forEach(function(e){e.destroy(!0)});delete r[t][i][e];Object.keys(r[t][i]).length||(r[t][i]=void 0)}};X.prototype.removeContentMapAt=function(e,t,i){for(var n,r,o=this.contentMap,s=o[e]||[],a=0,h=s.length;h>a;a++){if(s[a]){r=s[a].object;n=s[a].position;if(!(void 0===t&&void 0===i||n[0]===t&&n[1]===i))continue;r&&r.destroy(!0)}s.splice(a,1);a--;h--}s.length||delete o[e]};X.prototype.setDirection=function(e){if("vertical"==e){this.direction="vertical";this.currentSprite.setDirection(lime.ui.Scroller.Direction.VERTICAL)}else{this.direction="horizontal";this.currentSprite.setDirection(lime.ui.Scroller.Direction.HORIZONTAL)}};X.prototype.getDirection=function(){return this.direction};X.prototype.checkZAxis=function(){};goog.inherits(K,f);window.QyText=K;lime.input=function(){lime.Node.call(this);this.setSize(100,24)};goog.inherits(lime.input,lime.Node);lime.input.prototype.createDomElement=function(){var e=this,t=(this.renderer.getType()==lime.Renderer.CANVAS,"input"),i=function(){this.domElement=this.rootElement=this.containerElement=goog.dom.createDom(t);this.domClassName&&goog.dom.classes.add(this.domElement,this.domClassName);this.domElement.addEventListener("keyup",function(){e.value=this.value});this.dirty_|=-1};if(this.domElement){var n=this.domElement.tagName.toLowerCase();if(n!=t){var r=this.rootElement;i.call(this);r.parentNode&&r.parentNode.replaceChild(this.rootElement,r)}}else i.call(this)};lime.input.prototype.setBackgroundColor=function(e){this.bgColor=e;this.setDirty(lime.Dirty.CONTENT);return this};lime.input.prototype.getBackgroundColor=function(){return this.bgColor};lime.input.prototype.setValue=function(e){this.value=e;this.setDirty(lime.Dirty.CONTENT);return this};lime.input.prototype.getValue=function(){return this.value};lime.input.prototype.setPlaceHolder=function(e){this.placeHolder=e;this.setDirty(lime.Dirty.CONTENT);return this};lime.input.prototype.getPlaceHolder=function(){return this.placeHolder};lime.input.prototype.setStroke=lime.Sprite.prototype.setStroke;lime.input.prototype.getStroke=lime.Sprite.prototype.getStroke;lime.input.prototype.setRadius=lime.RoundedRect.prototype.setRadius;lime.input.prototype.getRadius=lime.RoundedRect.prototype.getRadius;lime.input.prototype.setType=function(e){this.type=e;this.setDirty(lime.Dirty.CONTENT);return this};lime.input.prototype.getType=function(){return this.type};lime.input.prototype.setLengthLimit=function(e){this.lengthLimit=e;return this};lime.input.prototype.validValue=function(){var e=null===this.lengthLimit?1/0:this.lengthLimit,t=this.getValue();return t.length<=e};["FontFamily","FontColor","FontWeight","FontSize","Padding","LineHeight","Align","Style"].forEach(function(e){lime.input.prototype["set"+e]=lime.Label.prototype["set"+e];lime.input.prototype["get"+e]=lime.Label.prototype["get"+e]});lime.input.prototype.setHidden=function(e){if(this.hidden_!=e){this.hidden_=e;this.domElement&&(this.domElement.style.display=this.hidden_?"none":"block");this.autoHide_=0;this.setDirty(!0)}return this};lime.Renderer.DOM.INPUT={};lime.Renderer.CANVAS.INPUT={};lime.input.prototype.supportedRenderers=[lime.Renderer.DOM.makeSubRenderer(lime.Renderer.DOM.INPUT),lime.Renderer.CANVAS.makeSubRenderer(lime.Renderer.CANVAS.INPUT)];lime.Renderer.DOM.INPUT.draw=function(e){e.focus();e.value=this.getValue()||"";e.type=this.type||"text";e.setAttribute("placeholder",this.getPlaceHolder()||"");var t=e.style;t.position="absolute";t.outline="none";t["background-color"]=this.getBackgroundColor()||"transparent";lime.style.setBorderRadius(e,[this.radius_,this.radius_]);this.stroke_&&!goog.isNull(this.stroke_)?this.stroke_&&this.stroke_.setDOMStyle(e,this):goog.style.setStyle(e,"border-width",0);this.lineHeight_&&(t.lineHeight=this.lineHeight_);this.padding_&&(t.padding=goog.array.map(this.padding_,function(e){return e},this).join("px ")+"px");t.color=this.getFontColor();t.fontFamily=this.getFontFamily();t.fontSize=this.getFontSize()+"px";t.fontWeight=this.getFontWeight();t.textAlign=this.getAlign();t["font-style"]=this.getStyle();this.dirty_=0};lime.Renderer.CANVAS.INPUT.draw=function(){this.createDomElement();game.director&&game.director.domElement&&game.director.domElement.appendChild(this.domElement);this.maskTarget_=!0;lime.Renderer.DOM.update.call(this);goog.style.setOpacity(this.domElement,this.getOpacity());delete this.maskTarget_;lime.Renderer.DOM.INPUT.draw.call(this,this.domElement);this.dirty_=0};goog.inherits(Y,f);Y.prototype.setValue=function(e){return this.currentSprite&&this.currentSprite.setValue&&this.currentSprite.setValue(e)};Y.prototype.getValue=function(){return this.currentSprite&&this.currentSprite.getValue&&this.currentSprite.getValue()};Y.prototype.validValue=function(){return this.currentSprite&&this.currentSprite.validValue&&this.currentSprite.validValue()};window.QyInput=Y;qyengine.createInstance=function(e,t,i){var n=w(e.type);if(!n)return null;var r=new n(e),o=e.id;o&&(window[o]=r,r.id=o);ee(r,t,e);i||e.no_c_d_evt||r.dispatchEvent("create");return r};qyengine.save=function(){return qyremote.uploadFile("dev",SelfModName()+"/gamecode.js",qyengine.gamecode)};goog.inherits(re,b2ContactListener);re.prototype.addContact=function(e,t){var i=t.GetFixtureA(),n=t.GetFixtureB(),r=oe(i),o=oe(n),s=t.IsSensor();ae(r)&&ae(o)&&se(e,r,o,i.fixName,n.fixName,s)};re.prototype.BeginContact=function(e){this.addContact(this.beginContacts,e)};re.prototype.EndContact=function(e){this.addContact(this.endContacts,e)};re.prototype.handleContacts=function(){this.handleContactList(this.beginContacts,"collision","enterobject");this.handleContactList(this.endContacts,"collisionend","leaveobject")};var Ze=[];qyengine.uniqueCollide=function(e,t,i,n){var r=t.other,o=t.myName,s=t.withName;if("allFixs"!=i&&i.indexOf(o)<0||"allFixs"!=n&&n.indexOf(s)<0)return!1;if(ce(e,r,i,n)||ce(r,e,n,i))return!1;Ze.push({obj1:e,obj2:r,myNames:i,withNames:n});return!0};re.prototype.handleContactList=function(e,t,i){for(var n=0;n<e.length;n++){var r=e[n],o=r.obj1,s=r.obj2,a=r.fixName1,h=r.fixName2,c=r.isSensor,l=c?i:t;he(o,s,l,a,h)}e.length=0;Ze.length=0};current_game.velocityIterations=1;current_game.positionIterations=1;var $e=0,et=!1;qyengine.switchScene=function(e,t){Ce?qe=e:qyengine.preloadedScenes[e]===!0?pe(e,t):we(e,function(){pe(e,t)})};qyengine.generated=function(){};var tt,it;current_game.disableDebugDraw=function(){it&&(it.style.visibility="hidden");current_game.world&&current_game.world.SetDebugDraw(null)};current_game.enableDebugDraw=function(){if(!it){var e=it=document.createElement("canvas");e.id="debug_canvas";e.style.border="1px dashed blue";document.body.appendChild(e);it=e;tt||(tt=new b2DebugDraw);tt.SetSprite(e.getContext("2d"));tt.SetFillAlpha(.3);tt.SetLineThickness(1);tt.SetFlags(b2DebugDraw.e_shapeBit|b2DebugDraw.e_jointBit)}it.style.visibility="visible";current_game.world.SetDebugDraw(tt);var t=current_scene.full_size,i=t.width/t.height;if(i>1){it.width=300;it.height=it.width/i}else{it.height=300;it.width=it.height*i}tt.SetDrawScale(it.width/t.width/Je)};var nt={};qyengine.isKeyDown=function(e){return nt[e]};qyengine.reset=function(){qyengine.keyDispatcher||ye();window.current_scene&&current_scene.destroy();A();clear_all_sounds();qyengine.resetCurCatBit();current_game.director&&current_game.director.popScene();current_game.disableDebugDraw();!qyengine.audioUnlocked&&qyengine.unlockAudio_&&ge();qyengine.preloadedScenes={};qyengine.preloadedSounds={}};var rt;qyengine.preloadedFiles={};qyengine.preloadedSounds={};qyengine.loadingAgent=new QyEventTarget;qyengine.preloadedScenes={};qyengine.preloadLoadingScene=function(e){we(current_game.loading_scene,function(){ke||qyengine.isApk||pe(current_game.loading_scene);we(current_game.start_scene,function(){qyengine.switchScene(current_game.start_scene)},e)},e)};qyengine.createGame=function(e){if(e){var t=e.global&&e.global.start_scene||"gamecode",i=qyengine.genGame(e);window.js_beautify&&(i=js_beautify(i));qyboot.evalClean(i+"\n//@ sourceURL="+t+".js")}};var ot=32,st=1e3/ot;qyengine.setStepsPerSecond=function(e){if(e){ot=e;st=1e3/e;lime.scheduleManager.setFrameTime(st)}};qyengine.gmx_foreach=_e;qyengine.define_type=function(e,t,i,n,r){if(n instanceof Array){r=n;n=null}var o=qyengine.guardType(e);goog.inherits(o,t);o.baseType=t;o.defaultOpt=i;o.evHandlers=n;o.prototype.classId=e;o.prototype.init_=be;o.classId=e;window[e]=o;if(r){goog.array.sortObjectsByKey(r,0);o.prototype.stepDefs_=r;o.prototype.stepMax_=r[r.length-1][0]+1}};qyengine.initStage=function(e){qyengine.gRenderer=PIXI.autoDetectRecommendedRenderer(800,600,e,!1,!0);var t=qyengine.gStage=new PIXI.Stage(2371909);t.mousedown=t.mousemove=t.mouseup=B;t.touchstart=t.touchmove=t.touchend=B}}(window.isLime);!function(){function e(e){QyObject.call(this);var t=this.currentSprite=(new lime.Video).setAnchorPoint(0,0).setSrc(e.src||"").setAutoplay(!!e.autoplay).setControls(!!e.controls),i=e.position;i&&t.setPosition(i.x,i.y);var n=e.size;n&&t.setSize(n.width,n.height);e.hiddenAtStart&&this.hide();t.qyobj=this;this.loopTime=0;this.setLoop(e.loop||1);e.videoSkipBtn&&e.videoSkipBtn.isUse&&e.videoSkipBtn.data&&e.videoSkipBtn.data.picture&&t.setSkipButton(e.videoSkipBtn.data);var r=this;goog.events.listen(t,"video:ended",function(){r.loopTime++;"loop"===r.loop||r.loopTime<r.loop?r.play():r.ended=!0})}lime.Video=function(){lime.Node.call(this);this.setSize(400,250)};goog.inherits(lime.Video,lime.Node);lime.Video.prototype.createDomElement=function(){var e=this,t="video",i=function(){var i=this.domElement=this.rootElement=this.containerElement=goog.dom.createDom(t);this.domClassName&&goog.dom.classes.add(this.domElement,this.domClassName);i.style.position="absolute";e.registerEvents();this.dirty_|=-1};if(this.domElement){var n=this.domElement.tagName.toLowerCase();if(n!=t){var r=this.rootElement;i.call(this);r.parentNode&&r.parentNode.replaceChild(this.rootElement,r)}}else i.call(this)};lime.Video.prototype.registerEvents=function(){var e=this,t=this.domElement;if(t){var i=["play","pause","progress","error","timeupdate","ended","abort","empty","emptied","waiting","loadedmetadata"];i.forEach(function(i){t.addEventListener(i,function(n){t.ended?e.dispatchEvent({type:"video:ended",event:n}):e.dispatchEvent({type:"video:"+i,event:n})})})}};lime.Video.prototype.setHidden=function(e){if(this.hidden_!=e){this.hidden_=e;this.domElement&&(this.domElement.style.display=this.hidden_?"none":"block");this.autoHide_=0;this.setDirty(!0)}return this};lime.Video.prototype.setSrc=function(e){this.src=e;this.setDirty(!0);return this};lime.Video.prototype.getSrc=function(){return this.src};lime.Video.prototype.setAutoplay=function(e){this.autoplay=!!e;this.setDirty(!0);return this};lime.Video.prototype.getAutoplay=function(){return!!this.autoplay};lime.Video.prototype.setControls=function(e){this.controls=!!e;this.setDirty(!0);return this};lime.Video.prototype.getControls=function(){return!!this.controls};lime.Video.prototype.play=function(){this.domElement&&this.domElement.play&&this.domElement.play()};lime.Video.prototype.pause=function(){this.domElement&&this.domElement.pause&&this.domElement.pause()};lime.Video.prototype.isEnded=function(){return this.domElement&&this.domElement.ended};lime.Video.prototype.replay=function(){var e=this.domElement;if(e){e.currentTime=0;e.play()}};lime.Video.prototype.skip=function(){var e=this.domElement;e&&(e.currentTime=e.duration)};lime.Video.prototype.setSkipButton=function(e){var t=this,i=this.skipButton;if(!i){i=this.skipButton=document.createElement("img");i.addEventListener("mousedown",function(){t.skip()});i.addEventListener("touchstart",function(){t.skip()});i.style.position="absolute"}i.src=e.picture;if(e.position){i.style.left=e.position.x+"px";i.style.top=e.position.y+"px"}};lime.Video.prototype.drawSkipButton=function(){if(this.skipButton){var e=this.domElement&&this.domElement.parentNode;if(e){var t=this.domElement.nextSibling;t?e.insertBefore(this.skipButton,t):e&&e.appendChild(this.skipButton)}else this.setDirty(!0)}};lime.Renderer.DOM.VIDEO={};lime.Renderer.CANVAS.VIDEO={};lime.Video.prototype.supportedRenderers=[lime.Renderer.DOM.makeSubRenderer(lime.Renderer.DOM.VIDEO),lime.Renderer.CANVAS.makeSubRenderer(lime.Renderer.CANVAS.VIDEO)];lime.Renderer.DOM.VIDEO.draw=function(e){e.setAttribute("src",this.getSrc());var t=this.getAutoplay();t?e.setAttribute("autoplay","autoplay"):e.removeAttribute("autoplay");var i=this.getControls();i?e.setAttribute("controls","controls"):e.removeAttribute("controls");this.drawSkipButton();this.dirty_=0};lime.Renderer.CANVAS.VIDEO.draw=function(){this.createDomElement();game.director&&game.director.domElement&&game.director.domElement.appendChild(this.domElement);this.maskTarget_=!0;lime.Renderer.DOM.update.call(this);goog.style.setOpacity(this.domElement,this.getOpacity());delete this.maskTarget_;lime.Renderer.DOM.VIDEO.draw.call(this,this.domElement);this.dirty_=0};goog.inherits(e,QyObject);e.prototype.setLoop=function(e){this.loop=e};e.prototype.getLoop=function(){return this.loop};e.prototype.play=function(){if(this.ended){this.ended=!1;this.loopTime=0}this.currentSprite&&this.currentSprite.play()};e.prototype.pause=function(){this.currentSprite&&this.currentSprite.pause()};e.prototype.setSrc=function(e){this.currentSprite&&this.currentSprite.setSrc(e)};e.prototype.replay=function(){if(this.ended){this.ended=!1;this.loopTime=0}this.currentSprite&&this.currentSprite.replay()};window.QyVideo=e}();!function(){function e(e){QyObject.call(this);var t=this.currentSprite=(new lime.Iframe).setAnchorPoint(0,0).setSrc(e.webLink||"").setRadius(e.radius).setStroke(e.border),i=e.position;i&&t.setPosition(i.x,i.y);var n=e.size;n&&t.setSize(n.width,n.height);e.hiddenAtStart&&this.hide();this.zIndex=e.zIndex||0;t.qyobj=this}lime.Iframe=function(){lime.Node.call(this);this.setSize(400,250)};goog.inherits(lime.Iframe,lime.Node);lime.Iframe.prototype.createDomElement=function(){var e="iframe",t=function(){var t=this.domElement=this.rootElement=this.containerElement=goog.dom.createDom(e);this.domClassName&&goog.dom.classes.add(this.domElement,this.domClassName);t.style.position="absolute";this.dirty_|=-1};if(this.domElement){var i=this.domElement.tagName.toLowerCase();if(i!=e){var n=this.rootElement;t.call(this);n.parentNode&&n.parentNode.replaceChild(this.rootElement,n)}}else t.call(this)};lime.Iframe.prototype.setHidden=function(e){if(this.hidden_!=e){this.hidden_=e;this.domElement&&(this.domElement.style.display=this.hidden_?"none":"block");this.autoHide_=0;this.setDirty(!0)}return this};lime.Iframe.prototype.setSrc=function(e){this.src=e;this.setDirty(!0);return this};lime.Iframe.prototype.getSrc=function(){return this.src};lime.Iframe.prototype.setRadius=function(e){this._radius=e;this.setDirty(!0);return this};lime.Iframe.prototype.getRadius=function(){return this._radius||0};lime.Iframe.prototype.setStroke=function(e){if(e){this._stroke={width:e.stroke||0,color:e.color||"#000000"};lime.Sprite.prototype.setStroke.call(this,this._stroke.width,this._stroke.color);this.setDirty(!0);return this}};lime.Iframe.prototype.getStroke=lime.Sprite.prototype.getStroke;lime.Renderer.DOM.IFRAME={};lime.Renderer.CANVAS.IFRAME={};lime.Iframe.prototype.supportedRenderers=[lime.Renderer.DOM.makeSubRenderer(lime.Renderer.DOM.IFRAME),lime.Renderer.CANVAS.makeSubRenderer(lime.Renderer.CANVAS.IFRAME)];lime.Renderer.DOM.IFRAME.draw=function(e){e.setAttribute("src",this.getSrc());lime.style.setBorderRadius(e,[this.getRadius(),this.getRadius()]);this.stroke_&&!goog.isNull(this.stroke_)?this.stroke_&&this.stroke_.setDOMStyle(e,this):goog.style.setStyle(e,"border-width",0);this.dirty_=0};lime.Renderer.CANVAS.IFRAME.draw=function(){this.createDomElement();game.director&&game.director.domElement&&game.director.domElement.appendChild(this.domElement);this.maskTarget_=!0;lime.Renderer.DOM.update.call(this);goog.style.setOpacity(this.domElement,this.getOpacity());delete this.maskTarget_;lime.Renderer.DOM.IFRAME.draw.call(this,this.domElement);this.dirty_=0};goog.inherits(e,QyObject);e.prototype.setSrc=function(e){this.currentSprite&&this.currentSprite.setSrc(e)};window.QyIframe=e}();!function(){function e(e,t){var i=h[e];i&&scene.stickyLayer.drawVariable(e,i.caption+t,i.x,i.y,i.font,i.other)}function t(e,t,i,n){e=null!=e?getText(e,!0):n+":";var r=null!=e.text?e.text:e;null!=e.text?e.text=current_game[n]:e=current_game[n];draw_variable(n,e,r,t,i)}function i(e){e&&(e.getActiveNode()||e.play())}function n(e){e&&e.getActiveNode()&&e.stop()}function r(e,t){var i,n=e.classId||e,r=l[n];if(r&&r.length>0){i=r[0];t&&goog.object.extend(i,t);return i}return s(e,t)}function o(e){var t=e.classId||e,i=l[t];if(i){for(var n=[],r=0;r<i.length;r++){var o=i[r];o.getActiveNode()||n.push(o)}for(var r=0;r<n.length;r++)goog.array.remove(i,n[r])}}function s(e,t){var i=e.classId||e;o(e);var n,r=qyengine.guardType(i);if(r){n=new r(t);l[i]?l[i].push(n):l[i]=[n];window[i]=n}return n}function a(e){window.gamejson&&window.gamejson.ranklists?e=Object.keys(window.gamejson.ranklists)[0]:e||(e="rank_1");if(!p[e]||p[e].scene!=current_scene){var t=qyengine.guardType(e);t&&(p[e]=new t)}return p[e]}qyengine.instance_create=window.instance_create=function(e,t,i,n){var r="string"==typeof n?n:n&&n.id,o=this.getRotation&&this.getRotation()||0;i instanceof Array&&(i=i[random(i.length-1)]);return qyengine.createInstance({type:i.classId||i,id:r,position:{x:e,y:t},rotation:o,zIndex:n.zIndex},n&&n.layer&&qyengine.guardId(n.layer))};qyengine.instance_change=window.instance_change=function(e,t,i){t.classId&&(t=t.classId);if(e.classId==t)return this;var n=e.getPosition();if(null==n)return null;if(e.destroyBuffered||e.rebuildBuffered||e.destroyed_)return null;var r=!i,o=e.layer,s={type:t.classId||t,id:e.id,position:{x:n.x,y:n.y},rotation:e.getRotation(),no_c_d_evt:r};e.destroy(r);return qyengine.createInstance(s,o)};qyengine.instance_destroy=window.instance_destroy=function(e){e.destroy()};qyengine.irandom_range=window.irandom_range=function(e,t){var i=Math.round(frandom_range(e,t+1));return i===t+1?e:i};qyengine.frandom_range=window.frandom_range=function(e,t){return Math.random()*(t-e)+e};qyengine.random_range=window.random_range=window.irandom_range;qyengine.random=window.random=function(e,t){if(null==t){t=e;e=0}return random_range(e,t)};qyengine.random_array=window.random_array=function(e){
e>0||(e=10);for(var t=goog.array.range(e),i=[],n=e-1;n>0;n--){var r=random(n);i.push(t[r]);goog.array.removeAt(t,r)}i.push(t[0]);return i};qyengine.prev_scene=window.prev_scene=function(){scene&&scene.prev_scene&&qyengine.switchScene(scene.prev_scene)};qyengine.next_scene=window.next_scene=function(){scene&&scene.next_scene?qyengine.switchScene(scene.next_scene):console.log("next_scene is not defined")};qyengine.restart_scene=window.restart_scene=function(){scene&&qyengine.switchScene(scene.classId)};qyengine.different_scene=window.different_scene=function(e){e.classId&&(e=e.classId);qyengine.switchScene(e)};qyengine.check_prev_scene=window.check_prev_scene=function(){return!(!scene||!scene.prev_scene)};qyengine.check_next_scene=window.check_next_scene=function(){return!(!scene||!scene.next_scene)};var h={};qyengine.updateDraw=e;qyengine.draw_variable=window.draw_variable=function(e,t,i,n,r,o){if(null!=t){var s=t.font||i.font,a=t.size||i.size;a&&(o?o.size||(o.size=a):o={size:a});null!=t.text&&(t=t.text);null!=i.text?i=i.text:i&&"no-text"!=i||(i="");h[e]={caption:i,x:n,y:r,font:s,other:o};scene.stickyLayer.drawVariable(e,i+("string"==typeof t?t:JSON.stringify(t)),n,r,s,o)}};qyengine.draw_text=window.draw_text=draw_variable;qyengine.draw_score=window.draw_score=function(e,i,n){t(e,i,n,"score")};qyengine.draw_lives=window.draw_lives=function(e,i,n){t(e,i,n,"lives")};qyengine.draw_life_image=window.draw_life_image=function(e,t,i,n,r){current_scene.drawLifeImage(e,t,i,n,r)};qyengine.draw_health=window.draw_health=function(e,i,n){t(e,i,n,"health")};qyengine.draw_money=window.draw_money=function(e,i,n){t(e,i,n,"money")};qyengine.draw_experience=window.draw_experience=function(e,i,n){t(e,i,n,"experience")};qyengine.draw_level=window.draw_level=function(e,i,n){t(e,i,n,"level")};qyengine.set_score=window.set_score=function(t){current_game.score=t;e("score",t)};qyengine.set_lives=window.set_lives=function(t){current_game.lives=t;e("lives",t);qyengine.draw_life_image()};qyengine.set_health=window.set_health=function(t){current_game.health=t;e("health",t)};qyengine.set_money=window.set_money=function(t){current_game.money=t;e("money",t)};qyengine.set_experience=window.set_experience=function(t){current_game.experience=t;e("experience",t)};qyengine.set_level=window.set_level=function(t){current_game.level=t;e("level",t)};qyengine.stop_all_sounds=window.stop_all_sounds=function(){for(var e in l)for(var t=0;t<l[e].length;t++)n(l[e][t])};qyengine.stop_sounds=window.stop_sounds=function(){for(var e in l)for(var t=0;t<l[e].length;t++)l[e][t]!=c&&n(l[e][t])};qyengine.clear_all_sounds=window.clear_all_sounds=function(){for(var e in l)for(var t=0;t<l[e].length;t++)l[e][t].unload();l={};c=null};if(qyengine.isApk){qyengine.mute=window.mute=function(){if(!qyengine._muted){qyengine._muted=!0;for(var e in l)for(var t=0;t<l[e].length;t++)l[e][t].mute()}};qyengine.unmute=window.unmute=function(){if(qyengine._muted){qyengine._muted=!1;for(var e in l)for(var t=0;t<l[e].length;t++)l[e][t].unmute()}};qyengine.setVolume=window.setVolume=function(e){e>=0&&1>=e||(e=1);qyengine.volume_=e;for(var t in l)for(var i=0;i<l[t].length;i++)l[t][i].setVolume(e)};qyengine.getVolume=window.getVolume=function(){return null!=qyengine.volume_?qyengine.volume_:1};qyengine.isMuted=function(){return qyengine._muted}}else{qyengine.mute=window.mute=function(){Howler.mute()};qyengine.unmute=window.unmute=function(){Howler.unmute()};qyengine.setVolume=window.setVolume=function(e){e>=0&&1>=e||(e=1);Howler.volume(e)};qyengine.getVolume=window.getVolume=function(){return Howler.volume()};qyengine.isMuted=function(){return Howler._muted}}qyengine.set_cursor=window.set_cursor=function(e){current_game.director.domElement.style.cursor=e};qyengine.hide_cursor=window.hide_cursor=function(){set_cursor("none")};qyengine.restore_cursor=window.restore_cursor=function(){set_cursor("auto")};qyengine.get_time_text=window.get_time_text=function(e){var t,i,n,r="";if(e>59){i=Math.floor(e/60);t=e%60;if(i>59){n=Math.floor(i/60);i%=60;r=(n>9?n:"0"+n)+":"+(i>9?i:"0"+i)+":"+(t>9?t:"0"+t)}else r=(i>9?i:"0"+i)+":"+(t>9?t:"0"+t)}else r="00:"+(e>9?e:"0"+e);return r};qyengine.vibrate=function(e){navigator.notification&&navigator.notification.vibrate&&navigator.notification.vibrate(e)};qyengine.cancelVibration=function(){navigator.notification&&navigator.notification.cancelVibration&&navigator.notification.cancelVibration()};!function(){function e(){"window"==l?i():"navigator"==l?t():console.log("accelerometer not spported")}function t(){c&&navigator.accelerometer.clearWatch(c);c=null;d.frequency=null;u=0;p=0;y=0}function i(){window.removeEventListener("devicemotion",r,!0);f=!1;u=0;p=0;y=0}function n(e){if(e.x!=u||e.y!=p||e.z!=y){u=e.x;p=e.y;y=e.z;g.x=10*u;g.y=10*p;g.z=10*y;qyengine.accelerationDispatcher.dispatchEvent(g)}}function r(e){var t=e.accelerationIncludingGravity;if(t.x!=u||t.y!=p||t.z!=y){u=t.x;p=t.y;y=t.z;g.x=10*u;g.y=10*p;g.z=10*y;qyengine.accelerationDispatcher.dispatchEvent(g)}}function o(e){console.log("acceleration watch error",e)}function s(e){"window"==l?a():"navigator"==l?h(e):console.log("accelerometer not supported.")}function a(){if(!f){window.addEventListener("devicemotion",r,!0);f=!0}}function h(t){t||(t=100);if(d.frequency!=t||!c){e();d.frequency=t;c=navigator.accelerometer.watchAcceleration(n,o,d)}}var c,l=window.DeviceMotionEvent?"window":navigator.accelerometer?"navigator":null,d={frequency:null},u=0,p=0,y=0,g={type:"acceleration",x:0,y:0,z:0};qyengine.accelerationDispatcher=new QyEventTarget;var f;qyengine.stopWatchAcceleration=e;qyengine.watchAcceleration=s}();var c,l={};qyengine.getSound=r;qyengine.soundExist=function(e){var t=e.classId||e;return l[t]&&l[t].length>0};qyengine.play_sound=window.play_sound=function(e,t){e.classId&&(e=e.classId);var r=s(e,t);if(r.is_background){n(c);c=r}i(r)};qyengine.sound_play=window.sound_play=play_sound;qyengine.stop_bg_sound=window.stop_bg_sound=function(){n(c)};qyengine.stop_sound=window.stop_sound=function(e){var t=e.classId||e,i=l[t];if(i)for(var r=0;r<i.length;r++)n(i[r])};qyengine.sound_stop=window.sound_stop=stop_sound;qyengine.check_sound=window.check_sound=function(e){var t=e.classId||e,i=l[t];if(i)for(var n=0;n<i.length;n++)if(i[n].getActiveNode())return!0;return!1};qyengine.sound_check=window.sound_check=check_sound;var d,u;qyengine.getLogger=window.getLogger=function(e){if(!window.log4javascript)return console;if("inpage"==e){if(!d){d=log4javascript.getLogger("inpage");var t=new log4javascript.InPageAppender;d.addAppender(t)}return d}if("popup"==e){if(!u){u=log4javascript.getLogger("popup");var t=new log4javascript.PopUpAppender;u.addAppender(t)}return u}return console};var p={};qyengine.getRankList=a;qyengine.displayRanklist=window.displayRanklist=function(e){var t=a(e);t&&t.displayRanklist()};qyengine.insertRankListData=window.insertRankListData=function(e,t){if(window.isLime){var i=a();if(i){e=JSON.parse(JSON.stringify(e));delete e.actionIndex;delete e.comment;delete e.disabled_action;delete e.method;delete e.show;delete e.ranklist;i.insertRankListData(e,t)}}};qyengine.execute_formula=window.execute_formula=function(e,t,i,n,r,o,s){return current_game.formulas&&current_game.formulas[e]?current_game.formulas[e].call(this,t,i,n,r,o,s):void 0}}();!function(e){function t(e){var t=goog.dom.createElement("link");t.rel="shortcut icon";t.href=e;window.document&&document.head.appendChild(t)}qyengine.registerWeixinMenuEvent=function(){var e=window.document.createElement("script");e.src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js";window.document.head.appendChild(e);e.onload=function(){var e=window.location.href,t=qyboot.getBaseURI()+qyboot.getPrefix()+qyboot.getDomainApp(),i=game.game_icon||"favicon.ico",n=game.share_text||game.game_desc||"game",r=game.game_name,o="wxdd06a5845121307a";i="/"===i[0]?qyboot.getBaseURI()+i:t+"/"+i;qyremote_async.getWeiXinSignature(e,function(t){if(t&&t.success){t=t.result;window.wx.config({appId:o,timestamp:t.timestamp,nonceStr:t.noncestr,signature:t.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"]});window.wx.ready(function(){window.wx.onMenuShareTimeline({title:n,link:e,imgUrl:game.weixin_share_images||i,desc:n,success:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_timeline:ok"})},fail:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_timeline:fail"})},cancel:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_timeline:cancel"})}});window.wx.onMenuShareAppMessage({title:r,link:e,imgUrl:game.weixin_share_images||i,desc:n,success:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_app_msg:ok"})},fail:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_app_msg:fail"})},cancel:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_app_msg:cancel"})}});window.wx.onMenuShareQQ({title:r,link:e,imgUrl:game.weixin_share_images||i,desc:n,success:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_qq:ok"})},fail:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_qq:fail"})},cancel:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_qq:cancel"})}});window.wx.onMenuShareWeibo({title:r,link:e,imgUrl:game.weixin_share_images||i,desc:n,success:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_weibo:ok"})},fail:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_weibo:fail"})},cancel:function(){game.weixin_callback&&game.scripts[game.weixin_callback]&&game.scripts[game.weixin_callback]({err_msg:"share_weibo:cancel"})}})})}})}};qyengine.start=function(i,n){current_game.dataforms||qyengine.initDataforms();localStorage.setItem("QYLOCALE","zh-CN");qyengine.reset();window[qyengine.loading_scene]||qyengine.initLoadingScene();i||(i=window.json||window.gamejson);window.gamejson=i;n?"string"==typeof n&&(n=document.getElementById(n)):n=document.body;var r=current_game.director&&current_game.director.domElement.parentElement;if(r!=n){current_game.director=new lime.Director(n);current_game.director.pauseClassFactory=QyPauseScene;for(var o=function(e){e.preventDefault&&e.preventDefault();e.returnValue=!1;e._isDefaultPrevented=!0},s=["touchstart","touchend","touchmove","touchcancel","mousedown","mouseup","mousemove","mouseout"],a=0;a<s.length;a++){document.addEventListener(s[a],o,!0);document.addEventListener(s[a],o,!1)}}if(!e&&!qyengine.gRenderer){var h=document.createElement("canvas");current_game.director.domElement.appendChild(h);qyengine.initStage(h)}current_game.start_scene||qyengine.createGame(i);current_game.director.setDisplayFPS(current_game.displayFPS);qyengine.generated&&qyengine.generated();current_game.loading_scene||(current_game.loading_scene=qyengine.loading_scene);current_game.pause_scene||(current_game.pause_scene=qyengine.pause_scene);if(!current_game.game_name){var c=qyboot.getDomainApp();current_game.game_name=c?qyboot.filename(c):"made by gamemei"}current_game.game_icon&&t(current_game.game_icon);current_game.extend&&qyengine.initVars(current_game,current_game.extend);qyengine.initBrowserVars();qyengine.loadAppUserData();window.document&&(window.document.title=current_game.game_name);qyengine.setStepsPerSecond(current_game.stepsPerSecond);current_game.start_scene?qyengine.preloadLoadingScene(i):console.log("current_game.start_scene is not defined.");!current_game.isFullScreen&&current_game.screenEmptyFill&&(n.style.backgroundColor=current_game.screenEmptyFill);if("pixel"===game.filter&&"dom"===game.renderer){var l=current_game.director.domElement;goog.style.installStyles(".pixelated {image-rendering:optimizeSpeed;             /* Legal fallback */image-rendering:-moz-crisp-edges;          /* Firefox        */image-rendering:-o-crisp-edges;            /* Opera          */image-rendering:-webkit-optimize-contrast; /* Safari         */image-rendering:optimize-contrast;         /* CSS3 Proposed  */image-rendering:crisp-edges;               /* CSS4 Proposed  */image-rendering:pixelated;                 /* CSS4 Proposed  */-ms-interpolation-mode:nearest-neighbor;   /* IE8+           */}");var d=l.getAttribute("class")||"";d+=" pixelated";l.setAttribute("class",d)}}}(window.isLime);!function(){lime.animation.RotateBy=function(e){lime.animation.Animation.call(this);this.delta_=e};goog.inherits(lime.animation.RotateBy,lime.animation.Animation);lime.animation.RotateBy.prototype.makeTargetProp=function(e){return e&&e.getRotation&&e.getRotation()};lime.animation.RotateBy.prototype.update=function(e,t){if(0!=this.status_){var i=this.getTargetProp(t);t.setRotation(i+this.delta_*e)}};lime.animation.ScaleBy=function(e,t){lime.animation.Animation.call(this);2==arguments.length?this.delta_=new goog.math.Coordinate(arguments[0],arguments[1]):this.delta_=e};goog.inherits(lime.animation.ScaleBy,lime.animation.Animation);lime.animation.ScaleBy.prototype.makeTargetProp=function(e){return e&&e.getScale&&e.getScale()};lime.animation.ScaleBy.prototype.update=function(e,t){if(0!=this.status_){var i=this.getTargetProp(t);t.setScale(i.x+this.delta_.x*e,i.y+this.delta_.y*e)}};lime.animation.FadeBy=function(e){lime.animation.Animation.call(this);this.delta_=e};goog.inherits(lime.animation.FadeBy,lime.animation.Animation);lime.animation.FadeBy.prototype.makeTargetProp=function(e){return e&&e.getOpacity&&e.getOpacity()};lime.animation.FadeBy.prototype.update=function(e,t){if(0!=this.status_){var i=this.getTargetProp(t),n=i+this.delta_*e;0>n&&(n=0);n>1&&(n=1);t.setOpacity(n)}}}()};
qyengine.initGenCode=function(){!function(){function e(e,t){t==qyengine.loading_scene&&(e=qyengine.loading_scene_json);var a={files:[],sounds:[],usedScenes:[]},c=e&&e.scenes&&e.scenes[t];if(!c)return a;s(e,c,a.files);Ne={};Ee=[];var u=o(e,c);n(e,t,u,a.files);a.sounds=r(e,u);a.usedScenes=i(e,u,c.prev_scene,c.next_scene)||[];return a}function t(e){if(e){e=z(e);if(e&&!Ne[e]){Ne[e]=!0;Ee.push(e)}}}function n(e,n,r,i){e.global.start_scene==n&&"load_as_scene"!==e.global.load_resource?Ee=Object.keys(e.sprites):Je(r,function(e){t(e.sprite);e.sprites&&Je(e.sprites,function(e){t(e)})});for(var s=0;s<Ee.length;s++){var o=Ee[s],c=e.sprites[o];if(c){a(i,c.fill);if(c.keyframe){a(i,c.keyframe.url);c.keyframe.frames&&Je(c.keyframe.frames,function(e){a(i,e.url)})}}}}function r(e,t){var n=[];f(t,function(t){("sound_play"==t.method||"play_sound"==t.method)&&e.sounds&&e.sounds[t.sound]&&n.push(t.sound)});return n}function i(e,t,n,r){function i(t){if(t&&"no-scene"!=t&&!s[t]){s[t]=!0;e.scenes[t]&&a.push(t)}}var a=[],s={};i(n);i(r);f(t,function(e){"different_scene"==e.method&&i(e.scene)});return a}function a(e,t){t instanceof Array?Je(t,function(t){a(e,t)}):t&&!/^#/.test(t)&&e&&e.push(t)}function s(e,t,n){var r=t.background&&e.backgrounds&&e.backgrounds[t.background];r&&a(n,r.fill)}function o(e,n){function r(t){t=z(t);if(!a[t]){a[t]=!0;var n=e.objects&&e.objects[t];if(n){o.push(n);n.parent&&"no-parent"!=n.parent&&r(n.parent)}}}function i(n){switch(n.method){case"instance_change":case"instance_create":case"create_moving":r(n.type);return;case"create_random":Je(n.objects,function(e){r(e)});return;case"set_timeline":var a=z(n.timeline);if(!s[a]){s[a]=!0;var o=e.timelines&&e.timelines[a];if(o&&o.steps)for(var c=0;c<o.steps.length;c++){var l=o.steps[c];u(l.actions,function(e){i(e)})}}return;case"change_sprite":t(n.sprite);return}}var a={},s={},o=[];l(n,function(e){i(e)});n.layers&&Je(n.layers,function(e){e.objects&&Je(e.objects,function(e){r(e.type)})});for(var c=[];o.length>0;){var f=o.shift();c.push(f);l(f,function(e){i(e)})}return c}function c(e,t){e&&Je(e,function(e){u(e.actions,t)})}function u(e,t){e&&Je(e,function(e){t(e)})}function l(e,t){var n=e.events;if(n instanceof Array)c(n,t);else for(var r in n)c(n[r],t)}function f(e,t){Je(e,function(e){l(e,t)})}function v(e,t,n){var r=t.events?y(t.events):"",i=t.steps?h(t):"",a=t.events,s=t.steps;delete t.events;delete t.steps;var o=JSON.stringify(t),c=r?",{"+r+"}":"",u=i?",["+i+"]":"",l=goog.string.format("gmx_['%s'] = function(opt) {this.init_(opt,'%s');};qyengine.define_type('%s',%s,%s %s %s);",e,e,e,n,o,c,u);a&&(t.events=a);s&&(t.steps=s);return l}function h(e){if(!e.steps||0==e.steps.length)return"";for(var t=[],n=0;n<e.steps.length;n++){var r=e.steps[n];if(!r.disabled_step){var i=P(r.actions),a="["+r.step+",function("+x(i)+"){var self = this;var other = this.other_;"+i+"}]";t.push(a)}}return t.join(",")}function p(e){var t=e.type.indexOf(":");e.keyCode=e.type.substr(t+1);var n=parseInt(e.keyCode);!isNaN(n)&&(e.keyCode=n);e.type=e.type.substr(0,t);"key"==e.type&&(e.type="keydown")}function g(e){var t=e.type;if(t instanceof Array){if(t.indexOf("mousedown")>=0){goog.array.remove(t,"touchstart");t.push("touchstart")}if(t.indexOf("mouseup")>=0){goog.array.remove(t,"touchend");t.push("touchend")}if(t.indexOf("mousemove")>=0){goog.array.remove(t,"touchmove");t.push("touchmove")}}else{if(/^key(up|down)?:/.test(t))p(e);else if(/^collision(end)?:/.test(t)){var n=t.split(":");e.type=n[0];e["with"]=n[1]}else if(/^(enter|leave)object:/.test(t)){var n=t.split(":");e.type=n[0];e["with"]=n[1]}else if(/^outofscene:/.test(t)){e.outType=t.substr("outofscene:".length);e.type="outofscene"}else if(/^outofview:/.test(t)){e.outType=t.substr("outofview:".length);e.type="outofview"}else if(/^inscene:/.test(t)){e.inType=t.substr("inscene:".length);e.type="inscene"}else if(/^inview:/.test(t)){e.inType=t.substr("inview:".length);e.type="inview"}else if(/^alarm:/.test(t)){e.alarmIdx=t.substr("alarm:".length);e.type="alarm"}else if(/^swipe:/.test(t)){e.swipeType=t.substr("swipe:".length);e.type="swipe"}else if("mousedown"==t)e.type=["mousedown","touchstart"];else if("mouseup"==t)e.type=["mouseup","touchend"];else if("mousemove"==t)e.type=["mousemove","touchmove"];else if(/^message:/.test(t)){e.message=t.substr("message:".length);e.type="message"}if(e["with"]&&"object"==typeof e["with"]){var r=Object.keys(e["with"])[0];e.withNames=e["with"][r];e["with"]=r}}}function _(e){for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r];"string"==typeof i&&i.indexOf(":")<0&&"loading"!=i&&"loaded"!=i?t.push(i):n.push(i)}return{can:t,others:n}}function d(e){for(var t=e.length,n=0;t>n;n++){var r=e[n];if(r.type instanceof Array){var i=_(r.type),a=i.can,s=i.others;if(a.length>0)r.type=a;else{var o=s.shift();if("object"==typeof o){r.type=o.type;qyengine.addToObj(r,o)}else r.type=o}Je(s,function(t){t.type?t.actions=r.actions:t={type:t,actions:r.actions};e.push(t)})}}}function y(e,t){if(!e)return"";if(!(e instanceof Array)){var n="";for(var r in e)n+=y(e[r],r);return n}d(e);var i={};Je(e,function(e){g(e);e.disabled_event||(i[e.type]?i[e.type].push(e):i[e.type]=[e])});var n="";for(var a in i){var s=i[a],o="";switch(a){case"keydown":case"keyup":o=B(s,a,t);break;case"outofscene":case"outofview":o=O(s,t,a);break;case"swipe":o=T(s,t);break;case"alarm":o=j(s,t);break;case"message":o=q(s,t);break;case"inscene":case"inview":o=S(s,t,a);break;case"loading":case"loaded":o=I(s,a,t);break;default:o=w(s,a,t)}if(o){n&&(n+=",");n+=o}}return n}function m(e,t){var n=e?"if(this.spriteName && this.spriteName != '"+e+"'){return;}":"",r=t.indexOf("self")>=0?"var self=this;":"",i=t.indexOf("other")>=0?"var other=this.other_;":"";return n+r+i+t}function b(e,t){var n=e.my,r=n&&JSON.stringify(n),i=e.withNames,a=i&&JSON.stringify(i);t=n&&i?"if(qyengine.uniqueCollide(this,event,"+r+","+a+")){"+t+"}":n?"if(qyengine.uniqueCollide(this,event,"+r+",'allFixs')){"+t+"}":i?"if(qyengine.uniqueCollide(this,event,'allFixs',"+a+")){"+t+"}":"if(event.myName=='allFixs'&&event.withName=='allFixs'){"+t+"}";return t}function w(e,t,n){if(!e||0==e.length)return"";var r="";Je(e,function(e){var t=P(e.actions);if(t){e["with"]&&(t=qe(e["with"])?"if(qyengine.isInTags('"+e["with"]+"', other)){"+b(e,t)+"}":"if(other instanceof qyengine.guardType('"+e["with"]+"')){"+b(e,t)+"}");r+=t}});r&&(r=goog.string.format("'%s':function(%s){%s}",t,x(r),m(n,r)));return r}function x(e){return e.indexOf("event")>=0?"event":""}function j(e,t){if(!e||0==e.length)return"";var n="switch (event.alarmIdx) {\n";Je(e,function(e){n+=e.alarmIdx&&"all"!=e.alarmIdx?"case '"+e.alarmIdx+"':\n":"default:\n";n+=P(e.actions);n+="break;\n"});n+="}";var r="'alarm':function("+x(n)+") {"+m(t,n)+"}";return r}function q(e,t){if(!e||0==e.length)return"";var n="switch (event.message) {\n";Je(e,function(e){n+=e.message&&"all"!=e.message?"case '"+e.message+"':\n":"default:\n";n+=P(e.actions);n+="break;\n"});n+="}";var r="'message':function("+x(n)+") {"+m(t,n)+"}";return r}function k(e){switch(e){case"top":return"up";case"bottom":return"down";default:return e}}function T(e,t){if(!e||0==e.length)return"";var n="switch (event.gesture.direction) {\n";Je(e,function(e){n+=e.swipeType&&"all"!=e.swipeType?"case '"+k(e.swipeType)+"':\n":"default:\n";n+=P(e.actions);n+="break;\n"});n+="}";var r="'swipe':function("+x(n)+") {"+m(t,n)+"}";return r}function O(e,t,n){if(!e||0==e.length)return"";var r="switch (event.outType) {\n";Je(e,function(e){r+=e.outType&&"other"!=e.outType?"case '"+e.outType+"':\n":"default:\n";r+=P(e.actions);r+="break;\n"});r+="}";var i="'"+n+"': function("+x(r)+") {"+m(t,r)+"}";return i}function S(e,t,n){if(!e||0==e.length)return"";var r="switch (event.inType) {\n";Je(e,function(e){r+=e.inType&&"other"!=e.inType?"case '"+e.inType+"':\n":"default:\n";r+=P(e.actions);r+="break;\n"});r+="}";r="'"+n+"':function("+x(r)+") {"+m(t,r)+"}";return r}function I(e,t,n){if(!e||0==e.length)return"";var r="";Je(e,function(e){var t=P(e.actions);t&&(r+=t+"\n")});if(r){var i="",a="";if(r.indexOf("progress")>=0){i="this.progress=event.progress;";a="event"}else r.indexOf("event")>=0&&(a="event");r="'"+t+"': function("+a+"){"+i+m(n,r)+"}"}return r}function B(e,t,n){if(!e||0==e.length)return"";var r="",i="";Je(e,function(e){if("any"==e.keyCode)r=P(e.actions);else{var t=M(e);t&&(i+=t+"\n")}});i&&(i="switch (event.keyCode) {"+i+"}");i+=r;if(i){var a="keydown"==t?"if(event.repeat){return;}":"";i="'"+t+"':function(event) {"+a+m(n,i)+"}"}return i}function M(e){var t=P(e.actions);t&&(t=goog.string.format("case %s:\n%s\nbreak;",A(e.keyCode),t));return t}function A(e){return"number"==typeof e?e:goog.events.KeyCodes[e.toUpperCase()]}function C(e){var t=Ve[e];if(t)return t.isTest;if(!gamejson.global||!gamejson.global.customActions)return!1;t=gamejson.global.customActions[e];return t&&t.isTest}function R(e,t,n){for(;t<e.length;){var r=E(e,t,"start_block");if(r.error)return r;goog.array.extend(n,r.block);if("end_block"==r.block[0].method)return{block:n};t+=r.block.length}return{idx:t,error:"no end_block"}}function N(e,t,n){var r=E(e,t,"test");if(r.error){"no action"==r.error&&(r.error="no action after test");return r}if("else_"==r.block[0].method)return{error:"no action after test",idx:t};t+=r.block.length;if(t<e.length&&"else_"==e[t].method){var i=E(e,t+1);if(i.error)return i;goog.array.extend(n,r.block);goog.array.extend(n,e[t]);goog.array.extend(n,i.block);return{block:n}}goog.array.extend(n,r.block);return{block:n}}function E(e,t,n){if(null==e||0==e.length||t>=e.length)return{idx:t,error:"no action"};var r=e[t],i=[r];return"start_block"==r.method?R(e,t+1,i):C(r.method)?N(e,t+1,i):"end_block"==r.method&&"start_block"!=n?{idx:t,error:"no start_block before"}:"else_"==r.method&&"test"!=n?{idx:t,error:"no test before"}:{block:i}}function J(e){var t={blocks:[]};if(!e||0==e.length)return t;for(var n=0;n<e.length;){var r=E(e,n);if(r.error)return r;t.blocks.push(r.block);n+=r.block.length}return t}function F(){return"repeatTime"+We++}function P(e){if(!e||0==e.length)return"";var t=J(e);t.error&&console.log(t.idx+":"+t.error);We=0;return Z(e)}function W(e,t){var n=e[t];delete e[t];return n}function V(e){if(e.type)return e;var t={};if(e.layer){t.type="id";t.str=e.layer}else if("this"==e||"other"==e||"browser"===e)t.type=e;else if(/^game:/.test(e))t.type="current_game";else if(/^scene:/.test(e))t.type="current_scene";else if(/^id:/.test(e)){t.type="id";t.str=e.substr("id:".length)}else if(/^tag:/.test(e)){t.type="tag";t.str=e.substr("tag:".length)}else if(e.indexOf(":")>0){t.type="class";t.str=e.substr(e.indexOf(":")+1)}else{t.type="class";t.str=e}t.str&&(t.str=$(t.str));return t}function D(e,t){if(!e)return"";t=V(t);switch(t.type){case"this":return e;case"other":case"current_game":case"current_scene":case"browser":return e.replace(/this/g,t.type);case"id":return e.replace(/this/g,"qyengine.guardId("+t.str+")");case"tag":return"qyengine.forEachTag(function(){"+e+"},"+t.str+");";default:return"qyengine.forEach(function(){"+e+"},"+t.str+");"}}function U(e,t){for(var n,r=!1,i=[],a=t.argMIdx;a>=0;a--){n=e["argument"+a];if(""!==n&&null!=n){i.push(n);r=!0}else r&&i.push("undefined")}t.argSelf&&i.push("self");t.argEvent&&i.push("event");var s="";if(t.argThis){i.push("this");s=".call"}return s+"("+i.reverse().join(",")+")"}function z(e){return e.replace(/(^')|('$)/g,"").replace(/(^")|("$)/g,"")}function G(e){var t=V(e);switch(t.type){case"this":case"other":return t.type;case"id":return t.str;case"class":return"qyengine.getInstancesByType("+t.str+")";default:return""}}function L(e){var t=/[^.]+.vars_\(['"]([^'"]+)['"]\)/,n=t.exec(e);return n?"'"+n[1]+"'":e}function Q(e,t,n){var r=e.x,i=e.y;(e.relative||e.relative_x)&&(0!=r?r+="+this.x":r="this.x");(e.relative||e.relative_y)&&(0!=i?i+="+this.y":i="this.y");var a=null!=e.caption&&"no-text"!==e.caption?z(e.caption):n+":",s="qyengine.draw_"+n+"('"+a+"',"+r+","+i+");";return D(s,t)}function X(e){return"this"==e?"self":"other"==e?"other":/^id:/.test(e)?e.substr("id:".length):"'"+e+"'"}function Y(e){var t=[];for(var n in e)e[n]instanceof Array?t.push('"'+n+'":['+e[n].join(",")+"]"):t.push('"'+n+'":'+$(e[n]));return"{"+t.join(",")+"}"}function $(e){if(["true","false","null","undefined"].indexOf(e)>=0)return e;if(""==e)return'""';/^[\u4e00-\u9fa5a-zA-Z_][\u4e00-\u9fa5\w]*$/.test(e)&&(e="'"+e+"'");return e}function H(e){switch(e){case"smaller_than":case"less_than":return"<";case"larger_than":case"greater_than":return">";case"not_smaller_than":case"not_less_than":return">=";case"not_larger_than":case"not_greater_than":return"<=";case"not_equal_to":return"!=";default:return"=="}}function K(e){var t="";if(e&&e.length){"start_block"!==e[0].method&&(t+="{");t+=Z(e);"end_block"!==e[e.length-1].method&&(t+="}")}else t="{}";return t}function Z(e){for(var t="",n=0;n<e.length;n++)if("set_sleep"===e[n].method){var r=E(e,n+1);t+=ee(e[n],r&&r.block);r&&r.block&&(n+=r.block.length)}else t+=ee(e[n])+"\n";return t}function ee(e,t){if(!e.method||e.disabled_action)return"";e=goog.object.clone(e);var n=W(e,"method"),r=W(e,"appliesTo"),i=r?r:"this",a=Ve[n],s=window.gamejson&&gamejson.global&&gamejson.global.customActions;if(s&&s[n]){var o=s[n],c=o.script;if(!c){(console.error||console.log).call(console,n+"has no corresponding script");return""}for(var u={method:"execute_script",script:o.script,isTest:o.isTest},l=0;l<o.parameters.length;l++){var f=e[o.parameters[l].prop];u["argument"+l]=null!=f?f:o.parameters[l].defaultValue}v=Ve.execute_script(u,i);return v}if(a){var v=a(e,i,t);a.isTest&&(v="if("+v+")");return v}(console.error||console.log).call(console,n+" is not supported.please check qyengine.supportedMethods and write your own custom action");return""}function te(){return 1<<Ge++}function ne(e,t){e.withs_||(e.withs_=[]);for(var n=0;n<e.withs_.length;n++)if(e.withs_[n]==t)return;e.withs_.push(t)}function re(e){if(!e.events)return[];d(e.events);for(var t=[],n=0;n<e.events.length;n++){var r=e.events[n];g(r);if(!r.disabled_event&&("collision"==r.type||"collisionend"==r.type||"enterobject"==r.type||"leaveobject"==r.type)){var i=qe(r["with"]);i&&i.objects&&i.objects.length?t=t.concat(i.objects):t.push(r["with"])}}return t}function ie(e,t,n){var r=t[e];if(r.handled_)return r;r.handled_={};if(null!=r.parent&&"no-parent"!=r.parent){var i=ie(r.parent,t,n);i.handled_.children?i.handled_.children.push(r):i.handled_.children=[r];r.handled_.parent=i}for(var a=re(r),s=0;s<a.length;s++){var o=a[s],c=t[o];if(c){ne(r,o);ne(c,e)}else console.log("ERROR:"+o+" does not exist")}n.push(e);return r}function ae(e,t){if(!t||e.physics){e.physics||(e.physics={});if(e.physics.solid===!0){e.physics.categoryBits=1;e.physics.maskBits=4294967295}else{0==e.physics.density&&(e.physics.density=.001);e.physics.categoryBits||(e.physics.categoryBits=t?2:te());null!=e.physics.maskBits||(e.physics.maskBits=e.physics.collideWithSolid?1:0)}}}function se(e,t,n){return e.handled_.actualWiths_&&e.handled_.actualWiths_.indexOf(t)>=0?!0:e.handled_.parent&&se(e.handled_.parent,t,n)?!0:t.handled_.parent&&se(e,t.handled_.parent,n)?!0:!1}function oe(e,t){var n=e.handled_.actualWiths_;if(n)for(var r=0;r<n.length;r++)n[r].physics.maskBits|=t;var i=e.handled_.parent;i&&oe(i,t)}function ce(e,t,n){if(!se(e,t,n)){e.handled_.actualWiths_||(e.handled_.actualWiths_=[]);t.handled_.actualWiths_||(t.handled_.actualWiths_=[]);e.handled_.actualWiths_.push(t);t.handled_.actualWiths_.push(e);ae(e);ae(t);oe(e,e.physics.categoryBits);oe(t,t.physics.categoryBits)}}function ue(e,t,n){function r(e,t){return n.indexOf(e)-n.indexOf(t)}if(e.withs_&&0!=e.withs_.length){e.withs_.sort(r);for(var i=0;i<e.withs_.length;i++){var a=t[e.withs_[i]];ce(e,a)}}}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=e[r];ae(i,!0);var a=i.physics&&i.physics.categoryBits;if(a){var s=i.handled_.children;if(s)for(var o=0;o<s.length;o++){var c=s[o];ae(c,!0);if(c.physics){2==c.physics.categoryBits&&(c.physics.categoryBits=a);c.physics.maskBits|=i.physics.maskBits}}}}}function fe(e){return Pe.indexOf(e)>=0||/^swipe:/.test(e)}function ve(e){if(e&&e.events)for(var t=0;t<e.events.length;t++){var n=e.events[t],r=n.type;if("string"==typeof r){if(fe(r)){e.gesture=!0;return}}else for(var i=0;i<r.length;i++)if(fe(r[i])){e.gesture=!0;return}}}function he(e){var t,n,r,i=[];for(t in e)ie(t,e,i);for(r=0;r<i.length;r++){t=i[r];n=e[t];ue(n,e,i)}le(e,i);var a="";for(r=0;r<i.length;r++){t=i[r];n=e[t];delete n.handled_;delete n.withs_;ve(n);var s=null!=n.parent&&"no-parent"!=n.parent?"qyengine.guardType("+$(n.parent)+")":"QyObject";a+=v(t,n,s)}return a}function pe(e,t){var n,r=e[t+"s"],i="";switch(t){case"object":i=he(r);break;case"scene":for(n in r)ve(r[n]);default:for(n in r)i+=v(n,r[n],"Qy"+qyengine.toUpperFirst(t))}return i}function ge(e){e||(e={});return JSON.stringify(e)}function _e(e){e=e.animation;for(var t={loop:"forever"==e.loop?0:e.loop||1,frames:[]},n=Le,r=0,i=0;i<e.frames.length;i++){var a=e.frames[i],s=ye(n,a);if(s){t.frames.push(s);n=a}else if(t.frames.length>0){t.frames[t.frames.length-1].duration+=a.duration+r;r=0}else r+=a.duration}return t}function de(e){var t,n={scale:["scaleTo","scaleTo"],moveTo:["oldFormatMove","oldFormatMove"],rotate:["rotateTo","rotateTo"],fadeTo:["fadeTo","fadeTo"],Rotate:["rotateTo","rotateBy"],Scale:["scaleTo","scaleBy"],Move:["moveTo","moveBy"],Fade:["fadeTo","fadeBy"],Color:["colorTo","colorTo"]};for(var r in n)if(e[r]){t=n[r][e[r].relative?1:0];e[t]=e[r];t!==r&&delete e[r]}return e}function ye(e,t){function n(e,t,n){var r=!1;n.forEach(function(n){r=r||e[n]!==t[n]});return r}var r={anim:[],duration:t.duration},i=e.anime,a=de(t.anime);[{type:"scaleTo",props:["x","y"]},{type:"scaleBy",props:["x","y"]},{type:"moveTo",props:["x","y"]},{type:"moveBy",props:["x","y"]},{type:"rotateTo",props:["angle"]},{type:"rotateBy",props:["angle"]},{type:"fadeTo",props:["opacity"]},{type:"fadeBy",props:["opacity"]},{type:"colorTo",props:["color"]},{type:"oldFormatMove",props:["x","y"]}].forEach(function(e){var t=e.type,s=i[t],o=a[t];if(o&&(!s||n(o,s,e.props))){var c=void 0;if(1===e.props.length)c=o[e.props[0]];else{c={};e.props&&e.props.forEach(function(e){c[e]=o[e]})}r.anim.push([t,c])}});return r.anim.length>0?r:null}function me(e){var t={};for(var n in e)t[n]=_e(e[n]);return JSON.stringify(t)}function be(t){var n={};for(var r in t.scenes)n[r]=e(t,r);return"current_game.sceneRes=qyengine.addToObj(current_game.sceneRes,"+JSON.stringify(n)+");"}function we(e){e=JSON.parse(JSON.stringify(e||{}));for(var t in e)e[t]=xe(e[t]);return ge(e)}function xe(e){if(e instanceof Array){var t={};e.forEach(function(e,n){t[n+1]=e});return t}return e.data}function je(e){return ge(e)}function qe(e){return qyengine.gmjson&&qyengine.gmjson.tags&&qyengine.gmjson.tags[e]}function ke(e){var t="current_game.texts=qyengine.addToObj(current_game.texts,"+ge(e.texts)+");";t+="current_game.fonts=qyengine.addToObj(current_game.fonts,"+ge(e.fonts)+");";t+="current_game.animations=qyengine.addToObj(current_game.animations,"+me(e.animations)+");";e.global&&(t+="qyengine.addToObj(current_game,"+JSON.stringify(e.global)+");");t+=be(e);t+="qyengine.installFonts();";e.dataforms&&(t+="current_game.dataforms=qyengine.addToObj(current_game.dataforms,"+we(e.dataforms)+");");t+="current_game.tags = qyengine.addToObj(current_game.tags,"+je(e.tags)+")";return t}function Te(e){if(!e||!e.objects)return e;for(var t in e.objects){var n=e.objects[t];if(n.sprites)if(1==n.sprites.length){var r=e.sprites[n.sprites[0]];if(r&&r.events&&r.events.length>0){n.events=r.events;r.events=null}}else if(n.sprites.length>1){for(var i,a={},s=0;s<n.sprites.length;s++){var o=n.sprites[s];r=e.sprites[o];if(r&&r.events&&r.events.length>0){a[o]=r.events;r.events=null;i=!0}}i&&(n.events=a)}}if(e.actionlists){e.scripts||(e.scripts={});for(var c in e.actionlists){var u="al_scr_"+c;e.scripts[u]=Ae();Ie(e.scripts[u],e.actionlists[c])}for(var c in e.actionlists){var u="al_scr_"+c;e.scripts[u].content=P(e.actionlists[c].actions)}}Me(e);var l,f,v,h;for(var p in e.tags){l=e.tags[p];if(l){f=l.objects;v=l.events;h=l.behaviors;f&&f.forEach(function(t){var n=e.objects[t];if(n){n.events||(n.events=[]);n.events=n.events.concat(v);for(var r in h)h[r]&&(n[r]&&n[r].inheritedTag!==p||(n[r]=h[r]));e.objects[t]=n}})}}}function Oe(e){if(!gamejson.global||!gamejson.global.customActions)return null;var t=gamejson.global.customActions;for(var n in t)if(t[n].script==e)return t[n];return null}function Se(e,t){var n="",r=t.parameters;if(r&&r.length>0){var i=[];e.argMIdx=r.length-1;for(var a=0;a<=e.argMIdx;a++)i.push(r[a].prop);n=i.join(",")}return n}function Ie(e,t){var n="",r=t.args||[];if(r&&r.length>0){var i=[];e.argMIdx=r.length-1;for(var a=0;a<=e.argMIdx;a++)i.push(r[a].name);n=i.join(",")}return n}function Be(e){var t=(e.content,""),n=["argument0","argument3","argument2","argument3","argument4"];e.argMIdx=-1;if(n&&n.length>0){var r=[];e.argMIdx=parseInt(n[n.length-1]["argument".length]);for(var i=0;i<=e.argMIdx;i++)r.push("argument"+i);t=r.join(",")}return t}function Me(e){for(var t in e.scripts){var n=e.scripts[t],r=n.content;if(/al_scr_/.test(t)){var i=Ie(n,e.actionlists&&e.actionlists[t.replace(/^al_scr_/,"")]),a=[];n.argEvent&&a.push("event");n.argSelf&&a.push("self");i&&a.push(i);n.argsStr=a.join(",")}else{n.argEvent=r.indexOf("event")>=0?"event":"";n.argThis=r.indexOf("this")>=0?"this":"";n.argSelf=r.indexOf("self")>=0?"self":"";var s=Oe(t),i=s?Se(n,s):Be(n),a=[];n.argEvent&&a.push("event");n.argSelf&&a.push("self");i&&a.push(i);n.argsStr=a.join(",")}}}function Ae(){return{argEvent:"event",argSelf:"self",argThis:"this",argsStr:"event,self,argument0,argument1,argument2,argument3,argument4"}}function Ce(e){var t=[];for(var n in e.scripts){var r=e.scripts[n],i=r.content;t.push('"'+n+'":function ('+r.argsStr+"){var self = this, other = this.other_;"+i+"}")}return"current_game.scripts=qyengine.addToObj(current_game.scripts,{"+t.join(",")+"});"}function Re(e){if(!e.formulas)return"";var t=[];for(var n in e.formulas){var r=e.formulas[n],i=r.formula,a=r.unknowns,s=goog.array.map(a,function(e){return e.name}).join(",");t.push('"'+n+'":function ('+s+"){return "+i+";}")}return"current_game.formulas=qyengine.addToObj(current_game.formulas,{"+t.join(",")+"});"}var Ne,Ee,Je=qyengine.gmx_foreach,Fe=["create","destroy","outofscene","outofview","inscene","inview","collision","collisionend","enterobject","leaveobject","pathstart","pathend","pathpoint","movestart","moveend","timelinestart","timelinestop","keyframestart","keyframeend","animationstart","animationend","alarm","wakeup","sleep","message"];qyengine.EventsOnQyObj=Fe;var Pe=[];!function(){for(var e in Hammer.gestures)Pe.push(e.toLowerCase())}();goog.array.extend(Fe,Pe);qyengine.checkActionList=J;var We=0;qyengine.forEach=function(e,t){var n=qyengine.getInstancesByType(t);Je(n,function(t){e.call(t)})};qyengine.all=function(e,t){for(var n=qyengine.getInstancesByType(t),r=0;r<n.length;r++)if(!e.call(n[r]))return!1;return!0};qyengine.forEachTag=function(e,t){var n=game.tags&&game.tags[t],r=n&&n.objects||[];if(r.length){var i=qyengine.getInstancesByType(r);Je(i,function(t){e.call(t)})}};qyengine.parseTarget=V;qyengine.genPattern=D;var Ve={};qyengine.genMethods=Ve;Ve.set_pause_scene=function(e){var t="current_game.pause_scene="+$(e.pause_scene)+";";return t};Ve.stop_event=function(){return"(event.event || event.originalEvent || event).stopPropagation();"};Ve.begin_watch_acceleration=function(e){var t="qyengine.watchAcceleration("+e.frequency+");";return t};Ve.cancel_watch_acceleration=function(){var e="qyengine.stopWatchAcceleration();";return e};Ve.save_game_variable=function(e){var t=e.variable,n=e.location,r="qyengine.saveGameVar("+$(t)+","+$(n)+");";return r};Ve.load_game_variable=function(e){var t=e.variable,n=e.location,r="qyengine.loadGameVar("+$(t)+","+$(n)+");";return r};Ve.save_all_autosave_variables=function(){var e="qyengine.storeAppUserData();";return e};Ve.load_all_autosave_variables=function(){var e="qyengine.loadAppUserData();";return e};Ve.apply_force=function(e,t){switch(e.type){case"angle":return Ve.apply_force_with_angle(e,t);case"tap":return Ve.apply_force_toward_tap(e,t);case"object":return Ve.apply_force_toward_object(e,t);default:return Ve.apply_force_with_coordinate(e,t)}};Ve.apply_force_with_coordinate=function(e,t){var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i="this.applyForce("+n+","+r+","+e.immediately+");";return D(i,t)};Ve.apply_torque=function(e,t){var n="this.applyTorque("+e.torque+");";return D(n,t)};Ve.set_opacity=function(e,t){var n,r=e.opacity,i=e.relative_opacity;n=i?"this.setOpacity("+r+"+this.getOpacity());":"this.setOpacity("+r+");";return D(n,t)};Ve.show=function(e,t){e=null;var n="this.show();";return D(n,t)};Ve.hide=function(e,t){e=null;var n="this.hide();";return D(n,t)};Ve.set_show_state=function(e,t){var n;n="show"==e.state?"this.show();":"hide"==e.state?"this.hide();":"this.toggleHidden();";return D(n,t)};Ve.execute_script=function(e,t){var n=e.script,r=z(n),i=window.gamejson.scripts[r];if(!i){(console.error||console.log).call(console,"script "+r+" not exist");return""}var a=e.isTest,s=U(e,i),o="current_game.scripts["+$(r)+"]"+s;if(a){t=V(t);return"class"==t.type?"if(qyengine.all(function(){return "+o+";},"+t.str+"))":"if("+D(o,t)+")"}return D(o+";",t)};Ve.execute_expression=function(e,t){var n=W(e,"expression");e.code=n;return Ve.execute_code(e,t)};Ve.execute_actionlist=function(e,t){var n=W(e,"actionlist");e.script="al_scr_"+z(n);return Ve.execute_script(e,t)};Ve.execute_code=function(e,t){var n=e.code;switch(t){case"this":return n;default:n.indexOf("this")>=0&&(n="(function(){"+n+"}).call(this);");return D(n,t)}};Ve.compare_2_values=function(e){var t=H(e.operation),n=e.value1+t+e.value2;e.not&&(n="!("+n+")");return n};Ve.compare_2_values.isTest=!0;Ve.is_mute=function(){var e="current_scene.mute";return e};Ve.is_mute.isTest=!0;Ve.is_paused=function(){var e="current_scene.paused";return e};Ve.is_paused.isTest=!0;Ve.is_between_values=function(e){var t="("+e.value+">="+e.lower_bound+" && "+e.value+"<="+e.upper_bound+")";e.not&&(t="!("+t+")");return t};Ve.is_between_values.isTest=!0;Ve.compare_width=function(e,t){var n=H(e.operation),r="this.width"+n+e.value;e.not&&(r="!("+r+")");t=V(t);return"class"==t.type?"qyengine.all(function(){return "+r+";},"+t.str+")":D(r,t)};Ve.compare_width.isTest=!0;Ve.compare_height=function(e,t){var n=H(e.operation),r="this.height"+n+e.value;e.not&&(r="!("+r+")");t=V(t);return"class"==t.type?"qyengine.all(function(){return "+r+";},"+t.str+")":D(r,t)};Ve.compare_height.isTest=!0;Ve.compare_rotation=function(e,t){var n=H(e.operation),r="this.rotation"+n+e.value;e.not&&(r="!("+r+")");t=V(t);return"class"==t.type?"qyengine.all(function(){return "+r+";},"+t.str+")":D(r,t)};Ve.compare_rotation.isTest=!0;Ve.compare_x=function(e,t){var n=H(e.operation),r="this.x"+n+e.value;e.not&&(r="!("+r+")");t=V(t);return"class"==t.type?"qyengine.all(function(){return "+r+";},"+t.str+")":D(r,t)};Ve.compare_x.isTest=!0;Ve.compare_y=function(e,t){var n=H(e.operation),r="this.y"+n+e.value;e.not&&(r="!("+r+")");t=V(t);return"class"==t.type?"qyengine.all(function(){return "+r+";},"+t.str+")":D(r,t)};Ve.compare_y.isTest=!0;Ve.jump_horizontal=function(e,t){var n=e.value;(e.relative||e.relative_value)&&(n+="+this.x");var r="this.setPosition("+n+",this.y,true);";return D(r,t)};Ve.jump_vertical=function(e,t){var n=e.value;(e.relative||e.relative_value)&&(n+="+this.y");var r="this.setPosition(this.x,"+n+",true);";return D(r,t)};Ve.move_to=function(e,t){var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i="this.moveTo("+n+","+r+","+e.speed+");";return D(i,t)};Ve.set_speed=function(e,t){switch(e.type){case"tap":return Ve.set_speed_toward_tap(e,t);case"angle":return Ve.set_speed_with_angle(e,t);case"object":return Ve.set_speed_toward_object(e,t);default:return Ve.set_speed_with_coordinate(e,t)}};Ve.set_speed_with_coordinate=function(e,t){var n=null!=e.x?e.x:10,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.speed.x":n="this.speed.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.speed.y":r="this.speed.y");var i="this.setSpeed("+n+","+r+");";return D(i,t)};Ve.set_speed_with_angle=function(e,t){var n=null!=e.speed?e.speed:10,r=null!=e.angle?e.angle:0,i="this.setSpeedWithAngle("+n+","+r+");";return D(i,t)};Ve.set_speed_toward_tap=function(e,t){var n=null!=e.speed?e.speed:10,r="this.setSpeedTowardTap("+n+");";return D(r,t)};Ve.set_speed_toward_object=function(e,t){var n=G(e.object);if(n){var r=null!=e.speed?e.speed:10,i="this.setSpeedTowardObject("+n+","+r+");";return D(i,t)}return""};Ve.apply_force_with_angle=function(e,t){var n=null!=e.force?e.force:10,r=null!=e.angle?e.angle:0,i=e.immediately;e.relative_angle&&(r+="+this.rotation");var a="this.applyForceWithAngle("+n+","+r+","+i+");";return D(a,t)};Ve.apply_force_toward_tap=function(e,t){var n=null!=e.force?e.force:10,r=e.immediately,i="this.applyForceTowardTap("+n+","+r+");";return D(i,t)};Ve.apply_force_toward_object=function(e,t){var n=G(e.object);if(n){var r=null!=e.force?e.force:10,i=e.immediately,a="this.applyForceTowardObject("+n+","+r+","+i+");";return D(a,t)}return""};Ve.set_gravity=function(e){var t=e.x,n=e.y;(e.relative||e.relative_x)&&(0!=t?t+="+current_game.gravityX":t="current_game.gravityX");(e.relative||e.relative_y)&&(0!=n?n+="+current_game.gravityY":n="current_game.gravityY");var r="qyengine.setGravity("+t+","+n+");";return r};Ve.set_gravity_with_angle=function(e){var t=e.gravity||0,n=e.angle||0,r="qyengine.setGravityWithAngle("+t+","+n+","+e.relative_gravity+","+e.relative_angle+");";return r};Ve.reverse_vertical=function(e,t){e=null;var n="this.setSpeed(this.speed.x, -this.speed.y);";return D(n,t)};Ve.reverse_horizontal=function(e,t){e=null;var n="this.setSpeed(-this.speed.x, this.speed.y);";return D(n,t)};Ve.toggleVariable=function(e,t){var n="this.toggleVar("+$(e.variable)+");";return D(n,t)};Ve.set_friction=function(e,t){var n=W(e,"friction"),r=W(e,"relative_friction"),i=r?"+=":"=",a="this.friction"+i+n+";";return D(a,t)};Ve.set_is_sensor=function(e,t){var n=W(e,"sensor"),r="this.setIsSensor("+n+");";return D(r,t)};Ve.jump_to=function(e,t){var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i="this.setPosition("+n+","+r+",true);";return D(i,t)};Ve.set_path=function(e,t){e=goog.object.clone(e);var n=W(e,"path"),r="this.setPath("+$(n)+","+Y(e)+");";return D(r,t)};Ve.set_random_path=function(e,t){var n="this.setRandomPath("+Y(e)+");";return D(n,t)};Ve.end_path=function(e,t){e=null;var n="this.endPath();";return D(n,t)};Ve.set_path_position=function(e,t){var n="this.setPathPosition("+e.position+","+(e.relative||e.relative_position)+");";return D(n,t)};Ve.set_path_speed=function(e,t){var n="this.setPathSpeed("+e.speed+","+!(!e.relative&&!e.relative_speed)+");";return D(n,t)};Ve.instance_create=function(e,t){e=goog.object.clone(e);var n=W(e,"type");if(!n||"no-object"==n)return"";var r=W(e,"x"),i=W(e,"y"),a=W(e,"relative"),s=W(e,"relative_x"),o=W(e,"relative_y");(a||s)&&(0!=r?r+="+this.x":r="this.x");(a||o)&&(0!=i?i+="+this.y":i="this.y");var c;c=n instanceof Array?"["+n.join(",")+"]":$(n);var u="qyengine.instance_create("+r+","+i+","+c+","+Y(e)+");";return D(u,t)};Ve.create_moving=function(e,t){e=goog.object.clone(e);var n=W(e,"type");if(!n||"no-object"==n)return"";var r=W(e,"x"),i=W(e,"y"),a=W(e,"relative"),s=W(e,"relative_x"),o=W(e,"relative_y");(a||s)&&(0!=r?r+="+this.x":r="this.x");(a||o)&&(0!=i?i+="+this.y":i="this.y");var c=W(e,"speed")||0,u=W(e,"relative_speed"),l=W(e,"direction")||0,f=W(e,"relative_direction");if(a||u){var v="Math.sqrt(Math.pow(this.speed.x, 2)+Math.pow(this.speed.y, 2))";0!==c?c+="+"+v:c=v}if(a||f){var h="Math.atan(-(this.speed.y?this.speed.y/this.speed.x:0))*180/Math.PI";0!==l?l+="+"+h:l=h}var p="(function(type, obj, x, y, speed, direction) {qyengine.instance_create(x, y, type, obj).setSpeed(speed * Math.cos(direction * qyengine.A2R), speed * Math.sin((direction + 180) * qyengine.A2R));})("+$(n)+", "+JSON.stringify(e)+", "+r+", "+i+", "+c+", "+l+");";
return D(p,t)};Ve.create_random=function(e,t){for(var n=[],r=0;r<e.objects.length;r++){var i=e.objects[r];"no-object"!==e.objects[r]&&n.push($(i))}var a=n.length;if(0>=a)return"";e.type=n;delete e.objects;return Ve.instance_create(e,t)};Ve.create_text=Ve.instance_create;Ve.insert_ranklist_data=function(e){var t=(e.ranklist,e.score,e.time,e.show),n=t?",true":"",r="qyengine.insertRankListData("+Y(e)+n+");";return r};Ve.display_ranklist=function(e){var t=e.ranklist,n=t?$(t):"",r="qyengine.displayRanklist("+n+");";return r};Ve.instance_change=function(e,t){var n="qyengine.instance_change(this,"+$(e.type)+","+e.perform_event+");";return D(n,t)};Ve.instance_destroy=function(e,t){e=null;var n="this.destroy && this.destroy();";return D(n,t)};Ve.transform_object=function(e,t){var n="";null!=e.angle&&(n="this.setRotation("+e.angle+");");null!=e.xscale&&(n+="this.setScale("+e.xscale+","+e.yscale+");");return D(n,t)};Ve.change_sprite=function(e,t){var n="this.changeSprite("+$(e.sprite)+");";return D(n,t)};Ve.set_text=function(e,t){var n="this.setText("+e.text+");";return D(n,t)};Ve.set_time_text=function(e,t){var n="this.setText(qyengine.get_time_text("+e.text+"));";return D(n,t)};Ve.get_time_text=function(e,t){var n="qyengine.get_time_text("+e.time+");";return D(n,t)};Ve.add_text=function(e,t){var n="this.addText("+e.text+");";return D(n,t)};Ve.set_font_color=function(e,t){var n="this.setFontColor('"+e.color+"');";return D(n,t)};Ve.set_font_size=function(e,t){var n="this.setFontSize("+e.size+");";return D(n,t)};Ve.set_input_value=function(e,t){var n="this.setValue && this.setValue("+$(e.value)+");";return D(n,t)};Ve.mute=function(){return"qyengine.mute();"};Ve.unmute=function(){return"qyengine.unmute();"};Ve.set_volume=function(e){var t=null!=e.volume?e.volume:1;e.relative_volume&&(t+="+qyengine.getVolume()");return"qyengine.setVolume("+t+");"};Ve.play_sound=function(e){e=goog.object.clone(e);var t="",n=W(e,"sound");n&&"no-sound"!==n&&(t="qyengine.play_sound("+n+","+JSON.stringify(e)+");");return t};Ve.sound_play=Ve.play_sound;Ve.stop_certain_sound=function(e){var t="",n=W(e,"sound");n&&"no-sound"!==n&&(t="qyengine.stop_sound("+n+");");return t};Ve.stop_sound=function(e){return"all"==e.type?"qyengine.stop_all_sounds();":"music"==e.type?"qyengine.stop_bg_sound();":"sound"==e.type?"qyengine.stop_sounds();":Ve.stop_certain_sound(e)};Ve.sound_stop=Ve.stop_sound;Ve.check_sound=function(e){var t="qyengine.check_sound("+$(e.sound)+")";e.not&&(t="!("+t+")");return t};Ve.check_sound.isTest=!0;Ve.sound_check=Ve.check_sound;Ve.vibrate=function(e){var t=e.time||1e3,n="qyengine.vibrate("+t+");";return n};Ve.cancelVibration=function(){var e="qyengine.cancelVibration();";return e};Ve.prev_scene=function(){return"qyengine.prev_scene();"};Ve.next_scene=function(){return"qyengine.next_scene();"};Ve.restart_scene=function(){return"qyengine.restart_scene();"};Ve.different_scene=function(e){return"qyengine.different_scene("+$(e.scene)+");"};Ve.check_prev_scene=function(){return"qyengine.check_prev_scene()"};Ve.check_prev_scene.isTest=!0;Ve.check_next_scene=function(){return"qyengine.check_next_scene()"};Ve.check_next_scene.isTest=!0;Ve.set_timeline=function(e,t){e=goog.object.clone(e);var n=W(e,"timeline");if(n&&"no-timeline"!==n){var r="this.setTimeline("+$(n)+","+JSON.stringify(e)+");";return D(r,t)}return""};Ve.set_timeline_position=function(e,t){var n="this.setTimelinePosition("+e.position+","+(e.relative||e.relative_position)+");";return D(n,t)};Ve.timeline_position=Ve.set_timeline_position;Ve.set_timeline_speed=function(e,t){var n="this.setTimelineSpeed("+e.speed+","+(e.relative||e.relative_speed)+");";return D(n,t)};Ve.timeline_speed=Ve.set_timeline_speed;Ve.start_timeline=function(e,t){e=null;var n="this.startTimeline();";return D(n,t)};Ve.stop_timeline=function(e,t){e=null;var n="this.stopTimeline();";return D(n,t)};Ve.restart_game=function(){var e="scene.restartGame();";return e};Ve.end_game=function(){var e="scene.endGame();";return e};Ve.restart_scene=function(){var e="scene.restart();";return e};Ve.pause_game=function(e){var t=e.run_keyframes?"true":"",n="scene.pause("+t+");";return n};Ve.resume_game=function(){var e="scene.resume();";return e};Ve.test_chance=function(e){var t=e.sides||6,n="random("+t+"-1)==0";e.not&&(n="!("+n+")");return n};Ve.test_chance.isTest=!0;Ve.check_question=function(e){var t="confirm('"+e.question+"')";e.not&&(t="!('"+t+"')");return t};Ve.check_question.isTest=!0;Ve.start_block=function(){return"{"};Ve.else_=function(){return"else"};Ve.exit=function(){return"return;"};Ve.end_block=function(){return"}"};var De=[];qyengine.pushRepeat=function(e){De.push(e);return 0};qyengine.popRepeat=function(){return De.pop()};Ve.repeat=function(e){var t=F(),n=e.times,r=goog.string.format("for(var %s=qyengine.pushRepeat(repeatTime),repeatTime=0;(%s<%s)?true:(repeatTime=qyengine.popRepeat(),false);repeatTime=++%s)",t,t,n,t);return r};Ve.set_variable=function(e,t){var n=e.relative||e.relative_value,r=n?",true":"",i="this.setVar("+$(L(e.variable))+","+e.value+r+");";return D(i,t)};Ve.test_variable=function(e,t){var n=H(e.operation),r="this.vars_["+$(L(e.variable))+"]"+n+e.value;e.not&&(r="!("+r+")");t=V(t);return"class"==t.type?"qyengine.all(function(){return "+r+";},"+t.str+")":D(r,t)};Ve.test_variable.isTest=!0;Ve.draw_variable=function(e,t){var n=null!=e.caption&&"no-text"!=e.caption,r=e.variable||"",i="this.vars_["+$(r)+"]",a="this.classId + '_'+"+$(r),s=n?e.caption:r,o=e.relative_x?e.x+"+this.x":e.x,c=e.relative_y?e.y+"+this.y":e.y,u="qyengine.draw_variable("+a+","+i+",getText("+$(s)+(n?"":"+':'")+",true),"+o+","+c+");";return D(u,t)};Ve.set_score=function(e){var t=e.score;(e.relative||e.relative_score)&&(t+="+current_game.score");var n="qyengine.set_score("+t+");";return n};Ve.test_score=function(e){var t=H(e.operation),n="current_game.score"+t+e.value;e.not&&(n="!("+n+")");return n};Ve.test_score.isTest=!0;Ve.draw_score=function(e,t){return Q(e,t,"score")};Ve.clear_highscore=function(e){e=null;var t="current_game.score = 0;draw_score();";return t};Ve.set_lives=function(e){var t=e.lives;(e.relative||e.relative_lives)&&(t="current_game.lives+"+t);var n="qyengine.set_lives("+t+");";return n};Ve.test_lives=function(e){var t=H(e.operation),n="current_game.lives"+t+e.value;e.not&&(n="!("+n+")");return n};Ve.test_lives.isTest=!0;Ve.draw_lives=function(e,t){return Q(e,t,"lives")};Ve.draw_life_image=function(e){var t=e.x,n=e.y,r=e.image&&"no-sprite"!=e.image?e.image:"",i=e.relative||e.relative_x,a=e.relative||e.relative_y,s=a?","+i+","+a:i?","+i:"",o="qyengine.draw_life_image("+t+","+n+","+$(r)+s+");";return o};Ve.update_life_image=function(){var e="qyengine.draw_life_image();";return e};Ve.set_health=function(e){var t=e.health;(e.relative||e.relative_health)&&(t="current_game.health+"+t);var n="qyengine.set_health("+t+");";return n};Ve.test_health=function(e){var t=H(e.operation),n="current_game.health"+t+e.value;e.not&&(n="!("+n+")");return n};Ve.test_health.isTest=!0;Ve.draw_health=function(e){var t=null!=e.caption&&"no-text"!==e.caption||"health:",n="qyengine.draw_health('"+t+"',"+e.x1+","+e.y1+");";return n};Ve.set_money=function(e){var t=e.money;(e.relative||e.relative_money)&&(t="current_game.money+"+t);var n="qyengine.set_money("+t+");";return n};Ve.test_money=function(e){var t=H(e.operation),n="current_game.money"+t+e.value;e.not&&(n="!("+n+")");return n};Ve.test_money.isTest=!0;Ve.draw_money=function(e,t){return Q(e,t,"money")};Ve.set_experience=function(e){var t=e.experience;(e.relative||e.relative_experience)&&(t="current_game.experience+"+t);var n="qyengine.set_experience("+t+");";return n};Ve.test_experience=function(e){var t=H(e.operation),n="current_game.experience"+t+e.value;e.not&&(n="!("+n+")");return n};Ve.test_experience.isTest=!0;Ve.draw_experience=function(e,t){return Q(e,t,"experience")};Ve.set_level=function(e){var t=e.level;(e.relative||e.relative_level)&&(t="current_game.level+"+t);var n="qyengine.set_level("+t+");";return n};Ve.test_level=function(e){var t=H(e.operation),n="current_game.level"+t+e.value;e.not&&(n="!("+n+")");return n};Ve.test_level.isTest=!0;Ve.draw_level=function(e,t){return Q(e,t,"level")};var Ue=0;Ve.draw_text=function(e,t){e=goog.object.clone(e);var n=W(e,"x"),r=W(e,"y"),i=W(e,"relative"),a=W(e,"relative_x"),s=W(e,"relative_y");(i||a)&&(0!=n?n+="+this.x":n="this.x");(i||s)&&(0!=r?r+="+this.y":r="this.y");var o=W(e,"id")||"text_"+ ++Ue,c=W(e,"caption"),u=W(e,"text"),l=JSON.stringify(e);null!=c&&"no-text"!=c||(c="");var f=goog.string.format("qyengine.draw_variable('%s',getText('%s',true),'%s',%s,%s,%s);",o,u,c,n,r,l);return D(f,t)};Ve.run_animation=function(e,t){e=goog.object.clone(e);var n=W(e,"animations")||W(e,"animation");n=n?JSON.stringify(n):$(W(e,"type"));var r="this.runAnimation("+n+");";return D(r,t)};Ve.change_animation=function(e,t){var n="this.changeAnimation("+$(e.animation)+");";return D(n,t)};Ve.set_angle=function(e,t){var n=e.relative||e.relative_angle||e.relative_rotation,r=null!=e.angle?e.angle:e.rotation;n&&(r+="+this.rotation");var i="this.setRotation("+r+");";return D(i,t)};Ve.set_rotation=Ve.set_angle;Ve.set_scale=function(e,t){var n=e.relative||e.relative_x,r=e.relative||e.relative_y,i=e.x,a=e.y;n&&(i+="*this.scaleX");r&&(a+="*this.scaleY");var s="this.setScale("+i+","+a+");";return D(s,t)};Ve.set_width=function(e,t){var n=e.relative||e.relative_value?"+=":"=",r=null!=e.value?e.value:e.width,i="this.width"+n+r+";";return D(i,t)};Ve.set_height=function(e,t){var n=e.relative||e.relative_value?"+=":"=",r=null!=e.value?e.value:e.height,i="this.height"+n+r+";";return D(i,t)};Ve.set_follow=function(e,t){if("mouse"==e.type)return Ve.follow_mouse(e,t);var n=G(e.object);if(n){var r=e.x||0,i=e.y||0,a=e.follow_options||"both",s="this.setFollowObj("+n+","+r+","+i+",'"+a+"');";return D(s,t)}return""};Ve.follow_mouse=function(e,t){var n=e.x||0,r=e.y||0,i=e.follow_options||"both",a=e.way||"instant",s=e.setSpeed||0,o="this.followMouse && this.followMouse("+e.hideCursor+","+n+","+r+","+$(i)+",'"+a+"',"+s+");";return D(o,t)};Ve.unfollow_mouse=function(e,t){e=null;var n="this.unfollowMouse();";return D(n,t)};Ve.unfollow=Ve.unfollow_mouse;Ve.multiConditions=function(e){if(!e.conditions||0==e.conditions.length)return"";for(var t="",n=0;n<e.conditions.length;n++){var r=ee(e.conditions[n]);t+=r.replace(/^if\(/,"(")}return t};Ve.multiConditions.isTest=!0;Ve.and=function(){return"&&"};Ve.or=function(){return"||"};Ve.left_bracket=function(){return"("};Ve.right_bracket=function(){return")"};Ve.console_log=function(e){var t="inpage"==e.logger||"popup"==e.logger?"qyengine.getLogger('"+e.logger+"').info":"console.log",n=t+"("+e.log+");";return n};Ve.create_distance_joint=function(e,t){var n=X(e.object),r=e.jointId,i=r?","+r:"";e.object&&(/^object:/.test(e.object)?n=e.object.substr("object:".length):/^id:/.test(e.object)&&(n="window["+e.object.substr("id:".length)+"]"));var a="this.createDistanceJoint("+n+i+");";return D(a,t)};Ve.create_rope_joint=function(e,t){var n=X(e.object),r=e.jointId,i=r?","+r:"";e.object&&(/^object:/.test(e.object)?n=e.object.substr("object:".length):/^id:/.test(e.object)&&(n="window["+e.object.substr("id:".length)+"]"));var a="this.createRopeJoint("+n+i+");";return D(a,t)};Ve.create_revolute_joint=function(e,t){var n=X(e.object),r=e.jointId,i=r?","+r:"";e.object&&(/^object:/.test(e.object)?n=e.object.substr("object:".length):/^id:/.test(e.object)&&(n="window["+e.object.substr("id:".length)+"]"));var a="this.createRevoluteJoint("+n+i+");";return D(a,t)};Ve.create_weld_joint=function(e,t){var n=X(e.object),r=e.jointId,i=r?","+r:"";e.object&&(/^object:/.test(e.object)?n=e.object.substr("object:".length):/^id:/.test(e.object)&&(n="window["+e.object.substr("id:".length)+"]"));var a="this.createWeldJoint("+n+i+");";return D(a,t)};Ve.create_prismatic_joint=function(e,t){var n=X(e.object),r=e.jointId,i=r?","+r:"";e.object&&(/^object:/.test(e.object)?n=e.object.substr("object:".length):/^id:/.test(e.object)&&(n="window["+e.object.substr("id:".length)+"]"));var a="this.createPrismaticJoint("+n+i+");";return D(a,t)};Ve.release_joints=function(e,t){var n=e.jointId&&"all"!=e.jointId?e.jointId:"",r="this.releaseJoints("+n+");";return D(r,t)};Ve.set_fixed_rotation=function(e,t){var n="this.fixedRotation="+e.fixed+";";return D(n,t)};Ve.set_gravity_scale=function(e,t){var n=e.relative_scale?"+=":"=",r="this.gravityScale"+n+e.scale+";";return D(r,t)};Ve.set_rotation_speed=function(e,t){var n=e.speed,r=e.relative||e.relative_speed?"+=":"=",i="this.rotationSpeed"+r+n+";";return D(i,t)};Ve.dispatch_event=function(e,t){var n="this.dispatchMessage("+JSON.stringify(e.event)+");";return D(n,t)};Ve.send_msg=function(e,t){var n={type:"message",message:'"'+e.name+'"'};e.argument0&&(n.argument0=e.argument0);e.argument1&&(n.argument1=e.argument1);e.argument2&&(n.argument2=e.argument2);e.argument3&&(n.argument3=e.argument3);e.argument4&&(n.argument4=e.argument4);var r="this.dispatchMessage("+Y(n)+");";return D(r,t)};Ve.set_mirror=function(e,t){var n=e.type,r=e.mirror?-1:1,i="horizontal"==n?r:"undefined,"+r,a="this.setMirror("+i+");";return D(a,t)};Ve.face_toward=function(e,t){switch(e.toward){case"forward":return Ve.face_forward(e,t);case"coordinate":var n="this.faceToward({toward:'coordinate',x:"+e.x+",y:"+e.y+",relative_x:"+e.relative_x+",relative_y:"+e.relative_y+",delta:"+e.delta+",always:"+e.always+",min_rotation:"+e.min_rotation+",max_rotation:"+e.max_rotation+"});";return D(n,t);case"mouse":var n="this.faceToward({toward:'mouse',delta:"+e.delta+",min_rotation:"+e.min_rotation+",max_rotation:"+e.max_rotation+",always:"+e.always+"});";return D(n,t);case"object":default:return Ve.face_toward_object(e,t)}};Ve.face_toward_object=function(e,t){var n=G(e.object);if(n){var r="this.faceToward({toward:'object',objId:"+n+",delta:"+e.delta+",min_rotation:"+e.min_rotation+",max_rotation:"+e.max_rotation+",always:"+e.always+"});";return D(r,t)}return""};Ve.face_forward=function(e,t){var n="this.faceForward("+e.delta+","+e.always+");";return D(n,t)};Ve.set_rotate_only=function(e,t){e=null;var n="this.setRotateOnly();";return D(n,t)};Ve.set_scene_follow=function(e,t){var n="(function(data){var view = current_scene.view;if(!view) return;var follows = view.follows;if(follows){follows.hbor = data.relative_hbor ? (follows.hbor+data.hbor):data.hbor;follows.vbor = data.relative_vbor ? (follows.vbor+data.vbor):data.vbor;follows.hsp = data.relative_hsp ? (follows.hsp+data.hsp):data.hsp;follows.vsp = data.relative_vsp ? (follows.vsp+data.vsp):data.vsp;}this.setFollowView();}).call(this, "+Y(e)+");";return D(n,t)};Ve.release_scene_follow=function(){var e="current_scene.releaseFollowView();";return e};Ve.control_rotation=function(e,t){var n="";null!=e.fixed&&(n="this.fixedRotation="+e.fixed+";");null!=e.torque&&(n+="this.applyTorque("+e.torque+");");if(null!=e.speed){var r=e.speed,i=e.rotateOnly;(e.relative||e.relative_speed)&&(r+="+this.getRotationSpeed()");n+="this.controlRotation("+r+","+i+");"}return D(n,t)};Ve.make_draggable=function(e,t){var n="this.makeDraggable("+e.force+");";return D(n,t)};Ve.release_draggable=function(e,t){e=null;var n="this.releaseDraggable();";return D(n,t)};Ve.drag_to=function(e,t){if("object"==e.type)return Ve.drag_to_object(e,t);var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i=e.force||100,a="this.dragToPos("+n+","+r+","+i+");";return D(a,t)};Ve.drag_to_object=function(e,t){var n=G(e.object);if(n){var r=e.force||100,i="this.dragToObj("+n+","+r+");";return D(i,t)}return""};Ve.check_empty=function(e,t){var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i="only_solid"==e.type,a="this.checkIfEmpty("+n+","+r+","+i+")";e.not&&(a="!("+a+")");a=t?D(a,t):a;return";"===a[a.length-1]?a.slice(0,a.length-1):a};Ve.check_empty.isTest=!0;Ve.check_collision=function(e,t){var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i="only_solid"==e.type,a="this.checkIfCollide("+n+","+r+","+i+")";e.not&&(a="!("+a+")");a=t?D(a,t):a;return";"===a[a.length-1]?a.slice(0,a.length-1):a};Ve.check_collision.isTest=!0;Ve.check_object=function(e,t){var n=e.x,r=e.y;(e.relative||e.relative_x)&&(0!=n?n+="+this.x":n="this.x");(e.relative||e.relative_y)&&(0!=r?r+="+this.y":r="this.y");var i=e.type,a="this.checkTypeAt("+n+","+r+","+$(i)+")";e.not&&(a="!("+a+")");a=t?D(a,t):a;return";"===a[a.length-1]?a.slice(0,a.length-1):a};Ve.check_object.isTest=!0;Ve.test_instance_count=function(e){var t=H(e.operation),n=e.object,r="qyengine.getInstanceCount("+$(n)+")"+t+e.number;e.not&&(r="!("+r+")");return r};Ve.test_instance_count.isTest=!0;Ve.test_key_down=function(e){var t="qyengine.isKeyDown("+e.keyCode+");";return t};Ve.test_key_down.isTest=!0;Ve.set_view_center=function(e,t){var n=W(e,"speed"),r="this.setViewCenter("+n+");";return D(r,t)};Ve.set_alarm=function(e,t){var n=e.alarmIdx,r=null!=e.delay?e.delay:1e3,i="this.setAlarm('"+n+"',"+r+");";return D(i,t)};Ve.cancel_alarm=function(e,t){var n=e.alarmIdx,r="this.cancelAlarm('"+n+"');";return D(r,t)};Ve.add_instance_to_scroller=function(e,t){var n=e.type,r=e.x||1,i=e.y||1,a=r?r+" - 1":null,s=i?i+" - 1":null,o="this.addOneInstance("+$(n)+","+s+","+a+","+Y(e)+");";return D(o,t)};Ve.remove_instance_from_scroller=function(e,t){var n=e.way||"objectName",r=e.type,i=e.id,a=e.x,s=e.y,o=a?a+" - 1":"null",c=s?s+" - 1":"null",u="objectName"===n?"this.removeOneInstance("+$(r)+","+c+","+o+");":"this.removeById("+$(i)+")";return D(u,t)};Ve.share_in_weibo=function(e){var t=W(e,"url"),n=W(e,"text"),r=W(e,"relateUid")||"",i=W(e,"images"),a=W(e,"appkey")||"2CbR5k";t||(t=qyboot.getBaseURI()+qyboot.getPrefix()+qyboot.getDomainApp());n||(n=game.share_text||(game.game_name||"game")+(game.game_desc||"game"));i||(i=[]);i.forEach(function(e,t){"/"===e[0]?i[t]=qyboot.getBaseURI()+e:/^assets/.test(e)&&(i[t]=qyboot.getBaseURI()+qyboot.getPrefix()+qyboot.getDomainApp()+"/"+e)});i=i.join("||");return"(function(url, relatedUid, weibo_appkey, text, images) {game.share_link = url;game.share_text = text;game.weibo_share_images = images;qyboot.openWindow('http://service.weibo.com/share/share.php?url= ' + url +'&type=button&ralateUid=' + relatedUid +'&language=zh_cn&default_text=' +'&appkey=' + weibo_appkey + '&title=' + text +'&source=&pic=' + images, 'share_in_weibo');})("+$(t)+", "+$(r)+", '"+$(a)+"', "+$(n)+", '"+$(i)+"');"};Ve.is_weixin_browser=function(){return"window.WeixinJSBridge !== undefined || (typeof navigator.userAgent === 'string' && navigator.userAgent.toLowerCase().match(/MicroMessenger/i)=='micromessenger')"};Ve.is_weixin_browser.isTest=!0;Ve.show_share_in_weixin_indicate_img=function(e){return"current_scene.layers[current_scene.layers.length - 1].appendChild(window.weixin_indicate_img= new QySprite({fill: '"+e.image+"',anchorPoint: {x: 1, y: 0},position: {x: "+e.x+",y: "+e.y+"}}));"};Ve.set_share_in_weixin=function(e){var t=e.appid,n=e.text,r=e.images,i=e.callback||"";n||(n=game.share_text||(game.game_name||"game")+(game.game_desc||"game"));r||(r=[]);r=r.join("||");return"(function(appid, text, images, callback) {images = images.split('||');images.forEach(function(image, index) {if (image[0] === '/') {images[index] = qyboot.getBaseURI() + image;} else if (/^assets/.test(image)) {images[index] = qyboot.getBaseURI() + qyboot.getPrefix() + qyboot.getDomainApp() + '/' + image;}});images = images.join('||');game.weixin_appid = appid;game.share_text = text;game.weixin_share_images = images;game.weixin_callback = callback;qyengine.registerWeixinMenuEvent();})("+$(t)+", "+$(n)+", '"+$(r)+"', "+$(i)+");"};Ve.set_keyframe_speed=function(e,t){var n=W(e,"speed"),r=W(e,"relative_speed")||!1,i="this.setFrameSpeed("+n+","+r+");";return D(i,t)};Ve.set_id=function(e,t){var n=W(e,"id"),r="(function(id){window[id] = this;this.id = id;}).call(this, "+$(n)+");";return D(r,t)};Ve.set_background=function(e){var t=W(e,"type"),n=W(e,"background_repeat"),r="(function(type, background_repeat){current_scene.removeChild(current_scene.background);current_scene.setBackground({background: type,background_repeat: background_repeat,size: {width: current_scene.width,height: current_scene.height}});var layers = current_scene.layers||[];for(var i = 0, length = layers.length; i<length; i++){current_scene.appendChild(layers[i]);}current_scene.stickyLayer && current_scene.appendChild(current_scene.stickyLayer)})("+$(t)+", '"+n+"');";return r};Ve.is_destroyed=function(e,t){e=null;var n="this.destroyed_||(this.isDestroyed && this.isDestroyed())";return D(n,t)};Ve.is_destroyed.isTest=!0;Ve.set_sprite_speed=function(e,t){var n=e.hsp,r=e.vsp,i=e.relative_hsp,a=e.relative_vsp,s="(function(hsp, vsp, relative_hsp, relative_vsp) {var type = this.background ? 'background' : 'currentSprite';if (!this[type])return;var speed = this[type].speed;if (relative_hsp) {speed.x += hsp;} else {speed.x = hsp;}if (relative_vsp) {speed.y += vsp;} else {speed.y = vsp;}}).call(this, "+n+", "+r+", "+i+", "+a+");";return D(s,t)};Ve.set_video_src=function(e,t){var n=e.src,r="this.setSrc && this.setSrc('"+n+"')";return D(r,t)};Ve.play_video=function(e,t){var n="this.play && this.play()";return D(n,t)};Ve.pause_video=function(e,t){var n="this.pause && this.pause()";return D(n,t)};Ve.replay_video=function(e,t){var n="this.replay && this.replay()";return D(n,t)};Ve.set_cursor=function(e){return"setCursor('"+e.cursor+"')"};Ve.set_shield=function(e,t){var n=e.setshield,r=e.shield,i="this.shieldEvent && this.shieldEvent("+JSON.stringify(n)+","+r+")";return D(i,t)};Ve.cancel_shield=function(e,t){var n=e.setshield,r="this.cancelShieldEvent && this.cancelShieldEvent("+JSON.stringify(n)+")";return D(r,t)};Ve.update_dataform=function(e){var t=e.dataform,n=e.id,r=e.data;return"qyengine.updateDataforms("+$(t)+","+$(n)+","+Y(r)+")"};Ve.delete_from_dataform=function(e){var t=e.dataform,n=e.id,r=e.data;return"qyengine.deleteFromDataform("+$(t)+","+$(n)+","+Y(r)+")"};Ve.set_shade=function(e,t){var n=e.applied,r=V(t);"this"===r.type?r="self":"other"===r.type?r="self.other":"id"===r.type&&(r=r.str);var i="this.setMask && this.setMask("+r+")";return D(i,n)};Ve.cancel_shade=function(e,t){var n="this.cancelMask && this.cancelMask()";return D(n,t)};Ve.set_sleep=function(e,t,n){var r=e.time,i=K(n);return"lime.scheduleManager.callAfter(function()"+i+".bind(this), game, "+r+");"};qyengine.supportedMethods=[];for(var ze in Ve)qyengine.supportedMethods.push(ze);var Ge=2;qyengine.resetCurCatBit=function(){Ge=2};qyengine.getCurCatBit=function(){return Ge};var Le={anime:{scaleTo:{},scaleBy:{},moveTo:{},moveBy:{},rotateTo:{},rotateBy:{},fadeTo:{},fadeBy:{},colorTo:{color:""},oldFormatMove:{}}};qyengine.resTypes=["background","timeline","sound","path","sprite","object","ranklist","scroller","text","scene","input","video","iframe"];qyengine.genGame=function(e){qyengine.gmjson=e;Te(e);for(var t="",n=0;n<qyengine.resTypes.length;n++)t+=pe(e,qyengine.resTypes[n])+"\n\n";t+=Ce(e);t+=Re(e);t+=ke(e);qyengine.gamecode=t;return t};window.game=window.current_game;window.engine=window.qyengine}()};null==window.isLime&&(window.isLime=!(window.json&&window.json.global&&"gmx"==window.json.global.renderer));qyengine.init=function(){qyengine.initUtil();qyengine.initBaseClass();qyengine.initGenCode()};qyengine.init();
